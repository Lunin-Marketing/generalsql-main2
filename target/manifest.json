{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/manifest/v6.json", "dbt_version": "1.2.2", "generated_at": "2022-10-22T23:21:21.283700Z", "invocation_id": "9a79e182-973b-45ef-a0da-8c84cee69745", "env": {}, "project_id": "da56b05026bc353b26537aae34f2e219", "user_id": "b33d4a82-5f22-462c-87b7-70667dc0ce69", "send_anonymous_usage_stats": true, "adapter_type": "postgres"}, "nodes": {"model.acton_marketing_data.test": {"raw_sql": "WITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'lead') }}\r\n\r\n), intermediate AS (\r\n\r\nSELECT\r\n    created_date::Timestamp AS created_date\r\nFROM base\r\nWHERE email ='100443596@alumnos.uc3m.es'\r\n\r\n)\r\n\r\nSELECT\r\n    {{ dbt_date.convert_timezone(\"created_date\", \"America/Los_Angeles\") }} As create_date\r\nFROM intermediate", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_date.convert_timezone"], "nodes": ["source.acton_marketing_data.salesforce.lead"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "test", "test"], "unique_id": "model.acton_marketing_data.test", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "test/test.sql", "original_file_path": "models/test/test.sql", "name": "test", "alias": "test", "checksum": {"name": "sha256", "checksum": "a7f9b3ad0ae5a655e81d1cf01fe74d84876e043b967ebec778c29e1e6de035bd"}, "tags": [], "refs": [], "sources": [["salesforce", "lead"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.1227105}, "model.acton_marketing_data.funnel_report_all_time_filters_industry": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n), final AS (\r\n\r\n    SELECT DISTINCT\r\n        base.industry\r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.funnel_report_all_time_lost"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_filters_industry"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_filters_industry", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_filters_industry.sql", "original_file_path": "models/funnel/funnel_report_all_time_filters_industry.sql", "name": "funnel_report_all_time_filters_industry", "alias": "funnel_report_all_time_filters_industry", "checksum": {"name": "sha256", "checksum": "c7d4c98370b026ce59cb26641d423445561759d5062cc9dc9d1c6a7a48c375d2"}, "tags": [], "refs": [["funnel_report_all_time_leads"], ["funnel_report_all_time_mqls"], ["funnel_report_all_time_sals"], ["funnel_report_all_time_sqls"], ["funnel_report_all_time_sqos"], ["funnel_report_all_time_demo"], ["funnel_report_all_time_voc"], ["funnel_report_all_time_closing"], ["funnel_report_all_time_won"], ["funnel_report_all_time_lost"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.1429906}, "model.acton_marketing_data.funnel_report_all_time_mql2sql_velocity": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        mql_created_date AS mql_date,\r\n        opportunity_id,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket,\r\n        opp_created_date AS sql_date,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket\r\n    FROM {{ref('opportunities_with_contacts')}}\r\n    WHERE type='New Business'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        mql_date,\r\n        sql_date,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        account_global_region,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket,\r\n        {{ dbt_utils.datediff(\"mql_date\",\"sql_date\",'day')}} AS mql2sql_velocity\r\n    FROM base\r\n    WHERE sql_date >= mql_date\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    opp_company_size_rev,\r\n    opp_lead_source,\r\n    opp_segment,\r\n    opp_industry,\r\n    opp_channel_bucket,\r\n    opp_industry_bucket,\r\n    sql_date,\r\n    mql2sql_velocity\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.opportunities_with_contacts"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_mql2sql_velocity"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_mql2sql_velocity", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_mql2sql_velocity.sql", "original_file_path": "models/funnel/funnel_report_all_time_mql2sql_velocity.sql", "name": "funnel_report_all_time_mql2sql_velocity", "alias": "funnel_report_all_time_mql2sql_velocity", "checksum": {"name": "sha256", "checksum": "c664b0df81c7668addc6bcfcc46cc1f8dcfcff51d86720a5f51eefd4e42bebe0"}, "tags": [], "refs": [["opportunities_with_contacts"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.1466982}, "model.acton_marketing_data.funnel_report_all_time_l20_velocity_opp": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opportunity_id,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket,\r\n        opp_created_date,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket\r\n    FROM {{ref('opportunities_with_contacts')}}\r\n    WHERE type='New Business'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opp_created_date,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket,\r\n        {{ dbt_utils.datediff(\"marketing_created_date\",\"opp_created_date\",'day')}} AS lead_to_opp_velocity\r\n    FROM base\r\n    WHERE opp_created_date >= marketing_created_date\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    opp_company_size_rev,\r\n    opp_lead_source,\r\n    opp_segment,\r\n    opp_industry,\r\n    opp_channel_bucket,\r\n    opp_industry_bucket,\r\n    opp_created_date,\r\n    lead_to_opp_velocity\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.opportunities_with_contacts"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_l20_velocity_opp"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_l20_velocity_opp", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_l20_velocity_opp.sql", "original_file_path": "models/funnel/funnel_report_all_time_l20_velocity_opp.sql", "name": "funnel_report_all_time_l20_velocity_opp", "alias": "funnel_report_all_time_l20_velocity_opp", "checksum": {"name": "sha256", "checksum": "9254fe4c290baa246bf90a18727ab413d8b3ef3f56d6d411a5a93ee7c6eda82b"}, "tags": [], "refs": [["opportunities_with_contacts"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.1655686}, "model.acton_marketing_data.funnel_report_all_time_lost": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n        SELECT DISTINCT\r\n        opp_source_xf.opportunity_id AS lost_id,\r\n        CONCAT('https://acton.my.salesforce.com/',opp_source_xf.opportunity_id) AS lost_url,\r\n        opp_source_xf.account_name,\r\n        opp_source_xf.type AS opp_type,\r\n        acv_deal_size_usd,\r\n        opp_source_xf.close_date AS lost_date,\r\n        CASE\r\n        WHEN opp_source_xf.account_global_region IS null THEN 'blank'\r\n        ELSE opp_source_xf.account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN opp_source_xf.company_size_rev IS null THEN 'blank'\r\n        ELSE opp_source_xf.company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_source_xf.opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_source_xf.opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN opp_source_xf.segment IS null THEN 'blank'\r\n        ELSE opp_source_xf.segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN opp_source_xf.industry IS null THEN 'blank'\r\n        ELSE opp_source_xf.industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN opp_source_xf.industry_bucket IS null THEN 'blank'\r\n        ELSE opp_source_xf.industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN opp_source_xf.channel_bucket IS null THEN 'blank'\r\n        ELSE opp_source_xf.channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE opp_offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation\r\n    FROM {{ref('opp_source_xf')}}\r\n    LEFT JOIN {{ref('account_source_xf')}} ON\r\n    opp_source_xf.account_id=account_source_xf.account_id\r\n    WHERE opp_source_xf.close_date IS NOT null\r\n    AND opp_source_xf.stage_name IN ('Closed \u2013 Lost No Resources / Budget','Closed \u2013 Lost Not Ready / No Decision','Closed \u2013 Lost Product Deficiency','Closed - Lost to Competitor', 'Closed Lost')\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.account_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_lost"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_lost", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_lost.sql", "original_file_path": "models/funnel/funnel_report_all_time_lost.sql", "name": "funnel_report_all_time_lost", "alias": "funnel_report_all_time_lost", "checksum": {"name": "sha256", "checksum": "8a9d6d2bda7b023c0abfd65560801adedc69d085e336fbc412db057ff53d8e7a"}, "tags": [], "refs": [["opp_source_xf"], ["account_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.1720326}, "model.acton_marketing_data.funnel_report_all_time_sqos_to_target": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH sqo_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS sqos_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_sqos'\r\n\r\n), actual_sqos AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sqo_date)::Date AS sqos_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT sqo_id) AS sqos\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    WHERE sqo_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    sqos_month,\r\n    actual_sqos.region,\r\n    sqos,\r\n    sqos_target,\r\n    sqos/sqos_target AS actual_vs_target\r\nFROM actual_sqos\r\nLEFT JOIN sqo_target ON\r\nactual_sqos.sqos_month=sqo_target.kpi_month\r\nAND actual_sqos.region=sqo_target.kpi_region\r\nWHERE region IS NOT null", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.kpi_targets", "model.acton_marketing_data.funnel_report_all_time_sqos"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_sqos_to_target"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_sqos_to_target", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_sqos_to_target.sql", "original_file_path": "models/funnel/funnel_report_all_time_sqos_to_target.sql", "name": "funnel_report_all_time_sqos_to_target", "alias": "funnel_report_all_time_sqos_to_target", "checksum": {"name": "sha256", "checksum": "83987d935de3b1bf18b1efa42c564969679b9fac98f394fb80a1e5c70c5c5124"}, "tags": [], "refs": [["kpi_targets"], ["funnel_report_all_time_sqos"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.1744523}, "model.acton_marketing_data.funnel_report_all_time_sqos": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        sqo_source_xf.opportunity_id AS sqo_id,\r\n        CONCAT('https://acton.my.salesforce.com/',sqo_source_xf.opportunity_id) AS sqo_url,\r\n        sqo_source_xf.discovery_date AS sqo_date,\r\n        account_name,\r\n        opportunity_name,\r\n        type AS opp_type,\r\n        owner_name,\r\n        sdr_name,\r\n        created_date,\r\n        close_date,\r\n        acv,\r\n        CASE\r\n        WHEN account_global_region IS null THEN 'blank'\r\n        ELSE account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE opp_offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation\r\n    FROM {{ref('sqo_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.sqo_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_sqos"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_sqos", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_sqos.sql", "original_file_path": "models/funnel/funnel_report_all_time_sqos.sql", "name": "funnel_report_all_time_sqos", "alias": "funnel_report_all_time_sqos", "checksum": {"name": "sha256", "checksum": "0188fc0bca8f02a7752cacba955f164af129befc3138bec71bc0c1740b836ce2"}, "tags": [], "refs": [["sqo_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.1766112}, "model.acton_marketing_data.funnel_report_all_time_filters_date": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n), final AS (\r\n\r\n    SELECT DISTINCT\r\n        base.date    \r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.funnel_report_all_time_lost"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_filters_date"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_filters_date", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_filters_date.sql", "original_file_path": "models/funnel/funnel_report_all_time_filters_date.sql", "name": "funnel_report_all_time_filters_date", "alias": "funnel_report_all_time_filters_date", "checksum": {"name": "sha256", "checksum": "2222effdd84473f6e1fd863cf5c4b90979c4cec5a9d0f08043886aa6254d0255"}, "tags": [], "refs": [["funnel_report_all_time_leads"], ["funnel_report_all_time_mqls"], ["funnel_report_all_time_sals"], ["funnel_report_all_time_sqls"], ["funnel_report_all_time_sqos"], ["funnel_report_all_time_demo"], ["funnel_report_all_time_voc"], ["funnel_report_all_time_closing"], ["funnel_report_all_time_won"], ["funnel_report_all_time_lost"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.1790948}, "model.acton_marketing_data.funnel_report_all_time_pipeline": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        sqo_source_xf.opportunity_id AS sqo_id,\r\n        CONCAT('https://acton.my.salesforce.com/',sqo_source_xf.opportunity_id) AS sqo_url,\r\n        sqo_source_xf.discovery_date AS sqo_date,\r\n        account_name,\r\n        opportunity_name,\r\n        stage_name,\r\n        type AS opp_type,\r\n        owner_name,\r\n        sdr_name,\r\n        created_date,\r\n        close_date,\r\n        acv,\r\n        CASE\r\n        WHEN account_global_region IS null THEN 'blank'\r\n        ELSE account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket\r\n    FROM {{ref('sqo_source_xf')}}\r\n\r\n) , final AS (\r\n\r\n    SELECT\r\n        sqo_id,\r\n        sqo_date,\r\n        opportunity_name,\r\n        stage_name,\r\n        opp_type,\r\n        acv,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        CASE\r\n            WHEN stage_name = 'Discovery' THEN '1.SQO'\r\n            WHEN stage_name = 'Demo' THEN '2.Demo'\r\n            WHEN stage_name = 'VOC/Negotiate' THEN '3.VOC'\r\n            WHEN stage_name = 'Closing' THEN '4.Closing'\r\n            WHEN stage_name = 'Implement' THEN '5.Closed Won'\r\n            WHEN LOWER(stage_name) LIKE '%lost%' THEN '6.Closed Lost'\r\n            WHEN stage_name = 'Not Renewed' THEN '7.Not Renewed'\r\n        END AS current_stage\r\n    FROM base\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.sqo_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_pipeline"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_pipeline", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_pipeline.sql", "original_file_path": "models/funnel/funnel_report_all_time_pipeline.sql", "name": "funnel_report_all_time_pipeline", "alias": "funnel_report_all_time_pipeline", "checksum": {"name": "sha256", "checksum": "d673b787eb32b5aeb73b1fa0ec4cfb17048d34a579f5089cef15c6986d5a3a65"}, "tags": [], "refs": [["sqo_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.1819956}, "model.acton_marketing_data.funnel_report_all_time_asp_to_target": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH asp_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS asp_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_asp'\r\n\r\n), actual_asp AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sqo_date)::Date AS asp_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        SUM(acv)/COUNT(DISTINCT sqo_id) AS asp\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    WHERE sqo_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    asp_month,\r\n    actual_asp.region,\r\n    asp,\r\n    asp_target,\r\n    asp/asp_target AS actual_vs_target\r\nFROM actual_asp\r\nLEFT JOIN asp_target ON\r\nactual_asp.asp_month=asp_target.kpi_month\r\nAND actual_asp.region=asp_target.kpi_region\r\nWHERE region IS NOT null", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.kpi_targets", "model.acton_marketing_data.funnel_report_all_time_sqos"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_asp_to_target"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_asp_to_target", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_asp_to_target.sql", "original_file_path": "models/funnel/funnel_report_all_time_asp_to_target.sql", "name": "funnel_report_all_time_asp_to_target", "alias": "funnel_report_all_time_asp_to_target", "checksum": {"name": "sha256", "checksum": "a3d211cf0c544e1ec6fab862d5ae7eb38fac299557f806be29cd96fe597b42cd"}, "tags": [], "refs": [["kpi_targets"], ["funnel_report_all_time_sqos"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.1841855}, "model.acton_marketing_data.funnel_report_all_time_intrapipe_to_target": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH intrapipe_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS intrapipe_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_intra_qtr_pipe'\r\n\r\n), actual_intrapipe AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sqo_date)::Date AS intrapipe_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        SUM(acv)/COUNT(DISTINCT sqo_id) AS intrapipe\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    WHERE sqo_date >= '2022-04-01'\r\n    AND DATE_TRUNC('month',sqo_date)=DATE_TRUNC('month',close_date)\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    intrapipe_month,\r\n    actual_intrapipe.region,\r\n    intrapipe,\r\n    intrapipe_target,\r\n    intrapipe/intrapipe_target AS actual_vs_target\r\nFROM actual_intrapipe\r\nLEFT JOIN intrapipe_target ON\r\nactual_intrapipe.intrapipe_month=intrapipe_target.kpi_month\r\nAND actual_intrapipe.region=intrapipe_target.kpi_region\r\nWHERE region IS NOT null", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.kpi_targets", "model.acton_marketing_data.funnel_report_all_time_sqos"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_intrapipe_to_target"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_intrapipe_to_target", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_intrapipe_to_target.sql", "original_file_path": "models/funnel/funnel_report_all_time_intrapipe_to_target.sql", "name": "funnel_report_all_time_intrapipe_to_target", "alias": "funnel_report_all_time_intrapipe_to_target", "checksum": {"name": "sha256", "checksum": "fc09779f6aec80abc31d0448010f40f2ac4eb7d6c6ac4d2569ea219ea2cf233b"}, "tags": [], "refs": [["kpi_targets"], ["funnel_report_all_time_sqos"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.1864383}, "model.acton_marketing_data.funnel_report_all_time_won": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        opp_sales_source_xf.opportunity_id AS won_id,\r\n        CONCAT('https://acton.my.salesforce.com/',opp_sales_source_xf.opportunity_id) AS won_url,\r\n        opp_sales_source_xf.close_date AS won_date,\r\n        account_name,\r\n        type AS opp_type,\r\n        acv,\r\n        opp_offer_asset_subtype_lead_creation,\r\n        opp_offer_asset_topic_lead_creation,\r\n        opp_offer_asset_type_lead_creation,\r\n        CASE\r\n        WHEN account_global_region IS null THEN 'blank'\r\n        ELSE account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE opp_offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation\r\n    FROM {{ref('opp_sales_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_sales_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_won"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_won", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_won.sql", "original_file_path": "models/funnel/funnel_report_all_time_won.sql", "name": "funnel_report_all_time_won", "alias": "funnel_report_all_time_won", "checksum": {"name": "sha256", "checksum": "6d1e6156888e9ede507ed4d8592a40dba9451ffcc17592bd42c7f059645f8820"}, "tags": [], "refs": [["opp_sales_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.1887493}, "model.acton_marketing_data.funnel_report_all_time_sal2sql_velocity": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        working_date,\r\n        opportunity_id,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket,\r\n        opp_created_date,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket\r\n    FROM {{ref('opportunities_with_contacts')}}\r\n    WHERE type='New Business'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        working_date,\r\n        opp_created_date,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket,\r\n        {{ dbt_utils.datediff(\"working_date\",\"opp_created_date\",'day')}} AS sal2sql_velocity\r\n    FROM base\r\n    WHERE opp_created_date >= working_date\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    opp_company_size_rev,\r\n    opp_lead_source,\r\n    opp_segment,\r\n    opp_industry,\r\n    opp_channel_bucket,\r\n    opp_industry_bucket,\r\n    opp_created_date,\r\n    sal2sql_velocity\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.opportunities_with_contacts"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_sal2sql_velocity"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_sal2sql_velocity", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_sal2sql_velocity.sql", "original_file_path": "models/funnel/funnel_report_all_time_sal2sql_velocity.sql", "name": "funnel_report_all_time_sal2sql_velocity", "alias": "funnel_report_all_time_sal2sql_velocity", "checksum": {"name": "sha256", "checksum": "142cfbb5a0c6d43f5e9787b78b67a26105dd9ac86deb20e9e2b39cd39b25a634"}, "tags": [], "refs": [["opportunities_with_contacts"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.1910484}, "model.acton_marketing_data.funnel_report_all_time_cwpipe_to_target": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH won_pipe_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS won_pipe_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_cw_pipe'\r\n\r\n), actual_won_pipe AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',won_date)::Date AS won_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        SUM(acv) AS won_pipe\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    WHERE won_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    won_month,\r\n    actual_won_pipe.region,\r\n    won_pipe,\r\n    won_pipe_target,\r\n    won_pipe/won_pipe_target AS actual_vs_target\r\nFROM actual_won_pipe\r\nLEFT JOIN won_pipe_target ON\r\nactual_won_pipe.won_month=won_pipe_target.kpi_month\r\nAND actual_won_pipe.region=won_pipe_target.kpi_region\r\nWHERE region IS NOT null", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.kpi_targets", "model.acton_marketing_data.funnel_report_all_time_won"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_cwpipe_to_target"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_cwpipe_to_target", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_cwpipe_to_target.sql", "original_file_path": "models/funnel/funnel_report_all_time_cwpipe_to_target.sql", "name": "funnel_report_all_time_cwpipe_to_target", "alias": "funnel_report_all_time_cwpipe_to_target", "checksum": {"name": "sha256", "checksum": "4407cd2039748d8c5803af007f7dff2448bcdd6c96ac210a4a6061580c129165"}, "tags": [], "refs": [["kpi_targets"], ["funnel_report_all_time_won"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.1968102}, "model.acton_marketing_data.funnel_report_all_time_l20_velocity_opp_annual": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opportunity_id,\r\n        opp_created_date,\r\n        type AS opp_type,\r\n        opp_segment\r\n    FROM {{ref('opportunities_with_contacts')}}\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opp_created_date,\r\n        opp_type,\r\n        opp_segment,\r\n        {{ dbt_utils.datediff(\"marketing_created_date\",\"opp_created_date\",'day')}} AS lead_to_opp_velocity\r\n    FROM base\r\n    WHERE opp_created_date >= marketing_created_date\r\n)\r\n\r\nSELECT\r\nopp_segment,\r\nopp_type,\r\nDATE_TRUNC('year',opp_created_date) AS opp_created_year,\r\nAVG(lead_to_opp_velocity) AS avg_lead_to_opp_velocity\r\nFROM final\r\nGROUP BY 1,2,3", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.opportunities_with_contacts"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_l20_velocity_opp_annual"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_l20_velocity_opp_annual", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_l20_velocity_opp_annual.sql", "original_file_path": "models/funnel/funnel_report_all_time_l20_velocity_opp_annual.sql", "name": "funnel_report_all_time_l20_velocity_opp_annual", "alias": "funnel_report_all_time_l20_velocity_opp_annual", "checksum": {"name": "sha256", "checksum": "34311d431bb4fe95a29daa9cf08e885570a2d53ba83249a4e33e7b8eeec5d76e"}, "tags": [], "refs": [["opportunities_with_contacts"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.199063}, "model.acton_marketing_data.funnel_report_all_time_sqo2demo_velocity": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH sqo_opp AS (\r\n\r\n    SELECT\r\n        sqo_id,\r\n        sqo_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n\r\n),  demo_opp AS (\r\n\r\n    SELECT\r\n        demo_id,\r\n        demo_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        demo_id,\r\n        demo_date,\r\n        sqo_date,\r\n        demo_opp.account_global_region,\r\n        demo_opp.company_size_rev,\r\n        demo_opp.opp_lead_source,\r\n        demo_opp.segment,\r\n        demo_opp.industry,\r\n        demo_opp.channel_bucket,\r\n        demo_opp.industry_bucket,\r\n        {{ dbt_utils.datediff(\"sqo_date\",\"demo_date\",'day')}} AS sqo2demo_velocity\r\n    FROM demo_opp\r\n    LEFT JOIN sqo_opp ON \r\n    demo_opp.demo_id=sqo_opp.sqo_id\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    company_size_rev,\r\n    opp_lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    demo_date,\r\n    sqo2demo_velocity\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_demo"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_sqo2demo_velocity"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_sqo2demo_velocity", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_sqo2demo_velocity.sql", "original_file_path": "models/funnel/funnel_report_all_time_sqo2demo_velocity.sql", "name": "funnel_report_all_time_sqo2demo_velocity", "alias": "funnel_report_all_time_sqo2demo_velocity", "checksum": {"name": "sha256", "checksum": "5350e1a0a85829b70086e07ea6501a4262afd1630e9d88aecebdfd60517720cd"}, "tags": [], "refs": [["funnel_report_all_time_sqos"], ["funnel_report_all_time_demo"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.204639}, "model.acton_marketing_data.funnel_report_all_time_voc": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        opp_voc_source_xf.opportunity_id AS voc_id,\r\n        CONCAT('https://acton.my.salesforce.com/',opp_voc_source_xf.opportunity_id) AS voc_url,\r\n        account_name,\r\n        type AS opp_type,\r\n        acv,\r\n        opp_voc_source_xf.negotiation_date AS voc_date,\r\n        CASE\r\n        WHEN account_global_region IS null THEN 'blank'\r\n        ELSE account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE opp_offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation\r\n    FROM {{ref('opp_voc_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_voc_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_voc"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_voc", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_voc.sql", "original_file_path": "models/funnel/funnel_report_all_time_voc.sql", "name": "funnel_report_all_time_voc", "alias": "funnel_report_all_time_voc", "checksum": {"name": "sha256", "checksum": "6730b38978cb34ed83af8d488cc29f8fd6d9b7dd7fd247211a885fc8f76258a9"}, "tags": [], "refs": [["opp_voc_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2105553}, "model.acton_marketing_data.funnel_report_all_time_filters_segment": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n), final AS (\r\n\r\n    SELECT DISTINCT\r\n        base.segment   \r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.funnel_report_all_time_lost"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_filters_segment"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_filters_segment", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_filters_segment.sql", "original_file_path": "models/funnel/funnel_report_all_time_filters_segment.sql", "name": "funnel_report_all_time_filters_segment", "alias": "funnel_report_all_time_filters_segment", "checksum": {"name": "sha256", "checksum": "489d54ed8a58c1e660f065985d24f82fbc2cd387425b2a52098ec16317fa5850"}, "tags": [], "refs": [["funnel_report_all_time_leads"], ["funnel_report_all_time_mqls"], ["funnel_report_all_time_sals"], ["funnel_report_all_time_sqls"], ["funnel_report_all_time_sqos"], ["funnel_report_all_time_demo"], ["funnel_report_all_time_voc"], ["funnel_report_all_time_closing"], ["funnel_report_all_time_won"], ["funnel_report_all_time_lost"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2125778}, "model.acton_marketing_data.funnel_report_all_time_clos2cw_velocity": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH won_opp AS (\r\n\r\n    SELECT\r\n        won_id,\r\n        won_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n\r\n),  closing_opp AS (\r\n\r\n    SELECT\r\n        closing_id,\r\n        closing_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        won_id,\r\n        closing_date,\r\n        won_date,\r\n        won_opp.account_global_region,\r\n        won_opp.company_size_rev,\r\n        won_opp.opp_lead_source,\r\n        won_opp.segment,\r\n        won_opp.industry,\r\n        won_opp.industry_bucket,\r\n        won_opp.channel_bucket,\r\n        {{ dbt_utils.datediff(\"closing_date\",\"won_date\",'day')}} AS closing2cw_velocity\r\n    FROM won_opp\r\n    LEFT JOIN closing_opp ON \r\n    won_opp.won_id=closing_opp.closing_id\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    company_size_rev,\r\n    opp_lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    won_date,\r\n    closing2cw_velocity\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.funnel_report_all_time_closing"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_clos2cw_velocity"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_clos2cw_velocity", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_clos2cw_velocity.sql", "original_file_path": "models/funnel/funnel_report_all_time_clos2cw_velocity.sql", "name": "funnel_report_all_time_clos2cw_velocity", "alias": "funnel_report_all_time_clos2cw_velocity", "checksum": {"name": "sha256", "checksum": "a5892c1d0e05e973c553b284be66c558d02e89156f3b909d16b2c258c37c0727"}, "tags": [], "refs": [["funnel_report_all_time_won"], ["funnel_report_all_time_closing"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2152762}, "model.acton_marketing_data.funnel_report_all_time_sqls_to_target": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH sql_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS sqls_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_sqls'\r\n\r\n), actual_sqls AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sql_date)::Date AS sqls_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT sql_id) AS sqls\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    WHERE sql_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    sqls_month,\r\n    actual_sqls.region,\r\n    sqls,\r\n    sqls_target,\r\n    sqls/sqls_target AS actual_vs_target\r\nFROM actual_sqls\r\nLEFT JOIN sql_target ON\r\nactual_sqls.sqls_month=sql_target.kpi_month\r\nAND actual_sqls.region=sql_target.kpi_region\r\nWHERE region IS NOT null", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.kpi_targets", "model.acton_marketing_data.funnel_report_all_time_sqls"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_sqls_to_target"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_sqls_to_target", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_sqls_to_target.sql", "original_file_path": "models/funnel/funnel_report_all_time_sqls_to_target.sql", "name": "funnel_report_all_time_sqls_to_target", "alias": "funnel_report_all_time_sqls_to_target", "checksum": {"name": "sha256", "checksum": "d640d8dac89fafd2cda15a540b0cc1a75a51aa48f14b8a861d9f769d0aef1253"}, "tags": [], "refs": [["kpi_targets"], ["funnel_report_all_time_sqls"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2215614}, "model.acton_marketing_data.funnel_report_all_time_sals": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        sal_source_xf.person_id AS sal_id,\r\n        CONCAT('https://acton.my.salesforce.com/',sal_source_xf.person_id) AS sal_url,\r\n        sal_source_xf.working_date AS sal_date,\r\n        sal_source_xf.mql_most_recent_date AS mql_date,\r\n        company,\r\n        is_hand_raiser,\r\n        CASE\r\n        WHEN global_region IS null THEN 'blank'\r\n        ELSE global_region\r\n    END AS global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN lead_source IS null THEN 'blank'\r\n        ELSE lead_source\r\n    END AS lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation,\r\n    CASE\r\n        WHEN campaign_lead_creation IS null THEN 'blank'\r\n        ELSE campaign_lead_creation\r\n    END AS campaign_lead_creation\r\n    FROM {{ref('sal_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.sal_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_sals"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_sals", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_sals.sql", "original_file_path": "models/funnel/funnel_report_all_time_sals.sql", "name": "funnel_report_all_time_sals", "alias": "funnel_report_all_time_sals", "checksum": {"name": "sha256", "checksum": "75d6daed90c026fefd325367ae1d6028e748cc9b6174b86a0d922e58bd7bd0f9"}, "tags": [], "refs": [["sal_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.223625}, "model.acton_marketing_data.funnel_report_all_time_sql2sqo_velocity": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH sqo_opp AS (\r\n\r\n    SELECT\r\n        sqo_id,\r\n        sqo_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n\r\n),  sql_opp AS (\r\n\r\n    SELECT\r\n        sql_id,\r\n        sql_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        sqo_id,\r\n        sql_date,\r\n        sqo_date,\r\n        sqo_opp.account_global_region,\r\n        sqo_opp.company_size_rev,\r\n        sqo_opp.opp_lead_source,\r\n        sqo_opp.segment,\r\n        sqo_opp.industry,\r\n        sqo_opp.channel_bucket,\r\n        sqo_opp.industry_bucket,\r\n        {{ dbt_utils.datediff(\"sql_date\",\"sqo_date\",'day')}} AS sql2sqo_velocity\r\n    FROM sqo_opp\r\n    LEFT JOIN sql_opp ON \r\n    sqo_opp.sqo_id=sql_opp.sql_id\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    company_size_rev,\r\n    opp_lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    sqo_date,\r\n    sql2sqo_velocity\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_sqls"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_sql2sqo_velocity"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_sql2sqo_velocity", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_sql2sqo_velocity.sql", "original_file_path": "models/funnel/funnel_report_all_time_sql2sqo_velocity.sql", "name": "funnel_report_all_time_sql2sqo_velocity", "alias": "funnel_report_all_time_sql2sqo_velocity", "checksum": {"name": "sha256", "checksum": "0cbde095c5bd5f94bdd8e7a3ed2989ef87697e6dc7f834eac1e9d726a1db1ccf"}, "tags": [], "refs": [["funnel_report_all_time_sqos"], ["funnel_report_all_time_sqls"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2257864}, "model.acton_marketing_data.funnel_report_all_time_l2m_to_target": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH l2m_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS l2m_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_l2m_conv'\r\n\r\n), actual_leads AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',created_date)::Date AS leads_month,\r\n        CASE \r\n            WHEN global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT lead_id) AS leads\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    WHERE created_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n\r\n), actual_mqls AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',mql_date)::Date AS mqls_month,\r\n        CASE \r\n            WHEN global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT mql_id) AS mqls\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    WHERE mql_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n\r\n), actual_l2m AS (\r\n\r\n    SELECT\r\n        mqls_month,\r\n        actual_mqls.region,\r\n        SUM(mqls)/SUM(leads) AS l2m_actual\r\n    FROM actual_mqls\r\n    LEFT JOIN actual_leads ON \r\n    actual_mqls.region=actual_leads.region\r\n    AND actual_mqls.mqls_month=actual_leads.leads_month\r\n    WHERE actual_mqls.region IS NOT null\r\n    GROUP BY 1,2\r\n\r\n)\r\n\r\nSELECT\r\n    mqls_month,\r\n    actual_l2m.region,\r\n    l2m_actual,\r\n    l2m_target,\r\n    l2m_actual/l2m_target AS actual_vs_target\r\nFROM actual_l2m\r\nLEFT JOIN l2m_target ON\r\nactual_l2m.mqls_month=l2m_target.kpi_month\r\nAND actual_l2m.region=l2m_target.kpi_region\r\nWHERE region IS NOT null", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.kpi_targets", "model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_mqls"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_l2m_to_target"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_l2m_to_target", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_l2m_to_target.sql", "original_file_path": "models/funnel/funnel_report_all_time_l2m_to_target.sql", "name": "funnel_report_all_time_l2m_to_target", "alias": "funnel_report_all_time_l2m_to_target", "checksum": {"name": "sha256", "checksum": "562ee0943739a8efd0266ee4c1b62d1655b6a81cd9bab6ba5ca8aa7f8d86f200"}, "tags": [], "refs": [["kpi_targets"], ["funnel_report_all_time_leads"], ["funnel_report_all_time_mqls"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.232143}, "model.acton_marketing_data.funnel_report_all_time_sqls": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        sql_source_xf.sql_id,\r\n        CONCAT('https://acton.my.salesforce.com/',sql_source_xf.sql_id) AS sql_url,\r\n        sql_source_xf.created_date AS sql_date,\r\n        account_name,\r\n        opportunity_name,\r\n        type AS opp_type,\r\n        owner_name,\r\n        sdr_name,\r\n        CASE\r\n        WHEN account_global_region IS null THEN 'blank'\r\n        ELSE account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE opp_offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation\r\n    FROM {{ref('sql_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.sql_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_sqls"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_sqls", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_sqls.sql", "original_file_path": "models/funnel/funnel_report_all_time_sqls.sql", "name": "funnel_report_all_time_sqls", "alias": "funnel_report_all_time_sqls", "checksum": {"name": "sha256", "checksum": "0b0594cc8c572526c613201d9bd6c6a6fb9916f8578d9af5ea5f0c4e3da9c994"}, "tags": [], "refs": [["sql_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.234674}, "model.acton_marketing_data.funnel_report_all_time_cohort": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n    --person fields\r\n        person_id,\r\n        marketing_created_date,\r\n        mql_created_date,\r\n        sal_created_date,\r\n        person_status,\r\n        email,\r\n        person_owner_id,\r\n\r\n    --opp fields\r\n        opportunity_id,\r\n        stage_name,\r\n        opp_type,\r\n        opp_created_date,\r\n        discovery_date,\r\n        demo_date,\r\n        voc_date,\r\n        closing_date,\r\n        close_date,\r\n        cw_date,\r\n        cl_date,\r\n\r\n    --Info\r\n        CASE\r\n            WHEN global_region IS null THEN 'blank'\r\n            ELSE global_region\r\n        END AS global_region,\r\n        CASE\r\n            WHEN company_size_rev IS null THEN 'blank'\r\n            ELSE company_size_rev\r\n        END AS company_size_rev,\r\n        CASE\r\n            WHEN lead_source IS null THEN 'blank'\r\n            ELSE lead_source\r\n        END AS lead_source,\r\n        CASE\r\n            WHEN segment IS null THEN 'blank'\r\n            ELSE segment\r\n        END AS segment,\r\n        CASE\r\n            WHEN industry IS null THEN 'blank'\r\n            ELSE industry\r\n        END AS industry,\r\n        CASE\r\n            WHEN industry_bucket IS null THEN 'blank'\r\n            ELSE industry_bucket\r\n        END AS industry_bucket,\r\n        CASE\r\n            WHEN channel_bucket IS null THEN 'blank'\r\n            ELSE channel_bucket\r\n        END AS channel_bucket,\r\n        CASE\r\n            WHEN person_offer_asset_name_lead_creation IS null THEN 'blank'\r\n            ELSE person_offer_asset_name_lead_creation\r\n        END AS offer_asset_name_lead_creation,\r\n        CASE\r\n            WHEN account_global_region IS null THEN 'blank'\r\n            ELSE account_global_region\r\n        END AS account_global_region,\r\n        CASE\r\n            WHEN opp_company_size_rev IS null THEN 'blank'\r\n            ELSE opp_company_size_rev\r\n        END AS opp_company_size_rev,\r\n        CASE\r\n            WHEN opp_lead_source IS null THEN 'blank'\r\n            ELSE opp_lead_source\r\n        END AS opp_lead_source,\r\n        CASE\r\n            WHEN opp_segment IS null THEN 'blank'\r\n            ELSE opp_segment\r\n        END AS opp_segment,\r\n        CASE\r\n            WHEN opp_industry IS null THEN 'blank'\r\n            ELSE opp_industry\r\n        END AS opp_industry,\r\n        CASE\r\n            WHEN opp_industry_bucket IS null THEN 'blank'\r\n            ELSE opp_industry_bucket\r\n        END AS opp_industry_bucket,\r\n        CASE\r\n            WHEN opp_channel_bucket IS null THEN 'blank'\r\n            ELSE opp_channel_bucket\r\n        END AS opp_channel_bucket,\r\n        CASE\r\n            WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n            ELSE opp_offer_asset_name_lead_creation\r\n        END AS opp_offer_asset_name_lead_creation,\r\n\r\n    --Flags\r\n        is_hand_raiser,\r\n        is_mql,\r\n        is_sal,\r\n        is_sql,\r\n        is_sqo,\r\n        is_demo,\r\n        is_voc,\r\n        is_closing,\r\n        is_cl,\r\n        is_cw,\r\n        is_won\r\n    FROM {{ref('lead_to_cw_cohort')}}\r\n\r\n)\r\n\r\nSELECT\r\n--ID Fields\r\n    person_id,\r\n    CASE\r\n        WHEN is_mql = 1 THEN person_id\r\n        ELSE null\r\n    END AS mql_id,\r\n    CASE\r\n        WHEN is_sal = 1 THEN person_id\r\n        ELSE null\r\n    END AS sal_id,\r\n    CASE\r\n        WHEN is_sql = 1 THEN opportunity_id\r\n        ELSE null\r\n    END AS sql_id,\r\n    CASE\r\n        WHEN is_sqo = 1 THEN opportunity_id\r\n        ELSE null\r\n    END AS sqo_id,\r\n    CASE\r\n        WHEN is_demo = 1 THEN opportunity_id\r\n        ELSE null\r\n    END AS demo_id,\r\n    CASE\r\n        WHEN is_voc = 1 THEN opportunity_id\r\n        ELSE null\r\n    END AS voc_id,\r\n    CASE\r\n        WHEN is_closing = 1 THEN opportunity_id\r\n        ELSE null\r\n    END AS closing_id,\r\n    CASE\r\n        WHEN is_cl = 1 THEN opportunity_id\r\n        ELSE null\r\n    END AS cl_id,\r\n    CASE\r\n        WHEN is_cw = 1 THEN opportunity_id\r\n        ELSE null\r\n    END AS cw_id,\r\n\r\n--person fields\r\n        marketing_created_date,\r\n        mql_created_date,\r\n        sal_created_date,\r\n        person_status,\r\n\r\n--opp fields\r\n        opportunity_id,\r\n        opp_type,\r\n        stage_name,\r\n        opp_created_date,\r\n        discovery_date,\r\n        demo_date,\r\n        voc_date,\r\n        closing_date,\r\n        close_date,\r\n        cw_date,\r\n        cl_date,\r\n\r\n-- person data\r\n    global_region,\r\n    company_size_rev,\r\n    lead_source,\r\n    segment,\r\n    industry,\r\n    industry_bucket,\r\n    channel_bucket,\r\n    offer_asset_name_lead_creation,\r\n\r\n-- opp data\r\n    account_global_region,\r\n    opp_company_size_rev,\r\n    opp_lead_source,\r\n    opp_segment,\r\n    opp_industry,\r\n    opp_industry_bucket,\r\n    opp_channel_bucket,\r\n    opp_offer_asset_name_lead_creation,\r\n\r\n--Flags\r\n    is_hand_raiser,\r\n    is_mql,\r\n    is_sal,\r\n    is_sql,\r\n    is_sqo,\r\n    is_demo,\r\n    is_voc,\r\n    is_closing,\r\n    is_cl,\r\n    is_cw,\r\n    is_won\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.lead_to_cw_cohort"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_cohort"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_cohort", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_cohort.sql", "original_file_path": "models/funnel/funnel_report_all_time_cohort.sql", "name": "funnel_report_all_time_cohort", "alias": "funnel_report_all_time_cohort", "checksum": {"name": "sha256", "checksum": "a4813364e902ce287645ff54486c9030b85b0a72dcd2cc357488a4785accdb1b"}, "tags": [], "refs": [["lead_to_cw_cohort"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2367904}, "model.acton_marketing_data.funnel_report_all_time_closing": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        opp_closing_source_xf.opportunity_id AS closing_id,\r\n        CONCAT('https://acton.my.salesforce.com/',opp_closing_source_xf.opportunity_id) AS closing_url,\r\n        acv,\r\n        account_name,\r\n        type AS opp_type,\r\n        opp_closing_source_xf.closing_date AS closing_date,\r\n        CASE\r\n        WHEN account_global_region IS null THEN 'blank'\r\n        ELSE account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE opp_offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation\r\n    FROM {{ref('opp_closing_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_closing_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_closing"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_closing", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_closing.sql", "original_file_path": "models/funnel/funnel_report_all_time_closing.sql", "name": "funnel_report_all_time_closing", "alias": "funnel_report_all_time_closing", "checksum": {"name": "sha256", "checksum": "83324f52b4a2f6b22128ac84dc04594350ea48362ecb673ff94af965274de061"}, "tags": [], "refs": [["opp_closing_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2389977}, "model.acton_marketing_data.funnel_report_all_time_filters_channelbucket": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n), final AS (\r\n\r\n    SELECT DISTINCT\r\n        base.channel_bucket\r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.funnel_report_all_time_lost"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_filters_channelbucket"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_filters_channelbucket", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_filters_channelbucket.sql", "original_file_path": "models/funnel/funnel_report_all_time_filters_channelbucket.sql", "name": "funnel_report_all_time_filters_channelbucket", "alias": "funnel_report_all_time_filters_channelbucket", "checksum": {"name": "sha256", "checksum": "ca70d41182a7716a9d7460c6e3d5e1f86c0d107b4b47afc2681e174eb00142fb"}, "tags": [], "refs": [["funnel_report_all_time_leads"], ["funnel_report_all_time_mqls"], ["funnel_report_all_time_sals"], ["funnel_report_all_time_sqls"], ["funnel_report_all_time_sqos"], ["funnel_report_all_time_demo"], ["funnel_report_all_time_voc"], ["funnel_report_all_time_closing"], ["funnel_report_all_time_won"], ["funnel_report_all_time_lost"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.241413}, "model.acton_marketing_data.funnel_report_all_time_filters_leadsource": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n), final AS (\r\n\r\n    SELECT DISTINCT\r\n        base.lead_source\r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.funnel_report_all_time_lost"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_filters_leadsource"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_filters_leadsource", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_filters_leadsource.sql", "original_file_path": "models/funnel/funnel_report_all_time_filters_leadsource.sql", "name": "funnel_report_all_time_filters_leadsource", "alias": "funnel_report_all_time_filters_leadsource", "checksum": {"name": "sha256", "checksum": "f4159bb8f5e13583482a47000cc6e983d86587356fbfca0e3e6f059c20963f5e"}, "tags": [], "refs": [["funnel_report_all_time_leads"], ["funnel_report_all_time_mqls"], ["funnel_report_all_time_sals"], ["funnel_report_all_time_sqls"], ["funnel_report_all_time_sqos"], ["funnel_report_all_time_demo"], ["funnel_report_all_time_voc"], ["funnel_report_all_time_closing"], ["funnel_report_all_time_won"], ["funnel_report_all_time_lost"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.244046}, "model.acton_marketing_data.funnel_report_all_time_sqo2won_velocity": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH sqo_opp AS (\r\n\r\n    SELECT\r\n        sqo_id,\r\n        sqo_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n\r\n), won_opp AS (\r\n\r\n    SELECT\r\n        won_id,\r\n        won_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        won_id,\r\n        won_date,\r\n        sqo_date,\r\n        won_opp.account_global_region,\r\n        won_opp.company_size_rev,\r\n        won_opp.opp_lead_source,\r\n        won_opp.segment,\r\n        won_opp.industry,\r\n        won_opp.channel_bucket,\r\n        won_opp.industry_bucket,\r\n        {{ dbt_utils.datediff(\"sqo_date\",\"won_date\",'day')}} AS sqo2won_velocity\r\n    FROM won_opp\r\n    LEFT JOIN sqo_opp ON \r\n    won_opp.won_id=sqo_opp.sqo_id\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    company_size_rev,\r\n    opp_lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    won_date,\r\n    sqo2won_velocity\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_won"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_sqo2won_velocity"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_sqo2won_velocity", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_sqo2won_velocity.sql", "original_file_path": "models/funnel/funnel_report_all_time_sqo2won_velocity.sql", "name": "funnel_report_all_time_sqo2won_velocity", "alias": "funnel_report_all_time_sqo2won_velocity", "checksum": {"name": "sha256", "checksum": "23b63f71ee3851840b8ca0b51986987a0680a6b7df52bbe3f679075c676513f7"}, "tags": [], "refs": [["funnel_report_all_time_sqos"], ["funnel_report_all_time_won"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.246932}, "model.acton_marketing_data.funnel_report_all_time_filters_companysizerev": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n), final AS (\r\n\r\n    SELECT DISTINCT\r\n        base.company_size_rev   \r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.funnel_report_all_time_lost"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_filters_companysizerev"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_filters_companysizerev", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_filters_companysizerev.sql", "original_file_path": "models/funnel/funnel_report_all_time_filters_companysizerev.sql", "name": "funnel_report_all_time_filters_companysizerev", "alias": "funnel_report_all_time_filters_companysizerev", "checksum": {"name": "sha256", "checksum": "6f654b40ff5eda766b8cbd1b1807b99116ebd6fdadcfae654dd4ccefc25797e2"}, "tags": [], "refs": [["funnel_report_all_time_leads"], ["funnel_report_all_time_mqls"], ["funnel_report_all_time_sals"], ["funnel_report_all_time_sqls"], ["funnel_report_all_time_sqos"], ["funnel_report_all_time_demo"], ["funnel_report_all_time_voc"], ["funnel_report_all_time_closing"], ["funnel_report_all_time_won"], ["funnel_report_all_time_lost"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2526536}, "model.acton_marketing_data.funnel_report_all_time_close_won_velocity": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH won_opp AS (\r\n\r\n    SELECT\r\n        won_id,\r\n        won_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n\r\n),  sql_opp AS (\r\n\r\n    SELECT\r\n        sql_id,\r\n        sql_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        won_id,\r\n        sql_date,\r\n        won_date,\r\n        won_opp.account_global_region,\r\n        won_opp.company_size_rev,\r\n        won_opp.opp_lead_source,\r\n        won_opp.segment,\r\n        won_opp.industry,\r\n        won_opp.industry_bucket,\r\n        won_opp.channel_bucket,\r\n        {{ dbt_utils.datediff(\"sql_date\",\"won_date\",'day')}} AS cw_velocity\r\n    FROM won_opp\r\n    LEFT JOIN sql_opp ON \r\n    won_opp.won_id=sql_opp.sql_id\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    company_size_rev,\r\n    opp_lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    won_date,\r\n    cw_velocity\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.funnel_report_all_time_sqls"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_close_won_velocity"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_close_won_velocity", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_close_won_velocity.sql", "original_file_path": "models/funnel/funnel_report_all_time_close_won_velocity.sql", "name": "funnel_report_all_time_close_won_velocity", "alias": "funnel_report_all_time_close_won_velocity", "checksum": {"name": "sha256", "checksum": "962a7f7f23a3cda555e49de6d706d9d5e516ed9af2be7029982c59f0e862ff19"}, "tags": [], "refs": [["funnel_report_all_time_won"], ["funnel_report_all_time_sqls"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2553854}, "model.acton_marketing_data.funnel_report_all_time_l20_velocity_mlc": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opportunity_id,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket,\r\n        opp_created_date,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket\r\n    FROM {{ref('opportunities_with_contacts')}}\r\n    WHERE type='New Business'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opp_created_date,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket,\r\n        {{ dbt_utils.datediff(\"marketing_created_date\",\"opp_created_date\",'day')}} AS lead_to_opp_velocity\r\n    FROM base\r\n    WHERE opp_created_date >= marketing_created_date\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    opp_company_size_rev,\r\n    opp_lead_source,\r\n    opp_segment,\r\n    opp_industry,\r\n    opp_channel_bucket,\r\n    opp_industry_bucket,\r\n    marketing_created_date,\r\n    lead_to_opp_velocity\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.opportunities_with_contacts"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_l20_velocity_mlc"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_l20_velocity_mlc", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_l20_velocity_mlc.sql", "original_file_path": "models/funnel/funnel_report_all_time_l20_velocity_mlc.sql", "name": "funnel_report_all_time_l20_velocity_mlc", "alias": "funnel_report_all_time_l20_velocity_mlc", "checksum": {"name": "sha256", "checksum": "39f21f8aec619c16ad7a66ef1bfe929279552372f979748660dd044e7b10dc5e"}, "tags": [], "refs": [["opportunities_with_contacts"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2612188}, "model.acton_marketing_data.funnel_report_all_time_m2sql_to_target": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH m2sql_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS m2sql_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_m2sql_conv'\r\n\r\n), actual_sqls AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sql_date)::Date AS sqls_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT sql_id) AS sqls\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    WHERE sql_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n\r\n), actual_mqls AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',mql_date)::Date AS mqls_month,\r\n        CASE \r\n            WHEN global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT mql_id) AS mqls\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    WHERE mql_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n\r\n), actual_m2sql AS (\r\n\r\n    SELECT\r\n        sqls_month,\r\n        actual_sqls.region,\r\n        SUM(sqls)/SUM(mqls) AS m2sql_actual\r\n    FROM actual_sqls\r\n    LEFT JOIN actual_mqls ON \r\n    actual_sqls.region=actual_mqls.region\r\n    AND actual_sqls.sqls_month=actual_mqls.mqls_month\r\n    WHERE actual_sqls.region IS NOT null\r\n    GROUP BY 1,2\r\n\r\n)\r\n\r\nSELECT\r\n    sqls_month,\r\n    actual_m2sql.region,\r\n    m2sql_actual,\r\n    m2sql_target,\r\n    m2sql_actual/m2sql_target AS actual_vs_target\r\nFROM actual_m2sql\r\nLEFT JOIN m2sql_target ON\r\nactual_m2sql.sqls_month=m2sql_target.kpi_month\r\nAND actual_m2sql.region=m2sql_target.kpi_region\r\nWHERE region IS NOT null", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.kpi_targets", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_mqls"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_m2sql_to_target"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_m2sql_to_target", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_m2sql_to_target.sql", "original_file_path": "models/funnel/funnel_report_all_time_m2sql_to_target.sql", "name": "funnel_report_all_time_m2sql_to_target", "alias": "funnel_report_all_time_m2sql_to_target", "checksum": {"name": "sha256", "checksum": "415f99ad2ceed193d25f2eadb325bdfbb31a76c4fa08f665f119b5fb6e274377"}, "tags": [], "refs": [["kpi_targets"], ["funnel_report_all_time_sqls"], ["funnel_report_all_time_mqls"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2665808}, "model.acton_marketing_data.funnel_report_all_time_voc2closing_velocity": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH voc_opp AS (\r\n\r\n    SELECT\r\n        voc_id,\r\n        voc_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n\r\n),  closing_opp AS (\r\n\r\n    SELECT\r\n        closing_id,\r\n        closing_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        closing_id,\r\n        voc_date,\r\n        closing_date,\r\n        closing_opp.account_global_region,\r\n        closing_opp.company_size_rev,\r\n        closing_opp.opp_lead_source,\r\n        closing_opp.segment,\r\n        closing_opp.industry,\r\n        closing_opp.industry_bucket,\r\n        closing_opp.channel_bucket,\r\n        {{ dbt_utils.datediff(\"voc_date\",\"closing_date\",'day')}} AS voc2closing_velocity\r\n    FROM closing_opp\r\n    LEFT JOIN voc_opp ON \r\n    closing_opp.closing_id=voc_opp.voc_id\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    company_size_rev,\r\n    opp_lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    closing_date,\r\n    voc2closing_velocity\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_closing"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_voc2closing_velocity"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_voc2closing_velocity", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_voc2closing_velocity.sql", "original_file_path": "models/funnel/funnel_report_all_time_voc2closing_velocity.sql", "name": "funnel_report_all_time_voc2closing_velocity", "alias": "funnel_report_all_time_voc2closing_velocity", "checksum": {"name": "sha256", "checksum": "63fd0da0f8689cd59d51fac8a4cd859a89e2169aa4765ac545f1e475fa1b3dfe"}, "tags": [], "refs": [["funnel_report_all_time_voc"], ["funnel_report_all_time_closing"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2688732}, "model.acton_marketing_data.funnel_report_all_time_m2sal_velocity": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH sals AS (\r\n\r\n    SELECT\r\n        sal_id,\r\n        sal_date,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n\r\n),  mqls AS (\r\n\r\n    SELECT\r\n        mql_id,\r\n        mql_date,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        sal_id,\r\n        sal_date,\r\n        mql_date,\r\n        sals.global_region,\r\n        sals.company_size_rev,\r\n        sals.lead_source,\r\n        sals.segment,\r\n        sals.industry,\r\n        sals.channel_bucket,\r\n        sals.industry_bucket,\r\n        {{ dbt_utils.datediff(\"mql_date\",\"sal_date\",'day')}} AS m2sal_velocity\r\n    FROM sals\r\n    LEFT JOIN mqls ON \r\n    sals.sal_id=mqls.mql_id\r\n)\r\n\r\nSELECT\r\n    global_region,\r\n    company_size_rev,\r\n    lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    sal_date,\r\n    m2sal_velocity\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_mqls"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_m2sal_velocity"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_m2sal_velocity", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_m2sal_velocity.sql", "original_file_path": "models/funnel/funnel_report_all_time_m2sal_velocity.sql", "name": "funnel_report_all_time_m2sal_velocity", "alias": "funnel_report_all_time_m2sal_velocity", "checksum": {"name": "sha256", "checksum": "7ef189dd937371b5e9e2a5d1170ca27a4d9b1b638b1208552153edc99e5fffee"}, "tags": [], "refs": [["funnel_report_all_time_sals"], ["funnel_report_all_time_mqls"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2752564}, "model.acton_marketing_data.funnel_report_all_time_filters_globalregion": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n), final AS (\r\n\r\n    SELECT DISTINCT\r\n        base.global_region \r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.funnel_report_all_time_lost"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_filters_globalregion"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_filters_globalregion", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_filters_globalregion.sql", "original_file_path": "models/funnel/funnel_report_all_time_filters_globalregion.sql", "name": "funnel_report_all_time_filters_globalregion", "alias": "funnel_report_all_time_filters_globalregion", "checksum": {"name": "sha256", "checksum": "96dd9d891fab0f388149a7c74133c7a962278fcd50c6b64eb041c1f8acbc09cc"}, "tags": [], "refs": [["funnel_report_all_time_leads"], ["funnel_report_all_time_mqls"], ["funnel_report_all_time_sals"], ["funnel_report_all_time_sqls"], ["funnel_report_all_time_sqos"], ["funnel_report_all_time_demo"], ["funnel_report_all_time_voc"], ["funnel_report_all_time_closing"], ["funnel_report_all_time_won"], ["funnel_report_all_time_lost"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2810016}, "model.acton_marketing_data.funnel_report_all_time_mqls": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        lead_mql_source_xf.person_id AS mql_id,\r\n        CONCAT('https://acton.my.salesforce.com/',lead_mql_source_xf.person_id) AS mql_url,\r\n        lead_mql_source_xf.mql_most_recent_date AS mql_date,\r\n        lead_mql_source_xf.working_date,\r\n        company,\r\n        first_name,\r\n        last_name,\r\n        title,\r\n        person_status,\r\n        country,\r\n        is_hand_raiser,\r\n        CASE \r\n            WHEN working_date IS null then 'No'\r\n            ELSE 'Yes'\r\n        END AS is_working,\r\n        CASE\r\n            WHEN global_region IS null THEN 'blank'\r\n            ELSE global_region\r\n        END AS global_region,\r\n        CASE\r\n            WHEN company_size_rev IS null THEN 'blank'\r\n            ELSE company_size_rev\r\n        END AS company_size_rev,\r\n        CASE\r\n            WHEN lead_source IS null THEN 'blank'\r\n            ELSE lead_source\r\n        END AS lead_source,\r\n        CASE\r\n            WHEN segment IS null THEN 'blank'\r\n            ELSE segment\r\n        END AS segment,\r\n        CASE\r\n            WHEN industry IS null THEN 'blank'\r\n            ELSE industry\r\n        END AS industry,\r\n        CASE\r\n            WHEN industry_bucket IS null THEN 'blank'\r\n            ELSE industry_bucket\r\n        END AS industry_bucket,\r\n        CASE\r\n            WHEN channel_bucket IS null THEN 'blank'\r\n            ELSE channel_bucket\r\n        END AS channel_bucket,\r\n        CASE\r\n            WHEN offer_asset_name_lead_creation IS null THEN 'blank'\r\n            ELSE offer_asset_name_lead_creation\r\n        END AS offer_asset_name_lead_creation,\r\n        CASE\r\n            WHEN campaign_lead_creation IS null THEN 'blank'\r\n            ELSE campaign_lead_creation\r\n        END AS campaign_lead_creation\r\n    FROM {{ref('lead_mql_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.lead_mql_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_mqls"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_mqls", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_mqls.sql", "original_file_path": "models/funnel/funnel_report_all_time_mqls.sql", "name": "funnel_report_all_time_mqls", "alias": "funnel_report_all_time_mqls", "checksum": {"name": "sha256", "checksum": "3212cd504116c279287f3ac0a1cdf23349270cac1f134a5eccfd52ae16579b68"}, "tags": [], "refs": [["lead_mql_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2836769}, "model.acton_marketing_data.funnel_report_all_time_sql2sqo_to_target": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH sql2sqo_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS sql2sqo_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_sql2sqo_conv'\r\n\r\n), actual_sqls AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sql_date)::Date AS sqls_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT sql_id) AS sqls\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    WHERE sql_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n\r\n), actual_sqos AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sqo_date)::Date AS sqos_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT sqo_id) AS sqos\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    WHERE sqo_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n\r\n), actual_sql2sqo AS (\r\n\r\n    SELECT\r\n        sqos_month,\r\n        actual_sqos.region,\r\n        SUM(sqos)/SUM(sqls) AS sql2sqo_actual\r\n    FROM actual_sqos\r\n    LEFT JOIN actual_sqls ON \r\n    actual_sqos.region=actual_sqls.region\r\n    AND actual_sqos.sqos_month=actual_sqls.sqls_month\r\n    WHERE actual_sqos.region IS NOT null\r\n    GROUP BY 1,2\r\n\r\n)\r\n\r\nSELECT\r\n    sqos_month,\r\n    actual_sql2sqo.region,\r\n    sql2sqo_actual,\r\n    sql2sqo_target,\r\n    sql2sqo_actual/sql2sqo_target AS actual_vs_target\r\nFROM actual_sql2sqo\r\nLEFT JOIN sql2sqo_target ON\r\nactual_sql2sqo.sqos_month=sql2sqo_target.kpi_month\r\nAND actual_sql2sqo.region=sql2sqo_target.kpi_region\r\nWHERE region IS NOT null", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.kpi_targets", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_sql2sqo_to_target"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_sql2sqo_to_target", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_sql2sqo_to_target.sql", "original_file_path": "models/funnel/funnel_report_all_time_sql2sqo_to_target.sql", "name": "funnel_report_all_time_sql2sqo_to_target", "alias": "funnel_report_all_time_sql2sqo_to_target", "checksum": {"name": "sha256", "checksum": "7b083121392bd66424fd4d8c606f8e47d9c338d64ae8e34e3daf63262cd8bef5"}, "tags": [], "refs": [["kpi_targets"], ["funnel_report_all_time_sqls"], ["funnel_report_all_time_sqos"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2857337}, "model.acton_marketing_data.funnel_report_all_time_demo2voc_velocity": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH demo_opp AS (\r\n\r\n    SELECT\r\n        demo_id,\r\n        demo_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n\r\n),  voc_opp AS (\r\n\r\n    SELECT\r\n        voc_id,\r\n        voc_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        voc_id,\r\n        demo_date,\r\n        voc_date,\r\n        voc_opp.account_global_region,\r\n        voc_opp.company_size_rev,\r\n        voc_opp.opp_lead_source,\r\n        voc_opp.segment,\r\n        voc_opp.industry,\r\n        voc_opp.channel_bucket,\r\n        voc_opp.industry_bucket,\r\n        {{ dbt_utils.datediff(\"demo_date\",\"voc_date\",'day')}} AS demo2voc_velocity\r\n    FROM voc_opp\r\n    LEFT JOIN demo_opp ON \r\n    voc_opp.voc_id=demo_opp.demo_id\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    company_size_rev,\r\n    opp_lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    voc_date,\r\n    demo2voc_velocity\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_voc"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_demo2voc_velocity"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_demo2voc_velocity", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_demo2voc_velocity.sql", "original_file_path": "models/funnel/funnel_report_all_time_demo2voc_velocity.sql", "name": "funnel_report_all_time_demo2voc_velocity", "alias": "funnel_report_all_time_demo2voc_velocity", "checksum": {"name": "sha256", "checksum": "21039b2f0baf764f82394655d7b0c0d66158325e9eac4cc9eac816d306332d11"}, "tags": [], "refs": [["funnel_report_all_time_demo"], ["funnel_report_all_time_voc"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2879918}, "model.acton_marketing_data.funnel_report_all_time_mqls_to_target": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH mql_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS mqls_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_mqls'\r\n\r\n), actual_mqls AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',mql_date)::Date AS mqls_month,\r\n        CASE \r\n            WHEN global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT mql_id) AS mqls\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    WHERE mql_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    mqls_month,\r\n    actual_mqls.region,\r\n    mqls,\r\n    mqls_target,\r\n    mqls/mqls_target AS actual_vs_target\r\nFROM actual_mqls\r\nLEFT JOIN mql_target ON\r\nactual_mqls.mqls_month=mql_target.kpi_month\r\nAND actual_mqls.region=mql_target.kpi_region\r\nWHERE region IS NOT null", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.kpi_targets", "model.acton_marketing_data.funnel_report_all_time_mqls"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_mqls_to_target"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_mqls_to_target", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_mqls_to_target.sql", "original_file_path": "models/funnel/funnel_report_all_time_mqls_to_target.sql", "name": "funnel_report_all_time_mqls_to_target", "alias": "funnel_report_all_time_mqls_to_target", "checksum": {"name": "sha256", "checksum": "43d2e84799394da2e18cf5dc0df337045ef301e190417692f31972776a202488"}, "tags": [], "refs": [["kpi_targets"], ["funnel_report_all_time_mqls"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.293582}, "model.acton_marketing_data.funnel_report_all_time_l20_velocity_mlc_annual": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opportunity_id,\r\n        opp_created_date,\r\n        type AS opp_type,\r\n        opp_segment\r\n    FROM {{ref('opportunities_with_contacts')}}\r\n    WHERE type='New Business'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opp_created_date,\r\n        opp_segment,\r\n        {{ dbt_utils.datediff(\"marketing_created_date\",\"opp_created_date\",'day')}} AS lead_to_opp_velocity\r\n    FROM base\r\n    WHERE opp_created_date >= marketing_created_date\r\n    \r\n)\r\n\r\nSELECT\r\nopp_segment,\r\nDATE_TRUNC('year',marketing_created_date) AS marketing_created_year,\r\nAVG(lead_to_opp_velocity) AS avg_lead_to_opp_velocity\r\nFROM final\r\nGROUP BY 1,2", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.opportunities_with_contacts"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_l20_velocity_mlc_annual"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_l20_velocity_mlc_annual", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_l20_velocity_mlc_annual.sql", "original_file_path": "models/funnel/funnel_report_all_time_l20_velocity_mlc_annual.sql", "name": "funnel_report_all_time_l20_velocity_mlc_annual", "alias": "funnel_report_all_time_l20_velocity_mlc_annual", "checksum": {"name": "sha256", "checksum": "dd3d1da7f9be8249212fdb179bca5c0a2d638a1d64dbe353057a027b2b6aea20"}, "tags": [], "refs": [["opportunities_with_contacts"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.2958603}, "model.acton_marketing_data.funnel_report_all_time_demo": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        opp_demo_source_xf.opportunity_id AS demo_id,\r\n        CONCAT('https://acton.my.salesforce.com/',opp_demo_source_xf.opportunity_id) AS demo_url,\r\n        acv,\r\n        account_name,\r\n        type AS opp_type,\r\n        opp_demo_source_xf.demo_date AS demo_date,\r\n        CASE\r\n        WHEN account_global_region IS null THEN 'blank'\r\n        ELSE account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE opp_offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation\r\n    FROM {{ref('opp_demo_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_demo_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_demo"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_demo", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_demo.sql", "original_file_path": "models/funnel/funnel_report_all_time_demo.sql", "name": "funnel_report_all_time_demo", "alias": "funnel_report_all_time_demo", "checksum": {"name": "sha256", "checksum": "d9007f732c5a0b27e227d76a1f57897fbf70dc87a8029812a3984f20b755c7c4"}, "tags": [], "refs": [["opp_demo_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3011339}, "model.acton_marketing_data.funnel_report_all_time_close_won_velocity_annual": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH closed_won AS (\r\n\r\n    SELECT\r\n        opp_sales_source_xf.opportunity_id AS won_id,\r\n        opp_sales_source_xf.close_date AS won_date,\r\n        segment AS won_segment,\r\n        type AS won_type\r\n    FROM {{ref('opp_sales_source_xf')}}\r\n\r\n),  created_opp AS (\r\n\r\n    SELECT\r\n        sql_source_xf.sql_id,\r\n        sql_source_xf.created_date AS sql_date,\r\n        segment AS opp_segment,\r\n        type AS opp_type\r\n    FROM {{ref('sql_source_xf')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        won_id,\r\n        sql_date,\r\n        won_date,\r\n        won_segment,\r\n        won_type,\r\n        {{ dbt_utils.datediff(\"sql_date\",\"won_date\",'day')}} AS cw_velocity\r\n    FROM closed_won\r\n    LEFT JOIN created_opp ON \r\n    closed_won.won_id=created_opp.sql_id\r\n)\r\n\r\nSELECT\r\nwon_segment,\r\nwon_type,\r\nDATE_TRUNC('year',won_date) AS cw_year,\r\nAVG(cw_velocity) AS avg_cw_velocity\r\nFROM final\r\nGROUP BY 1,2,3", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.opp_sales_source_xf", "model.acton_marketing_data.sql_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_close_won_velocity_annual"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_close_won_velocity_annual", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_close_won_velocity_annual.sql", "original_file_path": "models/funnel/funnel_report_all_time_close_won_velocity_annual.sql", "name": "funnel_report_all_time_close_won_velocity_annual", "alias": "funnel_report_all_time_close_won_velocity_annual", "checksum": {"name": "sha256", "checksum": "96061284d2c993d0e128ba59fb5969ba20a3d2f35f3a2e9d966ca2376d849414"}, "tags": [], "refs": [["opp_sales_source_xf"], ["sql_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.303243}, "model.acton_marketing_data.funnel_report_all_time_leads_to_target": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH lead_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS leads_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_leads'\r\n\r\n), actual_leads AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',created_date)::Date AS leads_month,\r\n        CASE \r\n            WHEN global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT lead_id) AS leads\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    WHERE created_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    leads_month,\r\n    actual_leads.region,\r\n    leads,\r\n    leads_target,\r\n    leads/leads_target AS actual_vs_target\r\nFROM actual_leads\r\nLEFT JOIN lead_target ON\r\nactual_leads.leads_month=lead_target.kpi_month\r\nAND actual_leads.region=lead_target.kpi_region\r\nWHERE region IS NOT null", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.kpi_targets", "model.acton_marketing_data.funnel_report_all_time_leads"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_leads_to_target"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_leads_to_target", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_leads_to_target.sql", "original_file_path": "models/funnel/funnel_report_all_time_leads_to_target.sql", "name": "funnel_report_all_time_leads_to_target", "alias": "funnel_report_all_time_leads_to_target", "checksum": {"name": "sha256", "checksum": "b4560b23bff353eed00dcad451d5eab15b405d646cc43ced5de3562598ead0b9"}, "tags": [], "refs": [["kpi_targets"], ["funnel_report_all_time_leads"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3087196}, "model.acton_marketing_data.funnel_report_all_time_filters": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        created_date AS date,\r\n        null AS opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        mql_date,\r\n        null AS opp_type,\r\n        is_working\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        sal_date,\r\n        null AS opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        'No' AS is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        sql_date,\r\n        opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        'No' AS is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        sqo_date,\r\n        opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        'No' AS is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        demo_date,\r\n        opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        'No' AS is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        voc_date,\r\n        opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        'No' AS is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        closing_date,\r\n        opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        'No' AS is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        won_date,\r\n        opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        'No' AS is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        lost_date,\r\n        opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n)\r\n\r\nSELECT DISTINCT\r\n    CASE\r\n        WHEN global_region IS null THEN 'blank'\r\n        ELSE global_region\r\n    END AS global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN lead_source IS null THEN 'blank'\r\n        ELSE lead_source\r\n    END AS lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation,\r\n    CASE\r\n        WHEN opp_type IS null THEN 'blank'\r\n        ELSE opp_type\r\n    END AS opp_type,\r\n    CASE\r\n        WHEN is_working IS null THEN 'No'\r\n        ELSE is_working\r\n    END AS is_working,\r\n    is_hand_raiser,\r\n    date\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.funnel_report_all_time_lost"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_filters"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_filters", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_filters.sql", "original_file_path": "models/funnel/funnel_report_all_time_filters.sql", "name": "funnel_report_all_time_filters", "alias": "funnel_report_all_time_filters", "checksum": {"name": "sha256", "checksum": "bb396f85f9761b1b9227b3a40640a310d0e088612fbbd2e3b8ebac847f34a0f2"}, "tags": [], "refs": [["funnel_report_all_time_leads"], ["funnel_report_all_time_mqls"], ["funnel_report_all_time_sals"], ["funnel_report_all_time_sqls"], ["funnel_report_all_time_sqos"], ["funnel_report_all_time_demo"], ["funnel_report_all_time_voc"], ["funnel_report_all_time_closing"], ["funnel_report_all_time_won"], ["funnel_report_all_time_lost"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3119962}, "model.acton_marketing_data.funnel_report_all_time_sqopipe_to_target": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH sqopipe_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS sqopipe_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_new_cw_pipe'\r\n    --WHERE kpi = 'target_sqo_pipe'\r\n    \r\n), actual_sqopipe AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sqo_date)::Date AS sqopipe_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        SUM(acv) AS sqopipe\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    WHERE sqo_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    sqopipe_month,\r\n    actual_sqopipe.region,\r\n    sqopipe,\r\n    sqopipe_target,\r\n    sqopipe/sqopipe_target AS actual_vs_target\r\nFROM actual_sqopipe\r\nLEFT JOIN sqopipe_target ON\r\nactual_sqopipe.sqopipe_month=sqopipe_target.kpi_month\r\nAND actual_sqopipe.region=sqopipe_target.kpi_region\r\nWHERE region IS NOT null", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.kpi_targets", "model.acton_marketing_data.funnel_report_all_time_sqos"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_sqopipe_to_target"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_sqopipe_to_target", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_sqopipe_to_target.sql", "original_file_path": "models/funnel/funnel_report_all_time_sqopipe_to_target.sql", "name": "funnel_report_all_time_sqopipe_to_target", "alias": "funnel_report_all_time_sqopipe_to_target", "checksum": {"name": "sha256", "checksum": "13bfbf46662b5b6c2f95d666986995cfe4d08345deefce877a86858a43b5cf6a"}, "tags": [], "refs": [["kpi_targets"], ["funnel_report_all_time_sqos"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3147123}, "model.acton_marketing_data.funnel_report_all_time_l2m_velocity": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH leads AS (\r\n\r\n    SELECT\r\n        lead_id,\r\n        created_date,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n\r\n),  mqls AS (\r\n\r\n    SELECT\r\n        mql_id,\r\n        mql_date,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        mql_id,\r\n        mql_date,\r\n        created_date,\r\n        mqls.global_region,\r\n        mqls.company_size_rev,\r\n        mqls.lead_source,\r\n        mqls.segment,\r\n        mqls.industry,\r\n        mqls.industry_bucket,\r\n        mqls.channel_bucket,\r\n        {{ dbt_utils.datediff(\"created_date\",\"mql_date\",'day')}} AS l2m_velocity\r\n    FROM mqls\r\n    LEFT JOIN leads ON \r\n    mqls.mql_id=leads.lead_id\r\n)\r\n\r\nSELECT\r\n    global_region,\r\n    company_size_rev,\r\n    lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    mql_date,\r\n    l2m_velocity\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_mqls"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_l2m_velocity"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_l2m_velocity", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_l2m_velocity.sql", "original_file_path": "models/funnel/funnel_report_all_time_l2m_velocity.sql", "name": "funnel_report_all_time_l2m_velocity", "alias": "funnel_report_all_time_l2m_velocity", "checksum": {"name": "sha256", "checksum": "9627fcacd69fe8fff442291793f8f42e0b0fc94e69b18e4b76f8bbf64ca56c60"}, "tags": [], "refs": [["funnel_report_all_time_leads"], ["funnel_report_all_time_mqls"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.316763}, "model.acton_marketing_data.funnel_report_all_time_all": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n    \r\n), lead_base AS (\r\n\r\n    SELECT\r\n        COUNT(DISTINCT lead_id) AS leads,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        created_date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), mql_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT mql_id) AS mqls,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), sal_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT sal_id) AS sals,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), sql_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT sql_id) AS sqls,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), sqo_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT sqo_id) AS sqos,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), demo_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT demo_id) AS demos,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), voc_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT voc_id) AS vocs,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), closing_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT closing_id) AS closing,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), won_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT won_id) AS won,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), lost_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT lost_id) AS lost,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), final AS (\r\n\r\n    SELECT \r\n        base.company_size_rev,\r\n        base.global_region,\r\n        base.lead_source,\r\n        base.segment,\r\n        base.industry,\r\n        base.industry_bucket,\r\n        base.channel_bucket,\r\n        base.date,\r\n        CASE \r\n            WHEN SUM(leads) IS null THEN 0\r\n            ELSE SUM(leads) \r\n        END AS leads,\r\n        CASE \r\n            WHEN SUM(mqls) IS null THEN 0\r\n            ELSE SUM(mqls) \r\n        END AS mqls,\r\n        CASE \r\n            WHEN SUM(sals) IS null THEN 0\r\n            ELSE SUM(sals) \r\n        END AS sals,\r\n        CASE \r\n            WHEN SUM(sqls) IS null THEN 0\r\n            ELSE SUM(sqls) \r\n        END AS sqls,\r\n        CASE \r\n            WHEN SUM(sqos) IS null THEN 0\r\n            ELSE SUM(sqos) \r\n        END AS sqos,\r\n        CASE \r\n            WHEN SUM(demos) IS null THEN 0\r\n            ELSE SUM(demos) \r\n        END AS demos,\r\n        CASE \r\n            WHEN SUM(vocs) IS null THEN 0\r\n            ELSE SUM(vocs) \r\n        END AS vocs,\r\n        CASE \r\n            WHEN SUM(closing) IS null THEN 0\r\n            ELSE SUM(closing) \r\n        END AS closing,\r\n        CASE \r\n            WHEN SUM(won) IS null THEN 0\r\n            ELSE SUM(won) \r\n        END AS won,\r\n        CASE \r\n            WHEN SUM(lost) IS null THEN 0\r\n            ELSE SUM(lost) \r\n        END AS lost\r\n    FROM base\r\n    LEFT JOIN lead_base ON \r\n    base.company_size_rev=lead_base.company_size_rev\r\n    AND base.global_region=lead_base.global_region\r\n    AND base.lead_source=lead_base.lead_source\r\n    AND base.segment=lead_base.segment\r\n    AND base.industry=lead_base.industry\r\n    AND base.channel_bucket=lead_base.channel_bucket\r\n    AND base.date=lead_base.created_date\r\n    LEFT JOIN mql_base ON\r\n    base.company_size_rev=mql_base.company_size_rev\r\n    AND base.global_region=mql_base.global_region\r\n    AND base.lead_source=mql_base.lead_source\r\n    AND base.segment=mql_base.segment\r\n    AND base.industry=mql_base.industry\r\n    AND base.channel_bucket=mql_base.channel_bucket\r\n    AND base.date=mql_base.mql_date\r\n    LEFT JOIN sal_base ON\r\n    base.company_size_rev=sal_base.company_size_rev\r\n    AND base.global_region=sal_base.global_region\r\n    AND base.lead_source=sal_base.lead_source\r\n    AND base.segment=sal_base.segment\r\n    AND base.industry=sal_base.industry\r\n    AND base.channel_bucket=sal_base.channel_bucket\r\n    AND base.date=sal_base.sal_date\r\n    LEFT JOIN sql_base ON\r\n    base.company_size_rev=sql_base.company_size_rev\r\n    AND base.global_region=sql_base.account_global_region\r\n    AND base.lead_source=sql_base.opp_lead_source\r\n    AND base.segment=sql_base.segment\r\n    AND base.industry=sql_base.industry\r\n    AND base.channel_bucket=sql_base.channel_bucket\r\n    AND base.date=sql_base.sql_date\r\n    LEFT JOIN sqo_base ON\r\n    base.company_size_rev=sqo_base.company_size_rev\r\n    AND base.global_region=sqo_base.account_global_region\r\n    AND base.lead_source=sqo_base.opp_lead_source\r\n    AND base.segment=sqo_base.segment\r\n    AND base.industry=sqo_base.industry\r\n    AND base.channel_bucket=sqo_base.channel_bucket\r\n    AND base.date=sqo_base.sqo_date\r\n    LEFT JOIN demo_base ON\r\n    base.company_size_rev=demo_base.company_size_rev\r\n    AND base.global_region=demo_base.account_global_region\r\n    AND base.lead_source=demo_base.opp_lead_source\r\n    AND base.segment=demo_base.segment\r\n    AND base.industry=demo_base.industry\r\n    AND base.channel_bucket=demo_base.channel_bucket\r\n    AND base.date=demo_base.demo_date\r\n    LEFT JOIN voc_base ON\r\n    base.company_size_rev=voc_base.company_size_rev\r\n    AND base.global_region=voc_base.account_global_region\r\n    AND base.lead_source=voc_base.opp_lead_source\r\n    AND base.segment=voc_base.segment\r\n    AND base.industry=voc_base.industry\r\n    AND base.channel_bucket=voc_base.channel_bucket\r\n    AND base.date=voc_base.voc_date\r\n    LEFT JOIN closing_base ON\r\n    base.company_size_rev=closing_base.company_size_rev\r\n    AND base.global_region=closing_base.account_global_region\r\n    AND base.lead_source=closing_base.opp_lead_source\r\n    AND base.segment=closing_base.segment\r\n    AND base.industry=closing_base.industry\r\n    AND base.channel_bucket=closing_base.channel_bucket\r\n    AND base.date=closing_base.closing_date\r\n    LEFT JOIN won_base ON\r\n    base.company_size_rev=won_base.company_size_rev\r\n    AND base.global_region=won_base.account_global_region\r\n    AND base.lead_source=won_base.opp_lead_source\r\n    AND base.segment=won_base.segment\r\n    AND base.industry=won_base.industry\r\n    AND base.channel_bucket=won_base.channel_bucket\r\n    AND base.date=won_base.won_date\r\n    LEFT JOIN lost_base ON\r\n    base.company_size_rev=lost_base.company_size_rev\r\n    AND base.global_region=lost_base.account_global_region\r\n    AND base.lead_source=lost_base.opp_lead_source\r\n    AND base.segment=lost_base.segment\r\n    AND base.industry=lost_base.industry\r\n    AND base.channel_bucket=lost_base.channel_bucket\r\n    AND base.date=lost_base.lost_date\r\n    GROUP BY 1,2,3,4,5,6,7,8\r\n\r\n)\r\n\r\nSELECT\r\n    company_size_rev,\r\n    global_region,\r\n    lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    date,\r\n    leads,\r\n    mqls,\r\n    sals,\r\n    sqls,\r\n    sqos,\r\n    demos,\r\n    vocs,\r\n    closing,\r\n    won,\r\n    lost,\r\n    CASE\r\n        WHEN mqls=0 THEN 0\r\n        ELSE SUM(leads/NULLIF(mqls,0))\r\n    END AS lead_to_mql_conv,\r\n    CASE\r\n        WHEN sals=0 THEN 0\r\n        ELSE SUM(mqls/NULLIF(sals,0))\r\n    END AS mql_to_sal_conv,\r\n    CASE\r\n        WHEN sqls=0 THEN 0\r\n        ELSE SUM(sals/NULLIF(sqls,0))\r\n    END AS sal_to_sql_conv,\r\n    CASE\r\n        WHEN sqos=0 THEN 0\r\n        ELSE SUM(sqls/NULLIF(sqos,0))\r\n    END AS sql_to_sqo_conv,\r\n    CASE\r\n        WHEN demos=0 THEN 0\r\n        ELSE SUM(sqos/NULLIF(demos,0))\r\n    END AS sqo_to_demo_conv,\r\n    CASE\r\n        WHEN vocs=0 THEN 0\r\n        ELSE SUM(demos/NULLIF(vocs,0))\r\n    END AS demo_to_voc_conv,\r\n    CASE\r\n        WHEN closing=0 THEN 0\r\n        ELSE SUM(vocs/NULLIF(closing,0))\r\n    END AS voc_to_closing_conv,\r\n    CASE\r\n        WHEN won=0 THEN 0\r\n        ELSE SUM(closing/NULLIF(won,0))\r\n    END AS closing_to_won_conv,\r\n    CASE\r\n        WHEN lost=0 THEN 0\r\n        ELSE SUM(closing/NULLIF(lost,0))\r\n    END AS closing_to_lost_conv\r\nFROM final\r\nGROUP BY 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.funnel_report_all_time_lost", "model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.funnel_report_all_time_lost"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_all"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_all", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_all.sql", "original_file_path": "models/funnel/funnel_report_all_time_all.sql", "name": "funnel_report_all_time_all", "alias": "funnel_report_all_time_all", "checksum": {"name": "sha256", "checksum": "246ffac55b2c91c02790e18f2ab61846157cddb3b84862c485cff20e78001194"}, "tags": [], "refs": [["funnel_report_all_time_leads"], ["funnel_report_all_time_mqls"], ["funnel_report_all_time_sals"], ["funnel_report_all_time_sqls"], ["funnel_report_all_time_sqos"], ["funnel_report_all_time_demo"], ["funnel_report_all_time_voc"], ["funnel_report_all_time_closing"], ["funnel_report_all_time_won"], ["funnel_report_all_time_lost"], ["funnel_report_all_time_leads"], ["funnel_report_all_time_mqls"], ["funnel_report_all_time_sals"], ["funnel_report_all_time_sqls"], ["funnel_report_all_time_sqos"], ["funnel_report_all_time_demo"], ["funnel_report_all_time_voc"], ["funnel_report_all_time_closing"], ["funnel_report_all_time_won"], ["funnel_report_all_time_lost"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3223627}, "model.acton_marketing_data.funnel_report_all_time_conversions": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        date,\r\n        ROUND(SUM(mqls/NULLIF(leads,0)),2) AS all_time_lead_to_mql,\r\n        ROUND(SUM(sals/NULLIF(mqls,0)),2) AS all_time_mql_to_sal,\r\n        ROUND(SUM(sqls/NULLIF(sals,0)),2) AS all_time_sal_to_sql,\r\n        ROUND(SUM(sqos/NULLIF(sqls,0)),2) AS all_time_sql_to_sqo,\r\n        ROUND(SUM(demos/NULLIF(sqos,0)),2) AS all_time_sqo_to_demo,\r\n        ROUND(SUM(vocs/NULLIF(demos,0)),2) AS all_time_demo_to_voc,\r\n        ROUND(SUM(closing/NULLIF(vocs,0)),2) AS all_time_voc_to_closing,\r\n        ROUND(SUM(won/NULLIF(closing,0)),2) AS all_time_closing_to_won,\r\n        ROUND(SUM(lost/NULLIF(closing,0)),2) AS all_time_closing_to_lost\r\n    FROM {{ref('funnel_report_all_time_all')}}\r\n    GROUP BY 1,2,3\r\n    \r\n)\r\n\r\nSELECT DISTINCT\r\n    global_region,\r\n    company_size_rev,\r\n    date,\r\n    CASE \r\n        WHEN all_time_lead_to_mql IS null THEN 0\r\n        ELSE all_time_lead_to_mql\r\n    END AS all_time_lead_to_mql,\r\n    CASE \r\n        WHEN all_time_mql_to_sal IS null THEN 0\r\n        ELSE all_time_mql_to_sal\r\n    END AS all_time_mql_to_sal,\r\n    CASE \r\n        WHEN all_time_sal_to_sql IS null THEN 0\r\n        ELSE all_time_sal_to_sql\r\n    END AS all_time_sal_to_sql,\r\n    CASE \r\n        WHEN all_time_sql_to_sqo IS null THEN 0\r\n        ELSE all_time_sql_to_sqo\r\n    END AS all_time_sql_to_sqo,\r\n    CASE \r\n        WHEN all_time_sqo_to_demo IS null THEN 0\r\n        ELSE all_time_sqo_to_demo\r\n    END AS all_time_sqo_to_demo,\r\n    CASE \r\n        WHEN all_time_demo_to_voc IS null THEN 0\r\n        ELSE all_time_demo_to_voc\r\n    END AS all_time_demo_to_voc,\r\n    CASE \r\n        WHEN all_time_voc_to_closing IS null THEN 0\r\n        ELSE all_time_voc_to_closing\r\n    END AS all_time_voc_to_closing,\r\n    CASE \r\n        WHEN all_time_closing_to_won IS null THEN 0\r\n        ELSE all_time_closing_to_won\r\n    END AS all_time_closing_to_won,\r\n    CASE \r\n        WHEN all_time_closing_to_lost IS null THEN 0\r\n        ELSE all_time_closing_to_lost\r\n    END AS all_time_closing_to_lost\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_all"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_conversions"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_conversions", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_conversions.sql", "original_file_path": "models/funnel/funnel_report_all_time_conversions.sql", "name": "funnel_report_all_time_conversions", "alias": "funnel_report_all_time_conversions", "checksum": {"name": "sha256", "checksum": "683b907d784fd1ee0c96a80f8f6ecdebbd92afe80f7e1812f0000a5a67876442"}, "tags": [], "refs": [["funnel_report_all_time_all"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3252518}, "model.acton_marketing_data.funnel_report_all_time_leads": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        person_source_xf.person_id AS lead_id,\r\n        CONCAT('https://acton.my.salesforce.com/',person_source_xf.person_id) AS lead_url,\r\n        person_source_xf.marketing_created_date AS created_date,\r\n        company,\r\n        first_name,\r\n        last_name,\r\n        title,\r\n        person_status,\r\n        country,\r\n        is_hand_raiser,\r\n    CASE\r\n        WHEN global_region IS null THEN 'blank'\r\n        ELSE global_region\r\n    END AS global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN lead_source IS null THEN 'blank'\r\n        ELSE lead_source\r\n    END AS lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation,\r\n    CASE\r\n        WHEN campaign_lead_creation IS null THEN 'blank'\r\n        ELSE campaign_lead_creation\r\n    END AS campaign_lead_creation\r\n    FROM {{ref('person_source_xf')}}\r\n    WHERE marketing_created_date IS NOT null\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.person_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel", "funnel_report_all_time_leads"], "unique_id": "model.acton_marketing_data.funnel_report_all_time_leads", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel/funnel_report_all_time_leads.sql", "original_file_path": "models/funnel/funnel_report_all_time_leads.sql", "name": "funnel_report_all_time_leads", "alias": "funnel_report_all_time_leads", "checksum": {"name": "sha256", "checksum": "97377dd0b25adcdc1cb0258057a31aeba966903ca26c2b073b4a7abcf7cff0c0"}, "tags": [], "refs": [["person_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3275743}, "model.acton_marketing_data.date_base_xf": {"raw_sql": "{{ config(materialized='table') }}\r\nSELECT\r\nday::date AS day,\r\nweek,\r\nmonth,\r\nmonth_name,\r\nquarter,\r\nfy\r\nFROM \"acton\".public.date_base", "resource_type": "model", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "date_base_xf"], "unique_id": "model.acton_marketing_data.date_base_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/date_base_xf.sql", "original_file_path": "models/sources/date_base_xf.sql", "name": "date_base_xf", "alias": "date_base_xf", "checksum": {"name": "sha256", "checksum": "11c8c14904f5631b0da8beaa4c4deea3af27d387cfa857de2938c6668e1ccac5"}, "tags": [], "refs": [], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3296058}, "model.acton_marketing_data.account_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'account') }}\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        base.id AS account_id,\r\n        base.is_deleted,\r\n        base.name AS account_name,\r\n        base.type AS account_type,\r\n        base.parent_id AS account_parent_id,\r\n        base.billing_state,\r\n        base.billing_postal_code,\r\n        base.billing_country,\r\n        base.industry,\r\n        CASE\r\n            WHEN base.industry IN ('Business Services') THEN 'Business Services'\r\n            WHEN base.industry IN ('Finance','Insurance') THEN 'Finance'\r\n            WHEN base.industry IN ('Manufacturing') THEN 'Manufacturing'\r\n            WHEN base.industry IN ('Software','Telecommunications') THEN 'SoftCom'\r\n            ELSE 'Other'\r\n        END AS default_industry_bucket,\r\n        base.annual_revenue,\r\n        base.number_of_employees,\r\n        base.owner_id AS account_owner_id,\r\n        base.created_date AS account_created_date,\r\n        base.last_modified_date,\r\n        base.system_modstamp AS systemmodstamp,\r\n        base.is_partner,\r\n        base.current_customer_c AS is_current_customer,\r\n        base.csm_c AS account_csm_c,\r\n        base.current_crm_c AS current_crm,\r\n        base.current_marketing_automation_c AS current_ma,\r\n        base.de_country_c AS de_country,\r\n        base.de_current_crm_c AS de_current_crm,\r\n        base.de_current_marketing_automation_c AS de_current_ma,\r\n        base.de_industry_c AS de_industry,\r\n        CASE\r\n            WHEN base.de_industry_c IN ('Business Services') THEN 'Business Services'\r\n            WHEN base.de_industry_c IN ('Finance','Insurance') THEN 'Finance'\r\n            WHEN base.de_industry_c IN ('Manufacturing') THEN 'Manufacturing'\r\n            WHEN base.de_industry_c IN ('Software','Telecommunications') THEN 'SoftCom'\r\n            ELSE 'Other'\r\n        END AS industry_bucket,\r\n        base.de_parent_company_c AS de_account_parent_name,\r\n        base.de_ultimate_parent_company_c AS de_ultimate_parent_account_name,\r\n        base.ao_instance_number_c AS ao_instance_number,\r\n        base.do_not_market_c AS do_not_market,\r\n        base.target_account_c AS target_account,\r\n        base.market_segment_static_c AS market_segment_static,\r\n        base.sdr_c AS sdr,\r\n        base.current_contract_c AS current_contract,\r\n        base.onboarding_completion_date_c AS onboarding_completion_date,\r\n        base.customer_since_c AS customer_since,\r\n        base.onboarding_specialist_c AS onboarding_specialist,\r\n        base.executive_sponsor_c AS executive_sponsor,\r\n        base.assigned_account_tier_c AS assigned_account_tier,\r\n        base.business_model_c AS business_model,\r\n        base.contract_type_c AS contract_type,\r\n        base.delivered_support_tier_c AS delivered_support_tier,\r\n        parent.name AS account_parent_name,\r\n        base.deliverability_consultant_c AS deliverability_consultant_id,\r\n        sdr.user_email AS sdr_email,\r\n        sdr.user_first_name AS sdr_first_name,\r\n        sdr.user_full_name AS sdr_full_name,\r\n        sdr.user_photo AS sdr_photo,\r\n        sdr.calendly_link AS sdr_calendly,\r\n        sdr.user_title AS sdr_title,\r\n        sdr.user_phone AS sdr_phone,\r\n        csm.user_email AS account_csm_email,\r\n        csm.user_photo AS account_csm_photo,\r\n        csm.user_id AS csm_id,\r\n        csm.user_full_name AS account_csm_name,\r\n        account_owner.user_full_name AS account_owner_name,\r\n        account_owner.user_email AS account_owner_email,\r\n        account_owner.calendly_link AS account_owner_calendly,\r\n        account_owner.user_photo AS account_owner_photo,\r\n        onboarding.user_photo AS onboarding_specialist_photo,\r\n        onboarding.user_email AS onboarding_specialist_email,\r\n        onboarding.user_full_name AS onboarding_specialist_name,\r\n        deliverability.user_email AS account_deliverability_consultant_email,\r\n        deliverability.user_full_name AS account_deliverability_consultant,\r\n        opp_source_xf.is_closed,\r\n        contract_source_xf.end_date,\r\n        CASE \r\n            WHEN base.annual_revenue <= 49999999 THEN 'SMB'\r\n            WHEN base.annual_revenue > 49999999 AND base.annual_revenue <= 499999999 THEN 'Mid-Market'\r\n            WHEN base.annual_revenue > 499999999 THEN 'Enterprise'\r\n        END AS company_size_rev,\r\n        COUNT(DISTINCT opp_source_xf.opportunity_id) AS number_of_open_opportunities,\r\n        CASE \r\n            WHEN opp_source_xf.is_closed = false THEN COUNT(DISTINCT opp_source_xf.opportunity_id)\r\n            ELSE 0\r\n        END AS number_of_open_opps,\r\n        CASE\r\n            WHEN base.billing_country IS NOT null AND base.billing_country IN ('GB','UK','IE','DE','DK','FI','IS','NO','SE','FR','AL','AD','AM','AT','BY','BE','BA','BG','HR','CS','CY','CZ','EE','FX','GE','GR','HU','IT','LV','LI','LT','LU','MK','MT','MD','MC','ME','NL','PL','PT','RO','SM','RS','SJ','SK','SI','ES','CH','UA','VA','FO','GI','GG','IM','JE','XK','RU') THEN 'EUROPE'\r\n            WHEN base.billing_country IS NOT null AND base.billing_country IN ('JP','KR','CN','MN','TW','VN','HK','LA','TH','KH','PH','MY','SG','ID','LK','IN','NP','BT','MM','PK','AF','KG','UZ','TM','KZ') THEN 'APJ'\r\n            WHEN base.billing_country IS NOT null AND base.billing_country IN ('AU','CX','NZ','NF','Australia','New Zealand') THEN 'AUNZ'\r\n            WHEN base.billing_country IS NOT null AND base.billing_country IN ('AR','BO','BR','BZ','CL','CO','CU','CR','DO','EC','FK','GF','GS','GY','GT','HN','MX','NI','PA','PE','PR','PY','SR','SV','UY','VE')THEN 'LATAM'\r\n            WHEN base.billing_state IS NOT null AND base.billing_state IN ('CA','NV','UT','AK','MO','CO','HI','OK','IL','AR','NE','MI','KS','OR','WA','ID','WI','MN','ND','SD','MT','WY','IA','NB','ON','PE','QC','AB','BC','MB','SK','NL','NS','YT','NU','NT') THEN 'NA-WEST'\r\n            WHEN base.billing_state IS NOT null AND base.billing_state IN ('NY','CT','MA','VT','NH','ME','NJ','RI','TX','AZ','NM','MS','LA','AL','TN','KY','OH','IN','GA','FL','NC','SC','PA','DC','DE','MD','VA','WV') THEN 'NA-EAST'\r\n            WHEN base.billing_country IS NOT null AND base.billing_country IN ('AG','AI','AN','AW','BB','BM','BS','DM','GD','GP','HT','JM','KN','LC','MQ','MS','TC','TT','VC','VG','VI') THEN 'NA-EAST'\r\n            WHEN base.billing_country IS NOT null AND base.billing_country IN ('US','CA') AND base.billing_state IS null  THEN 'NA-NO-STATEPROV'\r\n            WHEN base.billing_country IS NOT null AND base.billing_state IS NOT null THEN 'ROW'\r\n            ELSE 'Unknown'\r\n        END AS global_region,\r\n        contract_source_xf.end_date+1 AS renewal_date\r\n        -- \"Renewal_Notice_Date__c\" AS renewal_notice_date,\r\n    FROM base\r\n    LEFT JOIN \"acton\".salesforce.\"account\" AS parent ON\r\n    base.id=parent.parent_id\r\n    LEFT JOIN {{ref('user_source_xf')}} AS sdr ON\r\n    base.sdr_c=sdr.user_id\r\n    LEFT JOIN {{ref('user_source_xf')}} AS csm ON\r\n    base.csm_c=csm.user_id\r\n    LEFT JOIN {{ref('user_source_xf')}} AS account_owner ON\r\n    base.owner_id=account_owner.user_id\r\n    LEFT JOIN {{ref('user_source_xf')}} AS onboarding ON\r\n    base.onboarding_specialist_c=onboarding.user_id\r\n    LEFT JOIN {{ref('user_source_xf')}} AS deliverability ON\r\n    base.deliverability_consultant_c=deliverability.user_id\r\n    LEFT JOIN {{ref('opp_source_xf')}} ON\r\n    base.id=opp_source_xf.account_id\r\n    LEFT JOIN {{ref('contract_source_xf')}} ON\r\n    base.current_contract_c=contract_source_xf.contract_id\r\n    {{dbt_utils.group_by(n=66) }}\r\n\r\n)\r\n\r\nSELECT \r\nfinal.*,\r\nCASE\r\n    WHEN global_region IN ('EUROPE','ROW','AUNZ') THEN 'EMEA'\r\n    WHEN company_size_rev IN ('SMB') OR company_size_rev IS null THEN 'Velocity'\r\n    WHEN company_size_rev IN ('Mid-Market','Enterprise') THEN 'Upmarket'\r\n    ELSE null\r\nEND AS segment \r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.group_by"], "nodes": ["source.acton_marketing_data.salesforce.account", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.contract_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "account_source_xf"], "unique_id": "model.acton_marketing_data.account_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/account_source_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/account_source_xf.sql", "name": "account_source_xf", "alias": "account_source_xf", "checksum": {"name": "sha256", "checksum": "a33df3a4d8c1f40de1ff82fd5e05654c2be23975b25b62b14bab4ae5c4ed127d"}, "tags": [], "refs": [["user_source_xf"], ["user_source_xf"], ["user_source_xf"], ["user_source_xf"], ["user_source_xf"], ["opp_source_xf"], ["contract_source_xf"]], "sources": [["salesforce", "account"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3314526}, "model.acton_marketing_data.contact_history_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'contact_history') }}\r\n\r\n)\r\n\r\nSELECT\r\nid AS contact_history_id, \r\ncontact_id,\r\ncreated_date AS field_modified_at,\r\nfield,\r\nold_value,\r\nnew_value\r\nFROM base\r\nWHERE is_deleted = false", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.contact_history"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "contact_history_xf"], "unique_id": "model.acton_marketing_data.contact_history_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/contact_history_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/contact_history_xf.sql", "name": "contact_history_xf", "alias": "contact_history_xf", "checksum": {"name": "sha256", "checksum": "804169484507926511e61e9c545e9690135aa431759f296404cdc3998944e8a6"}, "tags": [], "refs": [], "sources": [["salesforce", "contact_history"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3419397}, "model.acton_marketing_data.product_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ source('salesforce', 'product_2') }}\r\n\r\n), final AS (\r\n\r\n    SELECT \r\n        id AS product_id,\r\n        product_code,\r\n        DATE_TRUNC('day',created_date)::Date AS product_created_date,\r\n        DATE_TRUNC('day',last_modified_date)::Date AS product_last_modified_date,\r\n        system_modstamp AS systemmodstamp,\r\n        is_deleted,\r\n        rev_rec_c AS rev_rec,\r\n        multiplier_override_c AS multiplier_override,\r\n        sbqq_subscription_type_c AS sbqq_subscription_type,\r\n        product_category_c AS product_category\r\n    FROM base\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.product_2"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "product_xf"], "unique_id": "model.acton_marketing_data.product_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/product_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/product_xf.sql", "name": "product_xf", "alias": "product_xf", "checksum": {"name": "sha256", "checksum": "b892bc25c1dd6f721a34f9be111df89d9a88cb15c1c8b5738dd6c140f9a1d288"}, "tags": [], "refs": [], "sources": [["salesforce", "product_2"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.344255}, "model.acton_marketing_data.lead_history_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'lead_history') }}\r\n\r\n)\r\n\r\nSELECT\r\nid AS lead_history_id, \r\nbase.lead_id,\r\nbase.created_date AS field_modified_at,\r\nfield,\r\nold_value,\r\nnew_value\r\nFROM base\r\nLEFT JOIN {{ref('lead_source_xf')}} ON\r\nbase.lead_id=lead_source_xf.lead_id\r\nWHERE base.is_deleted = false\r\nAND is_converted=false", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.lead_history", "model.acton_marketing_data.lead_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "lead_history_xf"], "unique_id": "model.acton_marketing_data.lead_history_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/lead_history_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/lead_history_xf.sql", "name": "lead_history_xf", "alias": "lead_history_xf", "checksum": {"name": "sha256", "checksum": "3370f17bb81ef633080a4c36c89902f12e709bc2c8a8c6b238733d01c6dfb325"}, "tags": [], "refs": [["lead_source_xf"]], "sources": [["salesforce", "lead_history"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.346246}, "model.acton_marketing_data.campaign_member_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'campaign_member') }}\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        id AS campaign_member_id,\r\n        campaign_id,\r\n        lead_id,\r\n        contact_id,\r\n        lead_or_contact_id,\r\n        account_id,\r\n        company_or_account AS account_name,\r\n        account_lookup_c AS account_lookup,\r\n        email,\r\n        status AS campaign_member_status,\r\n        type AS campaign_member_type,\r\n        has_responded AS campaign_member_has_responded,\r\n        DATE_TRUNC('day',base.created_date)::Date AS campaign_member_created_date,\r\n        DATE_TRUNC('day',base.first_responded_date)::Date AS campaign_member_first_responded_date,\r\n        is_deleted AS is_deleted_campaign_member\r\n    FROM base\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.campaign_member"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "campaign_member_source_xf"], "unique_id": "model.acton_marketing_data.campaign_member_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/campaign_member_source_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/campaign_member_source_xf.sql", "name": "campaign_member_source_xf", "alias": "campaign_member_source_xf", "checksum": {"name": "sha256", "checksum": "fbd220c144831925ad8d570aa98f6ce86dc57f408743743af007dadcb730ba59"}, "tags": [], "refs": [], "sources": [["salesforce", "campaign_member"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3484228}, "model.acton_marketing_data.user_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'user') }}\r\n\r\n)\r\n\r\n    SELECT\r\n        id AS user_id,\r\n        username AS user_name,\r\n        last_name AS user_last_name,\r\n        first_name AS user_first_name,\r\n        name AS user_full_name,\r\n        department AS user_department,\r\n        title AS user_title,\r\n        email AS user_email,\r\n        phone AS user_phone,\r\n        is_active AS is_active_user,\r\n        manager_id,\r\n        created_date AS user_created_date,\r\n        last_modified_date AS user_last_modified_date,\r\n        system_modstamp AS systemmodstamp,\r\n        contact_id AS user_contact_id,\r\n        account_id AS user_account_id,\r\n        full_photo_url AS user_photo_url,\r\n        sales_loft_calendar_link_c AS sales_loft_calendar_link,\r\n        calendly_link_c AS calendly_link,\r\n        headshot_url_c AS user_headshot_url,\r\n        office_location_c AS user_office_location,\r\n        sales_home_office_c AS user_sales_home_office,\r\n        csm_type_c AS csm_type,\r\n        my_territory_c AS user_territory,\r\n        photo_c AS user_photo\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.user"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "user_source_xf"], "unique_id": "model.acton_marketing_data.user_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/user_source_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/user_source_xf.sql", "name": "user_source_xf", "alias": "user_source_xf", "checksum": {"name": "sha256", "checksum": "6fcb107d95e2affae58c790a92e44ace193a146983467f674930ae0a45c6499f"}, "tags": [], "refs": [], "sources": [["salesforce", "user"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3504653}, "model.acton_marketing_data.opp_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\nSELECT *\r\nFROM {{ source('salesforce', 'opportunity') }}\r\n\r\n), intermediate AS (\r\n\r\n    SELECT DISTINCT\r\n        base.id AS opportunity_id,\r\n        base.is_deleted,\r\n        base.account_id,\r\n        account.name AS account_name,\r\n        --account.account_csm_name,\r\n        --account.account_owner_name,\r\n        account.current_customer_c AS is_current_customer,\r\n        account.sdr_c AS sdr_id,\r\n        sdr.user_name AS sdr_name,\r\n        CASE\r\n            WHEN account.billing_country IS NOT null AND account.billing_country IN ('GB','UK','IE','DE','DK','FI','IS','NO','SE','FR','AL','AD','AM','AT','BY','BE','BA','BG','HR','CS','CY','CZ','EE','FX','GE','GR','HU','IT','LV','LI','LT','LU','MK','MT','MD','MC','ME','NL','PL','PT','RO','SM','RS','SJ','SK','SI','ES','CH','UA','VA','FO','GI','GG','IM','JE','XK','RU') THEN 'EUROPE'\r\n            WHEN account.billing_country IS NOT null AND account.billing_country IN ('JP','KR','CN','MN','TW','VN','HK','LA','TH','KH','PH','MY','SG','ID','LK','IN','NP','BT','MM','PK','AF','KG','UZ','TM','KZ') THEN 'APJ'\r\n            WHEN account.billing_country IS NOT null AND account.billing_country IN ('AU','CX','NZ','NF','Australia','New Zealand') THEN 'AUNZ'\r\n            WHEN account.billing_country IS NOT null AND account.billing_country IN ('AR','BO','BR','BZ','CL','CO','CU','CR','DO','EC','FK','GF','GS','GY','GT','HN','MX','NI','PA','PE','PR','PY','SR','SV','UY','VE')THEN 'LATAM'\r\n            WHEN account.billing_state IS NOT null AND account.billing_state IN ('CA','NV','UT','AK','MO','CO','HI','OK','IL','AR','NE','MI','KS','OR','WA','ID','WI','MN','ND','SD','MT','WY','IA','NB','ON','PE','QC','AB','BC','MB','SK','NL','NS','YT','NU','NT') THEN 'NA-WEST'\r\n            WHEN account.billing_state IS NOT null AND account.billing_state IN ('NY','CT','MA','VT','NH','ME','NJ','RI','TX','AZ','NM','MS','LA','AL','TN','KY','OH','IN','GA','FL','NC','SC','PA','DC','DE','MD','VA','WV') THEN 'NA-EAST'\r\n            WHEN account.billing_country IS NOT null AND account.billing_country IN ('AG','AI','AN','AW','BB','BM','BS','DM','GD','GP','HT','JM','KN','LC','MQ','MS','TC','TT','VC','VG','VI') THEN 'NA-EAST'\r\n            WHEN account.billing_country IS NOT null AND account.billing_country IN ('US','CA') AND account.billing_state IS null  THEN 'NA-NO-STATEPROV'\r\n            WHEN account.billing_country IS NOT null AND account.billing_state IS NOT null THEN 'ROW'\r\n            ELSE 'Unknown'\r\n        END AS account_global_region,\r\n        CASE \r\n            WHEN account.annual_revenue <= 49999999 THEN 'SMB'\r\n            WHEN account.annual_revenue > 49999999 AND account.annual_revenue <= 499999999 THEN 'Mid-Market'\r\n            WHEN account.annual_revenue > 499999999 THEN 'Enterprise'\r\n        END AS company_size_rev,\r\n        base.name AS opportunity_name,\r\n        stage_name,\r\n        amount,\r\n        base.type,\r\n        lead_source AS opp_lead_source,\r\n        is_closed,\r\n        is_won,\r\n        base.owner_id,\r\n        owner.user_name AS owner_name, \r\n        base.created_date AS created_day,\r\n        DATE_TRUNC('day',base.created_date)::Date AS created_date,\r\n        DATE_TRUNC('day',base.last_modified_date)::Date AS last_modified_date,\r\n        base.system_modstamp AS systemmodstamp,\r\n        contact_id,\r\n        base.contract_id,\r\n        crm_c AS opp_crm,\r\n        renewal_type_c AS renewal_type,\r\n        renewal_acv_value_c AS renewal_acv,\r\n        channel_lead_creation_c AS opp_channel_lead_creation,\r\n        medium_lead_creation_c AS opp_medium_lead_creation,\r\n        DATE_TRUNC('day',discovery_date_c)::Date AS discovery_date,\r\n        DATE_TRUNC('day',date_reached_confirmed_value_c)::Date AS confirmed_value_date,\r\n        DATE_TRUNC('day',date_reached_contract_c)::Date AS negotiation_date,\r\n        DATE_TRUNC('day',date_reached_demo_c)::Date AS demo_date,\r\n        DATE_TRUNC('day',date_reached_solution_c)::Date AS solution_date,\r\n        DATE_TRUNC('day',date_reached_closing_c)::Date AS closing_date,\r\n        DATE_TRUNC('day',date_time_reached_implement_c)::Date AS implement_date,\r\n        DATE_TRUNC('day',sql_date_c)::Date AS sql_date,\r\n        DATE_TRUNC('day',date_time_reached_voc_negotiate_c)::Date AS voc_date,\r\n        DATE_TRUNC('day',date_time_reached_discovery_c)::Date AS discovery_day_time,\r\n        DATE_TRUNC('day',date_time_reached_demo_c)::Date AS demo_day_time,\r\n        DATE_TRUNC('day',date_time_reached_implement_c)::Date AS implement_day_time,\r\n        DATE_TRUNC('day',date_time_reached_sql_c)::Date AS sql_day_time,\r\n        DATE_TRUNC('day',date_time_reached_voc_negotiate_c)::Date AS voc_day_time,\r\n        oc_utm_channel_c AS opp_channel_opportunity_creation,\r\n        oc_utm_medium_c AS opp_medium_opportunity_creation,\r\n        oc_utm_content_c AS opp_content_opportunity_creation, \r\n        oc_utm_source_c AS opp_source_opportunity_creation, \r\n        base.csm_c AS csm,\r\n        base.marketing_channel_c AS marketing_channel,\r\n        base.ft_utm_channel_c AS opp_channel_first_touch,\r\n        base.ft_utm_content_c AS opp_content_first_touch,\r\n        base.ft_utm_medium_c AS opp_medium_first_touch,\r\n        base.ft_utm_source_c AS opp_source_first_touch,\r\n        base.oc_offer_asset_type_c AS opp_offer_asset_type_opportunity_creation,\r\n        base.oc_offer_asset_subtype_c AS opp_offer_asset_subtype_opportunity_creation,\r\n        base.oc_offer_asset_topic_c AS opp_offer_asset_topic_opportunity_creation,\r\n        base.oc_offer_asset_name_c AS opp_offer_asset_name_opportunity_creation,\r\n        base.ft_offer_asset_name_c AS opp_offer_asset_name_first_touch,\r\n        base.lc_offer_asset_name_c  AS opp_offer_asset_name_lead_creation, \r\n        base.ft_offer_asset_subtype_c AS opp_offer_asset_subtype_first_touch, \r\n        base.lc_offer_asset_subtype_c AS opp_offer_asset_subtype_lead_creation,\r\n        base.ft_offer_asset_topic_c AS opp_offer_asset_topic_first_touch, \r\n        base.lc_offer_asset_topic_c AS opp_offer_asset_topic_lead_creation,\r\n        base.ft_offer_asset_type_c AS opp_offer_asset_type_first_touch, \r\n        base.lc_offer_asset_type_c AS opp_offer_asset_type_lead_creation,\r\n        base.ft_subchannel_c AS opp_subchannel_first_touch,\r\n        base.lc_subchannel_c AS opp_subchannel_lead_creation, \r\n        base.oc_subchannel_c AS opp_subchannel_opportunity_creation,\r\n        DATE_TRUNC('day',base.discovery_call_scheduled_date_c)::Date AS discovery_call_date,\r\n        base.opportunity_status_c AS opportunity_status,\r\n        base.sql_status_reason_c AS sql_status_reason,\r\n        DATE_TRUNC('day',base.sql_date_c)::Date AS sql_day,\r\n        DATE_TRUNC('day',base.discovery_call_scheduled_date_time_c)::Date AS discovery_call_scheduled_datetime,\r\n        DATE_TRUNC('day',base.discovery_call_completed_date_time_c)::Date AS discovery_call_completed_datetime,\r\n        base.ao_account_id_c AS ao_account_id,\r\n        base.lead_id_converted_from_c AS lead_id_converted_from,\r\n        base.close_date,\r\n        base.opportunity_type_detail_c AS opp_type_details,\r\n        DATE_TRUNC('day',base.close_date)::Date AS close_day,\r\n        base.source_lead_creation_c AS opp_source_lead_creation,\r\n        base.oc_utm_campaign_c AS opp_campaign_opportunity_creation,\r\n        base.forecast_category,\r\n        base.ft_utm_campaign_c AS opp_campaign_first_touch,  \r\n        base.acv_deal_size_override_c AS acv_deal_size_override,\r\n        base.lead_grade_at_conversion_c AS lead_grade_at_conversion,\r\n        base.renewal_stage_c AS renewal_stage,\r\n        base.created_by_id,\r\n        quota_credit_renewal_c AS quota_credit_renewal,\r\n        base.sbqq_renewed_contract_c AS renewed_contract_id,\r\n        quota_credit_c AS quota_credit,\r\n        sbqq_primary_quote_c AS primary_quote_id,\r\n        quota_credit_new_business_c AS quota_credit_new_business,\r\n        quota_credit_one_time_c AS quota_credit_one_time,\r\n        submitted_for_approval_c AS submitted_for_approval,\r\n        acv_add_back_c AS acv_add_back,\r\n        trigger_renewal_value_c AS trigger_renewal_value,\r\n        opportunity_line_item_xf.sbqq_subscription_type,\r\n        quote_line.sbqq_product_subscription_term,\r\n        opportunity_line_item_xf.product_code,\r\n        opportunity_line_item_xf.product_family,\r\n        opportunity_line_item_xf.total_price,\r\n        opportunity_line_item_xf.annual_price,\r\n        quote_line.sbqq_primary_quote,\r\n        contract_source_xf.contract_acv,\r\n        account.industry,\r\n        CASE\r\n            WHEN account.industry IN ('Business Services') THEN 'Business Services'\r\n            WHEN account.industry IN ('Finance','Insurance') THEN 'Finance'\r\n            WHEN account.industry IN ('Manufacturing') THEN 'Manufacturing'\r\n            WHEN account.industry IN ('Software','Telecommunications') THEN 'SoftCom'\r\n            ELSE 'Other'\r\n        END AS industry_bucket,\r\n        --account.segment,\r\n        CASE\r\n            WHEN base.type IN ('New Business','Upsell','Trigger Renewal','Trigger Up','Non-Monetary Mod','Admin Opp','Partner New','Partner UpSell','Admin Conversion') THEN true\r\n            ELSE false\r\n        END AS include_in_acv_deal_size,\r\n        CASE\r\n            WHEN is_closed = true THEN {{ dbt_utils.datediff(\"base.created_date\",\"base.close_date\",'day') }}\r\n            ELSE {{ dbt_utils.datediff(\"base.created_date\",\"CURRENT_DATE\",'day') }}\r\n        END AS age,\r\n        CASE\r\n            WHEN opportunity_line_item_xf.sbqq_subscription_type = 'Renewable' AND opportunity_line_item_xf.product_code != 'SOW-MNTH-CUST' THEN SUM(total_price)\r\n            ELSE 0\r\n        END AS tcv,\r\n        CASE \r\n            WHEN opportunity_line_item_xf.sbqq_subscription_type = 'Renewable' AND opportunity_line_item_xf.product_family != 'Bundle' AND opportunity_line_item_xf.product_code NOT IN ('SOW-MNTH-CUST','MAAS-FND-TRAIN','MAAS-FND-FAST','MAAS-ACC-DELIV','MAAS-ACC-STRAT')\r\n                THEN SUM(annual_price)\r\n            ELSE 0\r\n        END AS acv,\r\n        CASE \r\n            WHEN opportunity_line_item_xf.sbqq_subscription_type = 'One-time' AND opportunity_line_item_xf.product_code NOT IN ('STD-CPCTY-ONE','SOW-MKTR-DMD','SOW-MNTH-CUST','MAAS-FND-TRAIN','MAAS-FND-FASTTRK','MAAS-ACC-IMPL','MAAS-ACC-DELIV','MAAS-ACC-STRAT','AO-CPM-OVER')\r\n                THEN SUM(total_price)\r\n            ELSE 0\r\n        END AS one_time_ps_value,\r\n        CASE \r\n            WHEN opportunity_line_item_xf.sbqq_subscription_type = 'One-time' AND opportunity_line_item_xf.product_code IN ('STD-CPCTY-ONE','AO-CPM-OVER') THEN SUM(total_price)\r\n            ELSE 0\r\n        END AS one_time_license_value,\r\n        CASE \r\n            WHEN opportunity_line_item_xf.product_code IN ('SOW-MKTR-DMD','SOW-MNTH-CUST','MAAS-FND-TRAIN','MAAS-FND-FASTTRK','MAAS-ACC-IMPL','MAAS-ACC-DELIV','MAAS-ACC-STRAT') THEN SUM(total_price)\r\n            ELSE 0\r\n        END AS pso_recurring_fees\r\n    FROM base\r\n    LEFT JOIN {{ref('contract_source_xf')}} ON\r\n    base.id=contract_source_xf.contract_opportunity_id\r\n    LEFT JOIN {{ref('opportunity_line_item_xf')}} ON\r\n    base.id=opportunity_line_item_xf.opportunity_id\r\n    LEFT JOIN {{ref('quote_line')}} ON\r\n    base.id=quote_line.opportunity_id\r\n    LEFT JOIN \"acton\".salesforce.\"account\" account ON\r\n    base.account_id=account.id\r\n    LEFT JOIN {{ref('user_source_xf')}} owner ON\r\n    base.owner_id=owner.user_id\r\n    LEFT JOIN {{ref('user_source_xf')}} sdr ON\r\n    account.sdr_c=sdr.user_id\r\n    {{dbt_utils.group_by(n=108) }}\r\n\r\n), intermediate_acv_formula AS (\r\n\r\n    SELECT \r\n      intermediate.opportunity_id,\r\n      intermediate.is_deleted,\r\n      intermediate.account_id,\r\n      intermediate.account_name,\r\n      intermediate.is_current_customer,\r\n      intermediate.sdr_id,\r\n      intermediate.sdr_name,\r\n      intermediate.company_size_rev,\r\n      intermediate.account_global_region,\r\n      intermediate.opportunity_name,\r\n      intermediate.stage_name,\r\n      intermediate.amount,\r\n      intermediate.type,\r\n      intermediate.opp_lead_source,\r\n      intermediate.is_closed,\r\n      intermediate.is_won,\r\n      intermediate.owner_id,\r\n      intermediate.owner_name,\r\n      intermediate.created_day,\r\n      intermediate.created_date,\r\n      intermediate.last_modified_date,\r\n      intermediate.systemmodstamp,\r\n      intermediate.contact_id,\r\n      intermediate.contract_id,\r\n      intermediate.opp_crm,\r\n      intermediate.renewal_type,\r\n      intermediate.renewal_acv,\r\n      intermediate.opp_channel_lead_creation,\r\n      intermediate.opp_medium_lead_creation,\r\n      intermediate.discovery_date,\r\n      intermediate.demo_date,\r\n      intermediate.solution_date,\r\n      intermediate.negotiation_date,\r\n      intermediate.confirmed_value_date,\r\n      intermediate.closing_date,\r\n      intermediate.implement_date,\r\n      intermediate.sql_date,\r\n      intermediate.voc_date,\r\n      intermediate.discovery_day_time,\r\n      intermediate.demo_day_time,\r\n      intermediate.implement_day_time,\r\n      intermediate.sql_day_time,\r\n      intermediate.voc_day_time,\r\n      intermediate.opp_channel_opportunity_creation,\r\n      intermediate.opp_medium_opportunity_creation,\r\n      intermediate.opp_content_opportunity_creation,\r\n      intermediate.opp_source_opportunity_creation,\r\n      intermediate.csm,\r\n      intermediate.marketing_channel,\r\n      intermediate.opp_channel_first_touch,\r\n      intermediate.opp_content_first_touch,\r\n      intermediate.opp_medium_first_touch,\r\n      intermediate.opp_source_first_touch,\r\n      intermediate.opp_offer_asset_type_opportunity_creation,\r\n      intermediate.opp_offer_asset_subtype_opportunity_creation,\r\n      intermediate.opp_offer_asset_topic_opportunity_creation,\r\n      intermediate.opp_offer_asset_name_opportunity_creation,\r\n      intermediate.opp_offer_asset_name_first_touch,\r\n      intermediate.opp_offer_asset_name_lead_creation,\r\n      intermediate.opp_offer_asset_subtype_first_touch,\r\n      intermediate.opp_offer_asset_subtype_lead_creation,\r\n      intermediate.opp_offer_asset_topic_first_touch,\r\n      intermediate.opp_offer_asset_topic_lead_creation,\r\n      intermediate.opp_offer_asset_type_first_touch,\r\n      intermediate.opp_offer_asset_type_lead_creation,\r\n      intermediate.opp_subchannel_first_touch,\r\n      intermediate.opp_subchannel_lead_creation,\r\n      intermediate.opp_subchannel_opportunity_creation,\r\n      intermediate.discovery_call_date,\r\n      intermediate.opportunity_status,\r\n      intermediate.sql_status_reason,\r\n      intermediate.sql_day,\r\n      intermediate.discovery_call_scheduled_datetime,\r\n      intermediate.discovery_call_completed_datetime,\r\n      intermediate.ao_account_id,\r\n      intermediate.lead_id_converted_from,\r\n      intermediate.close_date,\r\n      intermediate.opp_type_details,\r\n      intermediate.close_day,\r\n      intermediate.opp_source_lead_creation,\r\n      intermediate.opp_campaign_opportunity_creation,\r\n      intermediate.forecast_category,\r\n      intermediate.opp_campaign_first_touch,\r\n      intermediate.acv_deal_size_override,\r\n      intermediate.lead_grade_at_conversion,\r\n      intermediate.renewal_stage,\r\n      intermediate.created_by_id,\r\n      intermediate.quota_credit_renewal,\r\n      intermediate.renewed_contract_id,\r\n      intermediate.quota_credit,\r\n      intermediate.primary_quote_id,\r\n      intermediate.quota_credit_new_business,\r\n      intermediate.quota_credit_one_time,\r\n      intermediate.submitted_for_approval,\r\n      intermediate.acv_add_back,\r\n      intermediate.trigger_renewal_value,\r\n      intermediate.sbqq_primary_quote,\r\n      intermediate.sbqq_product_subscription_term,\r\n      intermediate.contract_acv,\r\n      intermediate.industry,\r\n      intermediate.industry_bucket,\r\n      --intermediate.segment,\r\n      intermediate.include_in_acv_deal_size,\r\n      intermediate.age,\r\n      intermediate.tcv,\r\n      intermediate.acv,\r\n      intermediate.one_time_ps_value,\r\n      intermediate.one_time_license_value,\r\n      intermediate.pso_recurring_fees,\r\n      intermediate.total_price,\r\n      intermediate.annual_price,\r\n      CASE\r\n        WHEN sbqq_product_subscription_term = 0 AND sbqq_primary_quote IS null THEN SUM(contract_acv)\r\n        WHEN sbqq_product_subscription_term > 0 AND sbqq_product_subscription_term < 12 THEN SUM(tcv) \r\n        ELSE SUM(acv)\r\n      END AS acv_formula\r\n      --intermediate.sbqq_subscription_type,\r\n      --intermediate.product_code,\r\n      --intermediate.product_family,\r\n    FROM intermediate\r\n    {{dbt_utils.group_by(n=110) }}\r\n\r\n), intermediate_acv_sum AS (\r\n    \r\n    SELECT\r\n      intermediate_acv_formula.opportunity_id,\r\n      intermediate_acv_formula.is_deleted,\r\n      intermediate_acv_formula.account_id,\r\n      intermediate_acv_formula.account_name,\r\n      intermediate_acv_formula.is_current_customer,\r\n      intermediate_acv_formula.sdr_id,\r\n      intermediate_acv_formula.sdr_name,\r\n      intermediate_acv_formula.account_global_region,\r\n      intermediate_acv_formula.company_size_rev,\r\n      intermediate_acv_formula.opportunity_name,\r\n      intermediate_acv_formula.stage_name,\r\n      intermediate_acv_formula.amount,\r\n      intermediate_acv_formula.type,\r\n      intermediate_acv_formula.opp_lead_source,\r\n      intermediate_acv_formula.is_closed,\r\n      intermediate_acv_formula.is_won,\r\n      intermediate_acv_formula.owner_id,\r\n      intermediate_acv_formula.owner_name,\r\n      intermediate_acv_formula.created_day,\r\n      intermediate_acv_formula.created_date,\r\n      intermediate_acv_formula.last_modified_date,\r\n      intermediate_acv_formula.systemmodstamp,\r\n      intermediate_acv_formula.contact_id,\r\n      intermediate_acv_formula.contract_id,\r\n      intermediate_acv_formula.opp_crm,\r\n      intermediate_acv_formula.renewal_type,\r\n      intermediate_acv_formula.renewal_acv,\r\n      intermediate_acv_formula.opp_channel_lead_creation,\r\n      intermediate_acv_formula.opp_medium_lead_creation,\r\n      intermediate_acv_formula.discovery_date,\r\n      intermediate_acv_formula.negotiation_date,\r\n      intermediate_acv_formula.demo_date,\r\n      intermediate_acv_formula.solution_date,\r\n      intermediate_acv_formula.confirmed_value_date,\r\n      intermediate_acv_formula.closing_date,\r\n      intermediate_acv_formula.implement_date,\r\n      intermediate_acv_formula.discovery_day_time,\r\n      intermediate_acv_formula.demo_day_time,\r\n      intermediate_acv_formula.implement_day_time,\r\n      intermediate_acv_formula.sql_day_time,\r\n      intermediate_acv_formula.voc_day_time,\r\n      intermediate_acv_formula.sql_date,\r\n      intermediate_acv_formula.voc_date,\r\n      intermediate_acv_formula.opp_channel_opportunity_creation,\r\n      intermediate_acv_formula.opp_medium_opportunity_creation,\r\n      intermediate_acv_formula.opp_content_opportunity_creation,\r\n      intermediate_acv_formula.opp_source_opportunity_creation,\r\n      intermediate_acv_formula.csm,\r\n      intermediate_acv_formula.marketing_channel,\r\n      intermediate_acv_formula.opp_channel_first_touch,\r\n      intermediate_acv_formula.opp_content_first_touch,\r\n      intermediate_acv_formula.opp_medium_first_touch,\r\n      intermediate_acv_formula.opp_source_first_touch,\r\n      intermediate_acv_formula.opp_offer_asset_type_opportunity_creation,\r\n      intermediate_acv_formula.opp_offer_asset_subtype_opportunity_creation,\r\n      intermediate_acv_formula.opp_offer_asset_topic_opportunity_creation,\r\n      intermediate_acv_formula.opp_offer_asset_name_opportunity_creation,\r\n      intermediate_acv_formula.opp_offer_asset_name_first_touch,\r\n      intermediate_acv_formula.opp_offer_asset_name_lead_creation,\r\n      intermediate_acv_formula.opp_offer_asset_subtype_first_touch,\r\n      intermediate_acv_formula.opp_offer_asset_subtype_lead_creation,\r\n      intermediate_acv_formula.opp_offer_asset_topic_first_touch,\r\n      intermediate_acv_formula.opp_offer_asset_topic_lead_creation,\r\n      intermediate_acv_formula.opp_offer_asset_type_first_touch,\r\n      intermediate_acv_formula.opp_offer_asset_type_lead_creation,\r\n      intermediate_acv_formula.opp_subchannel_first_touch,\r\n      intermediate_acv_formula.opp_subchannel_lead_creation,\r\n      intermediate_acv_formula.opp_subchannel_opportunity_creation,\r\n      intermediate_acv_formula.discovery_call_date,\r\n      intermediate_acv_formula.opportunity_status,\r\n      intermediate_acv_formula.sql_status_reason,\r\n      intermediate_acv_formula.sql_day,\r\n      intermediate_acv_formula.discovery_call_scheduled_datetime,\r\n      intermediate_acv_formula.discovery_call_completed_datetime,\r\n      intermediate_acv_formula.ao_account_id,\r\n      intermediate_acv_formula.lead_id_converted_from,\r\n      intermediate_acv_formula.close_date,\r\n      intermediate_acv_formula.opp_type_details,\r\n      intermediate_acv_formula.close_day,\r\n      intermediate_acv_formula.opp_source_lead_creation,\r\n      intermediate_acv_formula.opp_campaign_opportunity_creation,\r\n      intermediate_acv_formula.forecast_category,\r\n      intermediate_acv_formula.opp_campaign_first_touch,\r\n      intermediate_acv_formula.acv_deal_size_override,\r\n      intermediate_acv_formula.lead_grade_at_conversion,\r\n      intermediate_acv_formula.renewal_stage,\r\n      intermediate_acv_formula.created_by_id,\r\n      intermediate_acv_formula.quota_credit_renewal,\r\n      intermediate_acv_formula.renewed_contract_id,\r\n      intermediate_acv_formula.quota_credit,\r\n      intermediate_acv_formula.primary_quote_id,\r\n      intermediate_acv_formula.quota_credit_new_business,\r\n      intermediate_acv_formula.quota_credit_one_time,\r\n      intermediate_acv_formula.submitted_for_approval,\r\n      intermediate_acv_formula.acv_add_back,\r\n      intermediate_acv_formula.trigger_renewal_value,\r\n      intermediate_acv_formula.sbqq_primary_quote,\r\n      intermediate_acv_formula.sbqq_product_subscription_term,\r\n      intermediate_acv_formula.contract_acv,\r\n      intermediate_acv_formula.industry,\r\n      intermediate_acv_formula.industry_bucket,\r\n     -- intermediate_acv_formula.segment,\r\n      intermediate_acv_formula.include_in_acv_deal_size,\r\n      intermediate_acv_formula.age,\r\n      SUM(intermediate_acv_formula.one_time_ps_value) AS one_time_ps_value,\r\n      SUM(intermediate_acv_formula.one_time_license_value) AS one_time_license_value,\r\n      SUM(intermediate_acv_formula.pso_recurring_fees) AS pso_recurring_fees,\r\n      SUM(intermediate_acv_formula.tcv) AS tcv,\r\n      SUM(intermediate_acv_formula.acv) AS acv,\r\n      SUM(intermediate_acv_formula.total_price) AS total_price,\r\n      SUM(intermediate_acv_formula.annual_price) AS annual_price,\r\n      SUM(intermediate_acv_formula.acv_formula) AS acv_formula\r\n    FROM intermediate_acv_formula\r\n    {{dbt_utils.group_by(n=103) }}\r\n\r\n), intermediate_acv_deal_size AS (\r\n    \r\n    SELECT\r\n      intermediate_acv_sum.*,\r\n      CASE\r\n        WHEN account_global_region IN ('EUROPE','ROW','AUNZ') THEN 'EMEA'\r\n        WHEN company_size_rev IN ('SMB') OR company_size_rev IS null THEN 'Velocity'\r\n        WHEN company_size_rev IN ('Mid-Market','Enterprise') THEN 'Upmarket'\r\n        ELSE null\r\n      END AS segment, \r\n      CASE\r\n        WHEN acv_deal_size_override > 0 AND is_closed = false AND submitted_for_approval = false THEN acv_deal_size_override\r\n        WHEN type = 'Renewal' THEN SUM(acv_add_back + trigger_renewal_value)\r\n        WHEN include_in_acv_deal_size=false THEN 0\r\n        WHEN include_in_acv_deal_size=true AND acv_formula=0 AND one_time_ps_value=0 AND one_time_license_value=0 AND pso_recurring_fees=0 THEN amount\r\n        ELSE acv_formula\r\n      END AS acv_deal_size_usd\r\n    FROM intermediate_acv_sum\r\n    {{dbt_utils.group_by(n=111) }}\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        intermediate_acv_deal_size.*,\r\n        CASE \r\n            WHEN acv_deal_size_usd <= '9999' THEN '< 10K'\r\n            WHEN acv_deal_size_usd > '9999' AND acv_deal_size_usd <= '14999' THEN '10-15K'\r\n            WHEN acv_deal_size_usd > '14999' AND acv_deal_size_usd <= '19999' THEN '15-20K'\r\n            WHEN acv_deal_size_usd > '19999' AND acv_deal_size_usd <= '24999' THEN '20-25K'\r\n            WHEN acv_deal_size_usd > '24999' AND acv_deal_size_usd <= '29999' THEN '25-30K'\r\n            ELSE '30K+'\r\n        END AS deal_size_range,\r\n        CASE \r\n            WHEN LOWER(opp_channel_lead_creation) = 'organic' THEN 'Organic'\r\n            WHEN LOWER(opp_channel_lead_creation) IS null THEN 'Unknown'\r\n            WHEN LOWER(opp_channel_lead_creation) = 'social' AND LOWER(opp_medium_lead_creation) = 'social-organic' THEN 'Social - Organic'\r\n            WHEN LOWER(opp_channel_lead_creation) = 'social' AND LOWER(opp_medium_lead_creation) = 'social-paid' THEN 'Paid Social'\r\n            WHEN LOWER(opp_channel_lead_creation) = 'ppc' THEN 'PPC/Paid Search'\r\n            WHEN LOWER(opp_channel_lead_creation) = 'email' AND LOWER(opp_source_lead_creation) like '%act-on%' THEN 'Paid Email' \r\n            WHEN LOWER(opp_channel_lead_creation) = 'ppl' AND LOWER(opp_medium_lead_creation) = 'syndication partner' THEN 'PPL'\r\n            WHEN LOWER(opp_channel_lead_creation) IN ('prospecting','ppl') AND LOWER(opp_medium_lead_creation) = 'intent partner' THEN 'Intent Partners'\r\n            WHEN LOWER(opp_channel_lead_creation) = 'event' THEN 'Events and Trade Shows'\r\n            WHEN LOWER(opp_channel_lead_creation) = 'partner' THEN 'Partners'\r\n            ELSE 'Other'\r\n        END AS channel_bucket\r\n    FROM intermediate_acv_deal_size\r\n)\r\n\r\nSELECT DISTINCT\r\n*\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff", "macro.dbt_utils.group_by"], "nodes": ["source.acton_marketing_data.salesforce.opportunity", "model.acton_marketing_data.contract_source_xf", "model.acton_marketing_data.opportunity_line_item_xf", "model.acton_marketing_data.quote_line", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "opp_source_xf"], "unique_id": "model.acton_marketing_data.opp_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/opp_source_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/opp_source_xf.sql", "name": "opp_source_xf", "alias": "opp_source_xf", "checksum": {"name": "sha256", "checksum": "1e1d45c58d4cb293440ddd53078aab0d07ec7b7bd6970150e1d427f3cf50075d"}, "tags": [], "refs": [["contract_source_xf"], ["opportunity_line_item_xf"], ["quote_line"], ["user_source_xf"], ["user_source_xf"]], "sources": [["salesforce", "opportunity"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3524368}, "model.acton_marketing_data.lead_source_ss_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM \"acton\".salesforce.\"lead\"\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        id AS lead_id,\r\n        is_deleted,\r\n        first_name,\r\n        last_name, \r\n        title,\r\n        company,\r\n        state,\r\n        country,\r\n        email,\r\n        lead_source,\r\n        status AS lead_status,\r\n        industry,\r\n        annual_revenue,\r\n        number_of_employees,\r\n        owner_id AS lead_owner,\r\n        is_converted,\r\n        DATE_TRUNC('day',converted_date)::Date AS converted_date,\r\n        converted_account_id,\r\n        converted_contact_id,\r\n        converted_opportunity_id,\r\n        last_modified_date,\r\n        DATE_TRUNC('day',created_date)::Date AS created_date,\r\n        system_modstamp AS systemmodstamp,\r\n        DATE_TRUNC('day',mql_created_date_c)::Date AS mql_created_date,\r\n        DATE_TRUNC('day',mql_most_recent_date_c)::Date AS mql_most_recent_date,\r\n        DATE_TRUNC('day',date_time_to_working_c)::Date AS working_date,\r\n        account_c AS account_id,\r\n        no_longer_with_company_c AS no_longer_with_company,\r\n        ft_utm_channel_c AS channel_first_touch,\r\n        lt_utm_channel_c AS channel_last_touch,\r\n        lt_utm_medium_c AS medium_last_touch,\r\n        lt_utm_content_c AS content_last_touch,\r\n        lt_utm_source_c AS source_last_touch,\r\n        lt_utm_campaign_c AS campaign_last_touch,\r\n        channel_lead_creation_c AS channel_lead_creation,\r\n        medium_lead_creation_c AS medium_lead_creation,\r\n        hand_raiser_c AS is_hand_raiser,\r\n        ft_subchannel_c AS subchannel_first_touch,\r\n        lt_subchannel_c AS subchannel_last_touch,\r\n        lc_subchannel_c AS subchannel_lead_creation,\r\n        ft_offer_asset_type_c AS offer_asset_type_first_touch,\r\n        ft_offer_asset_subtype_c AS offer_asset_subtype_first_touch,\r\n        ft_offer_asset_topic_c AS offer_asset_topic_first_touch,\r\n        ft_offer_asset_name_c AS offer_asset_name_first_touch,\r\n        lc_offer_asset_type_c AS offer_asset_type_lead_creation,\r\n        lc_offer_asset_subtype_c AS offer_asset_subtype_lead_creation,\r\n        lc_offer_asset_topic_c AS offer_asset_topic_lead_creation,\r\n        lc_offer_asset_name_c AS offer_asset_name_lead_creation,\r\n        lt_offer_asset_type_c AS offer_asset_type_last_touch,\r\n        lt_offer_asset_subtype_c AS offer_asset_subtype_last_touch,\r\n        lt_offer_asset_topic_c AS offer_asset_topic_last_touch,\r\n        lt_offer_asset_name_c AS offer_asset_name_last_touch,\r\n        lean_data_a_2_b_account_c AS lean_data_account_id,\r\n        de_current_marketing_automation_c AS current_ma,\r\n        de_current_crm_c AS current_crm,\r\n        DATE_TRUNC('day',marketing_lead_creation_date_c)::Date AS marketing_created_date,\r\n        mql_created_time_c AS mql_created_datetime,\r\n        mql_most_recent_time_c AS mql_most_recent_datetime,\r\n        article_14_notice_date_c AS article_14_notice_date,\r\n        x_9883_lead_score_c AS lead_score,\r\n        ft_utm_medium_c AS medium_first_touch,\r\n        ft_utm_source_c AS source_first_touch,\r\n        ft_utm_campaign_c AS campaign_first_touch,\r\n        channel_lead_creation_c AS lead_channel_forecast,\r\n        email_bounced_reason,\r\n        legitimate_basis_c AS legitimate_basis,\r\n        email_bounced_date,\r\n        source_lead_creation_c AS source_lead_creation,\r\n        campaign_lead_creation_c AS campaign_lead_creation,\r\n        firmographic_demographic_lead_score_c AS firmographic_demographic_lead_score,\r\n        do_not_contact_c AS do_not_contact,\r\n        form_consent_opt_in_c AS form_consent_opt_in,\r\n        CASE \r\n            WHEN annual_revenue <= 49999999 THEN 'SMB'\r\n            WHEN annual_revenue > 49999999 AND annual_revenue <= 499999999 THEN 'Mid-Market'\r\n            WHEN annual_revenue > 499999999 THEN 'Enterprise'\r\n        END AS company_size_rev,\r\n        CASE \r\n            WHEN LOWER(channel_lead_creation_c) = 'organic' THEN 'Organic'\r\n            WHEN LOWER(channel_lead_creation_c) IS null THEN 'Unknown'\r\n            WHEN LOWER(channel_lead_creation_c) = 'social' AND LOWER(medium_lead_creation_c) = 'social-organic' THEN 'Social - Organic'\r\n            WHEN LOWER(channel_lead_creation_c) = 'social' AND LOWER(medium_lead_creation_c) = 'social-paid' THEN 'Paid Social'\r\n            WHEN LOWER(channel_lead_creation_c) = 'ppc' THEN 'PPC/Paid Search'\r\n            WHEN LOWER(channel_lead_creation_c) = 'email' AND LOWER(source_lead_creation_c) like '%act-on%' THEN 'Paid Email' \r\n            WHEN LOWER(channel_lead_creation_c) = 'ppl' AND LOWER(medium_lead_creation_c) = 'syndication partner' THEN 'PPL'\r\n            WHEN LOWER(channel_lead_creation_c) IN ('prospecting','ppl') AND LOWER(medium_lead_creation_c) = 'intent partner' THEN 'Intent Partners'\r\n            WHEN LOWER(channel_lead_creation_c) = 'event' THEN 'Events and Trade Shows'\r\n            WHEN LOWER(channel_lead_creation_c) = 'partner' THEN 'Partners'\r\n            ELSE 'Other'\r\n        END AS channel_bucket,\r\n        CASE\r\n            WHEN country IS NOT null AND country IN ('GB','UK','IE','DE','DK','FI','IS','NO','SE','FR','AL','AD','AM','AT','BY','BE','BA','BG','HR','CS','CY','CZ','EE','FX','GE','GR','HU','IT','LV','LI','LT','LU','MK','MT','MD','MC','ME','NL','PL','PT','RO','SM','RS','SJ','SK','SI','ES','CH','UA','VA','FO','GI','GG','IM','JE','XK','RU','United Kingdom','England') THEN 'EUROPE'\r\n            WHEN country IS NOT null AND country IN ('JP','KR','CN','MN','TW','VN','HK','LA','TH','KH','PH','MY','SG','ID','LK','IN','NP','BT','MM','PK','AF','KG','UZ','TM','KZ') THEN 'APJ'\r\n            WHEN country IS NOT null AND country IN ('AU','CX','NZ','NF','Australia','New Zealand') THEN 'AUNZ'\r\n            WHEN country IS NOT null AND country IN ('AR','BO','BR','BZ','CL','CO','CU','CR','DO','EC','FK','GF','GS','GY','GT','HN','MX','NI','PA','PE','PR','PY','SR','SV','UY','VE')THEN 'LATAM'\r\n            WHEN state IS NOT null AND state IN ('CA','NV','UT','AK','MO','CO','HI','OK','IL','AR','NE','MI','KS','OR','WA','ID','WI','MN','ND','SD','MT','WY','IA','NB','ON','PE','QC','AB','BC','MB','SK','NL','NS','YT','NU','NT') THEN 'NA-WEST'\r\n            WHEN state IS NOT null AND state IN ('NY','CT','MA','VT','NH','ME','NJ','RI','TX','AZ','NM','MS','LA','AL','TN','KY','OH','IN','GA','FL','NC','SC','PA','DC','DE','MD','VA','WV') THEN 'NA-EAST'\r\n            WHEN country IS NOT null AND country IN ('AG','AI','AN','AW','BB','BM','BS','DM','GD','GP','HT','JM','KN','LC','MQ','MS','TC','TT','VC','VG','VI') THEN 'NA-EAST'\r\n            WHEN country IS NOT null AND country IN ('US','CA') AND state IS null  THEN 'NA-NO-STATEPROV'\r\n            WHEN country IS NOT null AND state IS NOT null THEN 'ROW'\r\n            ELSE 'Unknown'\r\n        END AS global_region,\r\n        COALESCE(account_c,lean_data_a_2_b_account_c) AS person_account_id\r\n    FROM base\r\n    WHERE base.owner_id != '00Ga0000003Nugr' -- AO-Fake Leads\r\n\r\n)\r\n\r\nSELECT \r\nfinal.*,\r\nCASE\r\n    WHEN global_region IN ('EUROPE','ROW','AUNZ') THEN 'EMEA'\r\n    WHEN company_size_rev IN ('SMB') OR company_size_rev IS null THEN 'Velocity'\r\n    WHEN company_size_rev IN ('Mid-Market','Enterprise') THEN 'Upmarket'\r\n    ELSE null\r\nEND AS segment\r\nFROM final\r\nWHERE lead_status IN ('Suspect','Responded','RTM')", "resource_type": "model", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "lead_source_ss_xf"], "unique_id": "model.acton_marketing_data.lead_source_ss_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/lead_source_ss_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/lead_source_ss_xf.sql", "name": "lead_source_ss_xf", "alias": "lead_source_ss_xf", "checksum": {"name": "sha256", "checksum": "8e0aca73165037ef743eaafa698aa42953476ccd8f519056c15840e456f0dfa6"}, "tags": [], "refs": [], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3651605}, "model.acton_marketing_data.task_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'task') }}\r\n\r\n), renamed AS (\r\n\r\n    SELECT\r\n        id AS task_id,\r\n        what_id,\r\n        subject AS task_subject,\r\n        activity_date,\r\n        status AS task_status,\r\n        owner_id,\r\n        is_deleted,\r\n        account_id,\r\n        is_closed,\r\n        created_date AS task_created_date,\r\n        last_modified_date,\r\n        system_modstamp,\r\n        is_archived,\r\n        record_type_id,\r\n        who_id AS person_id,\r\n        type AS task_type,\r\n        closed_date_c AS close_date\r\n    FROM base\r\n    WHERE who_id IS NOT null\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n    --IDs\r\n        task_id,\r\n        renamed.person_id,\r\n        owner_id,\r\n        renamed.account_id,\r\n        email,\r\n\r\n    --Task Data\r\n        task_subject,\r\n        task_status,\r\n        task_type,\r\n        is_closed,\r\n        activity_date,\r\n        task_created_date,\r\n        close_date\r\n    FROM renamed\r\n    LEFT JOIN {{ref('person_source_xf')}} ON\r\n    renamed.person_id=person_source_xf.person_id\r\n)\r\n\r\nSELECT*\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.task", "model.acton_marketing_data.person_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "task_source_xf"], "unique_id": "model.acton_marketing_data.task_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/task_source_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/task_source_xf.sql", "name": "task_source_xf", "alias": "task_source_xf", "checksum": {"name": "sha256", "checksum": "56ea1acdf2e9255853fca578209d561001f7ed014a43811ec0cc6da2f0c83de9"}, "tags": [], "refs": [["person_source_xf"]], "sources": [["salesforce", "task"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3670955}, "model.acton_marketing_data.lead_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'lead') }}\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        id AS lead_id,\r\n        is_deleted,\r\n        base.created_by_id,\r\n        creator.user_name AS created_by_name,\r\n        first_name,\r\n        last_name, \r\n        title,\r\n        company,\r\n        state,\r\n        country,\r\n        email,\r\n        lead_source,\r\n        status AS lead_status,\r\n        de_industry_c AS industry,\r\n        CASE\r\n            WHEN de_industry_c IN ('Business Services') THEN 'Business Services'\r\n            WHEN de_industry_c IN ('Finance','Insurance') THEN 'Finance'\r\n            WHEN de_industry_c IN ('Manufacturing') THEN 'Manufacturing'\r\n            WHEN de_industry_c IN ('Software','Telecommunications') THEN 'SoftCom'\r\n            ELSE 'Other'\r\n        END AS industry_bucket,\r\n        annual_revenue,\r\n        number_of_employees,\r\n        owner_id AS lead_owner_id,\r\n        is_converted,\r\n        DATE_TRUNC('day',converted_date)::Date AS converted_date,\r\n        converted_account_id,\r\n        converted_contact_id,\r\n        converted_opportunity_id,\r\n        last_modified_date,\r\n        DATE_TRUNC('day',created_date)::Date AS created_date,\r\n        system_modstamp AS systemmodstamp,\r\n        DATE_TRUNC('day',mql_created_date_c)::Date AS mql_created_date,\r\n        DATE_TRUNC('day',mql_most_recent_date_c)::Date AS mql_most_recent_date,\r\n        DATE_TRUNC('day',date_time_to_working_c)::Date AS working_date,\r\n        account_c AS account_id,\r\n        no_longer_with_company_c AS no_longer_with_company,\r\n        ft_utm_channel_c AS channel_first_touch,\r\n        lt_utm_channel_c AS channel_last_touch,\r\n        lt_utm_medium_c AS medium_last_touch,\r\n        lt_utm_content_c AS content_last_touch,\r\n        lt_utm_source_c AS source_last_touch,\r\n        lt_utm_campaign_c AS campaign_last_touch,\r\n        channel_lead_creation_c AS channel_lead_creation,\r\n        medium_lead_creation_c AS medium_lead_creation,\r\n        hand_raiser_c AS is_hand_raiser,\r\n        ft_subchannel_c AS subchannel_first_touch,\r\n        lt_subchannel_c AS subchannel_last_touch,\r\n        lc_subchannel_c AS subchannel_lead_creation,\r\n        ft_offer_asset_type_c AS offer_asset_type_first_touch,\r\n        ft_offer_asset_subtype_c AS offer_asset_subtype_first_touch,\r\n        ft_offer_asset_topic_c AS offer_asset_topic_first_touch,\r\n        ft_offer_asset_name_c AS offer_asset_name_first_touch,\r\n        lc_offer_asset_type_c AS offer_asset_type_lead_creation,\r\n        lc_offer_asset_subtype_c AS offer_asset_subtype_lead_creation,\r\n        lc_offer_asset_topic_c AS offer_asset_topic_lead_creation,\r\n        lc_offer_asset_name_c AS offer_asset_name_lead_creation,\r\n        lt_offer_asset_type_c AS offer_asset_type_last_touch,\r\n        lt_offer_asset_subtype_c AS offer_asset_subtype_last_touch,\r\n        lt_offer_asset_topic_c AS offer_asset_topic_last_touch,\r\n        lt_offer_asset_name_c AS offer_asset_name_last_touch,\r\n        lean_data_a_2_b_account_c AS lean_data_account_id,\r\n        de_current_marketing_automation_c AS current_ma,\r\n        de_current_crm_c AS current_crm,\r\n        DATE_TRUNC('day',marketing_lead_creation_date_c)::Date AS marketing_created_date,\r\n        mql_created_time_c AS mql_created_datetime,\r\n        mql_most_recent_time_c AS mql_most_recent_datetime,\r\n        article_14_notice_date_c AS article_14_notice_date,\r\n        x_9883_lead_score_c AS lead_score,\r\n        ft_utm_medium_c AS medium_first_touch,\r\n        ft_utm_source_c AS source_first_touch,\r\n        ft_utm_campaign_c AS campaign_first_touch,\r\n        channel_lead_creation_c AS lead_channel_forecast,\r\n        email_bounced_reason,\r\n        legitimate_basis_c AS legitimate_basis,\r\n        email_bounced_date,\r\n        source_lead_creation_c AS source_lead_creation,\r\n        campaign_lead_creation_c AS campaign_lead_creation,\r\n        firmographic_demographic_lead_score_c AS firmographic_demographic_lead_score,\r\n        do_not_contact_c AS do_not_contact,\r\n        form_consent_opt_in_c AS form_consent_opt_in,\r\n        CASE \r\n            WHEN annual_revenue <= 49999999 THEN 'SMB'\r\n            WHEN annual_revenue > 49999999 AND annual_revenue <= 499999999 THEN 'Mid-Market'\r\n            WHEN annual_revenue > 499999999 THEN 'Enterprise'\r\n        END AS company_size_rev,\r\n        CASE \r\n            WHEN LOWER(channel_lead_creation_c) = 'organic' THEN 'Organic'\r\n            WHEN LOWER(channel_lead_creation_c) IS null THEN 'Unknown'\r\n            WHEN LOWER(channel_lead_creation_c) = 'social' AND LOWER(medium_lead_creation_c) = 'social-organic' THEN 'Social - Organic'\r\n            WHEN LOWER(channel_lead_creation_c) = 'social' AND LOWER(medium_lead_creation_c) = 'social-paid' THEN 'Paid Social'\r\n            WHEN LOWER(channel_lead_creation_c) = 'ppc' THEN 'PPC/Paid Search'\r\n            WHEN LOWER(channel_lead_creation_c) = 'email' AND LOWER(source_lead_creation_c) like '%act-on%' THEN 'Paid Email' \r\n            WHEN LOWER(channel_lead_creation_c) = 'ppl' AND LOWER(medium_lead_creation_c) = 'syndication partner' THEN 'PPL'\r\n            WHEN LOWER(channel_lead_creation_c) IN ('prospecting','ppl') AND LOWER(medium_lead_creation_c) = 'intent partner' THEN 'Intent Partners'\r\n            WHEN LOWER(channel_lead_creation_c) = 'event' THEN 'Events and Trade Shows'\r\n            WHEN LOWER(channel_lead_creation_c) = 'partner' THEN 'Partners'\r\n            ELSE 'Other'\r\n        END AS channel_bucket,\r\n        CASE\r\n            WHEN country IS NOT null AND country IN ('GB','UK','IE','DE','DK','FI','IS','NO','SE','FR','AL','AD','AM','AT','BY','BE','BA','BG','HR','CS','CY','CZ','EE','FX','GE','GR','HU','IT','LV','LI','LT','LU','MK','MT','MD','MC','ME','NL','PL','PT','RO','SM','RS','SJ','SK','SI','ES','CH','UA','VA','FO','GI','GG','IM','JE','XK','RU','United Kingdom','England') THEN 'EUROPE'\r\n            WHEN country IS NOT null AND country IN ('JP','KR','CN','MN','TW','VN','HK','LA','TH','KH','PH','MY','SG','ID','LK','IN','NP','BT','MM','PK','AF','KG','UZ','TM','KZ') THEN 'APJ'\r\n            WHEN country IS NOT null AND country IN ('AU','CX','NZ','NF','Australia','New Zealand') THEN 'AUNZ'\r\n            WHEN country IS NOT null AND country IN ('AR','BO','BR','BZ','CL','CO','CU','CR','DO','EC','FK','GF','GS','GY','GT','HN','MX','NI','PA','PE','PR','PY','SR','SV','UY','VE')THEN 'LATAM'\r\n            WHEN state IS NOT null AND state IN ('CA','NV','UT','AK','MO','CO','HI','OK','IL','AR','NE','MI','KS','OR','WA','ID','WI','MN','ND','SD','MT','WY','IA','NB','ON','PE','QC','AB','BC','MB','SK','NL','NS','YT','NU','NT') THEN 'NA-WEST'\r\n            WHEN state IS NOT null AND state IN ('NY','CT','MA','VT','NH','ME','NJ','RI','TX','AZ','NM','MS','LA','AL','TN','KY','OH','IN','GA','FL','NC','SC','PA','DC','DE','MD','VA','WV') THEN 'NA-EAST'\r\n            WHEN country IS NOT null AND country IN ('AG','AI','AN','AW','BB','BM','BS','DM','GD','GP','HT','JM','KN','LC','MQ','MS','TC','TT','VC','VG','VI') THEN 'NA-EAST'\r\n            WHEN country IS NOT null AND country IN ('US','CA') AND state IS null  THEN 'NA-NO-STATEPROV'\r\n            WHEN country IS NOT null AND state IS NOT null THEN 'ROW'\r\n            ELSE 'Unknown'\r\n        END AS global_region,\r\n        COALESCE(account_c,lean_data_a_2_b_account_c) AS person_account_id\r\n    FROM base\r\n    LEFT JOIN {{ref('user_source_xf')}} creator ON\r\n    base.created_by_id=creator.user_id\r\n    WHERE base.owner_id != '00Ga0000003Nugr' -- AO-Fake Leads\r\n\r\n)\r\n\r\nSELECT \r\nfinal.*,\r\nCASE\r\n    WHEN global_region IN ('EUROPE','ROW','AUNZ') THEN 'EMEA'\r\n    WHEN company_size_rev IN ('SMB') OR company_size_rev IS null THEN 'Velocity'\r\n    WHEN company_size_rev IN ('Mid-Market','Enterprise') THEN 'Upmarket'\r\n    ELSE null\r\nEND AS segment\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.lead", "model.acton_marketing_data.user_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "lead_source_xf"], "unique_id": "model.acton_marketing_data.lead_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/lead_source_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/lead_source_xf.sql", "name": "lead_source_xf", "alias": "lead_source_xf", "checksum": {"name": "sha256", "checksum": "c06441326756d0487ebd73e861a20186bdcf7377a635a9994248e0a110a1d4a2"}, "tags": [], "refs": [["user_source_xf"]], "sources": [["salesforce", "lead"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.369334}, "model.acton_marketing_data.contract_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\nSELECT *\r\nFROM {{ source('salesforce', 'contract') }}\r\n\r\n), final AS (\r\nSELECT\r\nid AS contract_id,\r\naccount_id,\r\nowner_id,\r\nstatus,\r\nis_deleted,\r\nDATE_TRUNC('day',created_date)::Date AS created_date,\r\nDATE_TRUNC('day',created_date)::Date AS end_date,\r\ncreated_by_id,\r\nDATE_TRUNC('day',last_modified_date)::Date AS last_modified_date,\r\nsystem_modstamp AS systemmodstamp,\r\ncontract_status_c AS contract_status,\r\nrelated_opportunity_c AS contract_opportunity_id,\r\nDATE_TRUNC('day',churn_date_c)::Date AS churn_date,\r\ncs_churn_c AS cs_churn,\r\narr_c AS arr,\r\ncontract_acv_c AS contract_acv,\r\nsubscription_term_c AS subscription_term,\r\ncs_churn_recognized_mrr_c AS cs_churn_recognized_mrr,\r\nsales_churn_c AS sales_churn,\r\ncurrent_quarter_debook_value_c AS current_quarter_debook_value,\r\nCASE\r\n    WHEN contract_status_c = 'Cancelled' AND cs_churn_c != false THEN cs_churn_recognized_mrr_c*-12\r\n    WHEN contract_status_c = 'Cancelled' AND sales_churn_c != false THEN current_quarter_debook_value_c\r\n    ELSE 0\r\nEND AS arr_loss_amount\r\nFROM base\r\n\r\n)\r\n\r\nSELECT\r\n*\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.contract"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "contract_source_xf"], "unique_id": "model.acton_marketing_data.contract_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/contract_source_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/contract_source_xf.sql", "name": "contract_source_xf", "alias": "contract_source_xf", "checksum": {"name": "sha256", "checksum": "cc568a75faf4d10c06b609bcd1e8c6903699379ab3107fc3e9517ea0846a8626"}, "tags": [], "refs": [], "sources": [["salesforce", "contract"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3717809}, "model.acton_marketing_data.opportunity_history_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'opportunity_field_history') }}\r\n\r\n)\r\n\r\nSELECT\r\nid AS opportunity_history_id, \r\nopportunity_id,\r\ncreated_date AS field_modified_at,\r\nfield,\r\nold_value,\r\nnew_value\r\nFROM base\r\nWHERE is_deleted = false", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.opportunity_field_history"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "opportunity_history_xf"], "unique_id": "model.acton_marketing_data.opportunity_history_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/opportunity_history_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/opportunity_history_xf.sql", "name": "opportunity_history_xf", "alias": "opportunity_history_xf", "checksum": {"name": "sha256", "checksum": "3249ecca9fa543779e5683c79d3357c7a3ab3d2852d313202ed6fd1c404bfdfa"}, "tags": [], "refs": [], "sources": [["salesforce", "opportunity_field_history"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3738945}, "model.acton_marketing_data.ao_instance_user_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'act_on_instance_user_c') }}\r\n\r\n), final AS (\r\n    SELECT\r\n        base.id AS ao_user_id,\r\n        base.is_deleted,\r\n        base.name AS ao_user_name,\r\n        base.created_date AS ao_user_created_date,\r\n        base.last_modified_date,\r\n        base.system_modstamp AS systemmodstamp,\r\n        base.act_on_instance_c AS ao_user_instance,\r\n        base.email_c AS ao_user_email, \r\n        base.first_name_c AS ao_user_first_name, \r\n        base.last_name_c AS ao_user_last_name, \r\n        base.is_admin_user_c AS is_admin_user,\r\n        base.is_marketing_user_c AS is_marketing_user,\r\n        base.is_sales_user_c AS is_sales_user,\r\n        base.date_user_created_c AS ao_user_date_created,\r\n        base.ao_user_account_id_c AS ao_user_account_id, \r\n        base.contact_c AS ao_user_contact_id,\r\n        base.deleted_c AS deleted,\r\n        base.deleted_date_c AS deleted_date,\r\n        ao_instance_source_xf.ao_instance_name AS ao_user_account_name\r\n    FROM base\r\n    LEFT JOIN {{ref('ao_instance_source_xf')}} ON\r\n    base.act_on_instance_c=ao_instance_source_xf.ao_instance_id\r\n    \r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.act_on_instance_user_c", "model.acton_marketing_data.ao_instance_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "ao_instance_user_source_xf"], "unique_id": "model.acton_marketing_data.ao_instance_user_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/ao_instance_user_source_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/ao_instance_user_source_xf.sql", "name": "ao_instance_user_source_xf", "alias": "ao_instance_user_source_xf", "checksum": {"name": "sha256", "checksum": "7bdffb2b18153cc157e05cc438e044b02c2e69ec3ccf8f4e1471860abb4096aa"}, "tags": [], "refs": [["ao_instance_source_xf"]], "sources": [["salesforce", "act_on_instance_user_c"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.375877}, "model.acton_marketing_data.opportunity_line_item_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\nSELECT *\r\nFROM {{ source('salesforce', 'opportunity_line_item') }}\r\n\r\n), final AS (\r\n    SELECT \r\n        id AS line_item_id,\r\n        opportunity_id,\r\n        product_2_id AS product_id,\r\n        name AS line_item_name,\r\n        currency_iso_code,\r\n        discount,\r\n        total_price,\r\n        list_price,\r\n        DATE_TRUNC('day',created_date)::Date AS line_item_created_date,\r\n        DATE_TRUNC('day',last_modified_date)::Date AS last_modified_date,\r\n        system_modstamp AS systemmodstamp,\r\n        is_deleted,\r\n        sbqq_subscription_type_c AS sbqq_subscription_type,\r\n        line_item_mrr_c AS line_item_mrr,\r\n        product_code_c AS product_code,\r\n        annual_price_c AS annual_price,\r\n        discounted_annual_price_c AS discounted_annual_price,\r\n        monthly_gross_c AS monthly_gross,\r\n        monthly_net_c AS monthly_net,\r\n        subscription_type_c AS subscription_type,\r\n        total_discount_c AS total_discount,\r\n        prorate_multiplier_mirror_c AS prorate_multiplier_mirror,\r\n        sbqq_parent_id_c AS sbqq_parent_id,\r\n        opp_product_family_text_c AS product_family\r\n    FROM base\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.opportunity_line_item"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "opportunity_line_item_xf"], "unique_id": "model.acton_marketing_data.opportunity_line_item_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/opportunity_line_item_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/opportunity_line_item_xf.sql", "name": "opportunity_line_item_xf", "alias": "opportunity_line_item_xf", "checksum": {"name": "sha256", "checksum": "a158abf96a1a58e05246ee69f7dfbb96636e68fc45673f98460809b6310dd56d"}, "tags": [], "refs": [], "sources": [["salesforce", "opportunity_line_item"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3780239}, "model.acton_marketing_data.quote_line": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM \"acton\".salesforce.\"sbqq_quote_line_c\"\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        base.id AS quote_id,\r\n        base.is_deleted,\r\n        base.name AS quote_name,\r\n        base.currency_iso_code,\r\n        DATE_TRUNC('day',base.created_date)::Date AS quote_created_date,\r\n        DATE_TRUNC('day',base.last_modified_date)::Date AS quote_last_modified_date,\r\n        base.system_modstamp AS systemmodstamp,\r\n        base.sbqq_quote_c AS sbqq_quote,\r\n        base.sbqq_product_option_c AS sbqq_product_option,\r\n        base.sbqq_product_c AS sbqq_product,\r\n        base.sbqq_prorate_multiplier_c AS sbqq_prorate_multiplier,\r\n        base.sbqq_prorated_list_price_c AS sbqq_prorated_list_price,\r\n        base.sbqq_prorated_price_c AS sbqq_prorated_price,\r\n        base.customer_discount_c AS customer_discount,\r\n        base.sbqq_product_subscription_type_c AS sbqq_product_subscription_type,\r\n        base.sbqq_subscription_term_c AS sbqq_product_subscription_term,\r\n        sbqq_quote_c.sbqq_opportunity_2_c AS opportunity_id,\r\n        product_xf.sbqq_subscription_type,\r\n        product_xf.product_code,\r\n        sbqq_quote_c.sbqq_primary_c AS sbqq_primary_quote\r\n    FROM base\r\n    LEFT JOIN \"acton\".salesforce.\"sbqq_quote_c\" ON\r\n    base.id=sbqq_quote_c.id\r\n    LEFT JOIN {{ref('product_xf')}} ON\r\n    base.sbqq_product_c=product_xf.product_id\r\n\r\n)   \r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.product_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "quote_line"], "unique_id": "model.acton_marketing_data.quote_line", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/quote_line.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/quote_line.sql", "name": "quote_line", "alias": "quote_line", "checksum": {"name": "sha256", "checksum": "1bee9c9dcd2e180cf28813e4575f0ded11ddcaba9c416f16c9a45f5ae7bb7682"}, "tags": [], "refs": [["product_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3800938}, "model.acton_marketing_data.campaign_influence_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'campaign_influence') }}\r\n\r\n), final AS (\r\n\r\n    SELECT  \r\n        id AS influence_id,\r\n        created_date AS influence_created_date,\r\n        opportunity_id AS influence_opportunity_id,\r\n        campaign_id AS influence_campaign_id,\r\n        contact_id AS influence_contact_id,\r\n        influence AS influence_amount,\r\n        revenue_share\r\n    FROM base\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.campaign_influence"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "campaign_influence_xf"], "unique_id": "model.acton_marketing_data.campaign_influence_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/campaign_influence_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/campaign_influence_xf.sql", "name": "campaign_influence_xf", "alias": "campaign_influence_xf", "checksum": {"name": "sha256", "checksum": "3f0fecb0ebea3ca82c360c3d233a40a0f6b45c6bd9ffd69df0ca328562f421c5"}, "tags": [], "refs": [], "sources": [["salesforce", "campaign_influence"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.382369}, "model.acton_marketing_data.campaign_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'campaign') }}\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n    --Campaign Info\r\n        base.id AS campaign_id,\r\n        base.name AS campaign_name, \r\n        base.type AS campaign_type,\r\n        base.status AS campaign_status,\r\n        DATE_TRUNC('day',base.start_date)::Date AS campaign_start_date,\r\n        DATE_TRUNC('day',base.end_date)::Date AS campaign_end_date,\r\n        base.expected_revenue,\r\n        base.budgeted_cost,\r\n        base.actual_cost,\r\n        base.expected_response,\r\n        base.owner_id AS campaign_owner_id,\r\n        base.is_active AS is_active_campaign,\r\n        base.is_deleted AS is_deleted_campaign,\r\n\r\n    --Parent Campaign Info\r\n        base.parent_id AS parent_campaign_id,\r\n        parent.name AS parent_campaign_name,\r\n        parent.type AS parent_campaign_type,\r\n        parent.status AS parent_campaign_status,\r\n        DATE_TRUNC('day',parent.start_date)::Date AS parent_campaign_start_date,\r\n        DATE_TRUNC('day',parent.end_date)::Date AS parent_campaign_end_date,\r\n        parent.expected_revenue AS parent_expected_revenue,\r\n        parent.budgeted_cost AS parent_budgeted_cost,\r\n        parent.actual_cost AS parent_actual_cost,\r\n        parent.expected_response AS parent_expected_reponse,\r\n        parent.owner_id AS parent_campaign_owner_id,\r\n        parent.is_active AS is_active_parent_campaign\r\n    FROM base\r\n    LEFT JOIN base parent ON \r\n    base.parent_id=parent.id\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.campaign"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "campaign_source_xf"], "unique_id": "model.acton_marketing_data.campaign_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/campaign_source_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/campaign_source_xf.sql", "name": "campaign_source_xf", "alias": "campaign_source_xf", "checksum": {"name": "sha256", "checksum": "a66f35e75badfaa92ed2f9c50fbce4b2f848a325d60e4d2a15158124c7a513e3"}, "tags": [], "refs": [], "sources": [["salesforce", "campaign"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3844397}, "model.acton_marketing_data.contact_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'contact') }}\r\n\r\n), final AS (\r\n\r\n    SELECT \r\n        base.id AS contact_id,\r\n        base.is_deleted,\r\n        base.created_by_id,\r\n        creator.user_name AS created_by_name,\r\n        base.account_id,\r\n        account_source_xf.account_name,\r\n        base.first_name,\r\n        base.mailing_postal_code,\r\n        base.mailing_country,\r\n        base.email,\r\n        base.title,\r\n        base.lead_source,\r\n        DATE_TRUNC('day',base.created_date)::Date AS created_date,\r\n        base.last_modified_date,\r\n        base.system_modstamp AS systemmodstamp,\r\n        base.current_customer_reference_c AS is_current_customer,\r\n        base.no_longer_with_company_c AS is_no_longer_with_company,\r\n        base.hand_raiser_c AS is_hand_raiser,\r\n        base.mql_created_date_c AS mql_created_date,\r\n        base.mql_most_recent_date_c AS mql_most_recent_date,\r\n        base.contact_role_c AS contact_role,\r\n        base.primary_contact_c AS is_primary_contact,\r\n        base.ft_offer_asset_type_c AS offer_asset_type_first_touch,\r\n        base.ft_offer_asset_subtype_c AS offer_asset_subtype_first_touch,\r\n        base.contact_status_c AS contact_status,\r\n        base.ft_utm_channel_c AS channel_first_touch,\r\n        base.lt_utm_channel_c AS channel_last_touch,\r\n        base.lt_utm_medium_c AS medium_last_touch,\r\n        base.lt_utm_source_c AS source_last_touch,\r\n        base.lt_utm_campaign_c AS campaign_last_touch,\r\n        base.channel_lead_creation_c AS channel_lead_creation,\r\n        base.content_lead_creation_c AS content_lead_creation,\r\n        base.campaign_lead_creation_c AS campaign_lead_creation,\r\n        base.ft_offer_asset_topic_c AS offer_asset_topic_first_touch,\r\n        base.ft_offer_asset_name_c AS offer_asset_name_first_touch,\r\n        base.lc_offer_asset_type_c AS offer_asset_type_lead_creation,\r\n        base.lc_offer_asset_subtype_c AS offer_asset_subtype_lead_creation,\r\n        base.lc_offer_asset_topic_c AS offer_asset_topic_lead_creation,\r\n        base.lc_offer_asset_name_c AS offer_asset_name_lead_creation,\r\n        base.lt_offer_asset_type_c AS offer_asset_type_last_touch,\r\n        base.lt_offer_asset_subtype_c AS offer_asset_subtype_last_touch,\r\n        base.lt_offer_asset_name_c AS offer_asset_name_last_touch,\r\n        base.lt_offer_asset_topic_c AS offer_asset_topic_last_touch,\r\n        base.renewal_contact_c AS is_renewal_contact, --verify data type\r\n        base.account_owner_email_c AS account_owner_email,\r\n        base.account_csm_email_c AS account_csm_email,\r\n        base.ft_subchannel_c AS subchannel_first_touch,\r\n        base.lt_subchannel_c AS subchannel_last_touch,\r\n        base.lc_subchannel_c AS subchannel_lead_creation,\r\n        base.x_9883_lead_score_c AS lead_score,\r\n        base.status_reason_c AS status_reason,\r\n        DATE_TRUNC('day',marketing_lead_creation_date_c)::Date AS marketing_created_date,\r\n        base.current_map_c AS current_ma,\r\n        base.account_lookup_c AS account_lookup,\r\n        base.ft_utm_campaign_c AS campaign_first_touch,\r\n        base.ft_utm_medium_c AS medium_first_touch,\r\n        base.ft_utm_source_c AS source_first_touch,\r\n        base.lead_id_converted_from_c AS lead_id_converted_from,\r\n        base.was_a_handraiser_lead_c AS was_a_handraiser_lead,\r\n        base.medium_lead_creation_c AS medium_lead_creation,\r\n        base.source_lead_creation_c AS source_lead_creation,\r\n        base.owner_id AS contact_owner_id,\r\n        base.firmographic_demographic_lead_score_c AS firmographic_demographic_lead_score,\r\n        base.last_name, \r\n        base.data_enrich_company_name_c AS de_account_name,\r\n        DATE_TRUNC('day',date_time_to_working_c)::Date AS working_date,\r\n        account_source_xf.account_owner_id,\r\n        account_source_xf.account_owner_name,\r\n        account_source_xf.annual_revenue,\r\n        account_source_xf.de_current_crm,\r\n        account_source_xf.de_current_ma,\r\n        account_source_xf.account_csm_name AS account_csm_name,\r\n        account_source_xf.csm_id AS account_csm_id,\r\n        account_source_xf.sdr_phone AS account_sdr_phone,\r\n        account_source_xf.sdr_photo AS account_sdr_photo,\r\n        account_source_xf.sdr_calendly AS account_sdr_calendly,\r\n        account_source_xf.sdr_title AS account_sdr_title,\r\n        account_source_xf.sdr_full_name AS account_sdr_full_name,\r\n        account_source_xf.sdr_email AS account_sdr_email,\r\n        account_source_xf.account_deliverability_consultant_email,\r\n        account_source_xf.account_deliverability_consultant,\r\n        user_source_xf.user_email AS owner_email,\r\n        CASE\r\n            WHEN account_source_xf.annual_revenue <= 49999999 THEN 'SMB'\r\n            WHEN account_source_xf.annual_revenue > 49999999 AND account_source_xf.annual_revenue <= 499999999 THEN 'Mid-Market'\r\n            WHEN account_source_xf.annual_revenue > 499999999 THEN 'Enterprise'\r\n        END AS company_size_rev,\r\n        account_source_xf.global_region,\r\n        account_source_xf.segment,\r\n        account_source_xf.de_industry AS industry,\r\n        CASE\r\n            WHEN account_source_xf.de_industry IN ('Business Services') THEN 'Business Services'\r\n            WHEN account_source_xf.de_industry IN ('Finance','Insurance') THEN 'Finance'\r\n            WHEN account_source_xf.de_industry IN ('Manufacturing') THEN 'Manufacturing'\r\n            WHEN account_source_xf.de_industry IN ('Software','Telecommunications') THEN 'SoftCom'\r\n            ELSE 'Other'\r\n        END AS industry_bucket,\r\n        CASE \r\n            WHEN LOWER(channel_lead_creation_c) = 'organic' THEN 'Organic'\r\n            WHEN LOWER(channel_lead_creation_c) IS null THEN 'Unknown'\r\n            WHEN LOWER(channel_lead_creation_c) = 'social' AND LOWER(medium_lead_creation_c) = 'social-organic' THEN 'Social - Organic'\r\n            WHEN LOWER(channel_lead_creation_c) = 'social' AND LOWER(medium_lead_creation_c) = 'social-paid' THEN 'Paid Social'\r\n            WHEN LOWER(channel_lead_creation_c) = 'ppc' THEN 'PPC/Paid Search'\r\n            WHEN LOWER(channel_lead_creation_c) = 'email' AND LOWER(source_lead_creation_c) like '%act-on%' THEN 'Paid Email' \r\n            WHEN LOWER(channel_lead_creation_c) = 'ppl' AND LOWER(medium_lead_creation_c) = 'syndication partner' THEN 'PPL'\r\n            WHEN LOWER(channel_lead_creation_c) IN ('prospecting','ppl') AND LOWER(medium_lead_creation_c) = 'intent partner' THEN 'Intent Partners'\r\n            WHEN LOWER(channel_lead_creation_c) = 'event' THEN 'Events and Trade Shows'\r\n            WHEN LOWER(channel_lead_creation_c) = 'partner' THEN 'Partners'\r\n            ELSE 'Other'\r\n        END AS channel_bucket\r\n    FROM base\r\n    LEFT JOIN {{ref('account_source_xf')}} ON\r\n    base.account_id=account_source_xf.account_id\r\n    LEFT JOIN {{ref('user_source_xf')}} ON\r\n    base.owner_id=user_source_xf.user_id\r\n    LEFT JOIN {{ref('user_source_xf')}} creator ON\r\n    base.created_by_id=creator.user_id\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.contact", "model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "contact_source_xf"], "unique_id": "model.acton_marketing_data.contact_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/contact_source_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/contact_source_xf.sql", "name": "contact_source_xf", "alias": "contact_source_xf", "checksum": {"name": "sha256", "checksum": "8699c28a3575ac1ec1d35de937c03b868ccd60760ee63782874bd6423998ffdf"}, "tags": [], "refs": [["account_source_xf"], ["user_source_xf"], ["user_source_xf"]], "sources": [["salesforce", "contact"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3864958}, "model.acton_marketing_data.ao_instance_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\nWITH base AS (\r\nSELECT *\r\nFROM {{ source('salesforce', 'act_on_instance_c') }}\r\n\r\n), final AS (\r\n    \r\n    SELECT\r\n        id AS ao_instance_id,\r\n        is_deleted,\r\n        name AS ao_instance_name,\r\n        created_date AS ao_instance_created_date,\r\n        last_modified_date,\r\n        system_modstamp AS systemmodstamp,\r\n        ao_account_name_c AS ao_account_name,\r\n        cdb_ao_instance_id_c AS cdb_ao_instance_id,\r\n        account_c AS ao_instance_account,\r\n        parent_account_c AS ao_instance_parent_account,\r\n        ao_parent_id_c AS ao_instance_parent_account_id \r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.salesforce.act_on_instance_c"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "sfdc", "sfdc_xf", "ao_instance_source_xf"], "unique_id": "model.acton_marketing_data.ao_instance_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/sfdc/sfdc_xf/ao_instance_source_xf.sql", "original_file_path": "models/sources/sfdc/sfdc_xf/ao_instance_source_xf.sql", "name": "ao_instance_source_xf", "alias": "ao_instance_source_xf", "checksum": {"name": "sha256", "checksum": "bf79ac86baa6a48631e185e7996e8ecbf72fecbff13e48639990dd7a73e58151"}, "tags": [], "refs": [], "sources": [["salesforce", "act_on_instance_c"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3888881}, "model.acton_marketing_data.ao_emails": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ source('data_studio_s3', 'data_studio_emails') }}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.data_studio_s3.data_studio_emails"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "ao_data", "ao_data_raw", "ao_emails"], "unique_id": "model.acton_marketing_data.ao_emails", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/ao_data/ao_data_raw/ao_emails.sql", "original_file_path": "models/sources/ao_data/ao_data_raw/ao_emails.sql", "name": "ao_emails", "alias": "ao_emails", "checksum": {"name": "sha256", "checksum": "1aa64fbcd42b3d5be5ded05a65ac68d480e41eae7cb16b9ff37d829909d23f4f"}, "tags": [], "refs": [], "sources": [["data_studio_s3", "data_studio_emails"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.392087}, "model.acton_marketing_data.ao_webinars": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ source('data_studio_s3', 'data_studio_webinars') }}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.data_studio_s3.data_studio_webinars"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "ao_data", "ao_data_raw", "ao_webinars"], "unique_id": "model.acton_marketing_data.ao_webinars", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/ao_data/ao_data_raw/ao_webinars.sql", "original_file_path": "models/sources/ao_data/ao_data_raw/ao_webinars.sql", "name": "ao_webinars", "alias": "ao_webinars", "checksum": {"name": "sha256", "checksum": "67a22115d76f5e03d9bd836970c62ba6e325bc57a8e1f3a2e5113e56f56d8119"}, "tags": [], "refs": [], "sources": [["data_studio_s3", "data_studio_webinars"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3942802}, "model.acton_marketing_data.ao_email_to_uid": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        recipient_e_mail AS email,\r\n        unique_visitor_id\r\n    FROM {{ref('ao_emails')}}\r\n    WHERE recipient_e_mail NOT LIKE 'unknown%'\r\n    AND recipient_e_mail IS NOT null\r\n    UNION ALL\r\n    SELECT\r\n        email,\r\n        unique_visitor_id\r\n    FROM {{ref('ao_forms')}}\r\n    WHERE email NOT LIKE 'unknown%'\r\n    AND email IS NOT null\r\n    UNION ALL\r\n    SELECT\r\n        e_mail_address AS email,\r\n        unique_visitor_id\r\n    FROM {{ref('ao_landingpages')}}\r\n    WHERE e_mail_address NOT LIKE 'unknown%'\r\n    AND e_mail_address IS NOT null\r\n    UNION ALL\r\n    SELECT\r\n        e_mail_address AS email,\r\n        unique_visitor_id\r\n    FROM {{ref('ao_media')}}\r\n    WHERE e_mail_address NOT LIKE 'unknown%'\r\n    AND e_mail_address IS NOT null\r\n    UNION ALL\r\n    SELECT\r\n        contact_e_mail AS email,\r\n        unique_visitor_id\r\n    FROM {{ref('ao_webinars')}}\r\n    WHERE contact_e_mail NOT LIKE 'unknown%'\r\n    AND contact_e_mail IS NOT null\r\n    UNION ALL\r\n    SELECT\r\n        contact_e_mail AS email,\r\n        unique_visitor_id\r\n    FROM {{ref('ao_webpages')}}\r\n    WHERE contact_e_mail NOT LIKE 'unknown%'\r\n    AND contact_e_mail IS NOT null\r\n\r\n)\r\n\r\n    SELECT DISTINCT\r\n        email,\r\n        unique_visitor_id\r\n    FROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.ao_emails", "model.acton_marketing_data.ao_forms", "model.acton_marketing_data.ao_landingpages", "model.acton_marketing_data.ao_media", "model.acton_marketing_data.ao_webinars", "model.acton_marketing_data.ao_webpages"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "ao_data", "ao_data_raw", "ao_email_to_uid"], "unique_id": "model.acton_marketing_data.ao_email_to_uid", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/ao_data/ao_data_raw/ao_email_to_uid.sql", "original_file_path": "models/sources/ao_data/ao_data_raw/ao_email_to_uid.sql", "name": "ao_email_to_uid", "alias": "ao_email_to_uid", "checksum": {"name": "sha256", "checksum": "6d17fc6ae4267f6c2af958883e39bc11a5b4a8074cd2a164e61264563b7e5ad4"}, "tags": [], "refs": [["ao_emails"], ["ao_forms"], ["ao_landingpages"], ["ao_media"], ["ao_webinars"], ["ao_webpages"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3962533}, "model.acton_marketing_data.ao_forms": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ source('data_studio_s3', 'data_studio_forms') }}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.data_studio_s3.data_studio_forms"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "ao_data", "ao_data_raw", "ao_forms"], "unique_id": "model.acton_marketing_data.ao_forms", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/ao_data/ao_data_raw/ao_forms.sql", "original_file_path": "models/sources/ao_data/ao_data_raw/ao_forms.sql", "name": "ao_forms", "alias": "ao_forms", "checksum": {"name": "sha256", "checksum": "60d39903aab08487434041e29b34d4b0d15c04c74d7ce53c418fa351888c0d81"}, "tags": [], "refs": [], "sources": [["data_studio_s3", "data_studio_forms"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.3988008}, "model.acton_marketing_data.ao_landingpages": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ source('data_studio_s3', 'data_studio_landingpages') }}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.data_studio_s3.data_studio_landingpages"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "ao_data", "ao_data_raw", "ao_landingpages"], "unique_id": "model.acton_marketing_data.ao_landingpages", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/ao_data/ao_data_raw/ao_landingpages.sql", "original_file_path": "models/sources/ao_data/ao_data_raw/ao_landingpages.sql", "name": "ao_landingpages", "alias": "ao_landingpages", "checksum": {"name": "sha256", "checksum": "66ab65a32f8a23861c3eff27050240c9ec2a19c8c57333904cbd24e8bc2a0589"}, "tags": [], "refs": [], "sources": [["data_studio_s3", "data_studio_landingpages"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.400887}, "model.acton_marketing_data.ao_media": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ source('data_studio_s3', 'data_studio_media') }}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.data_studio_s3.data_studio_media"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "ao_data", "ao_data_raw", "ao_media"], "unique_id": "model.acton_marketing_data.ao_media", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/ao_data/ao_data_raw/ao_media.sql", "original_file_path": "models/sources/ao_data/ao_data_raw/ao_media.sql", "name": "ao_media", "alias": "ao_media", "checksum": {"name": "sha256", "checksum": "948ef3f89231c22bc9455707bcc254f89f9e50ec8d86a3947213799d6d5c58d3"}, "tags": [], "refs": [], "sources": [["data_studio_s3", "data_studio_media"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4031603}, "model.acton_marketing_data.ao_webpages": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ source('data_studio_s3', 'data_studio_webpages') }}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.acton_marketing_data.data_studio_s3.data_studio_webpages"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "ao_data", "ao_data_raw", "ao_webpages"], "unique_id": "model.acton_marketing_data.ao_webpages", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/ao_data/ao_data_raw/ao_webpages.sql", "original_file_path": "models/sources/ao_data/ao_data_raw/ao_webpages.sql", "name": "ao_webpages", "alias": "ao_webpages", "checksum": {"name": "sha256", "checksum": "09cce3689c824baf7cdffb5c122f4c679f6dc58ee5cc5974e5925d30d64012f7"}, "tags": [], "refs": [], "sources": [["data_studio_s3", "data_studio_webpages"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4053516}, "model.acton_marketing_data.ao_webpages_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT \r\n-- IDs\r\n    contact_e_mail AS email,\r\n    unique_visitor_id,\r\n\r\n-- Webpage Attributes\r\n    page_url,\r\n    referral_url,\r\n    visitor_type,\r\n    url_path_info AS url_path,\r\n    SPLIT_PART(SPLIT_PART(page_url,'utm_campaign=',2),'&',1) AS campaign,\r\n    SPLIT_PART(SPLIT_PART(page_url,'utm_channel=',2),'&',1) AS channel,\r\n    SPLIT_PART(SPLIT_PART(page_url,'utm_source=',2),'&',1) AS source,\r\n    SPLIT_PART(SPLIT_PART(page_url,'utm_medium=',2),'&',1) AS medium,\r\n    SPLIT_PART(SPLIT_PART(page_url,'utm_content=',2),'&',1) AS content,\r\n    \r\n-- Action Data\r\n    action,\r\n    action_time,\r\n    action_day,\r\n\r\n-- Other Data\r\n    attribution_id,\r\n    cookie_id,\r\n    ip_address,\r\n    e_mail_domain AS email_domain\r\nFROM {{ref('ao_webpages')}}\r\nWHERE contact_e_mail IS NOT null", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.ao_webpages"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "ao_data", "ao_data_xf", "ao_webpages_xf"], "unique_id": "model.acton_marketing_data.ao_webpages_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/ao_data/ao_data_xf/ao_webpages_xf.sql", "original_file_path": "models/sources/ao_data/ao_data_xf/ao_webpages_xf.sql", "name": "ao_webpages_xf", "alias": "ao_webpages_xf", "checksum": {"name": "sha256", "checksum": "4c1debfaedc3ecf8a43df5a0d3da118fef5ddfadbcb39fc7d4b09458813387b4"}, "tags": [], "refs": [["ao_webpages"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4073472}, "model.acton_marketing_data.ao_media_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT \r\n-- IDs\r\n    document_id AS media_id,\r\n    e_mail_address AS email,\r\n    record_id,\r\n    unique_visitor_id,\r\n\r\n-- Media Attributes\r\n    document_name AS media_name,\r\n    \r\n-- Action Data\r\n    action,\r\n    action_time,\r\n    action_day,\r\n\r\n-- Other Data\r\n    cookie_id,\r\n    ip_address,\r\n    e_mail_domain AS email_domain\r\nFROM {{ref('ao_media')}}\r\nWHERE e_mail_address IS NOT null\r\nAND e_mail_address NOT LIKE 'unknown%'", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.ao_media"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "ao_data", "ao_data_xf", "ao_media_xf"], "unique_id": "model.acton_marketing_data.ao_media_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/ao_data/ao_data_xf/ao_media_xf.sql", "original_file_path": "models/sources/ao_data/ao_data_xf/ao_media_xf.sql", "name": "ao_media_xf", "alias": "ao_media_xf", "checksum": {"name": "sha256", "checksum": "459b638fb970156977433d5a1812c0bf5b40b47ef6fabe4fceba898289ccebfe"}, "tags": [], "refs": [["ao_media"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4093463}, "model.acton_marketing_data.ao_combined": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH emails AS (\r\n\r\n    SELECT\r\n    -- IDs\r\n        {{ dbt_utils.surrogate_key(['action_time', 'message_id','email'])}} AS touchpoint_id,\r\n        message_id,\r\n        email,\r\n        record_id,\r\n        unique_visitor_id,\r\n\r\n    --Message Attributes\r\n        message_title,\r\n        subject_line,\r\n        from_address,\r\n\r\n    --Action Attributes\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n    \r\n    --Attribution Attributes\r\n        campaign,\r\n        channel,\r\n        content,\r\n        medium,\r\n        source\r\n    FROM {{ref('ao_emails_xf')}}\r\n\r\n), forms AS (\r\n\r\n    SELECT\r\n    -- IDs\r\n        {{ dbt_utils.surrogate_key(['action_time', 'form_id','email'])}} AS touchpoint_id,\r\n        form_id,\r\n        email,\r\n        unique_visitor_id,\r\n        record_id,\r\n\r\n    --Form Attributes\r\n        form_title,\r\n\r\n    --Action Attributes\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        referral_url,\r\n\r\n    --Attribution Attributes\r\n        -- campaign,\r\n        -- channel,\r\n        -- content,\r\n        -- medium,\r\n        -- source\r\n\r\n    --Other Data\r\n        ip_address,\r\n        cookie_id\r\n    FROM {{ref('ao_forms_xf')}}\r\n\r\n), lps AS (\r\n\r\n    SELECT \r\n    -- IDs\r\n        {{ dbt_utils.surrogate_key(['action_time', 'landing_page_id','email'])}} AS touchpoint_id,\r\n        landing_page_id,\r\n        email,\r\n        record_id,\r\n        unique_visitor_id,\r\n\r\n    -- LP Attributes\r\n        landing_page_title,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n\r\n        --Attribution Attributes\r\n        campaign,\r\n        channel,\r\n        content,\r\n        medium,\r\n        source,\r\n\r\n    -- Action Data\r\n        action,\r\n        action_time,\r\n        action_day,\r\n\r\n    -- Other Data\r\n        cookie_id,\r\n        ip_address,\r\n        email_domain\r\n    FROM {{ref('ao_landingpages_xf')}}\r\n\r\n), media AS (\r\n\r\n    SELECT \r\n    -- IDs\r\n        {{ dbt_utils.surrogate_key(['action_time', 'media_id','email'])}} AS touchpoint_id,\r\n        media_id,\r\n        email,\r\n        record_id,\r\n        unique_visitor_id,\r\n\r\n    -- Media Attributes\r\n        media_name,\r\n        \r\n    -- Action Data\r\n        action,\r\n        action_time,\r\n        action_day,\r\n\r\n    -- Other Data\r\n        cookie_id,\r\n        ip_address,\r\n        email_domain\r\n    FROM {{ref('ao_media_xf')}}\r\n\r\n), tasks AS (\r\n\r\n    SELECT\r\n    --IDs\r\n        {{ dbt_utils.surrogate_key(['activity_date', 'task_id','email'])}} AS touchpoint_id,\r\n        task_id,\r\n        person_id,\r\n        owner_id,\r\n        account_id,\r\n        email,\r\n\r\n    --Task Data\r\n        task_subject,\r\n        activity_date,\r\n        task_status,\r\n        task_type,\r\n        is_closed,\r\n        task_created_date,\r\n        close_date\r\n    FROM {{ref('task_source_xf')}}\r\n\r\n), webinars AS (\r\n\r\n    SELECT \r\n    -- IDs\r\n        {{ dbt_utils.surrogate_key(['action_time', 'webinar_id','email'])}} AS touchpoint_id,\r\n        webinar_id,\r\n        email,\r\n        record_id,\r\n        unique_visitor_id,\r\n\r\n    -- Webinar Attributes\r\n        webinar_title,\r\n        event_id,\r\n\r\n    -- Action Data\r\n        action,\r\n        action_time,\r\n        action_day,\r\n\r\n    -- Other Data\r\n        email_domain\r\n    FROM {{ref('ao_webinars_xf')}}\r\n\r\n), webpages AS (\r\n\r\n    SELECT \r\n    -- IDs\r\n        {{ dbt_utils.surrogate_key(['action_time', 'page_url','email'])}} AS touchpoint_id,\r\n        email,\r\n        unique_visitor_id,\r\n\r\n    -- Webpage Attributes\r\n        page_url,\r\n        referral_url,\r\n        visitor_type,\r\n        url_path,\r\n\r\n    --Attribution Attributes\r\n        campaign,\r\n        channel,\r\n        content,\r\n        medium,\r\n        source,\r\n        \r\n    -- Action Data\r\n        action,\r\n        action_time,\r\n        action_day,\r\n\r\n    -- Other Data\r\n        attribution_id,\r\n        cookie_id,\r\n        ip_address,\r\n        email_domain\r\n    FROM {{ref('ao_webpages_xf')}}\r\n\r\n), combined_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        message_id AS asset_id,\r\n        email,\r\n        message_title AS asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        campaign,\r\n        channel,\r\n        content,\r\n        medium,\r\n        source,\r\n        clickthrough_link_name,\r\n        null AS referral_url,\r\n        null AS event_id,\r\n        'email' AS asset_type\r\n    FROM emails\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        form_id AS asset_id,\r\n        email,\r\n        form_title AS asset_title,\r\n        null AS subject_line,\r\n        null AS from_address,\r\n        null AS clicked_url,\r\n        null AS campaign,\r\n        null AS channel,\r\n        null AS content,\r\n        null AS medium,\r\n        null AS source,\r\n        null AS clickthrough_link_name,\r\n        referral_url,\r\n        null AS event_id,\r\n        'form' AS asset_type\r\n    FROM forms\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        landing_page_id AS asset_id,\r\n        email,\r\n        landing_page_title AS asset_title,\r\n        null AS subject_line,\r\n        null AS from_address,\r\n        clicked_url,\r\n        campaign,\r\n        channel,\r\n        content,\r\n        medium,\r\n        source,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        null AS event_id,\r\n        'landing page' AS asset_type\r\n    FROM lps\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        media_id AS asset_id,\r\n        email,\r\n        media_name AS asset_title,\r\n        null AS subject_line,\r\n        null AS from_address,\r\n        null AS clicked_url,\r\n        null AS campaign,\r\n        null AS channel,\r\n        null AS content,\r\n        null AS medium,\r\n        null AS source,\r\n        null AS clickthrough_link_name,\r\n        null AS referral_url,\r\n        null AS event_id,\r\n        'media' AS asset_type\r\n    FROM media\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        task_type AS action,\r\n        activity_date::timestamp AS action_time,\r\n        activity_date AS action_day,\r\n        task_id AS asset_id,\r\n        email,\r\n        task_subject AS asset_title,\r\n        null AS subject_line,\r\n        null AS from_address,\r\n        null AS clicked_url,\r\n        null AS campaign,\r\n        null AS channel,\r\n        null AS content,\r\n        null AS medium,\r\n        null AS source,\r\n        null AS clickthrough_link_name,\r\n        null AS referral_url,\r\n        null AS event_id,\r\n        'task' AS asset_type   \r\n    FROM tasks\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        webinar_id AS asset_id,\r\n        email,\r\n        webinar_title AS asset_title,\r\n        null AS subject_line,\r\n        null AS from_address,\r\n        null AS clicked_url,\r\n        null AS campaign,\r\n        null AS channel,\r\n        null AS content,\r\n        null AS medium,\r\n        null AS source,\r\n        null AS clickthrough_link_name,\r\n        null AS referral_url,\r\n        event_id,\r\n        'webinar' AS asset_type\r\n    FROM webinars\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        null AS asset_id,\r\n        email,\r\n        page_url AS asset_title,\r\n        null AS subject_line,\r\n        null AS from_address,\r\n        null AS clicked_url,\r\n        campaign,\r\n        channel,\r\n        content,\r\n        medium,\r\n        source,\r\n        null AS clickthrough_link_name,\r\n        referral_url,\r\n        null AS event_id,\r\n        'webpage' AS asset_type\r\n    FROM webpages\r\n)\r\n\r\nSELECT *\r\nFROM combined_base", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": ["model.acton_marketing_data.ao_emails_xf", "model.acton_marketing_data.ao_forms_xf", "model.acton_marketing_data.ao_landingpages_xf", "model.acton_marketing_data.ao_media_xf", "model.acton_marketing_data.task_source_xf", "model.acton_marketing_data.ao_webinars_xf", "model.acton_marketing_data.ao_webpages_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "ao_data", "ao_data_xf", "ao_combined"], "unique_id": "model.acton_marketing_data.ao_combined", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/ao_data/ao_data_xf/ao_combined.sql", "original_file_path": "models/sources/ao_data/ao_data_xf/ao_combined.sql", "name": "ao_combined", "alias": "ao_combined", "checksum": {"name": "sha256", "checksum": "e801bd44e3a243c9c6896f4a00b1564592353c31d4ab4da3fb8288a531df0522"}, "tags": [], "refs": [["ao_emails_xf"], ["ao_forms_xf"], ["ao_landingpages_xf"], ["ao_media_xf"], ["task_source_xf"], ["ao_webinars_xf"], ["ao_webpages_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4114118}, "model.acton_marketing_data.ao_forms_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n-- IDs\r\n    form_id,\r\n    email,\r\n    unique_visitor_id,\r\n    record_id,\r\n\r\n--Form Attributes\r\n    form_title,\r\n\r\n--Action Attributes\r\n    CASE\r\n        WHEN action IN ('INSERT','UPDATE') THEN 'SUBMIT'\r\n    END AS action,\r\n    action_time,\r\n    action_day,\r\n    referral_url,\r\n\r\n--Other Data\r\n    ip_address,\r\n    cookie_id\r\nFROM {{ref('ao_forms')}}\r\nWHERE email IS NOT null\r\nAND email NOT LIKE 'unknown%'", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.ao_forms"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "ao_data", "ao_data_xf", "ao_forms_xf"], "unique_id": "model.acton_marketing_data.ao_forms_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/ao_data/ao_data_xf/ao_forms_xf.sql", "original_file_path": "models/sources/ao_data/ao_data_xf/ao_forms_xf.sql", "name": "ao_forms_xf", "alias": "ao_forms_xf", "checksum": {"name": "sha256", "checksum": "df4b89186ea6b4c58be92e2e83a7ac8b1045e3b55d37ff9e671021a1e8ebe48d"}, "tags": [], "refs": [["ao_forms"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.439237}, "model.acton_marketing_data.ao_emails_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n-- IDs\r\n    message_id,\r\n    recipient_e_mail AS email,\r\n    record_id,\r\n    unique_visitor_id,\r\n\r\n--Message Attributes\r\n    message_title,\r\n    subject AS subject_line,\r\n    \"from\" AS from_address,\r\n\r\n--Action Attributes\r\n    action,\r\n    action_time,\r\n    action_day,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_campaign=',2),'&',1) AS campaign,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_channel=',2),'&',1) AS channel,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_source=',2),'&',1) AS source,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_medium=',2),'&',1) AS medium,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_content=',2),'&',1) AS content,\r\n    clicked_url,\r\n    clickthrough_link_name\r\nFROM {{ref('ao_emails')}}\r\nWHERE action = 'CLICKED'\r\nAND recipient_e_mail IS NOT null\r\nAND recipient_e_mail NOT LIKE 'unknown%'", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.ao_emails"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "ao_data", "ao_data_xf", "ao_emails_xf"], "unique_id": "model.acton_marketing_data.ao_emails_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/ao_data/ao_data_xf/ao_emails_xf.sql", "original_file_path": "models/sources/ao_data/ao_data_xf/ao_emails_xf.sql", "name": "ao_emails_xf", "alias": "ao_emails_xf", "checksum": {"name": "sha256", "checksum": "dc3a33cbc53e8d4977d277b3f5a915e0fc1bdedae4fec533b173b9998badda18"}, "tags": [], "refs": [["ao_emails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4412925}, "model.acton_marketing_data.ao_webinars_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT \r\n-- IDs\r\n    webinar_id,\r\n    contact_e_mail AS email,\r\n    record_id,\r\n    unique_visitor_id,\r\n\r\n-- Webinar Attributes\r\n    webinar_title,\r\n    event_program_id AS event_id,\r\n\r\n-- Action Data\r\n    action,\r\n    action_time,\r\n    action_day,\r\n\r\n-- Other Data\r\n    e_mail_domain AS email_domain\r\nFROM {{ref('ao_webinars')}}\r\nWHERE contact_e_mail IS NOT null\r\nAND contact_e_mail NOT LIKE 'unknown%'", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.ao_webinars"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "ao_data", "ao_data_xf", "ao_webinars_xf"], "unique_id": "model.acton_marketing_data.ao_webinars_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/ao_data/ao_data_xf/ao_webinars_xf.sql", "original_file_path": "models/sources/ao_data/ao_data_xf/ao_webinars_xf.sql", "name": "ao_webinars_xf", "alias": "ao_webinars_xf", "checksum": {"name": "sha256", "checksum": "681c00cfd355f9dbba832ec5abda453a2f1427e83c333c548f2405ad87879dd3"}, "tags": [], "refs": [["ao_webinars"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4433365}, "model.acton_marketing_data.ao_landingpages_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT \r\n-- IDs\r\n    landing_page_id,\r\n    e_mail_address AS email,\r\n    record_id,\r\n    unique_visitor_id,\r\n\r\n-- LP Attributes\r\n    landing_page_title,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_campaign=',2),'&',1) AS campaign,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_channel=',2),'&',1) AS channel,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_source=',2),'&',1) AS source,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_medium=',2),'&',1) AS medium,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_content=',2),'&',1) AS content,\r\n    clicked_url,\r\n    clickthrough_link_name,\r\n    referral_url,\r\n\r\n-- Action Data\r\n    action,\r\n    action_time,\r\n    action_day,\r\n\r\n-- Other Data\r\n    cookie_id,\r\n    ip_address,\r\n    e_mail_domain AS email_domain\r\nFROM {{ref('ao_landingpages')}}\r\nWHERE e_mail_address IS NOT null\r\nAND e_mail_address NOT LIKE 'unknown%'", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.ao_landingpages"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "sources", "ao_data", "ao_data_xf", "ao_landingpages_xf"], "unique_id": "model.acton_marketing_data.ao_landingpages_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sources/ao_data/ao_data_xf/ao_landingpages_xf.sql", "original_file_path": "models/sources/ao_data/ao_data_xf/ao_landingpages_xf.sql", "name": "ao_landingpages_xf", "alias": "ao_landingpages_xf", "checksum": {"name": "sha256", "checksum": "5ce78a13a0bd950ff37283cd1d614425828670eb8c1857fa4770074f808f50be"}, "tags": [], "refs": [["ao_landingpages"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4457579}, "model.acton_marketing_data.topo_leads": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    lead_source,\r\n    global_region,\r\n    'Inquiries' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_leads')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_leads.created_date=date_base_xf.day\r\nWHERE created_date >= '2021-01-01'\r\nAND lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.date_base_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "topo_model", "topo_leads"], "unique_id": "model.acton_marketing_data.topo_leads", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "topo_model/topo_leads.sql", "original_file_path": "models/topo_model/topo_leads.sql", "name": "topo_leads", "alias": "topo_leads", "checksum": {"name": "sha256", "checksum": "678832d4afd88a6f27418155fcd36235b18de97c554a603642fd7fef38a99d04"}, "tags": [], "refs": [["funnel_report_all_time_leads"], ["date_base_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4477983}, "model.acton_marketing_data.topo_all": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT *\r\nFROM {{ref('topo_closing')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_demos')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_leads')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_lost')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_mqls')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_pipe')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_sals')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_sqls')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_sqos')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_voc')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_won_acv')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_won')}}", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.topo_closing", "model.acton_marketing_data.topo_demos", "model.acton_marketing_data.topo_leads", "model.acton_marketing_data.topo_lost", "model.acton_marketing_data.topo_mqls", "model.acton_marketing_data.topo_pipe", "model.acton_marketing_data.topo_sals", "model.acton_marketing_data.topo_sqls", "model.acton_marketing_data.topo_sqos", "model.acton_marketing_data.topo_voc", "model.acton_marketing_data.topo_won_acv", "model.acton_marketing_data.topo_won"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "topo_model", "topo_all"], "unique_id": "model.acton_marketing_data.topo_all", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "topo_model/topo_all.sql", "original_file_path": "models/topo_model/topo_all.sql", "name": "topo_all", "alias": "topo_all", "checksum": {"name": "sha256", "checksum": "6616619ec3a8370a431eebc1b213cc43b12595d0b986060198048478ae2612bb"}, "tags": [], "refs": [["topo_closing"], ["topo_demos"], ["topo_leads"], ["topo_lost"], ["topo_mqls"], ["topo_pipe"], ["topo_sals"], ["topo_sqls"], ["topo_sqos"], ["topo_voc"], ["topo_won_acv"], ["topo_won"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4498873}, "model.acton_marketing_data.topo_won_acv": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'Won ACV' AS type,\r\n    month,\r\n    quarter,\r\n    SUM(acv) AS records\r\nFROM {{ref('funnel_report_all_time_won')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_won.won_date=date_base_xf.day\r\nWHERE won_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.date_base_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "topo_model", "topo_won_acv"], "unique_id": "model.acton_marketing_data.topo_won_acv", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "topo_model/topo_won_acv.sql", "original_file_path": "models/topo_model/topo_won_acv.sql", "name": "topo_won_acv", "alias": "topo_won_acv", "checksum": {"name": "sha256", "checksum": "e089342b627813cb2c81e3c3b49d1ef40c69c4af7edea875dd71862ff111389a"}, "tags": [], "refs": [["funnel_report_all_time_won"], ["date_base_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.452736}, "model.acton_marketing_data.topo_mqls": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    lead_source,\r\n    global_region,\r\n    'MQL' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_mqls')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_mqls.mql_date=date_base_xf.day\r\nWHERE mql_date >= '2021-01-01'\r\nAND lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.date_base_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "topo_model", "topo_mqls"], "unique_id": "model.acton_marketing_data.topo_mqls", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "topo_model/topo_mqls.sql", "original_file_path": "models/topo_model/topo_mqls.sql", "name": "topo_mqls", "alias": "topo_mqls", "checksum": {"name": "sha256", "checksum": "7535c0da8bfcaef6fff769aa1492989d2fb925f901946b96f504589bea8d98f8"}, "tags": [], "refs": [["funnel_report_all_time_mqls"], ["date_base_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.455264}, "model.acton_marketing_data.topo_sqls": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'SQL' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_sqls')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_sqls.sql_date=date_base_xf.day\r\nWHERE sql_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.date_base_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "topo_model", "topo_sqls"], "unique_id": "model.acton_marketing_data.topo_sqls", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "topo_model/topo_sqls.sql", "original_file_path": "models/topo_model/topo_sqls.sql", "name": "topo_sqls", "alias": "topo_sqls", "checksum": {"name": "sha256", "checksum": "e9763db998efcc4ad93582a748febae200247e289bc1310a40bfc1c061487ce4"}, "tags": [], "refs": [["funnel_report_all_time_sqls"], ["date_base_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4576197}, "model.acton_marketing_data.topo_sals": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    lead_source,\r\n    global_region,\r\n    'SAL' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_sals')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_sals.sal_date=date_base_xf.day\r\nWHERE sal_date >= '2021-01-01'\r\nAND lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.date_base_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "topo_model", "topo_sals"], "unique_id": "model.acton_marketing_data.topo_sals", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "topo_model/topo_sals.sql", "original_file_path": "models/topo_model/topo_sals.sql", "name": "topo_sals", "alias": "topo_sals", "checksum": {"name": "sha256", "checksum": "dc06fbb64db8e8d04cda35c339b2c61c4c3ae6b38cfbe13d72f89653cc2f16f2"}, "tags": [], "refs": [["funnel_report_all_time_sals"], ["date_base_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.45972}, "model.acton_marketing_data.topo_closing": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'CLOSING' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_closing')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_closing.closing_date=date_base_xf.day\r\nWHERE closing_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.date_base_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "topo_model", "topo_closing"], "unique_id": "model.acton_marketing_data.topo_closing", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "topo_model/topo_closing.sql", "original_file_path": "models/topo_model/topo_closing.sql", "name": "topo_closing", "alias": "topo_closing", "checksum": {"name": "sha256", "checksum": "c9d3256dffd1f37f85d858d59dc50098f566b036c106800694079c5ecac305c0"}, "tags": [], "refs": [["funnel_report_all_time_closing"], ["date_base_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4619193}, "model.acton_marketing_data.topo_lost": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'Lost' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_lost')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_lost.lost_date=date_base_xf.day\r\nWHERE lost_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_lost", "model.acton_marketing_data.date_base_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "topo_model", "topo_lost"], "unique_id": "model.acton_marketing_data.topo_lost", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "topo_model/topo_lost.sql", "original_file_path": "models/topo_model/topo_lost.sql", "name": "topo_lost", "alias": "topo_lost", "checksum": {"name": "sha256", "checksum": "71ede907cbd1522ca1ccd75841449f308a2c2cb863eb89786b2a62fe8c223297"}, "tags": [], "refs": [["funnel_report_all_time_lost"], ["date_base_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4639833}, "model.acton_marketing_data.topo_sqos": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'SQO' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_sqos')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_sqos.sqo_date=date_base_xf.day\r\nWHERE sqo_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.date_base_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "topo_model", "topo_sqos"], "unique_id": "model.acton_marketing_data.topo_sqos", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "topo_model/topo_sqos.sql", "original_file_path": "models/topo_model/topo_sqos.sql", "name": "topo_sqos", "alias": "topo_sqos", "checksum": {"name": "sha256", "checksum": "6a7c778f5d067b4213e3d7be057884078c0a6a94915f886838d546e7a2d0e579"}, "tags": [], "refs": [["funnel_report_all_time_sqos"], ["date_base_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.466445}, "model.acton_marketing_data.topo_pipe": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'PIPE' AS type,\r\n    month,\r\n    quarter,\r\n    SUM(acv) AS records\r\nFROM {{ref('funnel_report_all_time_sqos')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_sqos.sqo_date=date_base_xf.day\r\nWHERE sqo_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.date_base_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "topo_model", "topo_pipe"], "unique_id": "model.acton_marketing_data.topo_pipe", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "topo_model/topo_pipe.sql", "original_file_path": "models/topo_model/topo_pipe.sql", "name": "topo_pipe", "alias": "topo_pipe", "checksum": {"name": "sha256", "checksum": "50339211ba4dc33971099f1d79e8f1076269b97b8468515e5a9cb2cd73b979d0"}, "tags": [], "refs": [["funnel_report_all_time_sqos"], ["date_base_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.468515}, "model.acton_marketing_data.topo_won": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'Won' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_won')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_won.won_date=date_base_xf.day\r\nWHERE won_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.date_base_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "topo_model", "topo_won"], "unique_id": "model.acton_marketing_data.topo_won", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "topo_model/topo_won.sql", "original_file_path": "models/topo_model/topo_won.sql", "name": "topo_won", "alias": "topo_won", "checksum": {"name": "sha256", "checksum": "6f0cd517205924b5e11bc3b0181c32bb7ad41a0cdfe08ec004e7c343d5927c97"}, "tags": [], "refs": [["funnel_report_all_time_won"], ["date_base_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4705865}, "model.acton_marketing_data.topo_demos": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'DEMO' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_demo')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_demo.demo_date=date_base_xf.day\r\nWHERE demo_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.date_base_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "topo_model", "topo_demos"], "unique_id": "model.acton_marketing_data.topo_demos", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "topo_model/topo_demos.sql", "original_file_path": "models/topo_model/topo_demos.sql", "name": "topo_demos", "alias": "topo_demos", "checksum": {"name": "sha256", "checksum": "dae03ced86e4801d22bf5f143fa833be183990de550b2b9b9b5cb1e7d8504bbb"}, "tags": [], "refs": [["funnel_report_all_time_demo"], ["date_base_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4727821}, "model.acton_marketing_data.topo_voc": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'VOC' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_voc')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_voc.voc_date=date_base_xf.day\r\nWHERE voc_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.date_base_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "topo_model", "topo_voc"], "unique_id": "model.acton_marketing_data.topo_voc", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "topo_model/topo_voc.sql", "original_file_path": "models/topo_model/topo_voc.sql", "name": "topo_voc", "alias": "topo_voc", "checksum": {"name": "sha256", "checksum": "69cca010738c01509d0de60f7ee98cb16a35bd36cfb1b05249eb4446e9d55abf"}, "tags": [], "refs": [["funnel_report_all_time_voc"], ["date_base_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4749055}, "model.acton_marketing_data.marketing_lead_creation_date_history_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        lead_history_xf.lead_id,\r\n        lead_history_xf.field_modified_at,\r\n        lead_history_xf.field,\r\n        lead_history_xf.old_value,\r\n        lead_history_xf.new_value,\r\n        'lead' AS type\r\n    FROM {{ref('lead_history_xf')}}\r\n    LEFT JOIN {{ref('lead_source_xf')}} ON \r\n    lead_history_xf.lead_id=lead_source_xf.lead_id\r\n    WHERE marketing_created_date IS null\r\n    UNION ALL\r\n    SELECT \r\n        contact_history_xf.contact_id,\r\n        contact_history_xf.field_modified_at,\r\n        contact_history_xf.field,\r\n        contact_history_xf.old_value,\r\n        contact_history_xf.new_value,\r\n        'contact' AS type\r\n    FROM {{ref('contact_history_xf')}}\r\n    LEFT JOIN {{ref('contact_source_xf')}} ON \r\n    contact_history_xf.contact_id=contact_source_xf.contact_id\r\n    WHERE marketing_created_date IS null\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        lead_id,\r\n        old_value,\r\n        new_value,\r\n        field_modified_at,\r\n        type,\r\n        ROW_NUMBER() OVER(PARTITION BY lead_id ORDER BY field_modified_at) AS event_number\r\n    FROM base \r\n    WHERE field ='X9883_Lead_Score__c'\r\n    AND new_value > '0.0'\r\n    ORDER BY lead_id,field_modified_at\r\n\r\n)\r\n\r\nSELECT \r\n    lead_id,\r\n    old_value,\r\n    new_value,\r\n    field_modified_at,\r\n    type\r\nFROM final\r\nWHERE event_number = 1", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.lead_history_xf", "model.acton_marketing_data.lead_source_xf", "model.acton_marketing_data.contact_history_xf", "model.acton_marketing_data.contact_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel_date_updates", "marketing_lead_creation_date_history_xf"], "unique_id": "model.acton_marketing_data.marketing_lead_creation_date_history_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel_date_updates/marketing_lead_creation_date_history_xf.sql", "original_file_path": "models/funnel_date_updates/marketing_lead_creation_date_history_xf.sql", "name": "marketing_lead_creation_date_history_xf", "alias": "marketing_lead_creation_date_history_xf", "checksum": {"name": "sha256", "checksum": "6dc7ce24f9e0818e54ec6359e2e6574f1e081afde3efbdeee4385430a03080bc"}, "tags": [], "refs": [["lead_history_xf"], ["lead_source_xf"], ["contact_history_xf"], ["contact_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4773479}, "model.acton_marketing_data.opp_demo_date_history_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        opportunity_history_xf.opportunity_id,\r\n        opp_source_xf.type AS opp_type,\r\n        opportunity_history_xf.field_modified_at,\r\n        opportunity_history_xf.field,\r\n        opportunity_history_xf.old_value,\r\n        opportunity_history_xf.new_value\r\n    FROM {{ref('opportunity_history_xf')}}\r\n    LEFT JOIN {{ref('opp_source_xf')}} ON \r\n    opportunity_history_xf.opportunity_id=opp_source_xf.opportunity_id\r\n    WHERE demo_date IS null\r\n    AND type IN ('New Business','UpSell','Renewal')\r\n    AND field_modified_at >= '2021-01-01'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        opportunity_id,\r\n        opp_type,\r\n        old_value,\r\n        new_value,\r\n        field_modified_at,\r\n        ROW_NUMBER() OVER(PARTITION BY opportunity_id ORDER BY field_modified_at) AS event_number\r\n    FROM base \r\n    WHERE field = 'StageName'\r\n    AND new_value = 'Demo'\r\n    ORDER BY opportunity_id,field_modified_at\r\n\r\n)\r\n\r\nSELECT \r\n    opportunity_id,\r\n    opp_type,\r\n    old_value,\r\n    new_value,\r\n    field_modified_at\r\nFROM final\r\nWHERE event_number = 1", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opportunity_history_xf", "model.acton_marketing_data.opp_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel_date_updates", "opp_demo_date_history_xf"], "unique_id": "model.acton_marketing_data.opp_demo_date_history_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel_date_updates/opp_demo_date_history_xf.sql", "original_file_path": "models/funnel_date_updates/opp_demo_date_history_xf.sql", "name": "opp_demo_date_history_xf", "alias": "opp_demo_date_history_xf", "checksum": {"name": "sha256", "checksum": "99b51873270f0ad547a1b13870587c6dbdcdec6a524352a78210cc616403b9fb"}, "tags": [], "refs": [["opportunity_history_xf"], ["opp_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4796627}, "model.acton_marketing_data.working_date_history_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        lead_history_xf.lead_id,\r\n        lead_history_xf.field_modified_at,\r\n        lead_history_xf.field,\r\n        lead_history_xf.old_value,\r\n        lead_history_xf.new_value,\r\n        'lead' AS type\r\n    FROM {{ref('lead_history_xf')}}\r\n    LEFT JOIN {{ref('lead_source_xf')}} ON \r\n    lead_history_xf.lead_id=lead_source_xf.lead_id\r\n    WHERE working_date IS null\r\n    UNION ALL\r\n    SELECT \r\n        contact_history_xf.contact_id,\r\n        contact_history_xf.field_modified_at,\r\n        contact_history_xf.field,\r\n        contact_history_xf.old_value,\r\n        contact_history_xf.new_value,\r\n        'contact' AS type\r\n    FROM {{ref('contact_history_xf')}}\r\n    LEFT JOIN {{ref('contact_source_xf')}} ON \r\n    contact_history_xf.contact_id=contact_source_xf.contact_id\r\n    WHERE working_date IS null\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        lead_id,\r\n        old_value,\r\n        new_value,\r\n        field_modified_at,\r\n        type,\r\n        ROW_NUMBER() OVER(PARTITION BY lead_id ORDER BY field_modified_at) AS event_number\r\n    FROM base \r\n    WHERE field = 'Status'\r\n    AND new_value = 'Working'\r\n    ORDER BY lead_id,field_modified_at\r\n\r\n)\r\n\r\nSELECT \r\n    lead_id,\r\n    old_value,\r\n    new_value,\r\n    field_modified_at,\r\n    type\r\nFROM final\r\nWHERE event_number = 1", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.lead_history_xf", "model.acton_marketing_data.lead_source_xf", "model.acton_marketing_data.contact_history_xf", "model.acton_marketing_data.contact_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel_date_updates", "working_date_history_xf"], "unique_id": "model.acton_marketing_data.working_date_history_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel_date_updates/working_date_history_xf.sql", "original_file_path": "models/funnel_date_updates/working_date_history_xf.sql", "name": "working_date_history_xf", "alias": "working_date_history_xf", "checksum": {"name": "sha256", "checksum": "08ad9ce415fed26438371a6ff6db08d17877c2658fac9674c21d9c79f2bea39b"}, "tags": [], "refs": [["lead_history_xf"], ["lead_source_xf"], ["contact_history_xf"], ["contact_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.481853}, "model.acton_marketing_data.opp_closing_date_history_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        opportunity_history_xf.opportunity_id,\r\n        opp_source_xf.type AS opp_type,\r\n        opportunity_history_xf.field_modified_at,\r\n        opportunity_history_xf.field,\r\n        opportunity_history_xf.old_value,\r\n        opportunity_history_xf.new_value\r\n    FROM {{ref('opportunity_history_xf')}}\r\n    LEFT JOIN {{ref('opp_source_xf')}} ON \r\n    opportunity_history_xf.opportunity_id=opp_source_xf.opportunity_id\r\n    WHERE closing_date IS null\r\n    AND type IN ('New Business','UpSell','Renewal')\r\n    AND field_modified_at >= '2021-01-01'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        opportunity_id,\r\n        opp_type,\r\n        old_value,\r\n        new_value,\r\n        field_modified_at,\r\n        ROW_NUMBER() OVER(PARTITION BY opportunity_id ORDER BY field_modified_at) AS event_number\r\n    FROM base \r\n    WHERE field = 'StageName'\r\n    AND new_value = 'Closing'\r\n    ORDER BY opportunity_id,field_modified_at\r\n\r\n)\r\n\r\nSELECT \r\n    opportunity_id,\r\n    opp_type,\r\n    old_value,\r\n    new_value,\r\n    field_modified_at\r\nFROM final\r\nWHERE event_number = 1", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opportunity_history_xf", "model.acton_marketing_data.opp_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel_date_updates", "opp_closing_date_history_xf"], "unique_id": "model.acton_marketing_data.opp_closing_date_history_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel_date_updates/opp_closing_date_history_xf.sql", "original_file_path": "models/funnel_date_updates/opp_closing_date_history_xf.sql", "name": "opp_closing_date_history_xf", "alias": "opp_closing_date_history_xf", "checksum": {"name": "sha256", "checksum": "23f9f9731ab14c02ed89e3d2d7bd414d171fabb9991bb00bd34e30b9c8b50992"}, "tags": [], "refs": [["opportunity_history_xf"], ["opp_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.484157}, "model.acton_marketing_data.mql_date_history_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        lead_history_xf.lead_id,\r\n        lead_history_xf.field_modified_at,\r\n        lead_history_xf.field,\r\n        lead_history_xf.old_value,\r\n        lead_history_xf.new_value,\r\n        'lead' AS type\r\n    FROM {{ref('lead_history_xf')}}\r\n    LEFT JOIN {{ref('lead_source_xf')}} ON \r\n    lead_history_xf.lead_id=lead_source_xf.lead_id\r\n    WHERE mql_most_recent_date IS null\r\n    AND field ='X9883_Lead_Score__c'\r\n    AND new_value::Decimal >= '50.0'\r\n    AND old_value::Decimal < '50.0'\r\n    UNION ALL\r\n    SELECT \r\n        contact_history_xf.contact_id,\r\n        contact_history_xf.field_modified_at,\r\n        contact_history_xf.field,\r\n        contact_history_xf.old_value,\r\n        contact_history_xf.new_value,\r\n        'contact' AS type\r\n    FROM {{ref('contact_history_xf')}}\r\n    LEFT JOIN {{ref('contact_source_xf')}} ON \r\n    contact_history_xf.contact_id=contact_source_xf.contact_id\r\n    WHERE mql_most_recent_date IS null\r\n    AND field ='X9883_Lead_Score__c'\r\n    AND new_value::Decimal >= '50.0'\r\n    AND old_value::Decimal < '50.0'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        lead_id,\r\n        old_value,\r\n        new_value,\r\n        field_modified_at,\r\n        type,\r\n        ROW_NUMBER() OVER(PARTITION BY lead_id ORDER BY field_modified_at) AS event_number\r\n    FROM base \r\n    ORDER BY lead_id,field_modified_at\r\n\r\n)\r\n\r\nSELECT \r\n    lead_id,\r\n    old_value,\r\n    new_value,\r\n    field_modified_at,\r\n    type\r\nFROM final\r\nWHERE event_number = 1", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.lead_history_xf", "model.acton_marketing_data.lead_source_xf", "model.acton_marketing_data.contact_history_xf", "model.acton_marketing_data.contact_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel_date_updates", "mql_date_history_xf"], "unique_id": "model.acton_marketing_data.mql_date_history_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel_date_updates/mql_date_history_xf.sql", "original_file_path": "models/funnel_date_updates/mql_date_history_xf.sql", "name": "mql_date_history_xf", "alias": "mql_date_history_xf", "checksum": {"name": "sha256", "checksum": "1fa54ddfad8a80b7b3f7fb1a43b21da6962577f6eb862d0053ed6c6b9cdf2da7"}, "tags": [], "refs": [["lead_history_xf"], ["lead_source_xf"], ["contact_history_xf"], ["contact_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4865692}, "model.acton_marketing_data.opp_discovery_date_history_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        opportunity_history_xf.opportunity_id,\r\n        opp_source_xf.type AS opp_type,\r\n        opportunity_history_xf.field_modified_at,\r\n        opportunity_history_xf.field,\r\n        opportunity_history_xf.old_value,\r\n        opportunity_history_xf.new_value\r\n    FROM {{ref('opportunity_history_xf')}}\r\n    LEFT JOIN {{ref('opp_source_xf')}} ON \r\n    opportunity_history_xf.opportunity_id=opp_source_xf.opportunity_id\r\n    WHERE discovery_date IS null\r\n    AND type IN ('New Business','UpSell','Renewal')\r\n    AND field_modified_at >= '2021-01-01'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        opportunity_id,\r\n        opp_type,\r\n        old_value,\r\n        new_value,\r\n        field_modified_at,\r\n        ROW_NUMBER() OVER(PARTITION BY opportunity_id ORDER BY field_modified_at) AS event_number\r\n    FROM base \r\n    WHERE field = 'StageName'\r\n    AND new_value = 'Discovery'\r\n    ORDER BY opportunity_id,field_modified_at\r\n\r\n)\r\n\r\nSELECT \r\n    opportunity_id,\r\n    opp_type,\r\n    old_value,\r\n    new_value,\r\n    field_modified_at\r\nFROM final\r\nWHERE event_number = 1", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opportunity_history_xf", "model.acton_marketing_data.opp_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel_date_updates", "opp_discovery_date_history_xf"], "unique_id": "model.acton_marketing_data.opp_discovery_date_history_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel_date_updates/opp_discovery_date_history_xf.sql", "original_file_path": "models/funnel_date_updates/opp_discovery_date_history_xf.sql", "name": "opp_discovery_date_history_xf", "alias": "opp_discovery_date_history_xf", "checksum": {"name": "sha256", "checksum": "ca75cbfea918629a628d0408b6cd880e5b28ad86ecb9cb31f6c52248c00546a0"}, "tags": [], "refs": [["opportunity_history_xf"], ["opp_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4890573}, "model.acton_marketing_data.opp_voc_date_history_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        opportunity_history_xf.opportunity_id,\r\n        opp_source_xf.type AS opp_type,\r\n        opportunity_history_xf.field_modified_at,\r\n        opportunity_history_xf.field,\r\n        opportunity_history_xf.old_value,\r\n        opportunity_history_xf.new_value\r\n    FROM {{ref('opportunity_history_xf')}}\r\n    LEFT JOIN {{ref('opp_source_xf')}} ON \r\n    opportunity_history_xf.opportunity_id=opp_source_xf.opportunity_id\r\n    WHERE voc_date IS null\r\n    AND type IN ('New Business','UpSell','Renewal')\r\n    AND field_modified_at >= '2021-01-01'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        opportunity_id,\r\n        opp_type,\r\n        old_value,\r\n        new_value,\r\n        field_modified_at,\r\n        ROW_NUMBER() OVER(PARTITION BY opportunity_id ORDER BY field_modified_at) AS event_number\r\n    FROM base \r\n    WHERE field = 'StageName'\r\n    AND new_value = 'VOC/Negotiate'\r\n    ORDER BY opportunity_id,field_modified_at\r\n\r\n)\r\n\r\nSELECT \r\n    opportunity_id,\r\n    opp_type,\r\n    old_value,\r\n    new_value,\r\n    field_modified_at\r\nFROM final\r\nWHERE event_number = 1", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opportunity_history_xf", "model.acton_marketing_data.opp_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "funnel_date_updates", "opp_voc_date_history_xf"], "unique_id": "model.acton_marketing_data.opp_voc_date_history_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "funnel_date_updates/opp_voc_date_history_xf.sql", "original_file_path": "models/funnel_date_updates/opp_voc_date_history_xf.sql", "name": "opp_voc_date_history_xf", "alias": "opp_voc_date_history_xf", "checksum": {"name": "sha256", "checksum": "e701d2c0e23a2a3a8b16eae103e6cc492abfd149e6db81c8ad4c173b2d2108cb"}, "tags": [], "refs": [["opportunity_history_xf"], ["opp_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4912038}, "model.acton_marketing_data.marketo_persons_influenced": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        email,\r\n        global_region,\r\n        marketing_created_date,\r\n        mql_most_recent_date,\r\n        campaign_first_touch,\r\n        campaign_last_touch,\r\n        campaign_lead_creation,\r\n        offer_asset_name_first_touch,\r\n        offer_asset_name_last_touch,\r\n        offer_asset_name_lead_creation,\r\n        offer_asset_subtype_first_touch,\r\n        offer_asset_subtype_last_touch,\r\n        offer_asset_subtype_lead_creation,\r\n        offer_asset_topic_first_touch,\r\n        offer_asset_topic_last_touch,\r\n        offer_asset_topic_lead_creation,\r\n        offer_asset_type_first_touch,\r\n        offer_asset_type_last_touch,\r\n        offer_asset_type_lead_creation\r\n    FROM {{ref('person_source_xf')}}\r\n    WHERE (campaign_first_touch LIKE 'marketo ap'\r\n        OR campaign_last_touch LIKE 'marketo ap'\r\n        OR campaign_lead_creation LIKE 'marketo ap')\r\n    \r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.person_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "campaign_reporting", "marketo_persons_influenced"], "unique_id": "model.acton_marketing_data.marketo_persons_influenced", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "campaign_reporting/marketo_persons_influenced.sql", "original_file_path": "models/campaign_reporting/marketo_persons_influenced.sql", "name": "marketo_persons_influenced", "alias": "marketo_persons_influenced", "checksum": {"name": "sha256", "checksum": "1bdfd636dc7fac522d708cca7ca851146290de4bc0b3547a73720157673496a5"}, "tags": [], "refs": [["person_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4935694}, "model.acton_marketing_data.campaign_primary_source": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n    --Campaign Info\r\n        campaign_member.campaign_id,\r\n        campaign.campaign_name,\r\n        campaign.campaign_start_date,\r\n        campaign.campaign_end_date,\r\n        campaign.budgeted_cost,\r\n        campaign.actual_cost,\r\n        campaign.campaign_type,\r\n        campaign.campaign_status,\r\n        campaign.is_active_campaign,\r\n\r\n    --Parent Campaign Info\r\n        campaign.parent_campaign_id,\r\n        campaign.parent_campaign_name,\r\n        campaign.parent_campaign_start_date,\r\n        campaign.parent_campaign_end_date,\r\n        campaign.parent_budgeted_cost,\r\n        campaign.parent_actual_cost,\r\n        campaign.parent_campaign_type,\r\n        campaign.parent_campaign_status,\r\n        campaign.is_active_parent_campaign,\r\n\r\n    --Campaign Member Info\r\n        campaign_member.lead_or_contact_id,\r\n        campaign_member.campaign_member_id,\r\n        campaign_member.campaign_member_status,\r\n        campaign_member.campaign_member_type,\r\n        campaign_member.campaign_member_has_responded,\r\n        campaign_member.campaign_member_created_date,\r\n        campaign_member.campaign_member_first_responded_date,\r\n\r\n    --Person Info\r\n        person.email,\r\n        person.person_status,\r\n        person.lead_score,\r\n        person.mql_most_recent_date,\r\n        person.working_date,\r\n\r\n    --Account Info\r\n        person.lean_data_account_id AS account_id,\r\n        COALESCE(account.account_name,person.company) AS account_name,\r\n        account.account_owner_name,\r\n        account.account_csm_name,\r\n        COALESCE(account.global_region,person.global_region) AS global_region,\r\n        account.executive_sponsor,\r\n        account.assigned_account_tier,\r\n        account.customer_since,\r\n        account.renewal_date,\r\n        account.business_model,\r\n        account.contract_type,\r\n        account.delivered_support_tier,\r\n        COALESCE(account.industry,person.industry) AS industry,\r\n        COALESCE(account.industry_bucket,person.industry_bucket) AS industry_bucket,\r\n        COALESCE(account.company_size_rev,person.company_size_rev) AS company_size_rev,\r\n        COALESCE(account.segment,person.segment) AS segment,\r\n        account.account_type,\r\n        account.is_current_customer,\r\n\r\n    --Opportunity Info\r\n        campaign_influence.influence_opportunity_id AS opportunity_id,\r\n        opp.opportunity_name,\r\n        opp.acv AS acv_deal_size_usd,\r\n        opp.created_date,\r\n        opp.discovery_date,\r\n        opp.close_date,\r\n        opp.type AS opp_type,\r\n        opp.is_closed,\r\n        opp.is_won,\r\n        CASE \r\n            WHEN is_won = true THEN influence_opportunity_id\r\n            END AS won_opportunity_id,\r\n        CASE \r\n            WHEN is_won = true THEN acv\r\n            END AS won_opportunity_acv\r\nFROM {{ref('campaign_member_source_xf')}} campaign_member\r\nLEFT JOIN {{ref('campaign_source_xf')}} campaign\r\nON campaign_member.campaign_id=campaign.campaign_id\r\nLEFT JOIN {{ref('person_source_xf')}} person\r\nON campaign_member.lead_or_contact_id=person.person_id\r\nLEFT JOIN {{ref('account_source_xf')}} account\r\nON person.lean_data_account_id=account.account_id\r\nLEFT JOIN {{ref('campaign_influence_xf')}} campaign_influence\r\nON campaign_member.campaign_id=campaign_influence.influence_campaign_id\r\nAND campaign_influence.influence_contact_id=person.person_id\r\nLEFT JOIN {{ref('opp_source_xf')}} opp\r\nON campaign_influence.influence_opportunity_id=opp.opportunity_id\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.campaign_member_source_xf", "model.acton_marketing_data.campaign_source_xf", "model.acton_marketing_data.person_source_xf", "model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.campaign_influence_xf", "model.acton_marketing_data.opp_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "campaign_reporting", "campaign_primary_source"], "unique_id": "model.acton_marketing_data.campaign_primary_source", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "campaign_reporting/campaign_primary_source.sql", "original_file_path": "models/campaign_reporting/campaign_primary_source.sql", "name": "campaign_primary_source", "alias": "campaign_primary_source", "checksum": {"name": "sha256", "checksum": "250663c5818675d42873170deb2226d4c8fb6ba6c636de26dd7bfb23b9dbd93a"}, "tags": [], "refs": [["campaign_member_source_xf"], ["campaign_source_xf"], ["person_source_xf"], ["account_source_xf"], ["campaign_influence_xf"], ["opp_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.4955664}, "model.acton_marketing_data.first_touch": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type\r\n    FROM {{ref('ao_combined')}}\r\n\r\n), first_touch_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        ROW_NUMBER() OVER (PARTITION BY email ORDER BY action_time ASC ) AS touchpoint_number\r\n    FROM base\r\n\r\n)\r\n\r\nSELECT\r\n    email,\r\n    touchpoint_id,\r\n    action,\r\n    action_time,\r\n    action_day,\r\n    asset_id,\r\n    asset_title,\r\n    subject_line,\r\n    from_address,\r\n    clicked_url,\r\n    clickthrough_link_name,\r\n    referral_url,\r\n    event_id,\r\n    asset_type,\r\n    'FT' AS ft_position,\r\n    1 AS first_touch_weight,\r\n    .5 AS u_shaped_weight,\r\n    .3 AS w_shaped_weight,\r\n    .225 AS full_path_weight\r\nFROM first_touch_base\r\nWHERE touchpoint_number = 1", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.ao_combined"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "attribution", "attribution_models", "first_touch"], "unique_id": "model.acton_marketing_data.first_touch", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "attribution/attribution_models/first_touch.sql", "original_file_path": "models/attribution/attribution_models/first_touch.sql", "name": "first_touch", "alias": "first_touch", "checksum": {"name": "sha256", "checksum": "32dac25dcc79d4e4c31302ee2eec67a6c9248be76ce38e115e788731af54fab5"}, "tags": [], "refs": [["ao_combined"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.499135}, "model.acton_marketing_data.lead_creation": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type\r\n    FROM {{ref('ao_combined')}}\r\n    WHERE asset_type = 'form'\r\n\r\n), person_source_prep AS (\r\n\r\n    SELECT\r\n        email,\r\n        {{ dbt_date.convert_timezone(\"created_date::Timestamp\", \"America/Los_Angeles\") }} AS created_date\r\n    FROM {{ref('person_source_xf')}}\r\n\r\n), person_source AS (\r\n\r\n    SELECT\r\n        email,\r\n        created_date::Date AS created_date\r\n    FROM person_source_prep\r\n\r\n), lead_creation_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        base.email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        ROW_NUMBER() OVER (PARTITION BY base.email ORDER BY action_time ASC ) AS touchpoint_number\r\n    FROM base\r\n    LEFT JOIN person_source person ON\r\n    base.email=person.email\r\n    WHERE action_day=person.created_date\r\n\r\n)\r\n\r\nSELECT\r\n    touchpoint_id,\r\n    action,\r\n    action_time,\r\n    action_day,\r\n    asset_id,\r\n    email,\r\n    asset_title,\r\n    subject_line,\r\n    from_address,\r\n    clicked_url,\r\n    clickthrough_link_name,\r\n    referral_url,\r\n    event_id,\r\n    asset_type,\r\n    'LC' AS lc_position,\r\n    1 AS lead_creation_weight,\r\n    .5 AS u_shaped_weight,\r\n    .3 AS w_shaped_weight,\r\n    .225 AS full_path_weight\r\nFROM lead_creation_base\r\nWHERE touchpoint_number = 1", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_date.convert_timezone"], "nodes": ["model.acton_marketing_data.ao_combined", "model.acton_marketing_data.person_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "attribution", "attribution_models", "lead_creation"], "unique_id": "model.acton_marketing_data.lead_creation", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "attribution/attribution_models/lead_creation.sql", "original_file_path": "models/attribution/attribution_models/lead_creation.sql", "name": "lead_creation", "alias": "lead_creation", "checksum": {"name": "sha256", "checksum": "c1fbb2f0810a24e648562839dd735fea0cfacc387b686e9a92ac0b72639205ad"}, "tags": [], "refs": [["ao_combined"], ["person_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5011396}, "model.acton_marketing_data.last_touch": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type\r\n    FROM {{ref('ao_combined')}}\r\n\r\n), last_touch_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        ROW_NUMBER() OVER (PARTITION BY email ORDER BY action_time DESC ) AS touchpoint_number\r\n    FROM base\r\n\r\n)\r\n\r\nSELECT\r\n    touchpoint_id,\r\n    action,\r\n    action_time,\r\n    action_day,\r\n    asset_id,\r\n    email,\r\n    asset_title,\r\n    subject_line,\r\n    from_address,\r\n    clicked_url,\r\n    clickthrough_link_name,\r\n    referral_url,\r\n    event_id,\r\n    asset_type,\r\n    'LT' AS lt_position,\r\n    1 AS last_touch_weight\r\nFROM last_touch_base\r\nWHERE touchpoint_number = 1", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.ao_combined"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "attribution", "attribution_models", "last_touch"], "unique_id": "model.acton_marketing_data.last_touch", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "attribution/attribution_models/last_touch.sql", "original_file_path": "models/attribution/attribution_models/last_touch.sql", "name": "last_touch", "alias": "last_touch", "checksum": {"name": "sha256", "checksum": "639e80b63522e80bd1d8c2b39e406e104d679ec998c03ef147d70aa509ae0813"}, "tags": [], "refs": [["ao_combined"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5071313}, "model.acton_marketing_data.lead_creation2": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type\r\n    FROM {{ref('ao_combined')}}\r\n\r\n), person_source_prep AS (\r\n\r\n    SELECT\r\n        email,\r\n        {{ dbt_date.convert_timezone(\"created_date::Timestamp\", \"America/Los_Angeles\") }} AS created_date\r\n    FROM {{ref('person_source_xf')}}\r\n\r\n), person_source AS (\r\n\r\n    SELECT\r\n        email,\r\n        created_date::Date AS created_date\r\n    FROM person_source_prep\r\n\r\n), lead_creation_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        base.email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        ROW_NUMBER() OVER (PARTITION BY base.email ORDER BY action_time ASC ) AS touchpoint_number\r\n    FROM base\r\n    LEFT JOIN person_source person ON\r\n    base.email=person.email\r\n    WHERE action_day=person.created_date\r\n    AND asset_type = 'form'\r\n\r\n), linear_base AS (\r\n\r\n    SELECT\r\n        email,\r\n        COUNT(DISTINCT touchpoint_id) AS linear_touches\r\n    FROM base\r\n    GROUP BY 1\r\n)\r\n\r\nSELECT\r\n    base.touchpoint_id,\r\n    base.action,\r\n    base.action_time,\r\n    base.action_day,\r\n    base.asset_id,\r\n    base.email,\r\n    base.asset_title,\r\n    base.subject_line,\r\n    base.from_address,\r\n    base.clicked_url,\r\n    base.clickthrough_link_name,\r\n    base.referral_url,\r\n    base.event_id,\r\n    base.asset_type,\r\n    touchpoint_number,\r\n    linear_touches,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN 'LC' \r\n        ELSE null\r\n    END AS lc_position,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN 1\r\n        ELSE 0\r\n    END AS lead_creation_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .5\r\n        ELSE 0\r\n    END AS u_shaped_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .3 \r\n        WHEN linear_touches = 1 THEN .1\r\n        ELSE (.1/SUM(linear_touches-1))\r\n    END AS w_shaped_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .225 \r\n        WHEN linear_touches = 1 THEN .1\r\n        ELSE (.1/SUM(linear_touches-1))\r\n    END AS full_path_weight\r\nFROM base\r\nLEFT JOIN lead_creation_base ON\r\nbase.touchpoint_id=lead_creation_base.touchpoint_id\r\nLEFT JOIN linear_base ON\r\nbase.email=linear_base.email\r\n{{ dbt_utils.group_by(n=19) }}", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_date.convert_timezone", "macro.dbt_utils.group_by"], "nodes": ["model.acton_marketing_data.ao_combined", "model.acton_marketing_data.person_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "attribution", "attribution_models", "lead_creation2"], "unique_id": "model.acton_marketing_data.lead_creation2", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "attribution/attribution_models/lead_creation2.sql", "original_file_path": "models/attribution/attribution_models/lead_creation2.sql", "name": "lead_creation2", "alias": "lead_creation2", "checksum": {"name": "sha256", "checksum": "bb535fc75a48ffeeea1d304ab4ce740454e27075d72fea917a1a674ac48943d9"}, "tags": [], "refs": [["ao_combined"], ["person_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5093734}, "model.acton_marketing_data.first_touch2": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type\r\n    FROM {{ref('ao_combined')}}\r\n\r\n), first_touch_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        ROW_NUMBER() OVER (PARTITION BY email ORDER BY action_time ASC ) AS touchpoint_number\r\n    FROM base\r\n\r\n), linear_base AS (\r\n\r\n    SELECT\r\n        email,\r\n        COUNT(DISTINCT touchpoint_id) AS linear_touches\r\n    FROM base\r\n    GROUP BY 1\r\n)\r\n\r\nSELECT\r\n    first_touch_base.email,\r\n    touchpoint_id,\r\n    action,\r\n    action_time,\r\n    action_day,\r\n    asset_id,\r\n    asset_title,\r\n    subject_line,\r\n    from_address,\r\n    clicked_url,\r\n    clickthrough_link_name,\r\n    referral_url,\r\n    event_id,\r\n    asset_type,\r\n    touchpoint_number,\r\n    linear_touches,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN 'FT' \r\n        ELSE null\r\n    END AS ft_position,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN 1\r\n        ELSE 0\r\n    END AS first_touch_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .5\r\n        ELSE 0\r\n    END AS u_shaped_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .3 \r\n        WHEN linear_touches = 1 THEN .1\r\n        ELSE (.1/SUM(linear_touches-1))\r\n    END AS w_shaped_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .225 \r\n        WHEN linear_touches = 1 THEN .1\r\n        ELSE (.1/SUM(linear_touches-1))\r\n    END AS full_path_weight\r\nFROM first_touch_base\r\nLEFT JOIN linear_base ON\r\nfirst_touch_base.email=linear_base.email\r\n{{ dbt_utils.group_by(n=19) }}", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.group_by"], "nodes": ["model.acton_marketing_data.ao_combined"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "attribution", "attribution_models", "first_touch2"], "unique_id": "model.acton_marketing_data.first_touch2", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "attribution/attribution_models/first_touch2.sql", "original_file_path": "models/attribution/attribution_models/first_touch2.sql", "name": "first_touch2", "alias": "first_touch2", "checksum": {"name": "sha256", "checksum": "84762c0fe4770c3ab5fd6c1fab199489ba466ba7139b81fd09c499614dc9054b"}, "tags": [], "refs": [["ao_combined"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5160983}, "model.acton_marketing_data.opportunity_creation2": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type\r\n    FROM {{ref('ao_combined')}}\r\n\r\n), opp_creation_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        base.email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        ROW_NUMBER() OVER (PARTITION BY cohort.opportunity_id ORDER BY action_time ASC ) AS touchpoint_number\r\n    FROM base\r\n    LEFT JOIN {{ref('lead_to_cw_cohort')}} cohort ON\r\n    base.email=cohort.email\r\n    WHERE action_day <= cohort.opp_created_date\r\n\r\n), linear_base AS (\r\n\r\n    SELECT\r\n        email,\r\n        COUNT(DISTINCT touchpoint_id) AS linear_touches\r\n    FROM base\r\n    GROUP BY 1\r\n)\r\n\r\nSELECT\r\n    base.touchpoint_id,\r\n    base.action,\r\n    base.action_time,\r\n    base.action_day,\r\n    base.asset_id,\r\n    base.email,\r\n    base.asset_title,\r\n    base.subject_line,\r\n    base.from_address,\r\n    base.clicked_url,\r\n    base.clickthrough_link_name,\r\n    base.referral_url,\r\n    base.event_id,\r\n    base.asset_type,\r\n    touchpoint_number,\r\n    linear_touches,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN 'OC' \r\n        ELSE null\r\n    END AS oc_position,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN 1\r\n        ELSE 0\r\n    END AS opp_creation_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .3 \r\n        WHEN linear_touches = 1 THEN .1\r\n        ELSE (.1/SUM(linear_touches-1))\r\n    END AS w_shaped_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .225 \r\n        WHEN linear_touches = 1 THEN .1\r\n        ELSE (.1/SUM(linear_touches-1))\r\n    END AS full_path_weight\r\nFROM base\r\nLEFT JOIN opp_creation_base ON\r\nbase.touchpoint_id=opp_creation_base.touchpoint_id\r\nLEFT JOIN linear_base ON \r\nbase.email=linear_base.email\r\n{{ dbt_utils.group_by(n=18) }}", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.group_by"], "nodes": ["model.acton_marketing_data.ao_combined", "model.acton_marketing_data.lead_to_cw_cohort"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "attribution", "attribution_models", "opportunity_creation2"], "unique_id": "model.acton_marketing_data.opportunity_creation2", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "attribution/attribution_models/opportunity_creation2.sql", "original_file_path": "models/attribution/attribution_models/opportunity_creation2.sql", "name": "opportunity_creation2", "alias": "opportunity_creation2", "checksum": {"name": "sha256", "checksum": "429574952a68eb826a2f0f53eb6e4009e7a73e78c24c62762e4db001ebacf361"}, "tags": [], "refs": [["ao_combined"], ["lead_to_cw_cohort"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5216873}, "model.acton_marketing_data.custom_model": {"raw_sql": "", "resource_type": "model", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "attribution", "attribution_models", "custom_model"], "unique_id": "model.acton_marketing_data.custom_model", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "attribution/attribution_models/custom_model.sql", "original_file_path": "models/attribution/attribution_models/custom_model.sql", "name": "custom_model", "alias": "custom_model", "checksum": {"name": "sha256", "checksum": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"}, "tags": [], "refs": [], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5273457}, "model.acton_marketing_data.combined_attribution2": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH ao_combined AS (\r\n\r\n   SELECT *\r\n   FROM {{ref('ao_combined')}} \r\n\r\n), lead_creation AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('lead_creation2')}}\r\n\r\n), first_touch AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('first_touch2')}}\r\n\r\n), last_touch AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('last_touch')}}\r\n\r\n), opportunity_creation AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('opportunity_creation2')}}\r\n\r\n), linear_base AS (\r\n\r\n    SELECT\r\n        email,\r\n        COUNT(DISTINCT touchpoint_id)::Decimal AS linear_touches\r\n    FROM ao_combined\r\n    GROUP BY 1\r\n        \r\n), linear_final AS (\r\n\r\n    SELECT\r\n        ao_combined.email,\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        1/linear_touches AS linear_weight\r\n    FROM ao_combined\r\n    LEFT JOIN linear_base ON \r\n    ao_combined.email=linear_base.email\r\n\r\n), unioned AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        0 AS first_touch_weight,\r\n        0 AS lead_creation_weight,\r\n        opp_creation_weight,\r\n        0 AS u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight\r\n    FROM opportunity_creation\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        0 AS first_touch_weight,\r\n        lead_creation_weight,\r\n        0 AS opp_creation_weight,\r\n        u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight\r\n    FROM lead_creation\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        first_touch_weight,\r\n        0 AS lead_creation_weight,\r\n        0 AS opp_creation_weight,\r\n        u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight\r\n    FROM first_touch\r\n\r\n), unioned_final AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        SUM(first_touch_weight) AS first_touch_weight,\r\n        SUM(lead_creation_weight) AS lead_creation_weight,\r\n        SUM(opp_creation_weight) AS opp_creation_weight,\r\n        SUM(u_shaped_weight) AS u_shaped_weight,\r\n        SUM(w_shaped_weight) AS w_shaped_weight,\r\n        SUM(full_path_weight) AS full_path_weight\r\n    FROM unioned\r\n    GROUP BY 1\r\n\r\n), final_prep AS (\r\n\r\n    SELECT\r\n        linear_final.touchpoint_id,\r\n        first_touch_weight,\r\n        lead_creation_weight,\r\n        opp_creation_weight,\r\n        u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight,\r\n        linear_weight\r\n    FROM linear_final\r\n    LEFT JOIN unioned_final ON\r\n    unioned_final.touchpoint_id=linear_final.touchpoint_id\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n    -- Key IDs\r\n        lead_to_cw_cohort.email,\r\n        ao_combined.touchpoint_id,\r\n        opportunity_id,\r\n        person_id,\r\n\r\n    -- Dates\r\n        person_created_date,\r\n        marketing_created_date,\r\n        mql_created_date,\r\n        sal_created_date,\r\n        opp_created_date,\r\n        discovery_date,\r\n        demo_date,\r\n        voc_date,\r\n        closing_date,\r\n        ao_combined.action_time,\r\n        ao_combined.action_day,\r\n\r\n    --Opportunity Information\r\n        lead_to_cw_cohort.acv,\r\n\r\n    --Touchpoint Information\r\n        ao_combined.action,\r\n        ao_combined.asset_id,\r\n        ao_combined.asset_title,\r\n        ao_combined.subject_line,\r\n        ao_combined.from_address,\r\n        ao_combined.clicked_url,\r\n        ao_combined.clickthrough_link_name,\r\n        ao_combined.referral_url,\r\n        ao_combined.event_id,\r\n        ao_combined.asset_type,\r\n        CONCAT_WS(',',first_touch.ft_position,lead_creation.lc_position,opportunity_creation.oc_position,last_touch.lt_position) AS touchpoint_position,\r\n\r\n    --Touchpoint Weights\r\n        final_prep.first_touch_weight,\r\n        final_prep.lead_creation_weight,\r\n        final_prep.opp_creation_weight,\r\n        final_prep.u_shaped_weight,\r\n        final_prep.w_shaped_weight,\r\n        final_prep.full_path_weight,\r\n        final_prep.linear_weight,\r\n\r\n    --Touchpoint ACV Weights\r\n        lead_to_cw_cohort.acv*final_prep.first_touch_weight AS first_touch_acv,\r\n        lead_to_cw_cohort.acv*final_prep.lead_creation_weight AS lead_creation_acv,\r\n        lead_to_cw_cohort.acv*final_prep.opp_creation_weight AS opp_creation_acv,\r\n        lead_to_cw_cohort.acv*final_prep.u_shaped_weight AS u_shaped_acv,\r\n        lead_to_cw_cohort.acv*final_prep.w_shaped_weight AS w_shaped_acv,\r\n        lead_to_cw_cohort.acv*final_prep.full_path_weight AS full_path_acv,\r\n        lead_to_cw_cohort.acv*final_prep.linear_weight AS linear_acv\r\n    FROM ao_combined\r\n    LEFT JOIN final_prep ON\r\n    ao_combined.touchpoint_id=final_prep.touchpoint_id\r\n    LEFT JOIN {{ref('lead_to_cw_cohort')}} ON\r\n    ao_combined.email=lead_to_cw_cohort.email\r\n    LEFT JOIN lead_creation ON \r\n    ao_combined.touchpoint_id=lead_creation.touchpoint_id\r\n    LEFT JOIN opportunity_creation ON \r\n    ao_combined.touchpoint_id=opportunity_creation.touchpoint_id\r\n    LEFT JOIN first_touch ON \r\n    ao_combined.touchpoint_id=first_touch.touchpoint_id\r\n    LEFT JOIN last_touch ON \r\n    ao_combined.touchpoint_id=last_touch.touchpoint_id\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.statement"], "nodes": ["model.acton_marketing_data.ao_combined", "model.acton_marketing_data.lead_creation2", "model.acton_marketing_data.first_touch2", "model.acton_marketing_data.last_touch", "model.acton_marketing_data.opportunity_creation2", "model.acton_marketing_data.lead_to_cw_cohort"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "attribution", "attribution_models", "combined_attribution2"], "unique_id": "model.acton_marketing_data.combined_attribution2", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "attribution/attribution_models/combined_attribution2.sql", "original_file_path": "models/attribution/attribution_models/combined_attribution2.sql", "name": "combined_attribution2", "alias": "combined_attribution2", "checksum": {"name": "sha256", "checksum": "e74be2568db1ad1151b27c2993c3e5e2686e2be9ec0bf417697f2771f200c845"}, "tags": [], "refs": [["ao_combined"], ["lead_creation2"], ["first_touch2"], ["last_touch"], ["opportunity_creation2"], ["lead_to_cw_cohort"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target/compiled/acton_marketing_data/models/attribution/attribution_models/combined_attribution2.sql", "build_path": "target/run/acton_marketing_data/models/attribution/attribution_models/combined_attribution2.sql", "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5294085, "compiled_sql": "\n\nWITH ao_combined AS (\n\n   SELECT *\n   FROM \"acton\".\"dbt_actonmarketing\".\"ao_combined\" \n\n), lead_creation AS (\n\n    SELECT *\n    FROM \"acton\".\"dbt_actonmarketing\".\"lead_creation2\"\n\n), first_touch AS (\n\n    SELECT *\n    FROM \"acton\".\"dbt_actonmarketing\".\"first_touch2\"\n\n), last_touch AS (\n\n    SELECT *\n    FROM \"acton\".\"dbt_actonmarketing\".\"last_touch\"\n\n), opportunity_creation AS (\n\n    SELECT *\n    FROM \"acton\".\"dbt_actonmarketing\".\"opportunity_creation2\"\n\n), linear_base AS (\n\n    SELECT\n        email,\n        COUNT(DISTINCT touchpoint_id)::Decimal AS linear_touches\n    FROM ao_combined\n    GROUP BY 1\n        \n), linear_final AS (\n\n    SELECT\n        ao_combined.email,\n        touchpoint_id,\n        action,\n        action_time,\n        action_day,\n        asset_id,\n        asset_title,\n        subject_line,\n        from_address,\n        clicked_url,\n        clickthrough_link_name,\n        referral_url,\n        event_id,\n        asset_type,\n        1/linear_touches AS linear_weight\n    FROM ao_combined\n    LEFT JOIN linear_base ON \n    ao_combined.email=linear_base.email\n\n), unioned AS (\n\n    SELECT\n        touchpoint_id,\n        0 AS first_touch_weight,\n        0 AS lead_creation_weight,\n        opp_creation_weight,\n        0 AS u_shaped_weight,\n        w_shaped_weight,\n        full_path_weight\n    FROM opportunity_creation\n    UNION ALL\n    SELECT\n        touchpoint_id,\n        0 AS first_touch_weight,\n        lead_creation_weight,\n        0 AS opp_creation_weight,\n        u_shaped_weight,\n        w_shaped_weight,\n        full_path_weight\n    FROM lead_creation\n    UNION ALL\n    SELECT\n        touchpoint_id,\n        first_touch_weight,\n        0 AS lead_creation_weight,\n        0 AS opp_creation_weight,\n        u_shaped_weight,\n        w_shaped_weight,\n        full_path_weight\n    FROM first_touch\n\n), unioned_final AS (\n\n    SELECT\n        touchpoint_id,\n        SUM(first_touch_weight) AS first_touch_weight,\n        SUM(lead_creation_weight) AS lead_creation_weight,\n        SUM(opp_creation_weight) AS opp_creation_weight,\n        SUM(u_shaped_weight) AS u_shaped_weight,\n        SUM(w_shaped_weight) AS w_shaped_weight,\n        SUM(full_path_weight) AS full_path_weight\n    FROM unioned\n    GROUP BY 1\n\n), final_prep AS (\n\n    SELECT\n        linear_final.touchpoint_id,\n        first_touch_weight,\n        lead_creation_weight,\n        opp_creation_weight,\n        u_shaped_weight,\n        w_shaped_weight,\n        full_path_weight,\n        linear_weight\n    FROM linear_final\n    LEFT JOIN unioned_final ON\n    unioned_final.touchpoint_id=linear_final.touchpoint_id\n\n), final AS (\n\n    SELECT\n    -- Key IDs\n        lead_to_cw_cohort.email,\n        ao_combined.touchpoint_id,\n        opportunity_id,\n        person_id,\n\n    -- Dates\n        person_created_date,\n        marketing_created_date,\n        mql_created_date,\n        sal_created_date,\n        opp_created_date,\n        discovery_date,\n        demo_date,\n        voc_date,\n        closing_date,\n        ao_combined.action_time,\n        ao_combined.action_day,\n\n    --Opportunity Information\n        lead_to_cw_cohort.acv,\n\n    --Touchpoint Information\n        ao_combined.action,\n        ao_combined.asset_id,\n        ao_combined.asset_title,\n        ao_combined.subject_line,\n        ao_combined.from_address,\n        ao_combined.clicked_url,\n        ao_combined.clickthrough_link_name,\n        ao_combined.referral_url,\n        ao_combined.event_id,\n        ao_combined.asset_type,\n        CONCAT_WS(',',first_touch.ft_position,lead_creation.lc_position,opportunity_creation.oc_position,last_touch.lt_position) AS touchpoint_position,\n\n    --Touchpoint Weights\n        final_prep.first_touch_weight,\n        final_prep.lead_creation_weight,\n        final_prep.opp_creation_weight,\n        final_prep.u_shaped_weight,\n        final_prep.w_shaped_weight,\n        final_prep.full_path_weight,\n        final_prep.linear_weight,\n\n    --Touchpoint ACV Weights\n        lead_to_cw_cohort.acv*final_prep.first_touch_weight AS first_touch_acv,\n        lead_to_cw_cohort.acv*final_prep.lead_creation_weight AS lead_creation_acv,\n        lead_to_cw_cohort.acv*final_prep.opp_creation_weight AS opp_creation_acv,\n        lead_to_cw_cohort.acv*final_prep.u_shaped_weight AS u_shaped_acv,\n        lead_to_cw_cohort.acv*final_prep.w_shaped_weight AS w_shaped_acv,\n        lead_to_cw_cohort.acv*final_prep.full_path_weight AS full_path_acv,\n        lead_to_cw_cohort.acv*final_prep.linear_weight AS linear_acv\n    FROM ao_combined\n    LEFT JOIN final_prep ON\n    ao_combined.touchpoint_id=final_prep.touchpoint_id\n    LEFT JOIN \"acton\".\"dbt_actonmarketing\".\"lead_to_cw_cohort\" ON\n    ao_combined.email=lead_to_cw_cohort.email\n    LEFT JOIN lead_creation ON \n    ao_combined.touchpoint_id=lead_creation.touchpoint_id\n    LEFT JOIN opportunity_creation ON \n    ao_combined.touchpoint_id=opportunity_creation.touchpoint_id\n    LEFT JOIN first_touch ON \n    ao_combined.touchpoint_id=first_touch.touchpoint_id\n    LEFT JOIN last_touch ON \n    ao_combined.touchpoint_id=last_touch.touchpoint_id\n\n)\n\nSELECT *\nFROM final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"acton\".\"dbt_actonmarketing\".\"combined_attribution2\""}, "model.acton_marketing_data.combined_attribution": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH ao_combined AS (\r\n\r\n   SELECT *\r\n   FROM {{ref('ao_combined')}} \r\n\r\n), lead_creation AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('lead_creation')}}\r\n\r\n), first_touch AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('first_touch')}}\r\n\r\n), last_touch AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('last_touch')}}\r\n\r\n), opportunity_creation AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('opportunity_creation')}}\r\n\r\n), linear_base AS (\r\n\r\n    SELECT\r\n        email,\r\n        COUNT(DISTINCT touchpoint_id)::Decimal AS linear_touches\r\n    FROM ao_combined\r\n    GROUP BY 1\r\n        \r\n), linear_final AS (\r\n\r\n    SELECT\r\n        ao_combined.email,\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        1/linear_touches AS linear_weight\r\n    FROM ao_combined\r\n    LEFT JOIN linear_base ON \r\n    ao_combined.email=linear_base.email\r\n\r\n), unioned AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        0 AS first_touch_weight,\r\n        0 AS lead_creation_weight,\r\n        opp_creation_weight,\r\n        0 AS u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight\r\n    FROM opportunity_creation\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        0 AS first_touch_weight,\r\n        lead_creation_weight,\r\n        0 AS opp_creation_weight,\r\n        u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight\r\n    FROM lead_creation\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        first_touch_weight,\r\n        0 AS lead_creation_weight,\r\n        0 AS opp_creation_weight,\r\n        u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight\r\n    FROM first_touch\r\n\r\n), unioned_final AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        SUM(first_touch_weight) AS first_touch_weight,\r\n        SUM(lead_creation_weight) AS lead_creation_weight,\r\n        SUM(opp_creation_weight) AS opp_creation_weight,\r\n        SUM(u_shaped_weight) AS u_shaped_weight,\r\n        SUM(w_shaped_weight) AS w_shaped_weight,\r\n        SUM(full_path_weight) AS full_path_weight\r\n    FROM unioned\r\n    GROUP BY 1\r\n\r\n), final_prep AS (\r\n\r\n    SELECT\r\n        linear_final.touchpoint_id,\r\n        first_touch_weight,\r\n        lead_creation_weight,\r\n        opp_creation_weight,\r\n        u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight,\r\n        linear_weight\r\n    FROM linear_final\r\n    LEFT JOIN unioned_final ON\r\n    unioned_final.touchpoint_id=linear_final.touchpoint_id\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n    -- Key IDs\r\n        lead_to_cw_cohort.email,\r\n        ao_combined.touchpoint_id,\r\n        opportunity_id,\r\n        person_id,\r\n\r\n    -- Dates\r\n        person_created_date,\r\n        marketing_created_date,\r\n        mql_created_date,\r\n        sal_created_date,\r\n        opp_created_date,\r\n        discovery_date,\r\n        demo_date,\r\n        voc_date,\r\n        closing_date,\r\n        ao_combined.action_time,\r\n        ao_combined.action_day,\r\n\r\n    --Opportunity Information\r\n        lead_to_cw_cohort.acv,\r\n\r\n    --Touchpoint Information\r\n        ao_combined.action,\r\n        ao_combined.asset_id,\r\n        ao_combined.asset_title,\r\n        ao_combined.subject_line,\r\n        ao_combined.from_address,\r\n        ao_combined.clicked_url,\r\n        ao_combined.clickthrough_link_name,\r\n        ao_combined.referral_url,\r\n        ao_combined.event_id,\r\n        ao_combined.asset_type,\r\n        CONCAT_WS(',',first_touch.ft_position,lead_creation.lc_position,opportunity_creation.oc_position,last_touch.lt_position) AS touchpoint_position,\r\n\r\n    --Touchpoint Weights\r\n        final_prep.first_touch_weight,\r\n        final_prep.lead_creation_weight,\r\n        final_prep.opp_creation_weight,\r\n        final_prep.u_shaped_weight,\r\n        final_prep.w_shaped_weight,\r\n        final_prep.full_path_weight,\r\n        final_prep.linear_weight,\r\n\r\n    --Touchpoint ACV Weights\r\n        lead_to_cw_cohort.acv*final_prep.first_touch_weight AS first_touch_acv,\r\n        lead_to_cw_cohort.acv*final_prep.lead_creation_weight AS lead_creation_acv,\r\n        lead_to_cw_cohort.acv*final_prep.opp_creation_weight AS opp_creation_acv,\r\n        lead_to_cw_cohort.acv*final_prep.u_shaped_weight AS u_shaped_acv,\r\n        lead_to_cw_cohort.acv*final_prep.w_shaped_weight AS w_shaped_acv,\r\n        lead_to_cw_cohort.acv*final_prep.full_path_weight AS full_path_acv,\r\n        lead_to_cw_cohort.acv*final_prep.linear_weight AS linear_acv\r\n    FROM ao_combined\r\n    LEFT JOIN final_prep ON\r\n    ao_combined.touchpoint_id=final_prep.touchpoint_id\r\n    LEFT JOIN {{ref('lead_to_cw_cohort')}} ON\r\n    ao_combined.email=lead_to_cw_cohort.email\r\n    LEFT JOIN lead_creation ON \r\n    ao_combined.touchpoint_id=lead_creation.touchpoint_id\r\n    LEFT JOIN opportunity_creation ON \r\n    ao_combined.touchpoint_id=opportunity_creation.touchpoint_id\r\n    LEFT JOIN first_touch ON \r\n    ao_combined.touchpoint_id=first_touch.touchpoint_id\r\n    LEFT JOIN last_touch ON \r\n    ao_combined.touchpoint_id=last_touch.touchpoint_id\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.ao_combined", "model.acton_marketing_data.lead_creation", "model.acton_marketing_data.first_touch", "model.acton_marketing_data.last_touch", "model.acton_marketing_data.opportunity_creation", "model.acton_marketing_data.lead_to_cw_cohort"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "attribution", "attribution_models", "combined_attribution"], "unique_id": "model.acton_marketing_data.combined_attribution", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "attribution/attribution_models/combined_attribution.sql", "original_file_path": "models/attribution/attribution_models/combined_attribution.sql", "name": "combined_attribution", "alias": "combined_attribution", "checksum": {"name": "sha256", "checksum": "4b62aa2512ef4e7d5cdeae6d05db1868a1a563418bea919ccd69a056a59fa112"}, "tags": [], "refs": [["ao_combined"], ["lead_creation"], ["first_touch"], ["last_touch"], ["opportunity_creation"], ["lead_to_cw_cohort"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5324051}, "model.acton_marketing_data.opportunity_creation": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type\r\n    FROM {{ref('ao_combined')}}\r\n\r\n), opp_creation_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        base.email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        ROW_NUMBER() OVER (PARTITION BY cohort.opportunity_id ORDER BY action_time ASC ) AS touchpoint_number\r\n    FROM base\r\n    LEFT JOIN {{ref('lead_to_cw_cohort')}} cohort ON\r\n    base.email=cohort.email\r\n    WHERE action_day=cohort.opp_created_date\r\n\r\n)\r\n\r\nSELECT\r\n    touchpoint_id,\r\n    action,\r\n    action_time,\r\n    action_day,\r\n    asset_id,\r\n    email,\r\n    asset_title,\r\n    subject_line,\r\n    from_address,\r\n    clicked_url,\r\n    clickthrough_link_name,\r\n    referral_url,\r\n    event_id,\r\n    asset_type,\r\n    'OC' AS oc_position,\r\n    1 AS opp_creation_weight,\r\n    .3 AS w_shaped_weight,\r\n    .225 AS full_path_weight\r\nFROM opp_creation_base\r\nWHERE touchpoint_number = 1", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.ao_combined", "model.acton_marketing_data.lead_to_cw_cohort"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "attribution", "attribution_models", "opportunity_creation"], "unique_id": "model.acton_marketing_data.opportunity_creation", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "attribution/attribution_models/opportunity_creation.sql", "original_file_path": "models/attribution/attribution_models/opportunity_creation.sql", "name": "opportunity_creation", "alias": "opportunity_creation", "checksum": {"name": "sha256", "checksum": "678b9419db9434b3503cdf0314e23d8ca938fe0782fa1d8bf4e2c3d572acd55f"}, "tags": [], "refs": [["ao_combined"], ["lead_to_cw_cohort"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5351326}, "model.acton_marketing_data.customer_power_ups": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        campaign_member.campaign_id,\r\n        campaign.campaign_name,\r\n        campaign_member.lead_or_contact_id,\r\n        campaign_member.campaign_member_id,\r\n        campaign_member.campaign_member_status,\r\n        campaign_member.campaign_member_created_date,\r\n        person.lean_data_account_id AS account_id,\r\n        person.created_date,\r\n        COALESCE(account.account_name,person.company) AS account_name,\r\n        account.account_owner_name,\r\n        account.account_csm_name,\r\n        COALESCE(account.global_region,person.global_region) AS global_region,\r\n        account.executive_sponsor,\r\n        account.assigned_account_tier,\r\n        account.customer_since,\r\n        account.renewal_date,\r\n        account.business_model,\r\n        account.contract_type,\r\n        account.delivered_support_tier,\r\n        COALESCE(account.industry,person.industry) AS industry,\r\n        COALESCE(account.company_size_rev,person.company_size_rev) AS company_size_rev,\r\n        COALESCE(account.segment,person.segment) AS segment,\r\n        account.account_type,\r\n        account.is_current_customer,\r\n        campaign_influence.influence_opportunity_id AS opportunity_id,\r\n        opp.acv AS acv_deal_size_usd,\r\n        opp.opportunity_name,\r\n        opp.is_won,\r\n        CASE \r\n            WHEN is_won = true THEN influence_opportunity_id\r\n            END AS won_opportunity_id,\r\n        CASE \r\n            WHEN is_won = true THEN acv\r\n            END AS won_opportunity_acv\r\nFROM {{ref('campaign_member_source_xf')}} campaign_member\r\nLEFT JOIN {{ref('campaign_source_xf')}} campaign\r\nON campaign_member.campaign_id=campaign.campaign_id\r\nLEFT JOIN {{ref('person_source_xf')}} person\r\nON campaign_member.lead_or_contact_id=person.person_id\r\nLEFT JOIN {{ref('account_source_xf')}} account\r\nON person.lean_data_account_id=account.account_id\r\nLEFT JOIN {{ref('campaign_influence_xf')}} campaign_influence\r\nON campaign_member.campaign_id=campaign_influence.influence_campaign_id\r\nAND campaign_influence.influence_contact_id=person.person_id\r\nLEFT JOIN {{ref('opp_source_xf')}} opp\r\nON campaign_influence.influence_opportunity_id=opp.opportunity_id\r\nWHERE campaign.parent_campaign_id LIKE '7015Y000002UBBi%'\r\nAND campaign_member_status NOT IN ('Initial','Sent')\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.campaign_member_source_xf", "model.acton_marketing_data.campaign_source_xf", "model.acton_marketing_data.person_source_xf", "model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.campaign_influence_xf", "model.acton_marketing_data.opp_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "customer_marketing", "customer_power_ups"], "unique_id": "model.acton_marketing_data.customer_power_ups", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "customer_marketing/customer_power_ups.sql", "original_file_path": "models/customer_marketing/customer_power_ups.sql", "name": "customer_power_ups", "alias": "customer_power_ups", "checksum": {"name": "sha256", "checksum": "94bbf8ae330f800d9c00daf25058312f6fc47bbd84e5890d9d0125f272b22c4f"}, "tags": [], "refs": [["campaign_member_source_xf"], ["campaign_source_xf"], ["person_source_xf"], ["account_source_xf"], ["campaign_influence_xf"], ["opp_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5375674}, "model.acton_marketing_data.new_account_welcome_series_list": {"raw_sql": "WITH opp_and_acct_base AS (\r\n\r\n    SELECT\r\n        opportunity_id,\r\n        opp_source_xf.account_id,\r\n        opportunity_name,\r\n        customer_since,\r\n        account_csm_name,\r\n        account_csm_email,\r\n        account_csm_photo,\r\n        onboarding.user_name AS onboarding_specialist,\r\n        onboarding_specialist_email,\r\n        onboarding_specialist_photo,\r\n        owner.user_name AS account_owner,\r\n        account_owner_email,\r\n        account_owner_photo,\r\n        onboarding_completion_date,\r\n        opp_source_xf.close_date\r\n    FROM {{ref('opp_source_xf')}}\r\n    LEFT JOIN {{ref('account_source_xf')}} ON\r\n    opp_source_xf.account_id=account_source_xf.account_id\r\n    LEFT JOIN {{ref('user_source_xf')}} owner ON\r\n    account_source_xf.account_owner_id=owner.user_id\r\n    LEFT JOIN {{ref('user_source_xf')}} onboarding ON\r\n    account_source_xf.onboarding_specialist=onboarding.user_id\r\n    WHERE stage_name = 'Implement'\r\n   -- AND is_current_customer = 'true'\r\n    AND opp_source_xf.account_id != '0011O00002LeGkEQAV'\r\n    AND account_type != 'Partner Owned'\r\n\r\n)\r\n\r\nSELECT DISTINCT\r\n    opp_and_acct_base.opportunity_id,\r\n    opp_and_acct_base.account_id,\r\n    opp_and_acct_base.opportunity_name,\r\n    opp_and_acct_base.customer_since,\r\n    CASE \r\n        WHEN opp_and_acct_base.account_csm_name IS null THEN 'Support'\r\n        ELSE opp_and_acct_base.account_csm_name \r\n    END AS account_csm_name,\r\n    CASE \r\n        WHEN opp_and_acct_base.account_csm_email IS null THEN 'support@act-on.com'\r\n        ELSE opp_and_acct_base.account_csm_email \r\n    END AS account_csm_email,\r\n    CASE \r\n        WHEN opp_and_acct_base.account_csm_photo IS null THEN 'https://success.act-on.com/cdnr/forpcid1/acton/attachment/9883/f-fa8432de-9cea-4bf7-b6d4-eca1c9656b82/1/-/-/-/-/NewUserWelcomeSeries-EM3-Support.png'\r\n        ELSE opp_and_acct_base.account_csm_photo \r\n    END AS account_csm_photo,\r\n    CASE\r\n        WHEN opp_and_acct_base.onboarding_specialist IS null THEN 'marjorie.waniata@act-on.com'\r\n        ELSE opp_and_acct_base.onboarding_specialist\r\n    END AS onboarding_specialist,\r\n    CASE\r\n        WHEN opp_and_acct_base.onboarding_specialist_email IS null THEN 'marjorie.waniata@act-on.com'\r\n        ELSE opp_and_acct_base.onboarding_specialist_email\r\n    END AS onboarding_specialist_email,\r\n    CASE \r\n        WHEN opp_and_acct_base.onboarding_specialist_photo IS null THEN 'https://success.act-on.com/cdnr/forpcid1/acton/attachment/9883/f-776f2a0d-032b-406f-9b3b-f4990bc2e601/1/-/-/-/-/Marj_Waniata.png'\r\n        ELSE opp_and_acct_base.onboarding_specialist_photo\r\n    END AS onboarding_specialist_photo,\r\n    opp_and_acct_base.account_owner,\r\n    opp_and_acct_base.account_owner_email,\r\n    opp_and_acct_base.account_owner_photo,\r\n    contact_source_xf.first_name AS \"First Name\",\r\n    contact_source_xf.last_name AS \"Last Name\",\r\n    contact_source_xf.email AS \"Email\",\r\n    ao_instance_user_source_xf.ao_user_name,\r\n    ao_instance_user_source_xf.ao_user_id,\r\n    ao_instance_user_source_xf.is_marketing_user,\r\n    opp_and_acct_base.onboarding_completion_date,\r\n    ao_instance_user_source_xf.ao_user_created_date\r\nFROM {{ref('ao_instance_user_source_xf')}}\r\nLEFT JOIN {{ref('contact_source_xf')}} ON\r\ncontact_source_xf.contact_id=ao_instance_user_source_xf.ao_user_contact_id\r\nLEFT JOIN opp_and_acct_base ON\r\nopp_and_acct_base.account_id=contact_source_xf.account_id\r\nWHERE 1=1\r\nAND is_marketing_user = 'true'\r\nAND customer_since > CURRENT_DATE-60\r\nAND ao_user_created_date >= '2022-06-01'", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.ao_instance_user_source_xf", "model.acton_marketing_data.contact_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "customer_marketing", "new_user", "new_account_welcome_series_list"], "unique_id": "model.acton_marketing_data.new_account_welcome_series_list", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "customer_marketing/new_user/new_account_welcome_series_list.sql", "original_file_path": "models/customer_marketing/new_user/new_account_welcome_series_list.sql", "name": "new_account_welcome_series_list", "alias": "new_account_welcome_series_list", "checksum": {"name": "sha256", "checksum": "20a69e57fafad5f87ac365a1d0dfda030a288bc31cf6514fb5b9e5adc5c885c4"}, "tags": [], "refs": [["opp_source_xf"], ["account_source_xf"], ["user_source_xf"], ["user_source_xf"], ["ao_instance_user_source_xf"], ["contact_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5401556}, "model.acton_marketing_data.new_user_welcome_series_list": {"raw_sql": "WITH opp_and_acct_base AS (\r\n\r\n    SELECT\r\n        opportunity_id,\r\n        opp_source_xf.account_id,\r\n        opportunity_name,\r\n        customer_since,\r\n        account_csm_name,\r\n        account_csm_email,\r\n        account_csm_photo,\r\n        onboarding.user_name AS onboarding_specialist,\r\n        onboarding_specialist_email,\r\n        onboarding_specialist_photo,\r\n        owner.user_name AS account_owner,\r\n        account_owner_email,\r\n        account_owner_photo,\r\n        onboarding_completion_date,\r\n        opp_source_xf.close_date\r\n    FROM {{ref('opp_source_xf')}}\r\n    LEFT JOIN {{ref('account_source_xf')}} ON\r\n    opp_source_xf.account_id=account_source_xf.account_id\r\n    LEFT JOIN {{ref('user_source_xf')}} owner ON\r\n    account_source_xf.account_owner_id=owner.user_id\r\n    LEFT JOIN {{ref('user_source_xf')}} onboarding ON\r\n    account_source_xf.onboarding_specialist=onboarding.user_id\r\n    WHERE stage_name = 'Implement'\r\n   -- AND is_current_customer = 'true'\r\n    AND opp_source_xf.account_id != '0011O00002LeGkEQAV'\r\n    AND account_type != 'Partner Owned'\r\n\r\n)\r\n\r\nSELECT DISTINCT\r\n    opp_and_acct_base.opportunity_id,\r\n    opp_and_acct_base.account_id,\r\n    opp_and_acct_base.opportunity_name,\r\n    opp_and_acct_base.customer_since,\r\n    CASE \r\n        WHEN opp_and_acct_base.account_csm_name IS null THEN 'Support'\r\n        ELSE opp_and_acct_base.account_csm_name \r\n    END AS account_csm_name,\r\n    CASE \r\n        WHEN opp_and_acct_base.account_csm_email IS null THEN 'support@act-on.com'\r\n        ELSE opp_and_acct_base.account_csm_email \r\n    END AS account_csm_email,\r\n    CASE \r\n        WHEN opp_and_acct_base.account_csm_photo IS null THEN 'https://success.act-on.com/cdnr/forpcid1/acton/attachment/9883/f-fa8432de-9cea-4bf7-b6d4-eca1c9656b82/1/-/-/-/-/NewUserWelcomeSeries-EM3-Support.png'\r\n        ELSE opp_and_acct_base.account_csm_photo \r\n    END AS account_csm_photo,\r\n    opp_and_acct_base.onboarding_specialist,\r\n    opp_and_acct_base.onboarding_specialist_email,\r\n    opp_and_acct_base.onboarding_specialist_photo,\r\n    opp_and_acct_base.account_owner,\r\n    opp_and_acct_base.account_owner_email,\r\n    opp_and_acct_base.account_owner_photo,\r\n    contact_source_xf.first_name AS \"First Name\",\r\n    contact_source_xf.last_name AS \"Last Name\",\r\n    contact_source_xf.email AS \"Email\",\r\n    ao_instance_user_source_xf.ao_user_name,\r\n    ao_instance_user_source_xf.ao_user_id,\r\n    ao_instance_user_source_xf.is_marketing_user,\r\n    opp_and_acct_base.onboarding_completion_date,\r\n    ao_instance_user_source_xf.ao_user_created_date\r\nFROM {{ref('ao_instance_user_source_xf')}}\r\nLEFT JOIN {{ref('contact_source_xf')}} ON\r\ncontact_source_xf.contact_id=ao_instance_user_source_xf.ao_user_contact_id\r\nLEFT JOIN opp_and_acct_base ON\r\nopp_and_acct_base.account_id=contact_source_xf.account_id\r\nWHERE 1=1\r\nAND is_marketing_user = 'true'\r\nAND customer_since >= '2022-01-01'\r\nAND customer_since < CURRENT_DATE-60\r\nAND ao_user_created_date >= '2022-06-01'", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.ao_instance_user_source_xf", "model.acton_marketing_data.contact_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "customer_marketing", "new_user", "new_user_welcome_series_list"], "unique_id": "model.acton_marketing_data.new_user_welcome_series_list", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "customer_marketing/new_user/new_user_welcome_series_list.sql", "original_file_path": "models/customer_marketing/new_user/new_user_welcome_series_list.sql", "name": "new_user_welcome_series_list", "alias": "new_user_welcome_series_list", "checksum": {"name": "sha256", "checksum": "1c2071f6e59a1ce49ef85cac088c55404456fe6b517040bba456442f1d0e85c2"}, "tags": [], "refs": [["opp_source_xf"], ["account_source_xf"], ["user_source_xf"], ["user_source_xf"], ["ao_instance_user_source_xf"], ["contact_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5437944}, "model.acton_marketing_data.sal_source_ss_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    lead_id,\r\n    email,\r\n    lead_source,\r\n    is_converted,\r\n    is_hand_raiser,\r\n    working_date,\r\n    mql_most_recent_date,\r\n    lead_status,\r\n    country,\r\n    global_region\r\nFROM {{ref('lead_source_ss_xf')}}\r\nWHERE lead_owner != '00Ga0000003Nugr'\r\nAND working_date IS NOT null\r\nAND email NOT LIKE '%act-on.com'\r\nAND lead_source = 'Marketing'\r\nAND lead_status = 'Working'\r\n--AND lead_status  NOT IN ('Current Customer','Partner','Bad Data','No Fit')", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.lead_source_ss_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "sal_source_ss_xf"], "unique_id": "model.acton_marketing_data.sal_source_ss_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/sal_source_ss_xf.sql", "original_file_path": "models/kpi_definitions/sal_source_ss_xf.sql", "name": "sal_source_ss_xf", "alias": "sal_source_ss_xf", "checksum": {"name": "sha256", "checksum": "d9055d1ee100899f0e669b39a300eecfbed8f5650a00df5c5da14a028216005f"}, "tags": [], "refs": [["lead_source_ss_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5472667}, "model.acton_marketing_data.sql_source_ss_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    opportunity_id AS sql_id,\r\n    opportunity_name,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    created_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    opp_channel_opportunity_creation, \r\n    opp_medium_opportunity_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_lead_creation,\r\n    type,\r\n    billing_country AS country,\r\n    opp_source_xf.company_size_rev,\r\n    account_global_region\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE created_date IS NOT null\r\n--AND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed')\r\nAND stage_name = 'SQL'", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.account_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "sql_source_ss_xf"], "unique_id": "model.acton_marketing_data.sql_source_ss_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/sql_source_ss_xf.sql", "original_file_path": "models/kpi_definitions/sql_source_ss_xf.sql", "name": "sql_source_ss_xf", "alias": "sql_source_ss_xf", "checksum": {"name": "sha256", "checksum": "99da8244b85479598375dd19a62aa94ae619381b412cf18939de13339a4dbda0"}, "tags": [], "refs": [["opp_source_xf"], ["account_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.55065}, "model.acton_marketing_data.opp_closing_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    opportunity_id,\r\n    opportunity_name,\r\n    user_name AS owner_name,\r\n    opp_source_xf.account_name,\r\n    owner_id,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    closing_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    CASE \r\n        WHEN type in ('New Business') THEN 'New Business'\r\n        WHEN type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') THEN 'Upsell'\r\n        ELSE null\r\n    END AS grouped_type,\r\n    opp_channel_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_opportunity_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_source_lead_creation,\r\n    type,\r\n    acv_deal_size_usd AS acv,\r\n    billing_country AS country,\r\n    account_global_region,\r\n    opp_source_xf.company_size_rev,\r\n    opp_source_xf.segment,\r\n    opp_source_xf.industry,\r\n    opp_source_xf.industry_bucket,\r\n    opp_source_xf.channel_bucket,\r\n    opp_source_xf.opp_offer_asset_name_lead_creation\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE closing_date IS NOT null\r\nAND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery','Demo','VOC/Negotiate','Implement')", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.account_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "opp_closing_source_xf"], "unique_id": "model.acton_marketing_data.opp_closing_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/opp_closing_source_xf.sql", "original_file_path": "models/kpi_definitions/opp_closing_source_xf.sql", "name": "opp_closing_source_xf", "alias": "opp_closing_source_xf", "checksum": {"name": "sha256", "checksum": "0354ae58abdb43172e24994d49ea5ea3d6925d6436ddc374b17d4030a1330e0a"}, "tags": [], "refs": [["opp_source_xf"], ["user_source_xf"], ["account_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5527449}, "model.acton_marketing_data.person_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    -- Key ID\r\n    lead_id AS person_id,\r\n\r\n    -- Firmographic Information\r\n    email,\r\n    first_name,\r\n    last_name,\r\n    title,\r\n    country,\r\n    lead_status AS person_status,\r\n    global_region,\r\n\r\n    -- Account Information\r\n    company,\r\n    annual_revenue,\r\n    lean_data_account_id,\r\n    current_crm,\r\n    current_ma,\r\n    company_size_rev,\r\n    industry,\r\n    industry_bucket,\r\n    segment,\r\n\r\n    -- DateTime Fields\r\n    last_modified_date,\r\n    created_date,\r\n    mql_created_date,\r\n    mql_most_recent_date,\r\n    working_date,\r\n    marketing_created_date,\r\n\r\n    -- Other Key Information    \r\n    lead_source,    \r\n    lead_owner_id AS person_owner_id,\r\n    lead_score,\r\n    firmographic_demographic_lead_score,\r\n    no_longer_with_company,\r\n    CASE\r\n        WHEN is_hand_raiser = true THEN 'Yes'\r\n        ELSE 'No'\r\n    END AS is_hand_raiser,\r\n    created_by_name,\r\n\r\n    --Attribution Data\r\n    campaign_first_touch,\r\n    campaign_last_touch,\r\n    campaign_lead_creation,\r\n    channel_first_touch,\r\n    channel_last_touch,\r\n    channel_lead_creation,\r\n    medium_first_touch,\r\n    medium_last_touch,\r\n    medium_lead_creation,\r\n    source_first_touch,\r\n    source_last_touch, \r\n    source_lead_creation,    \r\n    subchannel_first_touch,\r\n    subchannel_last_touch,\r\n    subchannel_lead_creation,\r\n    offer_asset_name_first_touch,\r\n    offer_asset_name_last_touch,\r\n    offer_asset_name_lead_creation,\r\n    offer_asset_subtype_first_touch,\r\n    offer_asset_subtype_last_touch,\r\n    offer_asset_subtype_lead_creation,\r\n    offer_asset_topic_first_touch,\r\n    offer_asset_topic_last_touch,\r\n    offer_asset_topic_lead_creation,\r\n    offer_asset_type_first_touch,\r\n    offer_asset_type_last_touch,\r\n    offer_asset_type_lead_creation,\r\n    channel_bucket\r\nFROM {{ref('lead_source_xf')}}\r\nWHERE is_converted = FALSE\r\nAND is_deleted = FALSE\r\nUNION ALL\r\nSELECT\r\n    -- Key ID\r\n    contact_id AS person_id,\r\n\r\n    -- Firmographic Information\r\n    email,\r\n    first_name,\r\n    last_name,\r\n    title,\r\n    mailing_country,\r\n    contact_status AS person_status,\r\n    global_region,\r\n\r\n    -- Account Information\r\n    account_name,\r\n    annual_revenue,\r\n    account_id,\r\n    de_current_crm,\r\n    de_current_ma,\r\n    company_size_rev,\r\n    industry,\r\n    industry_bucket,\r\n    segment,\r\n    \r\n    -- DateTime Fields\r\n    last_modified_date,\r\n    created_date,\r\n    mql_created_date,\r\n    mql_most_recent_date,\r\n    working_date,\r\n    marketing_created_date,\r\n\r\n    -- Other Key Information    \r\n    lead_source,    \r\n    contact_owner_id AS person_owner_id,\r\n    lead_score,\r\n    firmographic_demographic_lead_score,\r\n    is_no_longer_with_company,\r\n    CASE\r\n        WHEN is_hand_raiser = true THEN 'Yes'\r\n        ELSE 'No'\r\n    END AS is_hand_raiser,\r\n    created_by_name,\r\n\r\n    --Attribution Data\r\n    campaign_first_touch,\r\n    campaign_last_touch,\r\n    campaign_lead_creation,\r\n    channel_first_touch,\r\n    channel_last_touch,\r\n    channel_lead_creation,\r\n    medium_first_touch,\r\n    medium_last_touch,\r\n    medium_lead_creation,\r\n    source_first_touch,\r\n    source_last_touch, \r\n    source_lead_creation,    \r\n    subchannel_first_touch,\r\n    subchannel_last_touch,\r\n    subchannel_lead_creation,\r\n    offer_asset_name_first_touch,\r\n    offer_asset_name_last_touch,\r\n    offer_asset_name_lead_creation,\r\n    offer_asset_subtype_first_touch,\r\n    offer_asset_subtype_last_touch,\r\n    offer_asset_subtype_lead_creation,\r\n    offer_asset_topic_first_touch,\r\n    offer_asset_topic_last_touch,\r\n    offer_asset_topic_lead_creation,\r\n    offer_asset_type_first_touch,\r\n    offer_asset_type_last_touch,\r\n    offer_asset_type_lead_creation,\r\n    channel_bucket\r\nFROM {{ref('contact_source_xf')}}\r\nWHERE is_deleted = FALSE", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.lead_source_xf", "model.acton_marketing_data.contact_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "person_source_xf"], "unique_id": "model.acton_marketing_data.person_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/person_source_xf.sql", "original_file_path": "models/kpi_definitions/person_source_xf.sql", "name": "person_source_xf", "alias": "person_source_xf", "checksum": {"name": "sha256", "checksum": "badfb838bb95595a1ee7c694d6d48820f868415a1d82c01f9aca08ce0fdf5f87"}, "tags": [], "refs": [["lead_source_xf"], ["contact_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5551474}, "model.acton_marketing_data.lead_mql_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    person_id,\r\n    email,\r\n    is_hand_raiser,\r\n    mql_created_date,\r\n    mql_most_recent_date,\r\n    working_date,\r\n    person_status,\r\n    country,\r\n    company,\r\n    first_name,\r\n    last_name,\r\n    title,\r\n    person_owner_id,\r\n    global_region,\r\n    company_size_rev,\r\n    lead_source,\r\n    segment,\r\n    industry,\r\n    industry_bucket,\r\n    channel_bucket,\r\n    offer_asset_name_lead_creation,\r\n    campaign_lead_creation\r\nFROM {{ref('person_source_xf')}}\r\nWHERE mql_most_recent_date IS NOT null\r\nAND person_owner_id != '00Ga0000003Nugr' -- AO-Fake Leads\r\nAND email NOT LIKE '%act-on.com'\r\n--AND lead_source = 'Marketing'", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.person_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "lead_mql_source_xf"], "unique_id": "model.acton_marketing_data.lead_mql_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/lead_mql_source_xf.sql", "original_file_path": "models/kpi_definitions/lead_mql_source_xf.sql", "name": "lead_mql_source_xf", "alias": "lead_mql_source_xf", "checksum": {"name": "sha256", "checksum": "7ba5a0f14e1c0cde1b519c6e6754e801357cc3b9e13e3771f745fc7e1f8e6fdb"}, "tags": [], "refs": [["person_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5573127}, "model.acton_marketing_data.opp_voc_source_ss_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    opportunity_id,\r\n    opportunity_name,\r\n    user_name AS owner_name,\r\n    owner_id,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    negotiation_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    CASE \r\n        WHEN type in ('New Business') THEN 'New Business'\r\n        WHEN type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') THEN 'Upsell'\r\n        ELSE null\r\n    END AS grouped_type,\r\n    opp_channel_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_opportunity_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_source_lead_creation,\r\n    type,\r\n    acv_deal_size_usd AS acv,\r\n    billing_country AS country,\r\n    account_global_region\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE negotiation_date IS NOT null\r\nAND stage_name = 'VOC/Negotiate'\r\n--AND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery','Demo')", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.account_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "opp_voc_source_ss_xf"], "unique_id": "model.acton_marketing_data.opp_voc_source_ss_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/opp_voc_source_ss_xf.sql", "original_file_path": "models/kpi_definitions/opp_voc_source_ss_xf.sql", "name": "opp_voc_source_ss_xf", "alias": "opp_voc_source_ss_xf", "checksum": {"name": "sha256", "checksum": "323de433b2306f8d22828b356dd7bbc868066934ab83826eb9f13524c558e4b3"}, "tags": [], "refs": [["opp_source_xf"], ["user_source_xf"], ["account_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5593357}, "model.acton_marketing_data.sqo_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\nopportunity_id,\r\nopportunity_name,\r\nuser_name AS owner_name,\r\nopp_source_xf.account_name,\r\nsdr_name,\r\nowner_id,\r\nopp_source_xf.is_closed,\r\nopp_source_xf.is_won,\r\ndiscovery_date,\r\ncreated_date,\r\nclose_day AS close_date,\r\nstage_name,\r\nopp_lead_source,\r\ncase \r\nwhen type in ('New Business') then 'New Business'\r\nwhen type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') then 'Upsell'\r\nelse null\r\nend as grouped_type,\r\nopp_channel_opportunity_creation, \r\nopp_channel_lead_creation,\r\nopp_medium_opportunity_creation,\r\nopp_medium_lead_creation,\r\nopp_source_opportunity_creation, \r\nopp_source_lead_creation,\r\ntype,\r\nacv_deal_size_usd AS acv,\r\nbilling_country AS country,\r\naccount_global_region,\r\nopp_source_xf.segment,\r\nopp_source_xf.industry,\r\nopp_source_xf.industry_bucket,\r\nchannel_bucket,\r\nopp_source_xf.company_size_rev,\r\nopp_source_xf.opp_offer_asset_name_lead_creation\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE discovery_date IS NOT null\r\nAND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','SQL - No Opportunity')\r\n--AND type = 'New Business'", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.account_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "sqo_source_xf"], "unique_id": "model.acton_marketing_data.sqo_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/sqo_source_xf.sql", "original_file_path": "models/kpi_definitions/sqo_source_xf.sql", "name": "sqo_source_xf", "alias": "sqo_source_xf", "checksum": {"name": "sha256", "checksum": "5443b5f02767cfba03565630c13fd34b6e790f7dbc26287c780971e48d6b88a3"}, "tags": [], "refs": [["opp_source_xf"], ["user_source_xf"], ["account_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5631275}, "model.acton_marketing_data.opp_demo_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    opportunity_id,\r\n    opportunity_name,\r\n    user_name AS owner_name,\r\n    opp_source_xf.account_name,\r\n    owner_id,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    demo_date,\r\n    solution_date,\r\n    confirmed_value_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    CASE \r\n        WHEN type in ('New Business') THEN 'New Business'\r\n        WHEN type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') THEN 'Upsell'\r\n        ELSE null\r\n    END AS grouped_type,\r\n    opp_channel_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_opportunity_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_source_lead_creation,\r\n    type,\r\n    acv_deal_size_usd AS acv,\r\n    billing_country AS country,\r\n    account_global_region,\r\n    opp_source_xf.company_size_rev,\r\n    opp_source_xf.segment,\r\n    opp_source_xf.industry,\r\n    opp_source_xf.industry_bucket,\r\n    opp_source_xf.channel_bucket,\r\n    opp_source_xf.opp_offer_asset_name_lead_creation\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE demo_date IS NOT null\r\n--AND stage_name = 'Demo'\r\nAND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery','Implement')", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.account_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "opp_demo_source_xf"], "unique_id": "model.acton_marketing_data.opp_demo_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/opp_demo_source_xf.sql", "original_file_path": "models/kpi_definitions/opp_demo_source_xf.sql", "name": "opp_demo_source_xf", "alias": "opp_demo_source_xf", "checksum": {"name": "sha256", "checksum": "b0bfdfa1be3382b3935a7486159b5bd03270bf647f938aa380e99aca7b2075c1"}, "tags": [], "refs": [["opp_source_xf"], ["user_source_xf"], ["account_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.565635}, "model.acton_marketing_data.opp_sales_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\nopportunity_id,\r\nopportunity_name,\r\nopp_source_xf.account_name,\r\nuser_name AS owner_name,\r\nclose_day AS close_date,\r\nopp_lead_source,\r\nopp_channel_opportunity_creation, \r\nopp_medium_opportunity_creation,\r\nopp_source_opportunity_creation, \r\nopp_channel_lead_creation,\r\nopp_medium_lead_creation,\r\nopp_source_lead_creation,\r\nopp_offer_asset_name_lead_creation,\r\nopp_offer_asset_subtype_lead_creation,\r\nopp_offer_asset_topic_lead_creation,\r\nopp_offer_asset_type_lead_creation,\r\ntype,\r\ncase \r\nwhen type in ('New Business') then 'New Business'\r\nwhen type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') then 'Upsell'\r\nelse null\r\nend as grouped_type,\r\nacv,\r\nbilling_country AS country,\r\naccount_global_region,\r\n    opp_source_xf.company_size_rev,\r\n    opp_source_xf.segment,\r\n    opp_source_xf.industry,\r\n    opp_source_xf.industry_bucket,\r\n    opp_source_xf.channel_bucket\r\nFROM {{ref('opp_source_xf')}}\r\n--FROM \"acton\".dbt_actonmarketing.opp_source_xf\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\n--LEFT JOIN \"acton\".dbt_actonmarketing.user_source_xf ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\n--LEFT JOIN \"acton\".dbt_actonmarketing.account_source_xf ON \r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE close_day IS NOT null\r\nAND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed')\r\nAND is_won = '1'", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.account_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "opp_sales_source_xf"], "unique_id": "model.acton_marketing_data.opp_sales_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/opp_sales_source_xf.sql", "original_file_path": "models/kpi_definitions/opp_sales_source_xf.sql", "name": "opp_sales_source_xf", "alias": "opp_sales_source_xf", "checksum": {"name": "sha256", "checksum": "143a577aaf21e20aaba0b560b998330407908e338393747862f75455896ff9b7"}, "tags": [], "refs": [["opp_source_xf"], ["user_source_xf"], ["account_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5678205}, "model.acton_marketing_data.opp_voc_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    opportunity_id,\r\n    opportunity_name,\r\n    user_name AS owner_name,\r\n    opp_source_xf.account_name,\r\n    owner_id,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    voc_date AS negotiation_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    CASE \r\n        WHEN type in ('New Business') THEN 'New Business'\r\n        WHEN type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') THEN 'Upsell'\r\n        ELSE null\r\n    END AS grouped_type,\r\n    opp_channel_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_opportunity_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_source_lead_creation,\r\n    type,\r\n    acv_deal_size_usd AS acv,\r\n    billing_country AS country,\r\n    account_global_region,\r\n    opp_source_xf.company_size_rev,\r\n    opp_source_xf.segment,\r\n    opp_source_xf.industry,\r\n    opp_source_xf.industry_bucket,\r\n    opp_source_xf.channel_bucket,\r\n    opp_source_xf.opp_offer_asset_name_lead_creation\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE voc_date IS NOT null\r\nAND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery','Demo','Implement')\r\nORDER BY 7 DESC", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.account_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "opp_voc_source_xf"], "unique_id": "model.acton_marketing_data.opp_voc_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/opp_voc_source_xf.sql", "original_file_path": "models/kpi_definitions/opp_voc_source_xf.sql", "name": "opp_voc_source_xf", "alias": "opp_voc_source_xf", "checksum": {"name": "sha256", "checksum": "5a095f49b477be0fe0c8b2ab6cb9dc02744d9f8b7b6b31f7acbb25453e2eb075"}, "tags": [], "refs": [["opp_source_xf"], ["user_source_xf"], ["account_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5699766}, "model.acton_marketing_data.opp_closing_source_ss_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    opportunity_id,\r\n    opportunity_name,\r\n    user_name AS owner_name,\r\n    opp_source_xf.account_name,\r\n    owner_id,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    discovery_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    CASE \r\n        WHEN type in ('New Business') THEN 'New Business'\r\n        WHEN type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') THEN 'Upsell'\r\n        ELSE null\r\n    END AS grouped_type,\r\n    opp_channel_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_opportunity_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_source_lead_creation,\r\n    type,\r\n    acv_deal_size_usd AS acv,\r\n    billing_country AS country,\r\n    account_global_region\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE discovery_date IS NOT null\r\nAND stage_name = 'Closing'\r\n--AND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery','Demo','VOC/Negotiate')", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.account_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "opp_closing_source_ss_xf"], "unique_id": "model.acton_marketing_data.opp_closing_source_ss_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/opp_closing_source_ss_xf.sql", "original_file_path": "models/kpi_definitions/opp_closing_source_ss_xf.sql", "name": "opp_closing_source_ss_xf", "alias": "opp_closing_source_ss_xf", "checksum": {"name": "sha256", "checksum": "4e7b8397f52fc08cd9d5d7123553153250e40808e5107f1e91c76b9323356e9c"}, "tags": [], "refs": [["opp_source_xf"], ["user_source_xf"], ["account_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5722592}, "model.acton_marketing_data.sqo_source_ss_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\nopportunity_id,\r\nopportunity_name,\r\nuser_name AS owner_name,\r\nowner_id,\r\nopp_source_xf.is_closed,\r\nopp_source_xf.is_won,\r\ndiscovery_date,\r\nstage_name,\r\nopp_lead_source,\r\ncase \r\nwhen type in ('New Business') then 'New Business'\r\nwhen type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') then 'Upsell'\r\nelse null\r\nend as grouped_type,\r\nopp_channel_opportunity_creation, \r\nopp_channel_lead_creation,\r\nopp_medium_opportunity_creation,\r\nopp_medium_lead_creation,\r\nopp_source_opportunity_creation, \r\nopp_source_lead_creation,\r\ntype,\r\nacv_deal_size_usd AS acv,\r\nbilling_country AS country,\r\naccount_global_region\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE discovery_date IS NOT null\r\nAND stage_name = ('Discovery')", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.account_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "sqo_source_ss_xf"], "unique_id": "model.acton_marketing_data.sqo_source_ss_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/sqo_source_ss_xf.sql", "original_file_path": "models/kpi_definitions/sqo_source_ss_xf.sql", "name": "sqo_source_ss_xf", "alias": "sqo_source_ss_xf", "checksum": {"name": "sha256", "checksum": "6e826f2c8ec71b2227f8f5055a537226be1edee309342024428424c93bab2d87"}, "tags": [], "refs": [["opp_source_xf"], ["user_source_xf"], ["account_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5747876}, "model.acton_marketing_data.opp_demo_source_ss_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    opportunity_id,\r\n    opportunity_name,\r\n    user_name AS owner_name,\r\n    owner_id,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    discovery_date,\r\n    demo_date,\r\n    solution_date,\r\n    confirmed_value_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    CASE \r\n        WHEN type in ('New Business') THEN 'New Business'\r\n        WHEN type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') THEN 'Upsell'\r\n        ELSE null\r\n    END AS grouped_type,\r\n    opp_channel_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_opportunity_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_source_lead_creation,\r\n    type,\r\n    acv_deal_size_usd AS acv,\r\n    billing_country AS country,\r\n    account_global_region\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE demo_date IS NOT null\r\nAND stage_name = 'Demo'\r\n--AND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery')", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.account_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "opp_demo_source_ss_xf"], "unique_id": "model.acton_marketing_data.opp_demo_source_ss_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/opp_demo_source_ss_xf.sql", "original_file_path": "models/kpi_definitions/opp_demo_source_ss_xf.sql", "name": "opp_demo_source_ss_xf", "alias": "opp_demo_source_ss_xf", "checksum": {"name": "sha256", "checksum": "206c491d55bf9e146d3c03fe992ad347938cf471447763b2f18de64d878d1e97"}, "tags": [], "refs": [["opp_source_xf"], ["user_source_xf"], ["account_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5772305}, "model.acton_marketing_data.sql_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT DISTINCT\r\n    opportunity_id AS sql_id,\r\n    opportunity_name,\r\n    opp_source_xf.account_name,\r\n    owner_name,\r\n    sdr_name,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    created_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    opp_channel_opportunity_creation, \r\n    opp_medium_opportunity_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_lead_creation,\r\n    type,\r\n    billing_country AS country,\r\n    opp_source_xf.company_size_rev,\r\n    account_global_region,\r\n    opp_source_xf.segment,\r\n    opp_source_xf.industry,\r\n    opp_source_xf.industry_bucket,\r\n    channel_bucket,\r\n    opp_source_xf.opp_offer_asset_name_lead_creation,\r\n    acv_deal_size_usd AS acv\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE created_date IS NOT null\r\nAND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed')\r\n--AND stage_name = 'SQL'", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.account_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "sql_source_xf"], "unique_id": "model.acton_marketing_data.sql_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/sql_source_xf.sql", "original_file_path": "models/kpi_definitions/sql_source_xf.sql", "name": "sql_source_xf", "alias": "sql_source_xf", "checksum": {"name": "sha256", "checksum": "1473a282bd1aef98853ee02fdd9b585dd56b47c2473220eea9ddbf9b331bc489"}, "tags": [], "refs": [["opp_source_xf"], ["account_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.579431}, "model.acton_marketing_data.kpi_targets": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM \"acton\".public.\"kpi_targets\"\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", "resource_type": "model", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "kpi_targets"], "unique_id": "model.acton_marketing_data.kpi_targets", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/kpi_targets.sql", "original_file_path": "models/kpi_definitions/kpi_targets.sql", "name": "kpi_targets", "alias": "kpi_targets", "checksum": {"name": "sha256", "checksum": "9197afc2db20108c676891ee47573b531ca47c281d8e8f210905cadad47a2e55"}, "tags": [], "refs": [], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5816648}, "model.acton_marketing_data.sal_source_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    person_id,\r\n    email,\r\n    is_hand_raiser,\r\n    working_date,\r\n    mql_most_recent_date,\r\n    person_status,\r\n    country,\r\n    global_region,\r\n    company,\r\n    company_size_rev,\r\n    lead_source,\r\n    segment,\r\n    industry,\r\n    industry_bucket,\r\n    channel_bucket,\r\n    offer_asset_name_lead_creation,\r\n    campaign_lead_creation\r\nFROM {{ref('person_source_xf')}}\r\nWHERE person_owner_id != '00Ga0000003Nugr'\r\nAND working_date IS NOT null\r\nAND email NOT LIKE '%act-on.com'\r\n--AND lead_source = 'Marketing'\r\nAND person_status  NOT IN ('Current Customer','Partner','Bad Data','No Fit')", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.person_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "sal_source_xf"], "unique_id": "model.acton_marketing_data.sal_source_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/sal_source_xf.sql", "original_file_path": "models/kpi_definitions/sal_source_xf.sql", "name": "sal_source_xf", "alias": "sal_source_xf", "checksum": {"name": "sha256", "checksum": "42378430793e70b8093439b77c5bc144940ef598cc807bc24bbd51e61641e45d"}, "tags": [], "refs": [["person_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5837843}, "model.acton_marketing_data.lead_mql_source_ss_xf": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    lead_id,\r\n    email,\r\n    lead_source,\r\n    is_converted,\r\n    is_hand_raiser,\r\n    mql_created_date,\r\n    mql_most_recent_date,\r\n    lead_status,\r\n    country,\r\n    lead_owner,\r\n    global_region\r\nFROM {{ref('lead_source_ss_xf')}}\r\nWHERE mql_most_recent_date IS NOT null\r\nAND lead_owner != '00Ga0000003Nugr' -- AO-Fake Leads\r\nAND email NOT LIKE '%act-on.com'\r\nAND lead_source = 'Marketing'", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.lead_source_ss_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "lead_mql_source_ss_xf"], "unique_id": "model.acton_marketing_data.lead_mql_source_ss_xf", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/lead_mql_source_ss_xf.sql", "original_file_path": "models/kpi_definitions/lead_mql_source_ss_xf.sql", "name": "lead_mql_source_ss_xf", "alias": "lead_mql_source_ss_xf", "checksum": {"name": "sha256", "checksum": "9b632fc8605aa1df4af5d7d8e2076ed838b3d826b0454a969604ce4268a5654d"}, "tags": [], "refs": [["lead_source_ss_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5859659}, "model.acton_marketing_data.wow_disco_scheduled": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH  base AS (\r\n\r\nSELECT\r\nopportunity_id,\r\nopportunity_name,\r\nowner_id,\r\ndiscovery_call_scheduled_datetime\r\nFROM {{ref('opp_source_xf')}}\r\n--FROM \"acton\".dbt_actonmarketing.opp_source_xf\r\nWHERE 1=1\r\nAND type = 'New Business'\r\nAND discovery_call_scheduled_datetime IS NOT null\r\nAND discovery_date IS null\r\nAND opportunity_status != 'Rescheduling Meeting'\r\nAND is_closed != 'true'\r\nAND is_won != 'true'\r\nAND is_deleted != 'true'\r\n)\r\n\r\nSELECT\r\ndiscovery_call_scheduled_datetime,\r\nCOUNT(DISTINCT opportunity_id) AS opps\r\nFROM base\r\nGROUP BY 1", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "disco calls", "wow_disco_scheduled"], "unique_id": "model.acton_marketing_data.wow_disco_scheduled", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/disco calls/wow_disco_scheduled.sql", "original_file_path": "models/kpi_definitions/disco calls/wow_disco_scheduled.sql", "name": "wow_disco_scheduled", "alias": "wow_disco_scheduled", "checksum": {"name": "sha256", "checksum": "e4900cf20a9ed9b9bf61d965c5f9240c00746a6dd7fdc23e6aa959b60b4865b1"}, "tags": [], "refs": [["opp_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5879943}, "model.acton_marketing_data.wow_disco_pastdue": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH  base AS (\r\n\r\nSELECT\r\nopportunity_id,\r\nopportunity_name,\r\nuser_name AS owner_name,\r\ndiscovery_call_scheduled_datetime\r\nFROM {{ref('opp_source_xf')}}\r\n--FROM \"acton\".dbt_actonmarketing.opp_source_xf\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\n--LEFT JOIN \"acton\".dbt_actonmarketing.user_source_xf ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nWHERE 1=1\r\nAND type = 'New Business'\r\nAND discovery_call_scheduled_datetime IS NOT null\r\nAND discovery_date IS null\r\nAND opportunity_status != 'Rescheduling Meeting'\r\nAND is_closed != 'true'\r\nAND is_won != 'true'\r\nAND is_deleted != 'true'\r\nAND discovery_call_scheduled_datetime < CURRENT_DATE\r\n)\r\n\r\nSELECT\r\nowner_name,\r\nCOUNT(DISTINCT opportunity_id) AS opps\r\nFROM base\r\nGROUP BY 1", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "disco calls", "wow_disco_pastdue"], "unique_id": "model.acton_marketing_data.wow_disco_pastdue", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/disco calls/wow_disco_pastdue.sql", "original_file_path": "models/kpi_definitions/disco calls/wow_disco_pastdue.sql", "name": "wow_disco_pastdue", "alias": "wow_disco_pastdue", "checksum": {"name": "sha256", "checksum": "849dc086ee7c5aa34a2cb4979acb765fa06fd02b4be7eed45836cd5de57d01c8"}, "tags": [], "refs": [["opp_source_xf"], ["user_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.590203}, "model.acton_marketing_data.wow_disco_missing": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT\r\nopportunity_id,\r\nuser_name AS owner_name\r\nFROM {{ref('opp_source_xf')}}\r\n--FROM \"acton\".dbt_actonmarketing.opp_source_xf\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\n--LEFT JOIN \"acton\".dbt_actonmarketing.user_source_xf ON\r\nopp_source_xf.created_by_id=user_source_xf.user_id\r\nWHERE 1=1\r\nAND type = 'New Business'\r\nAND discovery_call_scheduled_datetime IS null\r\nAND discovery_date IS null\r\nAND is_closed != 'true'\r\nAND is_won != 'true'\r\nAND is_deleted != 'true'\r\n\r\n)\r\n\r\nSELECT\r\nowner_name,\r\nCOUNT(DISTINCT opportunity_id) AS opps\r\nFROM base\r\nGROUP BY 1", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "kpi_definitions", "disco calls", "wow_disco_missing"], "unique_id": "model.acton_marketing_data.wow_disco_missing", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "kpi_definitions/disco calls/wow_disco_missing.sql", "original_file_path": "models/kpi_definitions/disco calls/wow_disco_missing.sql", "name": "wow_disco_missing", "alias": "wow_disco_missing", "checksum": {"name": "sha256", "checksum": "5f146439b74e3d481ef239be67bacd43c37c58937ec0ae3cbff121d408890309"}, "tags": [], "refs": [["opp_source_xf"], ["user_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5924373}, "model.acton_marketing_data.opportunities_with_contacts": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH person_base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        email,\r\n        is_hand_raiser,\r\n        person_owner_id AS owner_id,\r\n        channel_lead_creation,\r\n        medium_lead_creation,\r\n        source_lead_creation,\r\n        lead_source,\r\n        created_date,\r\n        marketing_created_date,\r\n        mql_most_recent_date AS mql_created_date,\r\n        working_date,\r\n        person_status,\r\n        company_size_rev,\r\n        global_region,\r\n        segment,\r\n        lean_data_account_id AS account_id,\r\n        channel_bucket,\r\n        industry_bucket,\r\n        industry,\r\n        offer_asset_name_lead_creation\r\n    FROM {{ref('person_source_xf')}}\r\n    --WHERE marketing_created_date >= '2021-01-01'\r\n)\r\n\r\nSELECT DISTINCT\r\n    person_base.person_id,\r\n    person_base.email,\r\n    person_base.is_hand_raiser,\r\n    person_base.channel_bucket,\r\n    person_base.owner_id,\r\n    person_base.channel_lead_creation,\r\n    person_base.medium_lead_creation,\r\n    person_base.source_lead_creation,\r\n    person_base.lead_source,\r\n    person_base.created_date AS person_created_date,\r\n    person_base.marketing_created_date,\r\n    person_base.mql_created_date,\r\n    person_base.working_date,\r\n    person_base.company_size_rev,\r\n    person_base.global_region,\r\n    person_base.segment,\r\n    person_base.account_id,\r\n    person_base.person_status,\r\n    person_base.industry,\r\n    person_base.offer_asset_name_lead_creation AS person_offer_asset_name_lead_creation,\r\n    person_base.industry_bucket,\r\n    -- account_base.is_current_customer, \r\n    -- account_base.account_name,\r\n    -- account_base.account_owner_name,\r\n    -- account_base.account_csm_name,\r\n   -- account_base.\r\n    opp_base.is_current_customer,\r\n    opp_base.opportunity_id,\r\n    opp_base.opportunity_name,\r\n    opp_base.is_won,\r\n    opp_base.created_date AS opp_created_date,\r\n    opp_base.discovery_date,\r\n    opp_base.demo_date,\r\n    opp_base.voc_date,\r\n    opp_base.closing_date,\r\n    opp_base.implement_date,\r\n    opp_base.close_date,\r\n    opp_base.stage_name,\r\n    opp_base.acv_deal_size_usd AS acv,\r\n    opp_base.opp_lead_source,\r\n    opp_base.type,\r\n    opp_base.is_closed,\r\n    opp_base.segment AS opp_segment,\r\n    opp_base.account_global_region,\r\n    opp_base.company_size_rev AS opp_company_size_rev,\r\n    opp_base.industry AS opp_industry,\r\n    opp_base.industry_bucket AS opp_industry_bucket,\r\n    opp_base.channel_bucket AS opp_channel_bucket,\r\n    opp_base.opp_offer_asset_name_lead_creation,\r\n    CASE \r\n        WHEN mql_created_date IS NOT null AND email NOT LIKE '%act-on%' THEN 1\r\n        ELSE 0\r\n    END AS is_mql,\r\n    CASE \r\n        WHEN working_date IS NOT null AND email NOT LIKE '%act-on%' AND person_status NOT IN ('Current Customer','Partner','Bad Data','No Fit') THEN 1\r\n        ELSE 0\r\n    END AS is_sal,\r\n    CASE\r\n        WHEN opp_base.created_date IS NOT null AND opp_base.stage_name NOT IN ('Closed - Duplicate','Closed - Admin Remove') THEN 1\r\n        ELSE 0\r\n    END AS is_sql,\r\n    CASE\r\n        WHEN opp_base.discovery_date IS NOT null AND opp_base.stage_name NOT IN ('Closed - Duplicate','Closed - Admin Remove') THEN 1\r\n        ELSE 0\r\n    END AS is_sqo,\r\n    CASE\r\n        WHEN opp_base.demo_date IS NOT null AND opp_base.stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery') THEN 1\r\n        ELSE 0\r\n    END AS is_demo,\r\n    CASE\r\n        WHEN opp_base.voc_date IS NOT null AND opp_base.stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery','Demo') THEN 1\r\n        ELSE 0\r\n    END AS is_voc,\r\n    CASE\r\n        WHEN opp_base.closing_date IS NOT null AND opp_base.stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery','Demo','VOC/Negotiate') THEN 1\r\n        ELSE 0\r\n    END AS is_closing,\r\n    CASE\r\n        WHEN opp_base.is_closed = true AND opp_base.is_won = false THEN 1\r\n        ELSE 0\r\n    END AS is_cl,\r\n    CASE\r\n        WHEN opp_base.is_closed = true AND opp_base.is_won = true THEN 1\r\n        ELSE 0\r\n    END AS is_cw\r\nFROM person_base\r\nFULL JOIN {{ref('opp_source_xf')}} AS opp_base ON\r\nperson_base.account_id=opp_base.account_id", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.person_source_xf", "model.acton_marketing_data.opp_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "cohort_model", "opportunities_with_contacts"], "unique_id": "model.acton_marketing_data.opportunities_with_contacts", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "cohort_model/opportunities_with_contacts.sql", "original_file_path": "models/cohort_model/opportunities_with_contacts.sql", "name": "opportunities_with_contacts", "alias": "opportunities_with_contacts", "checksum": {"name": "sha256", "checksum": "bf72a7456e11680853fd7a957fd25be1bb1692b1898eb91d80732bd81e8750e2"}, "tags": [], "refs": [["person_source_xf"], ["opp_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5948286}, "model.acton_marketing_data.avg_lead_to_cw_cohort_count": {"raw_sql": "WITH base AS(\r\n\r\n    SELECT *\r\n    FROM {{ ref('lead_to_cw_cohort')}}\r\n)\r\n\r\nSELECT DISTINCT\r\n    channel_bucket,\r\n    segment,\r\n    SUM(is_mql) AS mqls,\r\n    SUM(is_sal) AS sals,\r\n    SUM(is_sql) AS sqls,\r\n    SUM(is_sqo) AS sqos,\r\n    SUM(is_cl) AS closed_lost,\r\n    SUM(is_cw) AS closed_won\r\nFROM base\r\nGROUP BY 1,2", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.lead_to_cw_cohort"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "cohort_model", "avg_lead_to_cw_cohort_count"], "unique_id": "model.acton_marketing_data.avg_lead_to_cw_cohort_count", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "cohort_model/avg_lead_to_cw_cohort_count.sql", "original_file_path": "models/cohort_model/avg_lead_to_cw_cohort_count.sql", "name": "avg_lead_to_cw_cohort_count", "alias": "avg_lead_to_cw_cohort_count", "checksum": {"name": "sha256", "checksum": "5a68a7817dfe2cd9031b17328b15522b315a82db6f2a9154022138b5af4ceb84"}, "tags": [], "refs": [["lead_to_cw_cohort"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.597121}, "model.acton_marketing_data.avg_lead_to_cw_cohort": {"raw_sql": "WITH base AS(\r\n\r\n    SELECT *\r\n    FROM {{ ref('lead_to_cw_cohort')}}\r\n)\r\n\r\nSELECT\r\n    channel_bucket,\r\n    segment,\r\n    AVG(days_to_mql) AS avg_days_to_mql,\r\n    AVG(days_to_sal) AS avg_days_to_sal,\r\n    AVG(days_to_sql) AS avg_days_to_sql,\r\n    AVG(days_to_sqo) AS avg_days_to_sqo,\r\n    AVG(days_to_won) AS avg_days_to_won,\r\n    AVG(days_to_closed_lost) AS avg_days_to_closed_lost\r\nFROM base\r\nGROUP BY 1,2", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.lead_to_cw_cohort"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "cohort_model", "avg_lead_to_cw_cohort"], "unique_id": "model.acton_marketing_data.avg_lead_to_cw_cohort", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "cohort_model/avg_lead_to_cw_cohort.sql", "original_file_path": "models/cohort_model/avg_lead_to_cw_cohort.sql", "name": "avg_lead_to_cw_cohort", "alias": "avg_lead_to_cw_cohort", "checksum": {"name": "sha256", "checksum": "96ebbd538b46f34d110283fa62c73c2ca30fa79fb41c194b2ae13fe20f405a0d"}, "tags": [], "refs": [["lead_to_cw_cohort"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.5989835}, "model.acton_marketing_data.lead_to_cw_cohort": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('opportunities_with_contacts')}}\r\n\r\n), intermediate AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        email,\r\n        opportunity_id,\r\n        owner_id AS person_owner_id,\r\n        company_size_rev,\r\n        global_region,\r\n        segment,\r\n        channel_bucket,\r\n        industry,\r\n        industry_bucket,\r\n        lead_source,\r\n        person_created_date,\r\n        marketing_created_date::Date,\r\n        mql_created_date::Date,\r\n        working_date AS sal_created_date,\r\n        person_status,\r\n        opp_created_date::Date,\r\n        discovery_date::Date,\r\n        demo_date::Date,\r\n        voc_date::Date,\r\n        closing_date::Date,\r\n        close_date::Date,\r\n        CASE\r\n            WHEN is_won = true THEN close_date::Date\r\n            ELSE null\r\n        END AS cw_date,\r\n        CASE \r\n            WHEN is_won = false AND is_closed = true THEN close_date::Date\r\n            ELSE null\r\n        END AS cl_date,\r\n        is_won,\r\n        acv,\r\n        channel_lead_creation,\r\n        medium_lead_creation,\r\n        source_lead_creation,\r\n        person_offer_asset_name_lead_creation,\r\n        stage_name,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_industry,\r\n        opp_industry_bucket,\r\n        opp_channel_bucket,\r\n        opp_offer_asset_name_lead_creation,\r\n        type AS opp_type,\r\n        is_hand_raiser,\r\n        is_current_customer,\r\n        is_mql,\r\n        is_sal,\r\n        is_sql,\r\n        is_sqo,\r\n        is_demo,\r\n        is_voc,\r\n        is_closing,\r\n        is_cl,\r\n        is_cw\r\n    FROM base\r\n\r\n), final AS (\r\n\r\n    SELECT \r\n        intermediate.*,\r\n        CASE \r\n            WHEN mql_created_date>=marketing_created_date THEN {{ dbt_utils.datediff(\"marketing_created_date\",\"mql_created_date\",'day') }} \r\n            ELSE 0 \r\n        END AS days_to_mql,\r\n        CASE \r\n            WHEN sal_created_date>=mql_created_date THEN {{ dbt_utils.datediff(\"mql_created_date\",\"sal_created_date\",'day') }} \r\n            ELSE 0 \r\n        END AS  days_to_sal,\r\n        CASE \r\n            WHEN opp_created_date>=sal_created_date THEN {{ dbt_utils.datediff(\"sal_created_date\",\"opp_created_date\",'day') }} \r\n            ELSE 0 \r\n        END AS  days_to_sql,\r\n        CASE \r\n            WHEN discovery_date>=opp_created_date THEN {{ dbt_utils.datediff(\"opp_created_date\",\"discovery_date\",'day') }} \r\n            ELSE 0 \r\n        END AS  days_to_sqo,\r\n        CASE \r\n            WHEN cw_date>=discovery_date THEN {{ dbt_utils.datediff(\"discovery_date\",\"cw_date\",'day') }} \r\n            ELSE 0 \r\n        END AS  days_to_won,\r\n        CASE \r\n            WHEN cl_date>=discovery_date THEN {{ dbt_utils.datediff(\"discovery_date\",\"cl_date\",'day') }} \r\n            ELSE 0 \r\n        END AS  days_to_closed_lost\r\n    FROM intermediate\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.datediff"], "nodes": ["model.acton_marketing_data.opportunities_with_contacts"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "dbt_actonmarketing", "fqn": ["acton_marketing_data", "cohort_model", "lead_to_cw_cohort"], "unique_id": "model.acton_marketing_data.lead_to_cw_cohort", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "cohort_model/lead_to_cw_cohort.sql", "original_file_path": "models/cohort_model/lead_to_cw_cohort.sql", "name": "lead_to_cw_cohort", "alias": "lead_to_cw_cohort", "checksum": {"name": "sha256", "checksum": "d3006a83de3c9794cb7e18c8ce9b7d13b9d3ff4359016721f06fb92df8585901"}, "tags": [], "refs": [["opportunities_with_contacts"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1666469550.6008067}, "snapshot.acton_marketing_data.sfdc_ao_instance_snapshot2": {"raw_sql": "\r\n\r\n{{\r\n    config (\r\n        target_schema='snapshots',\r\n        unique_key = 'ao_instance_id',\r\n        strategy='timestamp',\r\n        updated_at='systemmodstamp'\r\n    )\r\n}}\r\n\r\nSELECT *\r\nFROM {{ref('ao_instance_source_xf')}}\r\n\r\n", "resource_type": "snapshot", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.ao_instance_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "snapshot", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "ao_instance_id", "on_schema_change": "ignore", "grants": {}, "strategy": "timestamp", "target_schema": "snapshots", "target_database": null, "updated_at": "systemmodstamp", "check_cols": null, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "snapshots", "fqn": ["acton_marketing_data", "sfdc", "sfdc_ao_instance_snapshot", "sfdc_ao_instance_snapshot2"], "unique_id": "snapshot.acton_marketing_data.sfdc_ao_instance_snapshot2", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sfdc/sfdc_ao_instance_snapshot.sql", "original_file_path": "snapshots/sfdc/sfdc_ao_instance_snapshot.sql", "name": "sfdc_ao_instance_snapshot2", "alias": "sfdc_ao_instance_snapshot2", "checksum": {"name": "sha256", "checksum": "a460b3d1add6700b47970262622605cfb9269a593970c22e454ed745d917ae68"}, "tags": [], "refs": [["ao_instance_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"target_schema": "snapshots", "unique_key": "ao_instance_id", "strategy": "timestamp", "updated_at": "systemmodstamp"}, "created_at": 1666469550.6228323}, "snapshot.acton_marketing_data.sfdc_contact_snapshot3": {"raw_sql": "\r\n\r\n{{\r\n    config (\r\n        target_schema='snapshots',\r\n        unique_key = 'contact_id',\r\n        strategy='timestamp',\r\n        updated_at='systemmodstamp'\r\n    )\r\n}}\r\n\r\nSELECT *\r\nFROM {{ref('contact_source_xf')}}\r\n\r\n", "resource_type": "snapshot", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.contact_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "snapshot", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "contact_id", "on_schema_change": "ignore", "grants": {}, "strategy": "timestamp", "target_schema": "snapshots", "target_database": null, "updated_at": "systemmodstamp", "check_cols": null, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "snapshots", "fqn": ["acton_marketing_data", "sfdc", "sfdc_contact_snapshot", "sfdc_contact_snapshot3"], "unique_id": "snapshot.acton_marketing_data.sfdc_contact_snapshot3", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sfdc/sfdc_contact_snapshot.sql", "original_file_path": "snapshots/sfdc/sfdc_contact_snapshot.sql", "name": "sfdc_contact_snapshot3", "alias": "sfdc_contact_snapshot3", "checksum": {"name": "sha256", "checksum": "ebe336e78ae4cf1d1302645a60d243070f30b246039e3c5f7a21ad34858d8034"}, "tags": [], "refs": [["contact_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"target_schema": "snapshots", "unique_key": "contact_id", "strategy": "timestamp", "updated_at": "systemmodstamp"}, "created_at": 1666469550.6301696}, "snapshot.acton_marketing_data.sfdc_lead_snapshot2": {"raw_sql": "\r\n\r\n{{\r\n    config (\r\n        target_schema='snapshots',\r\n        unique_key = 'lead_id',\r\n        strategy='timestamp',\r\n        updated_at='systemmodstamp'\r\n    )\r\n}}\r\n\r\nSELECT *\r\nFROM {{ref('lead_source_xf')}}\r\n\r\n", "resource_type": "snapshot", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.lead_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "snapshot", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "lead_id", "on_schema_change": "ignore", "grants": {}, "strategy": "timestamp", "target_schema": "snapshots", "target_database": null, "updated_at": "systemmodstamp", "check_cols": null, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "snapshots", "fqn": ["acton_marketing_data", "sfdc", "sfdc_lead_snapshot", "sfdc_lead_snapshot2"], "unique_id": "snapshot.acton_marketing_data.sfdc_lead_snapshot2", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sfdc/sfdc_lead_snapshot.sql", "original_file_path": "snapshots/sfdc/sfdc_lead_snapshot.sql", "name": "sfdc_lead_snapshot2", "alias": "sfdc_lead_snapshot2", "checksum": {"name": "sha256", "checksum": "1a754d6245739970a6da29d20fcbbe9f33b9663f456c6206b0fca3c6218128ee"}, "tags": [], "refs": [["lead_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"target_schema": "snapshots", "unique_key": "lead_id", "strategy": "timestamp", "updated_at": "systemmodstamp"}, "created_at": 1666469550.6350334}, "snapshot.acton_marketing_data.sfdc_contract_snapshot2": {"raw_sql": "\r\n\r\n{{\r\n    config (\r\n        target_schema='snapshots',\r\n        unique_key = 'contract_id',\r\n        strategy='timestamp',\r\n        updated_at='systemmodstamp'\r\n    )\r\n}}\r\n\r\nSELECT *\r\nFROM {{ref('contract_source_xf')}}\r\n\r\n", "resource_type": "snapshot", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.contract_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "snapshot", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "contract_id", "on_schema_change": "ignore", "grants": {}, "strategy": "timestamp", "target_schema": "snapshots", "target_database": null, "updated_at": "systemmodstamp", "check_cols": null, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "snapshots", "fqn": ["acton_marketing_data", "sfdc", "sfdc_contract_snapshot", "sfdc_contract_snapshot2"], "unique_id": "snapshot.acton_marketing_data.sfdc_contract_snapshot2", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sfdc/sfdc_contract_snapshot.sql", "original_file_path": "snapshots/sfdc/sfdc_contract_snapshot.sql", "name": "sfdc_contract_snapshot2", "alias": "sfdc_contract_snapshot2", "checksum": {"name": "sha256", "checksum": "35f0e1350b2f58119b5047c2ab9b675ee33c47225cb611378f7ec462fcfbb026"}, "tags": [], "refs": [["contract_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"target_schema": "snapshots", "unique_key": "contract_id", "strategy": "timestamp", "updated_at": "systemmodstamp"}, "created_at": 1666469550.6397629}, "snapshot.acton_marketing_data.sfdc_ao_instance_user_snapshot2": {"raw_sql": "\r\n\r\n{{\r\n    config (\r\n        target_schema='snapshots',\r\n        unique_key = 'ao_user_id',\r\n        strategy='timestamp',\r\n        updated_at='systemmodstamp'\r\n    )\r\n}}\r\n\r\nSELECT *\r\nFROM {{ref('ao_instance_user_source_xf')}}\r\n\r\n", "resource_type": "snapshot", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.ao_instance_user_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "snapshot", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "ao_user_id", "on_schema_change": "ignore", "grants": {}, "strategy": "timestamp", "target_schema": "snapshots", "target_database": null, "updated_at": "systemmodstamp", "check_cols": null, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "snapshots", "fqn": ["acton_marketing_data", "sfdc", "sfdc_ao_instance_user_snapshot", "sfdc_ao_instance_user_snapshot2"], "unique_id": "snapshot.acton_marketing_data.sfdc_ao_instance_user_snapshot2", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sfdc/sfdc_ao_instance_user_snapshot.sql", "original_file_path": "snapshots/sfdc/sfdc_ao_instance_user_snapshot.sql", "name": "sfdc_ao_instance_user_snapshot2", "alias": "sfdc_ao_instance_user_snapshot2", "checksum": {"name": "sha256", "checksum": "dfd908b80531bd2d3a0916d3278548a2d15c620aa5e02950ca839a07f1f1da4f"}, "tags": [], "refs": [["ao_instance_user_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"target_schema": "snapshots", "unique_key": "ao_user_id", "strategy": "timestamp", "updated_at": "systemmodstamp"}, "created_at": 1666469550.6446018}, "snapshot.acton_marketing_data.sfdc_account_snapshot4": {"raw_sql": "\r\n\r\n{{\r\n    config (\r\n        target_schema='snapshots',\r\n        unique_key = 'account_id',\r\n        strategy='timestamp',\r\n        updated_at='systemmodstamp'\r\n    )\r\n    \r\n}}\r\n\r\nSELECT *\r\nFROM {{ref('account_source_xf')}}\r\n\r\n", "resource_type": "snapshot", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.account_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "snapshot", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "account_id", "on_schema_change": "ignore", "grants": {}, "strategy": "timestamp", "target_schema": "snapshots", "target_database": null, "updated_at": "systemmodstamp", "check_cols": null, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "snapshots", "fqn": ["acton_marketing_data", "sfdc", "sfdc_account_snapshot", "sfdc_account_snapshot4"], "unique_id": "snapshot.acton_marketing_data.sfdc_account_snapshot4", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sfdc/sfdc_account_snapshot.sql", "original_file_path": "snapshots/sfdc/sfdc_account_snapshot.sql", "name": "sfdc_account_snapshot4", "alias": "sfdc_account_snapshot4", "checksum": {"name": "sha256", "checksum": "36e888f60e98924cf2cdadb8382f845e0210d955651783037f0e50181be3e304"}, "tags": [], "refs": [["account_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"target_schema": "snapshots", "unique_key": "account_id", "strategy": "timestamp", "updated_at": "systemmodstamp"}, "created_at": 1666469550.6497025}, "snapshot.acton_marketing_data.sfdc_opportunity_snapshot2": {"raw_sql": "\r\n\r\n{{\r\n    config (\r\n        target_schema='snapshots',\r\n        unique_key = 'opportunity_id',\r\n        strategy='timestamp',\r\n        updated_at='systemmodstamp'\r\n    )\r\n}}\r\n\r\nSELECT *\r\nFROM {{ref('opp_source_xf')}}\r\n\r\n", "resource_type": "snapshot", "depends_on": {"macros": [], "nodes": ["model.acton_marketing_data.opp_source_xf"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "snapshot", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "opportunity_id", "on_schema_change": "ignore", "grants": {}, "strategy": "timestamp", "target_schema": "snapshots", "target_database": null, "updated_at": "systemmodstamp", "check_cols": null, "post-hook": [], "pre-hook": []}, "database": "acton", "schema": "snapshots", "fqn": ["acton_marketing_data", "sfdc", "sfdc_opportunity_snapshot", "sfdc_opportunity_snapshot2"], "unique_id": "snapshot.acton_marketing_data.sfdc_opportunity_snapshot2", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "sfdc/sfdc_opportunity_snapshot.sql", "original_file_path": "snapshots/sfdc/sfdc_opportunity_snapshot.sql", "name": "sfdc_opportunity_snapshot2", "alias": "sfdc_opportunity_snapshot2", "checksum": {"name": "sha256", "checksum": "b51fb000a612300d8cebed81ee4d28addbb6e2983ebfbdb6cba7fe82d336872d"}, "tags": [], "refs": [["opp_source_xf"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"target_schema": "snapshots", "unique_key": "opportunity_id", "strategy": "timestamp", "updated_at": "systemmodstamp"}, "created_at": 1666469550.6552517}}, "sources": {"source.acton_marketing_data.salesforce.account": {"fqn": ["acton_marketing_data", "salesforce", "account"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.account", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "account", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "account", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"account\"", "created_at": 1666469550.7711895}, "source.acton_marketing_data.salesforce.act_on_instance_c": {"fqn": ["acton_marketing_data", "salesforce", "act_on_instance_c"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.act_on_instance_c", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "act_on_instance_c", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "act_on_instance_c", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"act_on_instance_c\"", "created_at": 1666469550.7713702}, "source.acton_marketing_data.salesforce.act_on_instance_user_c": {"fqn": ["acton_marketing_data", "salesforce", "act_on_instance_user_c"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.act_on_instance_user_c", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "act_on_instance_user_c", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "act_on_instance_user_c", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"act_on_instance_user_c\"", "created_at": 1666469550.7714932}, "source.acton_marketing_data.salesforce.campaign_influence": {"fqn": ["acton_marketing_data", "salesforce", "campaign_influence"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.campaign_influence", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "campaign_influence", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "campaign_influence", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"campaign_influence\"", "created_at": 1666469550.7716088}, "source.acton_marketing_data.salesforce.campaign_member": {"fqn": ["acton_marketing_data", "salesforce", "campaign_member"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.campaign_member", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "campaign_member", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "campaign_member", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"campaign_member\"", "created_at": 1666469550.7717206}, "source.acton_marketing_data.salesforce.campaign": {"fqn": ["acton_marketing_data", "salesforce", "campaign"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.campaign", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "campaign", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "campaign", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"campaign\"", "created_at": 1666469550.7718296}, "source.acton_marketing_data.salesforce.contact_history": {"fqn": ["acton_marketing_data", "salesforce", "contact_history"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.contact_history", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "contact_history", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "contact_history", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"contact_history\"", "created_at": 1666469550.7719367}, "source.acton_marketing_data.salesforce.contact": {"fqn": ["acton_marketing_data", "salesforce", "contact"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.contact", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "contact", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "contact", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"contact\"", "created_at": 1666469550.7720432}, "source.acton_marketing_data.salesforce.contract": {"fqn": ["acton_marketing_data", "salesforce", "contract"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.contract", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "contract", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "contract", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"contract\"", "created_at": 1666469550.7721481}, "source.acton_marketing_data.salesforce.lead_history": {"fqn": ["acton_marketing_data", "salesforce", "lead_history"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.lead_history", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "lead_history", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "lead_history", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"lead_history\"", "created_at": 1666469550.772253}, "source.acton_marketing_data.salesforce.lead": {"fqn": ["acton_marketing_data", "salesforce", "lead"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.lead", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "lead", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "lead", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"lead\"", "created_at": 1666469550.7723575}, "source.acton_marketing_data.salesforce.opportunity": {"fqn": ["acton_marketing_data", "salesforce", "opportunity"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.opportunity", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "opportunity", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "opportunity", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"opportunity\"", "created_at": 1666469550.772463}, "source.acton_marketing_data.salesforce.opportunity_field_history": {"fqn": ["acton_marketing_data", "salesforce", "opportunity_field_history"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.opportunity_field_history", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "opportunity_field_history", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "opportunity_field_history", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"opportunity_field_history\"", "created_at": 1666469550.772568}, "source.acton_marketing_data.salesforce.opportunity_line_item": {"fqn": ["acton_marketing_data", "salesforce", "opportunity_line_item"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.opportunity_line_item", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "opportunity_line_item", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "opportunity_line_item", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"opportunity_line_item\"", "created_at": 1666469550.7726853}, "source.acton_marketing_data.salesforce.product_2": {"fqn": ["acton_marketing_data", "salesforce", "product_2"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.product_2", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "product_2", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "product_2", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"product_2\"", "created_at": 1666469550.7728174}, "source.acton_marketing_data.salesforce.task": {"fqn": ["acton_marketing_data", "salesforce", "task"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.task", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "task", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "task", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"task\"", "created_at": 1666469550.772955}, "source.acton_marketing_data.salesforce.user": {"fqn": ["acton_marketing_data", "salesforce", "user"], "database": "acton", "schema": "salesforce", "unique_id": "source.acton_marketing_data.salesforce.user", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "user", "source_name": "salesforce", "source_description": "", "loader": "", "identifier": "user", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"salesforce\".\"user\"", "created_at": 1666469550.7730834}, "source.acton_marketing_data.data_studio_s3.data_studio_emails": {"fqn": ["acton_marketing_data", "data_studio_s3", "data_studio_emails"], "database": "acton", "schema": "data_studio_s3", "unique_id": "source.acton_marketing_data.data_studio_s3.data_studio_emails", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "data_studio_emails", "source_name": "data_studio_s3", "source_description": "", "loader": "", "identifier": "data_studio_emails", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"data_studio_s3\".\"data_studio_emails\"", "created_at": 1666469550.7732444}, "source.acton_marketing_data.data_studio_s3.data_studio_forms": {"fqn": ["acton_marketing_data", "data_studio_s3", "data_studio_forms"], "database": "acton", "schema": "data_studio_s3", "unique_id": "source.acton_marketing_data.data_studio_s3.data_studio_forms", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "data_studio_forms", "source_name": "data_studio_s3", "source_description": "", "loader": "", "identifier": "data_studio_forms", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"data_studio_s3\".\"data_studio_forms\"", "created_at": 1666469550.7733696}, "source.acton_marketing_data.data_studio_s3.data_studio_landingpages": {"fqn": ["acton_marketing_data", "data_studio_s3", "data_studio_landingpages"], "database": "acton", "schema": "data_studio_s3", "unique_id": "source.acton_marketing_data.data_studio_s3.data_studio_landingpages", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "data_studio_landingpages", "source_name": "data_studio_s3", "source_description": "", "loader": "", "identifier": "data_studio_landingpages", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"data_studio_s3\".\"data_studio_landingpages\"", "created_at": 1666469550.7734902}, "source.acton_marketing_data.data_studio_s3.data_studio_media": {"fqn": ["acton_marketing_data", "data_studio_s3", "data_studio_media"], "database": "acton", "schema": "data_studio_s3", "unique_id": "source.acton_marketing_data.data_studio_s3.data_studio_media", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "data_studio_media", "source_name": "data_studio_s3", "source_description": "", "loader": "", "identifier": "data_studio_media", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"data_studio_s3\".\"data_studio_media\"", "created_at": 1666469550.7735991}, "source.acton_marketing_data.data_studio_s3.data_studio_webinars": {"fqn": ["acton_marketing_data", "data_studio_s3", "data_studio_webinars"], "database": "acton", "schema": "data_studio_s3", "unique_id": "source.acton_marketing_data.data_studio_s3.data_studio_webinars", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "data_studio_webinars", "source_name": "data_studio_s3", "source_description": "", "loader": "", "identifier": "data_studio_webinars", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"data_studio_s3\".\"data_studio_webinars\"", "created_at": 1666469550.7737095}, "source.acton_marketing_data.data_studio_s3.data_studio_webpages": {"fqn": ["acton_marketing_data", "data_studio_s3", "data_studio_webpages"], "database": "acton", "schema": "data_studio_s3", "unique_id": "source.acton_marketing_data.data_studio_s3.data_studio_webpages", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "data_studio_webpages", "source_name": "data_studio_s3", "source_description": "", "loader": "", "identifier": "data_studio_webpages", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"data_studio_s3\".\"data_studio_webpages\"", "created_at": 1666469550.7738326}, "source.acton_marketing_data.datastudio1.email_clicks_ao_20220330": {"fqn": ["acton_marketing_data", "staging", "tpch", "datastudio1", "email_clicks_ao_20220330"], "database": "acton", "schema": "datastudio1", "unique_id": "source.acton_marketing_data.datastudio1.email_clicks_ao_20220330", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "models/staging/tpch/sources.yml", "original_file_path": "models/staging/tpch/sources.yml", "name": "email_clicks_ao_20220330", "source_name": "datastudio1", "source_description": "", "loader": "", "identifier": "email_clicks_ao_20220330", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": {"location": "s3://datastudio1/email_clicks_ao_20220330.csv", "file_format": null, "row_format": null, "tbl_properties": null, "partitions": null}, "description": "This source table is actually a set of files in external storage. The dbt-external-tables package provides handy macros for getting those files queryable, just in time for modeling.\n                \n", "columns": {"Recipient E-mail": {"name": "Recipient E-mail", "description": "Email", "meta": {}, "data_type": "varchar(255)", "quote": null, "tags": []}, "Action": {"name": "Action", "description": "Action", "meta": {}, "data_type": "varchar(255)", "quote": null, "tags": []}, "Action Day": {"name": "Action Day", "description": "Action Day", "meta": {}, "data_type": "varchar(255)", "quote": null, "tags": []}, "Action Time": {"name": "Action Time", "description": "Action Time", "meta": {}, "data_type": "varchar(255)", "quote": null, "tags": []}, "Message ID": {"name": "Message ID", "description": "Message ID", "meta": {}, "data_type": "varchar(255)", "quote": null, "tags": []}, "Subject": {"name": "Subject", "description": "Message Subject", "meta": {}, "data_type": "varchar(255)", "quote": null, "tags": []}, "Message Title": {"name": "Message Title", "description": "Message Title", "meta": {}, "data_type": "varchar(255)", "quote": null, "tags": []}, "Automated Program Name": {"name": "Automated Program Name", "description": "AP Name", "meta": {}, "data_type": "varchar(255)", "quote": null, "tags": []}, "Campaign Name": {"name": "Campaign Name", "description": "Campaign Name", "meta": {}, "data_type": "varchar(255)", "quote": null, "tags": []}, "Clicked URL": {"name": "Clicked URL", "description": "Clicked URL", "meta": {}, "data_type": "varchar(255)", "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"acton\".\"datastudio1\".\"email_clicks_ao_20220330\"", "created_at": 1666469550.7739813}}, "macros": {"macro.acton_marketing_data.refresh_external_table": {"unique_id": "macro.acton_marketing_data.refresh_external_table", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "macros/common/refresh_external_table.sql", "original_file_path": "macros/common/refresh_external_table.sql", "name": "refresh_external_table", "macro_sql": "{% macro refresh_external_table(source_node) %}\r\n    {{ return(adapter.dispatch('refresh_external_table', 'dbt_external_tables')(source_node)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.acton_marketing_data.default__refresh_external_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.8705616}, "macro.acton_marketing_data.default__refresh_external_table": {"unique_id": "macro.acton_marketing_data.default__refresh_external_table", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "macros/common/refresh_external_table.sql", "original_file_path": "macros/common/refresh_external_table.sql", "name": "default__refresh_external_table", "macro_sql": "{% macro default__refresh_external_table(source_node) %}\r\n    {% do return([]) %}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.87094}, "macro.acton_marketing_data.get_external_build_plan": {"unique_id": "macro.acton_marketing_data.get_external_build_plan", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "macros/common/get_external_build_plan.sql", "original_file_path": "macros/common/get_external_build_plan.sql", "name": "get_external_build_plan", "macro_sql": "{% macro get_external_build_plan(source_node) %}\r\n    {{ return(adapter.dispatch('get_external_build_plan', 'dbt_external_tables')(source_node)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.acton_marketing_data.default__get_external_build_plan"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.8717413}, "macro.acton_marketing_data.default__get_external_build_plan": {"unique_id": "macro.acton_marketing_data.default__get_external_build_plan", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "macros/common/get_external_build_plan.sql", "original_file_path": "macros/common/get_external_build_plan.sql", "name": "default__get_external_build_plan", "macro_sql": "{% macro default__get_external_build_plan(source_node) %}\r\n    {{ exceptions.raise_compiler_error(\"Staging external sources is not implemented for the default adapter\") }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.8720531}, "macro.acton_marketing_data.create_external_table": {"unique_id": "macro.acton_marketing_data.create_external_table", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "macros/common/create_external_table.sql", "original_file_path": "macros/common/create_external_table.sql", "name": "create_external_table", "macro_sql": "{% macro create_external_table(source_node) %}\r\n    {{ adapter.dispatch('create_external_table', 'dbt_external_tables')(source_node) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.acton_marketing_data.default__create_external_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.8727193}, "macro.acton_marketing_data.default__create_external_table": {"unique_id": "macro.acton_marketing_data.default__create_external_table", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "macros/common/create_external_table.sql", "original_file_path": "macros/common/create_external_table.sql", "name": "default__create_external_table", "macro_sql": "{% macro default__create_external_table(source_node) %}\r\n    {{ exceptions.raise_compiler_error(\"External table creation is not implemented for the default adapter\") }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.8731523}, "macro.acton_marketing_data.stage_external_sources": {"unique_id": "macro.acton_marketing_data.stage_external_sources", "package_name": "acton_marketing_data", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981", "path": "macros/common/stage_external_sources.sql", "original_file_path": "macros/common/stage_external_sources.sql", "name": "stage_external_sources", "macro_sql": "{% macro stage_external_sources(select=none) %}\r\n\r\n    {% set sources_to_stage = [] %}\r\n    \r\n    {% set source_nodes = graph.sources.values() if graph.sources else [] %}\r\n    \r\n    {% for node in source_nodes %}\r\n        {% if node.external %}\r\n            \r\n            {% if select %}\r\n            \r\n                {% for src in select.split(' ') %}\r\n                \r\n                    {% if '.' in src %}\r\n                        {% set src_s = src.split('.') %}\r\n                        {% if src_s[0] == node.source_name and src_s[1] == node.name %}\r\n                            {% do sources_to_stage.append(node) %}\r\n                        {% endif %}\r\n                    {% else %}\r\n                        {% if src == node.source_name %}\r\n                            {% do sources_to_stage.append(node) %}\r\n                        {% endif %}\r\n                    {% endif %}\r\n                    \r\n                {% endfor %}\r\n                        \r\n            {% else %}\r\n            \r\n                {% do sources_to_stage.append(node) %}\r\n                \r\n            {% endif %}\r\n        {% endif %}\r\n        \r\n    {% endfor %}\r\n    \r\n    {% if sources_to_stage|length == 0 %}\r\n        {% do log('No external sources selected', info = true) %}\r\n    {% endif %}\r\n            \r\n    {% for node in sources_to_stage %}\r\n\r\n        {% set loop_label = loop.index ~ ' of ' ~ loop.length %}\r\n\r\n        {% do log(loop_label ~ ' START external source ' ~ node.schema ~ '.' ~ node.identifier, info = true) -%}\r\n        \r\n        {% set run_queue = dbt_external_tables.get_external_build_plan(node) %}\r\n        \r\n        {% do log(loop_label ~ ' SKIP', info = true) if run_queue == [] %}\r\n        {% set width = flags.PRINTER_WIDTH %}\r\n        \r\n        {% for q in run_queue %}\r\n        \r\n            {% set q_msg = q|replace('\\n','')|replace('begin;','')|trim %}\r\n            {% set q_log = q_msg[:width] ~ '...  ' if q_msg|length > width else q_msg %}\r\n        \r\n            {% do log(loop_label ~ ' (' ~ loop.index ~ ') ' ~ q_log, info = true) %}\r\n            {% set exit_txn = dbt_external_tables.exit_transaction() %}\r\n        \r\n            {% call statement('runner', fetch_result = True, auto_begin = False) %}\r\n                {{ exit_txn }} {{ q }}\r\n            {% endcall %}\r\n            \r\n            {% set runner = load_result('runner') %}\r\n            {% set log_msg = runner['response'] if 'response' in runner.keys() else runner['status'] %}\r\n            {% do log(loop_label ~ ' (' ~ loop.index ~ ') ' ~ log_msg, info = true) %}\r\n            \r\n        {% endfor %}\r\n        \r\n    {% endfor %}\r\n    \r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.get_external_build_plan", "macro.dbt_external_tables.exit_transaction", "macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.883403}, "macro.dbt_postgres.postgres_get_relations": {"unique_id": "macro.dbt_postgres.postgres_get_relations", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/relations.sql", "original_file_path": "macros/relations.sql", "name": "postgres_get_relations", "macro_sql": "{% macro postgres_get_relations () -%}\n\n  {#\n      -- in pg_depend, objid is the dependent, refobjid is the referenced object\n      --  > a pg_depend entry indicates that the referenced object cannot be\n      --  > dropped without also dropping the dependent object.\n  #}\n\n  {%- call statement('relations', fetch_result=True) -%}\n    with relation as (\n        select\n            pg_rewrite.ev_class as class,\n            pg_rewrite.oid as id\n        from pg_rewrite\n    ),\n    class as (\n        select\n            oid as id,\n            relname as name,\n            relnamespace as schema,\n            relkind as kind\n        from pg_class\n    ),\n    dependency as (\n        select distinct\n            pg_depend.objid as id,\n            pg_depend.refobjid as ref\n        from pg_depend\n    ),\n    schema as (\n        select\n            pg_namespace.oid as id,\n            pg_namespace.nspname as name\n        from pg_namespace\n        where nspname != 'information_schema' and nspname not like 'pg\\_%'\n    ),\n    referenced as (\n        select\n            relation.id AS id,\n            referenced_class.name ,\n            referenced_class.schema ,\n            referenced_class.kind\n        from relation\n        join class as referenced_class on relation.class=referenced_class.id\n        where referenced_class.kind in ('r', 'v')\n    ),\n    relationships as (\n        select\n            referenced.name as referenced_name,\n            referenced.schema as referenced_schema_id,\n            dependent_class.name as dependent_name,\n            dependent_class.schema as dependent_schema_id,\n            referenced.kind as kind\n        from referenced\n        join dependency on referenced.id=dependency.id\n        join class as dependent_class on dependency.ref=dependent_class.id\n        where\n            (referenced.name != dependent_class.name or\n             referenced.schema != dependent_class.schema)\n    )\n\n    select\n        referenced_schema.name as referenced_schema,\n        relationships.referenced_name as referenced_name,\n        dependent_schema.name as dependent_schema,\n        relationships.dependent_name as dependent_name\n    from relationships\n    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id\n    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id\n    group by referenced_schema, referenced_name, dependent_schema, dependent_name\n    order by referenced_schema, referenced_name, dependent_schema, dependent_name;\n\n  {%- endcall -%}\n\n  {{ return(load_result('relations').table) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.884691}, "macro.dbt_postgres.postgres__create_table_as": {"unique_id": "macro.dbt_postgres.postgres__create_table_as", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__create_table_as", "macro_sql": "{% macro postgres__create_table_as(temporary, relation, sql) -%}\n  {%- set unlogged = config.get('unlogged', default=false) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n  create {% if temporary -%}\n    temporary\n  {%- elif unlogged -%}\n    unlogged\n  {%- endif %} table {{ relation }}\n  as (\n    {{ sql }}\n  );\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.8951888}, "macro.dbt_postgres.postgres__get_create_index_sql": {"unique_id": "macro.dbt_postgres.postgres__get_create_index_sql", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__get_create_index_sql", "macro_sql": "{% macro postgres__get_create_index_sql(relation, index_dict) -%}\n  {%- set index_config = adapter.parse_index(index_dict) -%}\n  {%- set comma_separated_columns = \", \".join(index_config.columns) -%}\n  {%- set index_name = index_config.render(relation) -%}\n\n  create {% if index_config.unique -%}\n    unique\n  {%- endif %} index if not exists\n  \"{{ index_name }}\"\n  on {{ relation }} {% if index_config.type -%}\n    using {{ index_config.type }}\n  {%- endif %}\n  ({{ comma_separated_columns }});\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.8962631}, "macro.dbt_postgres.postgres__create_schema": {"unique_id": "macro.dbt_postgres.postgres__create_schema", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__create_schema", "macro_sql": "{% macro postgres__create_schema(relation) -%}\n  {% if relation.database -%}\n    {{ adapter.verify_database(relation.database) }}\n  {%- endif -%}\n  {%- call statement('create_schema') -%}\n    create schema if not exists {{ relation.without_identifier().include(database=False) }}\n  {%- endcall -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.8970485}, "macro.dbt_postgres.postgres__drop_schema": {"unique_id": "macro.dbt_postgres.postgres__drop_schema", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__drop_schema", "macro_sql": "{% macro postgres__drop_schema(relation) -%}\n  {% if relation.database -%}\n    {{ adapter.verify_database(relation.database) }}\n  {%- endif -%}\n  {%- call statement('drop_schema') -%}\n    drop schema if exists {{ relation.without_identifier().include(database=False) }} cascade\n  {%- endcall -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.8977902}, "macro.dbt_postgres.postgres__get_columns_in_relation": {"unique_id": "macro.dbt_postgres.postgres__get_columns_in_relation", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__get_columns_in_relation", "macro_sql": "{% macro postgres__get_columns_in_relation(relation) -%}\n  {% call statement('get_columns_in_relation', fetch_result=True) %}\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from {{ relation.information_schema('columns') }}\n      where table_name = '{{ relation.identifier }}'\n        {% if relation.schema %}\n        and table_schema = '{{ relation.schema }}'\n        {% endif %}\n      order by ordinal_position\n\n  {% endcall %}\n  {% set table = load_result('get_columns_in_relation').table %}\n  {{ return(sql_convert_columns_in_relation(table)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.sql_convert_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.8988273}, "macro.dbt_postgres.postgres__list_relations_without_caching": {"unique_id": "macro.dbt_postgres.postgres__list_relations_without_caching", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__list_relations_without_caching", "macro_sql": "{% macro postgres__list_relations_without_caching(schema_relation) %}\n  {% call statement('list_relations_without_caching', fetch_result=True) -%}\n    select\n      '{{ schema_relation.database }}' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike '{{ schema_relation.schema }}'\n    union all\n    select\n      '{{ schema_relation.database }}' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike '{{ schema_relation.schema }}'\n  {% endcall %}\n  {{ return(load_result('list_relations_without_caching').table) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.8996322}, "macro.dbt_postgres.postgres__information_schema_name": {"unique_id": "macro.dbt_postgres.postgres__information_schema_name", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__information_schema_name", "macro_sql": "{% macro postgres__information_schema_name(database) -%}\n  {% if database_name -%}\n    {{ adapter.verify_database(database_name) }}\n  {%- endif -%}\n  information_schema\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9000218}, "macro.dbt_postgres.postgres__list_schemas": {"unique_id": "macro.dbt_postgres.postgres__list_schemas", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__list_schemas", "macro_sql": "{% macro postgres__list_schemas(database) %}\n  {% if database -%}\n    {{ adapter.verify_database(database) }}\n  {%- endif -%}\n  {% call statement('list_schemas', fetch_result=True, auto_begin=False) %}\n    select distinct nspname from pg_namespace\n  {% endcall %}\n  {{ return(load_result('list_schemas').table) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.90078}, "macro.dbt_postgres.postgres__check_schema_exists": {"unique_id": "macro.dbt_postgres.postgres__check_schema_exists", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__check_schema_exists", "macro_sql": "{% macro postgres__check_schema_exists(information_schema, schema) -%}\n  {% if information_schema.database -%}\n    {{ adapter.verify_database(information_schema.database) }}\n  {%- endif -%}\n  {% call statement('check_schema_exists', fetch_result=True, auto_begin=False) %}\n    select count(*) from pg_namespace where nspname = '{{ schema }}'\n  {% endcall %}\n  {{ return(load_result('check_schema_exists').table) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9016623}, "macro.dbt_postgres.postgres__current_timestamp": {"unique_id": "macro.dbt_postgres.postgres__current_timestamp", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__current_timestamp", "macro_sql": "{% macro postgres__current_timestamp() -%}\n  now()\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.901851}, "macro.dbt_postgres.postgres__snapshot_string_as_time": {"unique_id": "macro.dbt_postgres.postgres__snapshot_string_as_time", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__snapshot_string_as_time", "macro_sql": "{% macro postgres__snapshot_string_as_time(timestamp) -%}\n    {%- set result = \"'\" ~ timestamp ~ \"'::timestamp without time zone\" -%}\n    {{ return(result) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.902289}, "macro.dbt_postgres.postgres__snapshot_get_time": {"unique_id": "macro.dbt_postgres.postgres__snapshot_get_time", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__snapshot_get_time", "macro_sql": "{% macro postgres__snapshot_get_time() -%}\n  {{ current_timestamp() }}::timestamp without time zone\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9025283}, "macro.dbt_postgres.postgres__make_relation_with_suffix": {"unique_id": "macro.dbt_postgres.postgres__make_relation_with_suffix", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__make_relation_with_suffix", "macro_sql": "{% macro postgres__make_relation_with_suffix(base_relation, suffix, dstring) %}\n    {% if dstring %}\n      {% set dt = modules.datetime.datetime.now() %}\n      {% set dtstring = dt.strftime(\"%H%M%S%f\") %}\n      {% set suffix = suffix ~ dtstring %}\n    {% endif %}\n    {% set suffix_length = suffix|length %}\n    {% set relation_max_name_length = base_relation.relation_max_name_length() %}\n    {% if suffix_length > relation_max_name_length %}\n        {% do exceptions.raise_compiler_error('Relation suffix is too long (' ~ suffix_length ~ ' characters). Maximum length is ' ~ relation_max_name_length ~ ' characters.') %}\n    {% endif %}\n    {% set identifier = base_relation.identifier[:relation_max_name_length - suffix_length] ~ suffix %}\n\n    {{ return(base_relation.incorporate(path={\"identifier\": identifier })) }}\n\n  {% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9042668}, "macro.dbt_postgres.postgres__make_intermediate_relation": {"unique_id": "macro.dbt_postgres.postgres__make_intermediate_relation", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__make_intermediate_relation", "macro_sql": "{% macro postgres__make_intermediate_relation(base_relation, suffix) %}\n    {{ return(postgres__make_relation_with_suffix(base_relation, suffix, dstring=False)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_relation_with_suffix"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9048214}, "macro.dbt_postgres.postgres__make_temp_relation": {"unique_id": "macro.dbt_postgres.postgres__make_temp_relation", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__make_temp_relation", "macro_sql": "{% macro postgres__make_temp_relation(base_relation, suffix) %}\n    {% set temp_relation = postgres__make_relation_with_suffix(base_relation, suffix, dstring=True) %}\n    {{ return(temp_relation.incorporate(path={\"schema\": none,\n                                              \"database\": none})) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_relation_with_suffix"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9055722}, "macro.dbt_postgres.postgres__make_backup_relation": {"unique_id": "macro.dbt_postgres.postgres__make_backup_relation", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__make_backup_relation", "macro_sql": "{% macro postgres__make_backup_relation(base_relation, backup_relation_type, suffix) %}\n    {% set backup_relation = postgres__make_relation_with_suffix(base_relation, suffix, dstring=False) %}\n    {{ return(backup_relation.incorporate(type=backup_relation_type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_relation_with_suffix"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9061785}, "macro.dbt_postgres.postgres_escape_comment": {"unique_id": "macro.dbt_postgres.postgres_escape_comment", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres_escape_comment", "macro_sql": "{% macro postgres_escape_comment(comment) -%}\n  {% if comment is not string %}\n    {% do exceptions.raise_compiler_error('cannot escape a non-string: ' ~ comment) %}\n  {% endif %}\n  {%- set magic = '$dbt_comment_literal_block$' -%}\n  {%- if magic in comment -%}\n    {%- do exceptions.raise_compiler_error('The string ' ~ magic ~ ' is not allowed in comments.') -%}\n  {%- endif -%}\n  {{ magic }}{{ comment }}{{ magic }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9071062}, "macro.dbt_postgres.postgres__alter_relation_comment": {"unique_id": "macro.dbt_postgres.postgres__alter_relation_comment", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__alter_relation_comment", "macro_sql": "{% macro postgres__alter_relation_comment(relation, comment) %}\n  {% set escaped_comment = postgres_escape_comment(comment) %}\n  comment on {{ relation.type }} {{ relation }} is {{ escaped_comment }};\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres_escape_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9076066}, "macro.dbt_postgres.postgres__alter_column_comment": {"unique_id": "macro.dbt_postgres.postgres__alter_column_comment", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__alter_column_comment", "macro_sql": "{% macro postgres__alter_column_comment(relation, column_dict) %}\n  {% set existing_columns = adapter.get_columns_in_relation(relation) | map(attribute=\"name\") | list %}\n  {% for column_name in column_dict if (column_name in existing_columns) %}\n    {% set comment = column_dict[column_name]['description'] %}\n    {% set escaped_comment = postgres_escape_comment(comment) %}\n    comment on column {{ relation }}.{{ adapter.quote(column_name) if column_dict[column_name]['quote'] else column_name }} is {{ escaped_comment }};\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres_escape_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9088795}, "macro.dbt_postgres.postgres__get_show_grant_sql": {"unique_id": "macro.dbt_postgres.postgres__get_show_grant_sql", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__get_show_grant_sql", "macro_sql": "\n\n{%- macro postgres__get_show_grant_sql(relation) -%}\n  select grantee, privilege_type\n  from {{ relation.information_schema('role_table_grants') }}\n      where grantor = current_role\n        and grantee != current_role\n        and table_schema = '{{ relation.schema }}'\n        and table_name = '{{ relation.identifier }}'\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.909354}, "macro.dbt_postgres.postgres__copy_grants": {"unique_id": "macro.dbt_postgres.postgres__copy_grants", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "postgres__copy_grants", "macro_sql": "{% macro postgres__copy_grants() %}\n    {{ return(False) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9096324}, "macro.dbt_postgres.postgres__get_catalog": {"unique_id": "macro.dbt_postgres.postgres__get_catalog", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/catalog.sql", "original_file_path": "macros/catalog.sql", "name": "postgres__get_catalog", "macro_sql": "{% macro postgres__get_catalog(information_schema, schemas) -%}\n\n  {%- call statement('catalog', fetch_result=True) -%}\n    {#\n      If the user has multiple databases set and the first one is wrong, this will fail.\n      But we won't fail in the case where there are multiple quoting-difference-only dbs, which is better.\n    #}\n    {% set database = information_schema.database %}\n    {{ adapter.verify_database(database) }}\n\n    select\n        '{{ database }}' as table_database,\n        sch.nspname as table_schema,\n        tbl.relname as table_name,\n        case tbl.relkind\n            when 'v' then 'VIEW'\n            else 'BASE TABLE'\n        end as table_type,\n        tbl_desc.description as table_comment,\n        col.attname as column_name,\n        col.attnum as column_index,\n        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,\n        col_desc.description as column_comment,\n        pg_get_userbyid(tbl.relowner) as table_owner\n\n    from pg_catalog.pg_namespace sch\n    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid\n    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid\n    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)\n    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)\n\n    where (\n        {%- for schema in schemas -%}\n          upper(sch.nspname) = upper('{{ schema }}'){%- if not loop.last %} or {% endif -%}\n        {%- endfor -%}\n      )\n      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session\n      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables\n      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view\n      and col.attnum > 0 -- negative numbers are used for system columns such as oid\n      and not col.attisdropped -- column as not been dropped\n\n    order by\n        sch.nspname,\n        tbl.relname,\n        col.attnum\n\n  {%- endcall -%}\n\n  {{ return(load_result('catalog').table) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.911701}, "macro.dbt_postgres.postgres__split_part": {"unique_id": "macro.dbt_postgres.postgres__split_part", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "name": "postgres__split_part", "macro_sql": "{% macro postgres__split_part(string_text, delimiter_text, part_number) %}\n\n  {% if part_number >= 0 %}\n    {{ dbt.default__split_part(string_text, delimiter_text, part_number) }}\n  {% else %}\n    {{ dbt._split_part_negative(string_text, delimiter_text, part_number) }}\n  {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__split_part", "macro.dbt._split_part_negative"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.912706}, "macro.dbt_postgres.postgres__any_value": {"unique_id": "macro.dbt_postgres.postgres__any_value", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/utils/any_value.sql", "original_file_path": "macros/utils/any_value.sql", "name": "postgres__any_value", "macro_sql": "{% macro postgres__any_value(expression) -%}\n\n    min({{ expression }})\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9132283}, "macro.dbt_postgres.postgres__datediff": {"unique_id": "macro.dbt_postgres.postgres__datediff", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/utils/datediff.sql", "original_file_path": "macros/utils/datediff.sql", "name": "postgres__datediff", "macro_sql": "{% macro postgres__datediff(first_date, second_date, datepart) -%}\n\n    {% if datepart == 'year' %}\n        (date_part('year', ({{second_date}})::date) - date_part('year', ({{first_date}})::date))\n    {% elif datepart == 'quarter' %}\n        ({{ datediff(first_date, second_date, 'year') }} * 4 + date_part('quarter', ({{second_date}})::date) - date_part('quarter', ({{first_date}})::date))\n    {% elif datepart == 'month' %}\n        ({{ datediff(first_date, second_date, 'year') }} * 12 + date_part('month', ({{second_date}})::date) - date_part('month', ({{first_date}})::date))\n    {% elif datepart == 'day' %}\n        (({{second_date}})::date - ({{first_date}})::date)\n    {% elif datepart == 'week' %}\n        ({{ datediff(first_date, second_date, 'day') }} / 7 + case\n            when date_part('dow', ({{first_date}})::timestamp) <= date_part('dow', ({{second_date}})::timestamp) then\n                case when {{first_date}} <= {{second_date}} then 0 else -1 end\n            else\n                case when {{first_date}} <= {{second_date}} then 1 else 0 end\n        end)\n    {% elif datepart == 'hour' %}\n        ({{ datediff(first_date, second_date, 'day') }} * 24 + date_part('hour', ({{second_date}})::timestamp) - date_part('hour', ({{first_date}})::timestamp))\n    {% elif datepart == 'minute' %}\n        ({{ datediff(first_date, second_date, 'hour') }} * 60 + date_part('minute', ({{second_date}})::timestamp) - date_part('minute', ({{first_date}})::timestamp))\n    {% elif datepart == 'second' %}\n        ({{ datediff(first_date, second_date, 'minute') }} * 60 + floor(date_part('second', ({{second_date}})::timestamp)) - floor(date_part('second', ({{first_date}})::timestamp)))\n    {% elif datepart == 'millisecond' %}\n        ({{ datediff(first_date, second_date, 'minute') }} * 60000 + floor(date_part('millisecond', ({{second_date}})::timestamp)) - floor(date_part('millisecond', ({{first_date}})::timestamp)))\n    {% elif datepart == 'microsecond' %}\n        ({{ datediff(first_date, second_date, 'minute') }} * 60000000 + floor(date_part('microsecond', ({{second_date}})::timestamp)) - floor(date_part('microsecond', ({{first_date}})::timestamp)))\n    {% else %}\n        {{ exceptions.raise_compiler_error(\"Unsupported datepart for macro datediff in postgres: {!r}\".format(datepart)) }}\n    {% endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9193647}, "macro.dbt_postgres.postgres__dateadd": {"unique_id": "macro.dbt_postgres.postgres__dateadd", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/utils/dateadd.sql", "original_file_path": "macros/utils/dateadd.sql", "name": "postgres__dateadd", "macro_sql": "{% macro postgres__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n    {{ from_date_or_timestamp }} + ((interval '1 {{ datepart }}') * ({{ interval }}))\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9199836}, "macro.dbt_postgres.postgres__last_day": {"unique_id": "macro.dbt_postgres.postgres__last_day", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "name": "postgres__last_day", "macro_sql": "{% macro postgres__last_day(date, datepart) -%}\n\n    {%- if datepart == 'quarter' -%}\n    -- postgres dateadd does not support quarter interval.\n    cast(\n        {{dbt.dateadd('day', '-1',\n        dbt.dateadd('month', '3', dbt.date_trunc(datepart, date))\n        )}}\n        as date)\n    {%- else -%}\n    {{dbt.default_last_day(date, datepart)}}\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.dateadd", "macro.dbt_utils.date_trunc", "macro.dbt.default_last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9212599}, "macro.dbt_postgres.postgres__listagg": {"unique_id": "macro.dbt_postgres.postgres__listagg", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/utils/listagg.sql", "original_file_path": "macros/utils/listagg.sql", "name": "postgres__listagg", "macro_sql": "{% macro postgres__listagg(measure, delimiter_text, order_by_clause, limit_num) -%}\n\n    {% if limit_num -%}\n    array_to_string(\n        (array_agg(\n            {{ measure }}\n            {% if order_by_clause -%}\n            {{ order_by_clause }}\n            {%- endif %}\n        ))[1:{{ limit_num }}],\n        {{ delimiter_text }}\n        )\n    {%- else %}\n    string_agg(\n        {{ measure }},\n        {{ delimiter_text }}\n        {% if order_by_clause -%}\n        {{ order_by_clause }}\n        {%- endif %}\n        )\n    {%- endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.922638}, "macro.dbt_postgres.postgres__snapshot_merge_sql": {"unique_id": "macro.dbt_postgres.postgres__snapshot_merge_sql", "package_name": "dbt_postgres", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/postgres", "path": "macros/materializations/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshot_merge.sql", "name": "postgres__snapshot_merge_sql", "macro_sql": "{% macro postgres__snapshot_merge_sql(target, source, insert_cols) -%}\n    {%- set insert_cols_csv = insert_cols | join(', ') -%}\n\n    update {{ target }}\n    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n    from {{ source }} as DBT_INTERNAL_SOURCE\n    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = {{ target }}.dbt_scd_id::text\n      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)\n      and {{ target }}.dbt_valid_to is null;\n\n    insert into {{ target }} ({{ insert_cols_csv }})\n    select {% for column in insert_cols -%}\n        DBT_INTERNAL_SOURCE.{{ column }} {%- if not loop.last %}, {%- endif %}\n    {%- endfor %}\n    from {{ source }} as DBT_INTERNAL_SOURCE\n    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.924153}, "macro.dbt.get_catalog": {"unique_id": "macro.dbt.get_catalog", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "get_catalog", "macro_sql": "{% macro get_catalog(information_schema, schemas) -%}\n  {{ return(adapter.dispatch('get_catalog', 'dbt')(information_schema, schemas)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_catalog"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9268346}, "macro.dbt.default__get_catalog": {"unique_id": "macro.dbt.default__get_catalog", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "default__get_catalog", "macro_sql": "{% macro default__get_catalog(information_schema, schemas) -%}\n\n  {% set typename = adapter.type() %}\n  {% set msg -%}\n    get_catalog not implemented for {{ typename }}\n  {%- endset %}\n\n  {{ exceptions.raise_compiler_error(msg) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9274144}, "macro.dbt.information_schema_name": {"unique_id": "macro.dbt.information_schema_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "information_schema_name", "macro_sql": "{% macro information_schema_name(database) %}\n  {{ return(adapter.dispatch('information_schema_name', 'dbt')(database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__information_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9278233}, "macro.dbt.default__information_schema_name": {"unique_id": "macro.dbt.default__information_schema_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "default__information_schema_name", "macro_sql": "{% macro default__information_schema_name(database) -%}\n  {%- if database -%}\n    {{ database }}.INFORMATION_SCHEMA\n  {%- else -%}\n    INFORMATION_SCHEMA\n  {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.928174}, "macro.dbt.list_schemas": {"unique_id": "macro.dbt.list_schemas", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "list_schemas", "macro_sql": "{% macro list_schemas(database) -%}\n  {{ return(adapter.dispatch('list_schemas', 'dbt')(database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__list_schemas"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9285617}, "macro.dbt.default__list_schemas": {"unique_id": "macro.dbt.default__list_schemas", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "default__list_schemas", "macro_sql": "{% macro default__list_schemas(database) -%}\n  {% set sql %}\n    select distinct schema_name\n    from {{ information_schema_name(database) }}.SCHEMATA\n    where catalog_name ilike '{{ database }}'\n  {% endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.information_schema_name", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.929266}, "macro.dbt.check_schema_exists": {"unique_id": "macro.dbt.check_schema_exists", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "check_schema_exists", "macro_sql": "{% macro check_schema_exists(information_schema, schema) -%}\n  {{ return(adapter.dispatch('check_schema_exists', 'dbt')(information_schema, schema)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__check_schema_exists"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9297323}, "macro.dbt.default__check_schema_exists": {"unique_id": "macro.dbt.default__check_schema_exists", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "default__check_schema_exists", "macro_sql": "{% macro default__check_schema_exists(information_schema, schema) -%}\n  {% set sql -%}\n        select count(*)\n        from {{ information_schema.replace(information_schema_view='SCHEMATA') }}\n        where catalog_name='{{ information_schema.database }}'\n          and schema_name='{{ schema }}'\n  {%- endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.replace", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9304676}, "macro.dbt.list_relations_without_caching": {"unique_id": "macro.dbt.list_relations_without_caching", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "list_relations_without_caching", "macro_sql": "{% macro list_relations_without_caching(schema_relation) %}\n  {{ return(adapter.dispatch('list_relations_without_caching', 'dbt')(schema_relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__list_relations_without_caching"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9308813}, "macro.dbt.default__list_relations_without_caching": {"unique_id": "macro.dbt.default__list_relations_without_caching", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "default__list_relations_without_caching", "macro_sql": "{% macro default__list_relations_without_caching(schema_relation) %}\n  {{ exceptions.raise_not_implemented(\n    'list_relations_without_caching macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9312418}, "macro.dbt.get_columns_in_relation": {"unique_id": "macro.dbt.get_columns_in_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "get_columns_in_relation", "macro_sql": "{% macro get_columns_in_relation(relation) -%}\n  {{ return(adapter.dispatch('get_columns_in_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9340992}, "macro.dbt.default__get_columns_in_relation": {"unique_id": "macro.dbt.default__get_columns_in_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "default__get_columns_in_relation", "macro_sql": "{% macro default__get_columns_in_relation(relation) -%}\n  {{ exceptions.raise_not_implemented(\n    'get_columns_in_relation macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9344532}, "macro.dbt.sql_convert_columns_in_relation": {"unique_id": "macro.dbt.sql_convert_columns_in_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "sql_convert_columns_in_relation", "macro_sql": "{% macro sql_convert_columns_in_relation(table) -%}\n  {% set columns = [] %}\n  {% for row in table %}\n    {% do columns.append(api.Column(*row)) %}\n  {% endfor %}\n  {{ return(columns) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9351232}, "macro.dbt.get_columns_in_query": {"unique_id": "macro.dbt.get_columns_in_query", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "get_columns_in_query", "macro_sql": "{% macro get_columns_in_query(select_sql) -%}\n  {{ return(adapter.dispatch('get_columns_in_query', 'dbt')(select_sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.935602}, "macro.dbt.default__get_columns_in_query": {"unique_id": "macro.dbt.default__get_columns_in_query", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "default__get_columns_in_query", "macro_sql": "{% macro default__get_columns_in_query(select_sql) %}\n    {% call statement('get_columns_in_query', fetch_result=True, auto_begin=False) -%}\n        select * from (\n            {{ select_sql }}\n        ) as __dbt_sbq\n        where false\n        limit 0\n    {% endcall %}\n\n    {{ return(load_result('get_columns_in_query').table.columns | map(attribute='name') | list) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9363408}, "macro.dbt.alter_column_type": {"unique_id": "macro.dbt.alter_column_type", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "alter_column_type", "macro_sql": "{% macro alter_column_type(relation, column_name, new_column_type) -%}\n  {{ return(adapter.dispatch('alter_column_type', 'dbt')(relation, column_name, new_column_type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9368315}, "macro.dbt.default__alter_column_type": {"unique_id": "macro.dbt.default__alter_column_type", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "default__alter_column_type", "macro_sql": "{% macro default__alter_column_type(relation, column_name, new_column_type) -%}\n  {#\n    1. Create a new column (w/ temp name and correct type)\n    2. Copy data over to it\n    3. Drop the existing column (cascade!)\n    4. Rename the new column to existing column\n  #}\n  {%- set tmp_column = column_name + \"__dbt_alter\" -%}\n\n  {% call statement('alter_column_type') %}\n    alter table {{ relation }} add column {{ adapter.quote(tmp_column) }} {{ new_column_type }};\n    update {{ relation }} set {{ adapter.quote(tmp_column) }} = {{ adapter.quote(column_name) }};\n    alter table {{ relation }} drop column {{ adapter.quote(column_name) }} cascade;\n    alter table {{ relation }} rename column {{ adapter.quote(tmp_column) }} to {{ adapter.quote(column_name) }}\n  {% endcall %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.938145}, "macro.dbt.alter_relation_add_remove_columns": {"unique_id": "macro.dbt.alter_relation_add_remove_columns", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "alter_relation_add_remove_columns", "macro_sql": "{% macro alter_relation_add_remove_columns(relation, add_columns = none, remove_columns = none) -%}\n  {{ return(adapter.dispatch('alter_relation_add_remove_columns', 'dbt')(relation, add_columns, remove_columns)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__alter_relation_add_remove_columns"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.938696}, "macro.dbt.default__alter_relation_add_remove_columns": {"unique_id": "macro.dbt.default__alter_relation_add_remove_columns", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "default__alter_relation_add_remove_columns", "macro_sql": "{% macro default__alter_relation_add_remove_columns(relation, add_columns, remove_columns) %}\n\n  {% if add_columns is none %}\n    {% set add_columns = [] %}\n  {% endif %}\n  {% if remove_columns is none %}\n    {% set remove_columns = [] %}\n  {% endif %}\n\n  {% set sql -%}\n\n     alter {{ relation.type }} {{ relation }}\n\n            {% for column in add_columns %}\n               add column {{ column.name }} {{ column.data_type }}{{ ',' if not loop.last }}\n            {% endfor %}{{ ',' if add_columns and remove_columns }}\n\n            {% for column in remove_columns %}\n                drop column {{ column.name }}{{ ',' if not loop.last }}\n            {% endfor %}\n\n  {%- endset -%}\n\n  {% do run_query(sql) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9403737}, "macro.dbt.current_timestamp": {"unique_id": "macro.dbt.current_timestamp", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "name": "current_timestamp", "macro_sql": "{% macro current_timestamp() -%}\n  {{ adapter.dispatch('current_timestamp', 'dbt')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9414816}, "macro.dbt.default__current_timestamp": {"unique_id": "macro.dbt.default__current_timestamp", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "name": "default__current_timestamp", "macro_sql": "{% macro default__current_timestamp() -%}\n  {{ exceptions.raise_not_implemented(\n    'current_timestamp macro not implemented for adapter '+adapter.type()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.941812}, "macro.dbt.collect_freshness": {"unique_id": "macro.dbt.collect_freshness", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "name": "collect_freshness", "macro_sql": "{% macro collect_freshness(source, loaded_at_field, filter) %}\n  {{ return(adapter.dispatch('collect_freshness', 'dbt')(source, loaded_at_field, filter))}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__collect_freshness"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9423072}, "macro.dbt.default__collect_freshness": {"unique_id": "macro.dbt.default__collect_freshness", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "name": "default__collect_freshness", "macro_sql": "{% macro default__collect_freshness(source, loaded_at_field, filter) %}\n  {% call statement('collect_freshness', fetch_result=True, auto_begin=False) -%}\n    select\n      max({{ loaded_at_field }}) as max_loaded_at,\n      {{ current_timestamp() }} as snapshotted_at\n    from {{ source }}\n    {% if filter %}\n    where {{ filter }}\n    {% endif %}\n  {% endcall %}\n  {{ return(load_result('collect_freshness').table) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_date.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9432147}, "macro.dbt.alter_column_comment": {"unique_id": "macro.dbt.alter_column_comment", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "name": "alter_column_comment", "macro_sql": "{% macro alter_column_comment(relation, column_dict) -%}\n  {{ return(adapter.dispatch('alter_column_comment', 'dbt')(relation, column_dict)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9445481}, "macro.dbt.default__alter_column_comment": {"unique_id": "macro.dbt.default__alter_column_comment", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "name": "default__alter_column_comment", "macro_sql": "{% macro default__alter_column_comment(relation, column_dict) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_column_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.944918}, "macro.dbt.alter_relation_comment": {"unique_id": "macro.dbt.alter_relation_comment", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "name": "alter_relation_comment", "macro_sql": "{% macro alter_relation_comment(relation, relation_comment) -%}\n  {{ return(adapter.dispatch('alter_relation_comment', 'dbt')(relation, relation_comment)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__alter_relation_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9453773}, "macro.dbt.default__alter_relation_comment": {"unique_id": "macro.dbt.default__alter_relation_comment", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "name": "default__alter_relation_comment", "macro_sql": "{% macro default__alter_relation_comment(relation, relation_comment) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_relation_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9458406}, "macro.dbt.persist_docs": {"unique_id": "macro.dbt.persist_docs", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "name": "persist_docs", "macro_sql": "{% macro persist_docs(relation, model, for_relation=true, for_columns=true) -%}\n  {{ return(adapter.dispatch('persist_docs', 'dbt')(relation, model, for_relation, for_columns)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9464183}, "macro.dbt.default__persist_docs": {"unique_id": "macro.dbt.default__persist_docs", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "name": "default__persist_docs", "macro_sql": "{% macro default__persist_docs(relation, model, for_relation, for_columns) -%}\n  {% if for_relation and config.persist_relation_docs() and model.description %}\n    {% do run_query(alter_relation_comment(relation, model.description)) %}\n  {% endif %}\n\n  {% if for_columns and config.persist_column_docs() and model.columns %}\n    {% do run_query(alter_column_comment(relation, model.columns)) %}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt.alter_relation_comment", "macro.dbt.alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9475853}, "macro.dbt.copy_grants": {"unique_id": "macro.dbt.copy_grants", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "copy_grants", "macro_sql": "{% macro copy_grants() %}\n    {{ return(adapter.dispatch('copy_grants', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__copy_grants"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9505093}, "macro.dbt.default__copy_grants": {"unique_id": "macro.dbt.default__copy_grants", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "default__copy_grants", "macro_sql": "{% macro default__copy_grants() %}\n    {{ return(True) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.950856}, "macro.dbt.support_multiple_grantees_per_dcl_statement": {"unique_id": "macro.dbt.support_multiple_grantees_per_dcl_statement", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "support_multiple_grantees_per_dcl_statement", "macro_sql": "{% macro support_multiple_grantees_per_dcl_statement() %}\n    {{ return(adapter.dispatch('support_multiple_grantees_per_dcl_statement', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__support_multiple_grantees_per_dcl_statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.951234}, "macro.dbt.default__support_multiple_grantees_per_dcl_statement": {"unique_id": "macro.dbt.default__support_multiple_grantees_per_dcl_statement", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "default__support_multiple_grantees_per_dcl_statement", "macro_sql": "\n\n{%- macro default__support_multiple_grantees_per_dcl_statement() -%}\n    {{ return(True) }}\n{%- endmacro -%}\n\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9514859}, "macro.dbt.should_revoke": {"unique_id": "macro.dbt.should_revoke", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "should_revoke", "macro_sql": "{% macro should_revoke(existing_relation, full_refresh_mode=True) %}\n\n    {% if not existing_relation %}\n        {#-- The table doesn't already exist, so no grants to copy over --#}\n        {{ return(False) }}\n    {% elif full_refresh_mode %}\n        {#-- The object is being REPLACED -- whether grants are copied over depends on the value of user config --#}\n        {{ return(copy_grants()) }}\n    {% else %}\n        {#-- The table is being merged/upserted/inserted -- grants will be carried over --#}\n        {{ return(True) }}\n    {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.copy_grants"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9522312}, "macro.dbt.get_show_grant_sql": {"unique_id": "macro.dbt.get_show_grant_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "get_show_grant_sql", "macro_sql": "{% macro get_show_grant_sql(relation) %}\n    {{ return(adapter.dispatch(\"get_show_grant_sql\", \"dbt\")(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_show_grant_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.952638}, "macro.dbt.default__get_show_grant_sql": {"unique_id": "macro.dbt.default__get_show_grant_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "default__get_show_grant_sql", "macro_sql": "{% macro default__get_show_grant_sql(relation) %}\n    show grants on {{ relation }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.952871}, "macro.dbt.get_grant_sql": {"unique_id": "macro.dbt.get_grant_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "get_grant_sql", "macro_sql": "{% macro get_grant_sql(relation, privilege, grantees) %}\n    {{ return(adapter.dispatch('get_grant_sql', 'dbt')(relation, privilege, grantees)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_grant_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9533877}, "macro.dbt.default__get_grant_sql": {"unique_id": "macro.dbt.default__get_grant_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "default__get_grant_sql", "macro_sql": "\n\n{%- macro default__get_grant_sql(relation, privilege, grantees) -%}\n    grant {{ privilege }} on {{ relation }} to {{ grantees | join(', ') }}\n{%- endmacro -%}\n\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.953819}, "macro.dbt.get_revoke_sql": {"unique_id": "macro.dbt.get_revoke_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "get_revoke_sql", "macro_sql": "{% macro get_revoke_sql(relation, privilege, grantees) %}\n    {{ return(adapter.dispatch('get_revoke_sql', 'dbt')(relation, privilege, grantees)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_revoke_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.95432}, "macro.dbt.default__get_revoke_sql": {"unique_id": "macro.dbt.default__get_revoke_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "default__get_revoke_sql", "macro_sql": "\n\n{%- macro default__get_revoke_sql(relation, privilege, grantees) -%}\n    revoke {{ privilege }} on {{ relation }} from {{ grantees | join(', ') }}\n{%- endmacro -%}\n\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9547367}, "macro.dbt.get_dcl_statement_list": {"unique_id": "macro.dbt.get_dcl_statement_list", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "get_dcl_statement_list", "macro_sql": "{% macro get_dcl_statement_list(relation, grant_config, get_dcl_macro) %}\n    {{ return(adapter.dispatch('get_dcl_statement_list', 'dbt')(relation, grant_config, get_dcl_macro)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_dcl_statement_list"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.955227}, "macro.dbt.default__get_dcl_statement_list": {"unique_id": "macro.dbt.default__get_dcl_statement_list", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "default__get_dcl_statement_list", "macro_sql": "\n\n{%- macro default__get_dcl_statement_list(relation, grant_config, get_dcl_macro) -%}\n    {#\n      -- Unpack grant_config into specific privileges and the set of users who need them granted/revoked.\n      -- Depending on whether this database supports multiple grantees per statement, pass in the list of\n      -- all grantees per privilege, or (if not) template one statement per privilege-grantee pair.\n      -- `get_dcl_macro` will be either `get_grant_sql` or `get_revoke_sql`\n    #}\n    {%- set dcl_statements = [] -%}\n    {%- for privilege, grantees in grant_config.items() %}\n        {%- if support_multiple_grantees_per_dcl_statement() and grantees -%}\n          {%- set dcl = get_dcl_macro(relation, privilege, grantees) -%}\n          {%- do dcl_statements.append(dcl) -%}\n        {%- else -%}\n          {%- for grantee in grantees -%}\n              {% set dcl = get_dcl_macro(relation, privilege, [grantee]) %}\n              {%- do dcl_statements.append(dcl) -%}\n          {% endfor -%}\n        {%- endif -%}\n    {%- endfor -%}\n    {{ return(dcl_statements) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.support_multiple_grantees_per_dcl_statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9567237}, "macro.dbt.call_dcl_statements": {"unique_id": "macro.dbt.call_dcl_statements", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "call_dcl_statements", "macro_sql": "{% macro call_dcl_statements(dcl_statement_list) %}\n    {{ return(adapter.dispatch(\"call_dcl_statements\", \"dbt\")(dcl_statement_list)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__call_dcl_statements"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.95717}, "macro.dbt.default__call_dcl_statements": {"unique_id": "macro.dbt.default__call_dcl_statements", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "default__call_dcl_statements", "macro_sql": "{% macro default__call_dcl_statements(dcl_statement_list) %}\n    {#\n      -- By default, supply all grant + revoke statements in a single semicolon-separated block,\n      -- so that they're all processed together.\n\n      -- Some databases do not support this. Those adapters will need to override this macro\n      -- to run each statement individually.\n    #}\n    {% call statement('grants') %}\n        {% for dcl_statement in dcl_statement_list %}\n            {{ dcl_statement }};\n        {% endfor %}\n    {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9577217}, "macro.dbt.apply_grants": {"unique_id": "macro.dbt.apply_grants", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "apply_grants", "macro_sql": "{% macro apply_grants(relation, grant_config, should_revoke) %}\n    {{ return(adapter.dispatch(\"apply_grants\", \"dbt\")(relation, grant_config, should_revoke)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__apply_grants"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9582217}, "macro.dbt.default__apply_grants": {"unique_id": "macro.dbt.default__apply_grants", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "name": "default__apply_grants", "macro_sql": "{% macro default__apply_grants(relation, grant_config, should_revoke=True) %}\n    {#-- If grant_config is {} or None, this is a no-op --#}\n    {% if grant_config %}\n        {% if should_revoke %}\n            {#-- We think previous grants may have carried over --#}\n            {#-- Show current grants and calculate diffs --#}\n            {% set current_grants_table = run_query(get_show_grant_sql(relation)) %}\n            {% set current_grants_dict = adapter.standardize_grants_dict(current_grants_table) %}\n            {% set needs_granting = diff_of_two_dicts(grant_config, current_grants_dict) %}\n            {% set needs_revoking = diff_of_two_dicts(current_grants_dict, grant_config) %}\n            {% if not (needs_granting or needs_revoking) %}\n                {{ log('On ' ~ relation ~': All grants are in place, no revocation or granting needed.')}}\n            {% endif %}\n        {% else %}\n            {#-- We don't think there's any chance of previous grants having carried over. --#}\n            {#-- Jump straight to granting what the user has configured. --#}\n            {% set needs_revoking = {} %}\n            {% set needs_granting = grant_config %}\n        {% endif %}\n        {% if needs_granting or needs_revoking %}\n            {% set revoke_statement_list = get_dcl_statement_list(relation, needs_revoking, get_revoke_sql) %}\n            {% set grant_statement_list = get_dcl_statement_list(relation, needs_granting, get_grant_sql) %}\n            {% set dcl_statement_list = revoke_statement_list + grant_statement_list %}\n            {% if dcl_statement_list %}\n                {{ call_dcl_statements(dcl_statement_list) }}\n            {% endif %}\n        {% endif %}\n    {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt.get_show_grant_sql", "macro.dbt.get_dcl_statement_list", "macro.dbt.call_dcl_statements"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9607668}, "macro.dbt.make_intermediate_relation": {"unique_id": "macro.dbt.make_intermediate_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "make_intermediate_relation", "macro_sql": "{% macro make_intermediate_relation(base_relation, suffix='__dbt_tmp') %}\n  {{ return(adapter.dispatch('make_intermediate_relation', 'dbt')(base_relation, suffix)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_intermediate_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.966247}, "macro.dbt.default__make_intermediate_relation": {"unique_id": "macro.dbt.default__make_intermediate_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "default__make_intermediate_relation", "macro_sql": "{% macro default__make_intermediate_relation(base_relation, suffix) %}\n    {{ return(default__make_temp_relation(base_relation, suffix)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__make_temp_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.966629}, "macro.dbt.make_temp_relation": {"unique_id": "macro.dbt.make_temp_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "make_temp_relation", "macro_sql": "{% macro make_temp_relation(base_relation, suffix='__dbt_tmp') %}\n  {{ return(adapter.dispatch('make_temp_relation', 'dbt')(base_relation, suffix)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_temp_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.967105}, "macro.dbt.default__make_temp_relation": {"unique_id": "macro.dbt.default__make_temp_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "default__make_temp_relation", "macro_sql": "{% macro default__make_temp_relation(base_relation, suffix) %}\n    {%- set temp_identifier = base_relation.identifier ~ suffix -%}\n    {%- set temp_relation = base_relation.incorporate(\n                                path={\"identifier\": temp_identifier}) -%}\n\n    {{ return(temp_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.967727}, "macro.dbt.make_backup_relation": {"unique_id": "macro.dbt.make_backup_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "make_backup_relation", "macro_sql": "{% macro make_backup_relation(base_relation, backup_relation_type, suffix='__dbt_backup') %}\n    {{ return(adapter.dispatch('make_backup_relation', 'dbt')(base_relation, backup_relation_type, suffix)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_backup_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.968255}, "macro.dbt.default__make_backup_relation": {"unique_id": "macro.dbt.default__make_backup_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "default__make_backup_relation", "macro_sql": "{% macro default__make_backup_relation(base_relation, backup_relation_type, suffix) %}\n    {%- set backup_identifier = base_relation.identifier ~ suffix -%}\n    {%- set backup_relation = base_relation.incorporate(\n                                  path={\"identifier\": backup_identifier},\n                                  type=backup_relation_type\n    ) -%}\n    {{ return(backup_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9689386}, "macro.dbt.drop_relation": {"unique_id": "macro.dbt.drop_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "drop_relation", "macro_sql": "{% macro drop_relation(relation) -%}\n  {{ return(adapter.dispatch('drop_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__drop_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.96937}, "macro.dbt.default__drop_relation": {"unique_id": "macro.dbt.default__drop_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "default__drop_relation", "macro_sql": "{% macro default__drop_relation(relation) -%}\n  {% call statement('drop_relation', auto_begin=False) -%}\n    drop {{ relation.type }} if exists {{ relation }} cascade\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9698613}, "macro.dbt.truncate_relation": {"unique_id": "macro.dbt.truncate_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "truncate_relation", "macro_sql": "{% macro truncate_relation(relation) -%}\n  {{ return(adapter.dispatch('truncate_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__truncate_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9702585}, "macro.dbt.default__truncate_relation": {"unique_id": "macro.dbt.default__truncate_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "default__truncate_relation", "macro_sql": "{% macro default__truncate_relation(relation) -%}\n  {% call statement('truncate_relation') -%}\n    truncate table {{ relation }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9706175}, "macro.dbt.rename_relation": {"unique_id": "macro.dbt.rename_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "rename_relation", "macro_sql": "{% macro rename_relation(from_relation, to_relation) -%}\n  {{ return(adapter.dispatch('rename_relation', 'dbt')(from_relation, to_relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__rename_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.971056}, "macro.dbt.default__rename_relation": {"unique_id": "macro.dbt.default__rename_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "default__rename_relation", "macro_sql": "{% macro default__rename_relation(from_relation, to_relation) -%}\n  {% set target_name = adapter.quote_as_configured(to_relation.identifier, 'identifier') %}\n  {% call statement('rename_relation') -%}\n    alter table {{ from_relation }} rename to {{ target_name }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9717572}, "macro.dbt.get_or_create_relation": {"unique_id": "macro.dbt.get_or_create_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "get_or_create_relation", "macro_sql": "{% macro get_or_create_relation(database, schema, identifier, type) -%}\n  {{ return(adapter.dispatch('get_or_create_relation', 'dbt')(database, schema, identifier, type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_or_create_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9723}, "macro.dbt.default__get_or_create_relation": {"unique_id": "macro.dbt.default__get_or_create_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "default__get_or_create_relation", "macro_sql": "{% macro default__get_or_create_relation(database, schema, identifier, type) %}\n  {%- set target_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n\n  {% if target_relation %}\n    {% do return([true, target_relation]) %}\n  {% endif %}\n\n  {%- set new_relation = api.Relation.create(\n      database=database,\n      schema=schema,\n      identifier=identifier,\n      type=type\n  ) -%}\n  {% do return([false, new_relation]) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9735029}, "macro.dbt.load_cached_relation": {"unique_id": "macro.dbt.load_cached_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "load_cached_relation", "macro_sql": "{% macro load_cached_relation(relation) %}\n  {% do return(adapter.get_relation(\n    database=relation.database,\n    schema=relation.schema,\n    identifier=relation.identifier\n  )) -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9740078}, "macro.dbt.load_relation": {"unique_id": "macro.dbt.load_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "load_relation", "macro_sql": "{% macro load_relation(relation) %}\n    {{ return(load_cached_relation(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.load_cached_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9743257}, "macro.dbt.drop_relation_if_exists": {"unique_id": "macro.dbt.drop_relation_if_exists", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "drop_relation_if_exists", "macro_sql": "{% macro drop_relation_if_exists(relation) %}\n  {% if relation is not none %}\n    {{ adapter.drop_relation(relation) }}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9747531}, "macro.dbt.create_schema": {"unique_id": "macro.dbt.create_schema", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "name": "create_schema", "macro_sql": "{% macro create_schema(relation) -%}\n  {{ adapter.dispatch('create_schema', 'dbt')(relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__create_schema"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.975623}, "macro.dbt.default__create_schema": {"unique_id": "macro.dbt.default__create_schema", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "name": "default__create_schema", "macro_sql": "{% macro default__create_schema(relation) -%}\n  {%- call statement('create_schema') -%}\n    create schema if not exists {{ relation.without_identifier() }}\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9760334}, "macro.dbt.drop_schema": {"unique_id": "macro.dbt.drop_schema", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "name": "drop_schema", "macro_sql": "{% macro drop_schema(relation) -%}\n  {{ adapter.dispatch('drop_schema', 'dbt')(relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__drop_schema"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9763894}, "macro.dbt.default__drop_schema": {"unique_id": "macro.dbt.default__drop_schema", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "name": "default__drop_schema", "macro_sql": "{% macro default__drop_schema(relation) -%}\n  {%- call statement('drop_schema') -%}\n    drop schema if exists {{ relation.without_identifier() }} cascade\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9768887}, "macro.dbt.get_create_index_sql": {"unique_id": "macro.dbt.get_create_index_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "name": "get_create_index_sql", "macro_sql": "{% macro get_create_index_sql(relation, index_dict) -%}\n  {{ return(adapter.dispatch('get_create_index_sql', 'dbt')(relation, index_dict)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_create_index_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.977928}, "macro.dbt.default__get_create_index_sql": {"unique_id": "macro.dbt.default__get_create_index_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "name": "default__get_create_index_sql", "macro_sql": "{% macro default__get_create_index_sql(relation, index_dict) -%}\n  {% do return(None) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9789052}, "macro.dbt.create_indexes": {"unique_id": "macro.dbt.create_indexes", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "name": "create_indexes", "macro_sql": "{% macro create_indexes(relation) -%}\n  {{ adapter.dispatch('create_indexes', 'dbt')(relation) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9792657}, "macro.dbt.default__create_indexes": {"unique_id": "macro.dbt.default__create_indexes", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "name": "default__create_indexes", "macro_sql": "{% macro default__create_indexes(relation) -%}\n  {%- set _indexes = config.get('indexes', default=[]) -%}\n\n  {% for _index_dict in _indexes %}\n    {% set create_index_sql = get_create_index_sql(relation, _index_dict) %}\n    {% if create_index_sql %}\n      {% do run_query(create_index_sql) %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_create_index_sql", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9801295}, "macro.dbt.generate_schema_name": {"unique_id": "macro.dbt.generate_schema_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "name": "generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name=none, node=none) -%}\n    {{ return(adapter.dispatch('generate_schema_name', 'dbt')(custom_schema_name, node)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9812555}, "macro.dbt.default__generate_schema_name": {"unique_id": "macro.dbt.default__generate_schema_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "name": "default__generate_schema_name", "macro_sql": "{% macro default__generate_schema_name(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if custom_schema_name is none -%}\n\n        {{ default_schema }}\n\n    {%- else -%}\n\n        {{ default_schema }}_{{ custom_schema_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9819396}, "macro.dbt.generate_schema_name_for_env": {"unique_id": "macro.dbt.generate_schema_name_for_env", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "name": "generate_schema_name_for_env", "macro_sql": "{% macro generate_schema_name_for_env(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if target.name == 'prod' and custom_schema_name is not none -%}\n\n        {{ custom_schema_name | trim }}\n\n    {%- else -%}\n\n        {{ default_schema }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9825656}, "macro.dbt.generate_alias_name": {"unique_id": "macro.dbt.generate_alias_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/get_custom_name/get_custom_alias.sql", "original_file_path": "macros/get_custom_name/get_custom_alias.sql", "name": "generate_alias_name", "macro_sql": "{% macro generate_alias_name(custom_alias_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_alias_name', 'dbt')(custom_alias_name, node)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_alias_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9834487}, "macro.dbt.default__generate_alias_name": {"unique_id": "macro.dbt.default__generate_alias_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/get_custom_name/get_custom_alias.sql", "original_file_path": "macros/get_custom_name/get_custom_alias.sql", "name": "default__generate_alias_name", "macro_sql": "{% macro default__generate_alias_name(custom_alias_name=none, node=none) -%}\n\n    {%- if custom_alias_name is none -%}\n\n        {{ node.name }}\n\n    {%- else -%}\n\n        {{ custom_alias_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9839542}, "macro.dbt.generate_database_name": {"unique_id": "macro.dbt.generate_database_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/get_custom_name/get_custom_database.sql", "original_file_path": "macros/get_custom_name/get_custom_database.sql", "name": "generate_database_name", "macro_sql": "{% macro generate_database_name(custom_database_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_database_name', 'dbt')(custom_database_name, node)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_database_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9848564}, "macro.dbt.default__generate_database_name": {"unique_id": "macro.dbt.default__generate_database_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/get_custom_name/get_custom_database.sql", "original_file_path": "macros/get_custom_name/get_custom_database.sql", "name": "default__generate_database_name", "macro_sql": "{% macro default__generate_database_name(custom_database_name=none, node=none) -%}\n    {%- set default_database = target.database -%}\n    {%- if custom_database_name is none -%}\n\n        {{ default_database }}\n\n    {%- else -%}\n\n        {{ custom_database_name }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.985445}, "macro.dbt.string_literal": {"unique_id": "macro.dbt.string_literal", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/literal.sql", "original_file_path": "macros/utils/literal.sql", "name": "string_literal", "macro_sql": "{%- macro string_literal(value) -%}\n  {{ return(adapter.dispatch('string_literal', 'dbt') (value)) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__string_literal"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9861107}, "macro.dbt.default__string_literal": {"unique_id": "macro.dbt.default__string_literal", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/literal.sql", "original_file_path": "macros/utils/literal.sql", "name": "default__string_literal", "macro_sql": "{% macro default__string_literal(value) -%}\n    '{{ value }}'\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9863513}, "macro.dbt.type_string": {"unique_id": "macro.dbt.type_string", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "name": "type_string", "macro_sql": "\n\n{%- macro type_string() -%}\n  {{ return(adapter.dispatch('type_string', 'dbt')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9881508}, "macro.dbt.default__type_string": {"unique_id": "macro.dbt.default__type_string", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "name": "default__type_string", "macro_sql": "{% macro default__type_string() %}\n    {{ return(api.Column.translate_type(\"string\")) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9884963}, "macro.dbt.type_timestamp": {"unique_id": "macro.dbt.type_timestamp", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "name": "type_timestamp", "macro_sql": "\n\n{%- macro type_timestamp() -%}\n  {{ return(adapter.dispatch('type_timestamp', 'dbt')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9888518}, "macro.dbt.default__type_timestamp": {"unique_id": "macro.dbt.default__type_timestamp", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "name": "default__type_timestamp", "macro_sql": "{% macro default__type_timestamp() %}\n    {{ return(api.Column.translate_type(\"timestamp\")) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9892175}, "macro.dbt.type_float": {"unique_id": "macro.dbt.type_float", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "name": "type_float", "macro_sql": "\n\n{%- macro type_float() -%}\n  {{ return(adapter.dispatch('type_float', 'dbt')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_float"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9895928}, "macro.dbt.default__type_float": {"unique_id": "macro.dbt.default__type_float", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "name": "default__type_float", "macro_sql": "{% macro default__type_float() %}\n    {{ return(api.Column.translate_type(\"float\")) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9899328}, "macro.dbt.type_numeric": {"unique_id": "macro.dbt.type_numeric", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "name": "type_numeric", "macro_sql": "\n\n{%- macro type_numeric() -%}\n  {{ return(adapter.dispatch('type_numeric', 'dbt')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9902873}, "macro.dbt.default__type_numeric": {"unique_id": "macro.dbt.default__type_numeric", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "name": "default__type_numeric", "macro_sql": "{% macro default__type_numeric() %}\n    {{ return(api.Column.numeric_type(\"numeric\", 28, 6)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.990678}, "macro.dbt.type_bigint": {"unique_id": "macro.dbt.type_bigint", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "name": "type_bigint", "macro_sql": "\n\n{%- macro type_bigint() -%}\n  {{ return(adapter.dispatch('type_bigint', 'dbt')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9910321}, "macro.dbt.default__type_bigint": {"unique_id": "macro.dbt.default__type_bigint", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "name": "default__type_bigint", "macro_sql": "{% macro default__type_bigint() %}\n    {{ return(api.Column.translate_type(\"bigint\")) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9913669}, "macro.dbt.type_int": {"unique_id": "macro.dbt.type_int", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "name": "type_int", "macro_sql": "\n\n{%- macro type_int() -%}\n  {{ return(adapter.dispatch('type_int', 'dbt')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9918659}, "macro.dbt.default__type_int": {"unique_id": "macro.dbt.default__type_int", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "name": "default__type_int", "macro_sql": "{%- macro default__type_int() -%}\n  {{ return(api.Column.translate_type(\"integer\")) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9922924}, "macro.dbt.replace": {"unique_id": "macro.dbt.replace", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/replace.sql", "original_file_path": "macros/utils/replace.sql", "name": "replace", "macro_sql": "{% macro replace(field, old_chars, new_chars) -%}\n    {{ return(adapter.dispatch('replace', 'dbt') (field, old_chars, new_chars)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__replace"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9931402}, "macro.dbt.default__replace": {"unique_id": "macro.dbt.default__replace", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/replace.sql", "original_file_path": "macros/utils/replace.sql", "name": "default__replace", "macro_sql": "{% macro default__replace(field, old_chars, new_chars) %}\n\n    replace(\n        {{ field }},\n        {{ old_chars }},\n        {{ new_chars }}\n    )\n\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.993531}, "macro.dbt.right": {"unique_id": "macro.dbt.right", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/right.sql", "original_file_path": "macros/utils/right.sql", "name": "right", "macro_sql": "{% macro right(string_text, length_expression) -%}\n    {{ return(adapter.dispatch('right', 'dbt') (string_text, length_expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__right"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.994273}, "macro.dbt.default__right": {"unique_id": "macro.dbt.default__right", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/right.sql", "original_file_path": "macros/utils/right.sql", "name": "default__right", "macro_sql": "{% macro default__right(string_text, length_expression) %}\n\n    right(\n        {{ string_text }},\n        {{ length_expression }}\n    )\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9945824}, "macro.dbt.split_part": {"unique_id": "macro.dbt.split_part", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "name": "split_part", "macro_sql": "{% macro split_part(string_text, delimiter_text, part_number) %}\n  {{ return(adapter.dispatch('split_part', 'dbt') (string_text, delimiter_text, part_number)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__split_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9956605}, "macro.dbt.default__split_part": {"unique_id": "macro.dbt.default__split_part", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "name": "default__split_part", "macro_sql": "{% macro default__split_part(string_text, delimiter_text, part_number) %}\n\n    split_part(\n        {{ string_text }},\n        {{ delimiter_text }},\n        {{ part_number }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.996034}, "macro.dbt._split_part_negative": {"unique_id": "macro.dbt._split_part_negative", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "name": "_split_part_negative", "macro_sql": "{% macro _split_part_negative(string_text, delimiter_text, part_number) %}\n\n    split_part(\n        {{ string_text }},\n        {{ delimiter_text }},\n          length({{ string_text }})\n          - length(\n              replace({{ string_text }},  {{ delimiter_text }}, '')\n          ) + 2 {{ part_number }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9965239}, "macro.dbt.safe_cast": {"unique_id": "macro.dbt.safe_cast", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/safe_cast.sql", "original_file_path": "macros/utils/safe_cast.sql", "name": "safe_cast", "macro_sql": "{% macro safe_cast(field, type) %}\n  {{ return(adapter.dispatch('safe_cast', 'dbt') (field, type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__safe_cast"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9973588}, "macro.dbt.default__safe_cast": {"unique_id": "macro.dbt.default__safe_cast", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/safe_cast.sql", "original_file_path": "macros/utils/safe_cast.sql", "name": "default__safe_cast", "macro_sql": "{% macro default__safe_cast(field, type) %}\n    {# most databases don't support this function yet\n    so we just need to use cast #}\n    cast({{field}} as {{type}})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9976954}, "macro.dbt.cast_bool_to_text": {"unique_id": "macro.dbt.cast_bool_to_text", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/cast_bool_to_text.sql", "original_file_path": "macros/utils/cast_bool_to_text.sql", "name": "cast_bool_to_text", "macro_sql": "{% macro cast_bool_to_text(field) %}\n  {{ adapter.dispatch('cast_bool_to_text', 'dbt') (field) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__cast_bool_to_text"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9983509}, "macro.dbt.default__cast_bool_to_text": {"unique_id": "macro.dbt.default__cast_bool_to_text", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/cast_bool_to_text.sql", "original_file_path": "macros/utils/cast_bool_to_text.sql", "name": "default__cast_bool_to_text", "macro_sql": "{% macro default__cast_bool_to_text(field) %}\n    cast({{ field }} as {{ api.Column.translate_type('string') }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9987116}, "macro.dbt.any_value": {"unique_id": "macro.dbt.any_value", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/any_value.sql", "original_file_path": "macros/utils/any_value.sql", "name": "any_value", "macro_sql": "{% macro any_value(expression) -%}\n    {{ return(adapter.dispatch('any_value', 'dbt') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__any_value"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9993608}, "macro.dbt.default__any_value": {"unique_id": "macro.dbt.default__any_value", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/any_value.sql", "original_file_path": "macros/utils/any_value.sql", "name": "default__any_value", "macro_sql": "{% macro default__any_value(expression) -%}\n\n    any_value({{ expression }})\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469548.9996016}, "macro.dbt.bool_or": {"unique_id": "macro.dbt.bool_or", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/bool_or.sql", "original_file_path": "macros/utils/bool_or.sql", "name": "bool_or", "macro_sql": "{% macro bool_or(expression) -%}\n    {{ return(adapter.dispatch('bool_or', 'dbt') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__bool_or"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0002465}, "macro.dbt.default__bool_or": {"unique_id": "macro.dbt.default__bool_or", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/bool_or.sql", "original_file_path": "macros/utils/bool_or.sql", "name": "default__bool_or", "macro_sql": "{% macro default__bool_or(expression) -%}\n\n    bool_or({{ expression }})\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0004869}, "macro.dbt.date_trunc": {"unique_id": "macro.dbt.date_trunc", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/date_trunc.sql", "original_file_path": "macros/utils/date_trunc.sql", "name": "date_trunc", "macro_sql": "{% macro date_trunc(datepart, date) -%}\n  {{ return(adapter.dispatch('date_trunc', 'dbt') (datepart, date)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0012069}, "macro.dbt.default__date_trunc": {"unique_id": "macro.dbt.default__date_trunc", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/date_trunc.sql", "original_file_path": "macros/utils/date_trunc.sql", "name": "default__date_trunc", "macro_sql": "{% macro default__date_trunc(datepart, date) -%}\n    date_trunc('{{datepart}}', {{date}})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0015233}, "macro.dbt.hash": {"unique_id": "macro.dbt.hash", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/hash.sql", "original_file_path": "macros/utils/hash.sql", "name": "hash", "macro_sql": "{% macro hash(field) -%}\n  {{ return(adapter.dispatch('hash', 'dbt') (field)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__hash"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0022748}, "macro.dbt.default__hash": {"unique_id": "macro.dbt.default__hash", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/hash.sql", "original_file_path": "macros/utils/hash.sql", "name": "default__hash", "macro_sql": "{% macro default__hash(field) -%}\n    md5(cast({{ field }} as {{ api.Column.translate_type('string') }}))\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.002647}, "macro.dbt.datediff": {"unique_id": "macro.dbt.datediff", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/datediff.sql", "original_file_path": "macros/utils/datediff.sql", "name": "datediff", "macro_sql": "{% macro datediff(first_date, second_date, datepart) %}\n  {{ return(adapter.dispatch('datediff', 'dbt')(first_date, second_date, datepart)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0034642}, "macro.dbt.default__datediff": {"unique_id": "macro.dbt.default__datediff", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/datediff.sql", "original_file_path": "macros/utils/datediff.sql", "name": "default__datediff", "macro_sql": "{% macro default__datediff(first_date, second_date, datepart) -%}\n\n    datediff(\n        {{ datepart }},\n        {{ first_date }},\n        {{ second_date }}\n        )\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0039883}, "macro.dbt.dateadd": {"unique_id": "macro.dbt.dateadd", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/dateadd.sql", "original_file_path": "macros/utils/dateadd.sql", "name": "dateadd", "macro_sql": "{% macro dateadd(datepart, interval, from_date_or_timestamp) %}\n  {{ return(adapter.dispatch('dateadd', 'dbt')(datepart, interval, from_date_or_timestamp)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0048132}, "macro.dbt.default__dateadd": {"unique_id": "macro.dbt.default__dateadd", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/dateadd.sql", "original_file_path": "macros/utils/dateadd.sql", "name": "default__dateadd", "macro_sql": "{% macro default__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n    dateadd(\n        {{ datepart }},\n        {{ interval }},\n        {{ from_date_or_timestamp }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.005209}, "macro.dbt.last_day": {"unique_id": "macro.dbt.last_day", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "name": "last_day", "macro_sql": "{% macro last_day(date, datepart) %}\n  {{ return(adapter.dispatch('last_day', 'dbt') (date, datepart)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0060463}, "macro.dbt.default_last_day": {"unique_id": "macro.dbt.default_last_day", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "name": "default_last_day", "macro_sql": "\n\n{%- macro default_last_day(date, datepart) -%}\n    cast(\n        {{dbt.dateadd('day', '-1',\n        dbt.dateadd(datepart, '1', dbt.date_trunc(datepart, date))\n        )}}\n        as date)\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.dateadd", "macro.dbt_utils.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0066288}, "macro.dbt.default__last_day": {"unique_id": "macro.dbt.default__last_day", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "name": "default__last_day", "macro_sql": "{% macro default__last_day(date, datepart) -%}\n    {{dbt.default_last_day(date, datepart)}}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default_last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.006963}, "macro.dbt.except": {"unique_id": "macro.dbt.except", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/except.sql", "original_file_path": "macros/utils/except.sql", "name": "except", "macro_sql": "{% macro except() %}\n  {{ return(adapter.dispatch('except', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__except"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0076597}, "macro.dbt.default__except": {"unique_id": "macro.dbt.default__except", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/except.sql", "original_file_path": "macros/utils/except.sql", "name": "default__except", "macro_sql": "{% macro default__except() %}\n\n    except\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0078437}, "macro.dbt.position": {"unique_id": "macro.dbt.position", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/position.sql", "original_file_path": "macros/utils/position.sql", "name": "position", "macro_sql": "{% macro position(substring_text, string_text) -%}\n    {{ return(adapter.dispatch('position', 'dbt') (substring_text, string_text)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__position"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.008578}, "macro.dbt.default__position": {"unique_id": "macro.dbt.default__position", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/position.sql", "original_file_path": "macros/utils/position.sql", "name": "default__position", "macro_sql": "{% macro default__position(substring_text, string_text) %}\n\n    position(\n        {{ substring_text }} in {{ string_text }}\n    )\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0088968}, "macro.dbt.length": {"unique_id": "macro.dbt.length", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/length.sql", "original_file_path": "macros/utils/length.sql", "name": "length", "macro_sql": "{% macro length(expression) -%}\n    {{ return(adapter.dispatch('length', 'dbt') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__length"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0096056}, "macro.dbt.default__length": {"unique_id": "macro.dbt.default__length", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/length.sql", "original_file_path": "macros/utils/length.sql", "name": "default__length", "macro_sql": "{% macro default__length(expression) %}\n\n    length(\n        {{ expression }}\n    )\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0098536}, "macro.dbt.concat": {"unique_id": "macro.dbt.concat", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/concat.sql", "original_file_path": "macros/utils/concat.sql", "name": "concat", "macro_sql": "{% macro concat(fields) -%}\n  {{ return(adapter.dispatch('concat', 'dbt')(fields)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__concat"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0105019}, "macro.dbt.default__concat": {"unique_id": "macro.dbt.default__concat", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/concat.sql", "original_file_path": "macros/utils/concat.sql", "name": "default__concat", "macro_sql": "{% macro default__concat(fields) -%}\n    {{ fields|join(' || ') }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0107875}, "macro.dbt.escape_single_quotes": {"unique_id": "macro.dbt.escape_single_quotes", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/escape_single_quotes.sql", "original_file_path": "macros/utils/escape_single_quotes.sql", "name": "escape_single_quotes", "macro_sql": "{% macro escape_single_quotes(expression) %}\n      {{ return(adapter.dispatch('escape_single_quotes', 'dbt') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__escape_single_quotes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.011477}, "macro.dbt.default__escape_single_quotes": {"unique_id": "macro.dbt.default__escape_single_quotes", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/escape_single_quotes.sql", "original_file_path": "macros/utils/escape_single_quotes.sql", "name": "default__escape_single_quotes", "macro_sql": "{% macro default__escape_single_quotes(expression) -%}\n{{ expression | replace(\"'\",\"''\") }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0117915}, "macro.dbt.listagg": {"unique_id": "macro.dbt.listagg", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/listagg.sql", "original_file_path": "macros/utils/listagg.sql", "name": "listagg", "macro_sql": "{% macro listagg(measure, delimiter_text=\"','\", order_by_clause=none, limit_num=none) -%}\n    {{ return(adapter.dispatch('listagg', 'dbt') (measure, delimiter_text, order_by_clause, limit_num)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__listagg"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0131612}, "macro.dbt.default__listagg": {"unique_id": "macro.dbt.default__listagg", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/listagg.sql", "original_file_path": "macros/utils/listagg.sql", "name": "default__listagg", "macro_sql": "{% macro default__listagg(measure, delimiter_text, order_by_clause, limit_num) -%}\n\n    {% if limit_num -%}\n    array_to_string(\n        array_slice(\n            array_agg(\n                {{ measure }}\n            ){% if order_by_clause -%}\n            within group ({{ order_by_clause }})\n            {%- endif %}\n            ,0\n            ,{{ limit_num }}\n        ),\n        {{ delimiter_text }}\n        )\n    {%- else %}\n    listagg(\n        {{ measure }},\n        {{ delimiter_text }}\n        )\n        {% if order_by_clause -%}\n        within group ({{ order_by_clause }})\n        {%- endif %}\n    {%- endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0140817}, "macro.dbt.intersect": {"unique_id": "macro.dbt.intersect", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/intersect.sql", "original_file_path": "macros/utils/intersect.sql", "name": "intersect", "macro_sql": "{% macro intersect() %}\n  {{ return(adapter.dispatch('intersect', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__intersect"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0147045}, "macro.dbt.default__intersect": {"unique_id": "macro.dbt.default__intersect", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/utils/intersect.sql", "original_file_path": "macros/utils/intersect.sql", "name": "default__intersect", "macro_sql": "{% macro default__intersect() %}\n\n    intersect\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0148842}, "macro.dbt.convert_datetime": {"unique_id": "macro.dbt.convert_datetime", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "name": "convert_datetime", "macro_sql": "{% macro convert_datetime(date_str, date_fmt) %}\n\n  {% set error_msg -%}\n      The provided partition date '{{ date_str }}' does not match the expected format '{{ date_fmt }}'\n  {%- endset %}\n\n  {% set res = try_or_compiler_error(error_msg, modules.datetime.datetime.strptime, date_str.strip(), date_fmt) %}\n  {{ return(res) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0182183}, "macro.dbt.dates_in_range": {"unique_id": "macro.dbt.dates_in_range", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "name": "dates_in_range", "macro_sql": "{% macro dates_in_range(start_date_str, end_date_str=none, in_fmt=\"%Y%m%d\", out_fmt=\"%Y%m%d\") %}\n    {% set end_date_str = start_date_str if end_date_str is none else end_date_str %}\n\n    {% set start_date = convert_datetime(start_date_str, in_fmt) %}\n    {% set end_date = convert_datetime(end_date_str, in_fmt) %}\n\n    {% set day_count = (end_date - start_date).days %}\n    {% if day_count < 0 %}\n        {% set msg -%}\n            Partiton start date is after the end date ({{ start_date }}, {{ end_date }})\n        {%- endset %}\n\n        {{ exceptions.raise_compiler_error(msg, model) }}\n    {% endif %}\n\n    {% set date_list = [] %}\n    {% for i in range(0, day_count + 1) %}\n        {% set the_date = (modules.datetime.timedelta(days=i) + start_date) %}\n        {% if not out_fmt %}\n            {% set _ = date_list.append(the_date) %}\n        {% else %}\n            {% set _ = date_list.append(the_date.strftime(out_fmt)) %}\n        {% endif %}\n    {% endfor %}\n\n    {{ return(date_list) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.convert_datetime"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0207853}, "macro.dbt.partition_range": {"unique_id": "macro.dbt.partition_range", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "name": "partition_range", "macro_sql": "{% macro partition_range(raw_partition_date, date_fmt='%Y%m%d') %}\n    {% set partition_range = (raw_partition_date | string).split(\",\") %}\n\n    {% if (partition_range | length) == 1 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = none %}\n    {% elif (partition_range | length) == 2 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = partition_range[1] %}\n    {% else %}\n      {{ exceptions.raise_compiler_error(\"Invalid partition time. Expected format: {Start Date}[,{End Date}]. Got: \" ~ raw_partition_date) }}\n    {% endif %}\n\n    {{ return(dates_in_range(start_date, end_date, in_fmt=date_fmt)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.dates_in_range"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0224586}, "macro.dbt.py_current_timestring": {"unique_id": "macro.dbt.py_current_timestring", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "name": "py_current_timestring", "macro_sql": "{% macro py_current_timestring() %}\n    {% set dt = modules.datetime.datetime.now() %}\n    {% do return(dt.strftime(\"%Y%m%d%H%M%S%f\")) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0230753}, "macro.dbt.statement": {"unique_id": "macro.dbt.statement", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "name": "statement", "macro_sql": "{% macro statement(name=None, fetch_result=False, auto_begin=True) -%}\n  {%- if execute: -%}\n    {%- set sql = caller() -%}\n\n    {%- if name == 'main' -%}\n      {{ log('Writing runtime SQL for node \"{}\"'.format(model['unique_id'])) }}\n      {{ write(sql) }}\n    {%- endif -%}\n\n    {%- set res, table = adapter.execute(sql, auto_begin=auto_begin, fetch=fetch_result) -%}\n    {%- if name is not none -%}\n      {{ store_result(name, response=res, agate_table=table) }}\n    {%- endif -%}\n\n  {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.025388}, "macro.dbt.noop_statement": {"unique_id": "macro.dbt.noop_statement", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "name": "noop_statement", "macro_sql": "{% macro noop_statement(name=None, message=None, code=None, rows_affected=None, res=None) -%}\n  {%- set sql = caller() -%}\n\n  {%- if name == 'main' -%}\n    {{ log('Writing runtime SQL for node \"{}\"'.format(model['unique_id'])) }}\n    {{ write(sql) }}\n  {%- endif -%}\n\n  {%- if name is not none -%}\n    {{ store_raw_result(name, message=message, code=code, rows_affected=rows_affected, agate_table=res) }}\n  {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0266452}, "macro.dbt.run_query": {"unique_id": "macro.dbt.run_query", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "name": "run_query", "macro_sql": "{% macro run_query(sql) %}\n  {% call statement(\"run_query_statement\", fetch_result=true, auto_begin=false) %}\n    {{ sql }}\n  {% endcall %}\n\n  {% do return(load_result(\"run_query_statement\").table) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0272903}, "macro.dbt.default__test_unique": {"unique_id": "macro.dbt.default__test_unique", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/generic_test_sql/unique.sql", "original_file_path": "macros/generic_test_sql/unique.sql", "name": "default__test_unique", "macro_sql": "{% macro default__test_unique(model, column_name) %}\n\nselect\n    {{ column_name }} as unique_field,\n    count(*) as n_records\n\nfrom {{ model }}\nwhere {{ column_name }} is not null\ngroup by {{ column_name }}\nhaving count(*) > 1\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0280354}, "macro.dbt.default__test_not_null": {"unique_id": "macro.dbt.default__test_not_null", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/generic_test_sql/not_null.sql", "original_file_path": "macros/generic_test_sql/not_null.sql", "name": "default__test_not_null", "macro_sql": "{% macro default__test_not_null(model, column_name) %}\n\n{% set column_list = '*' if should_store_failures() else column_name %}\n\nselect {{ column_list }}\nfrom {{ model }}\nwhere {{ column_name }} is null\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_store_failures"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0288029}, "macro.dbt.default__test_accepted_values": {"unique_id": "macro.dbt.default__test_accepted_values", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/generic_test_sql/accepted_values.sql", "original_file_path": "macros/generic_test_sql/accepted_values.sql", "name": "default__test_accepted_values", "macro_sql": "{% macro default__test_accepted_values(model, column_name, values, quote=True) %}\n\nwith all_values as (\n\n    select\n        {{ column_name }} as value_field,\n        count(*) as n_records\n\n    from {{ model }}\n    group by {{ column_name }}\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    {% for value in values -%}\n        {% if quote -%}\n        '{{ value }}'\n        {%- else -%}\n        {{ value }}\n        {%- endif -%}\n        {%- if not loop.last -%},{%- endif %}\n    {%- endfor %}\n)\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0301113}, "macro.dbt.default__test_relationships": {"unique_id": "macro.dbt.default__test_relationships", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/generic_test_sql/relationships.sql", "original_file_path": "macros/generic_test_sql/relationships.sql", "name": "default__test_relationships", "macro_sql": "{% macro default__test_relationships(model, column_name, to, field) %}\n\nwith child as (\n    select {{ column_name }} as from_field\n    from {{ model }}\n    where {{ column_name }} is not null\n),\n\nparent as (\n    select {{ field }} as to_field\n    from {{ to }}\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0309248}, "macro.dbt.set_sql_header": {"unique_id": "macro.dbt.set_sql_header", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "name": "set_sql_header", "macro_sql": "{% macro set_sql_header(config) -%}\n  {{ config.set('sql_header', caller()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0317476}, "macro.dbt.should_full_refresh": {"unique_id": "macro.dbt.should_full_refresh", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "name": "should_full_refresh", "macro_sql": "{% macro should_full_refresh() %}\n  {% set config_full_refresh = config.get('full_refresh') %}\n  {% if config_full_refresh is none %}\n    {% set config_full_refresh = flags.FULL_REFRESH %}\n  {% endif %}\n  {% do return(config_full_refresh) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0324118}, "macro.dbt.should_store_failures": {"unique_id": "macro.dbt.should_store_failures", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "name": "should_store_failures", "macro_sql": "{% macro should_store_failures() %}\n  {% set config_store_failures = config.get('store_failures') %}\n  {% if config_store_failures is none %}\n    {% set config_store_failures = flags.STORE_FAILURES %}\n  {% endif %}\n  {% do return(config_store_failures) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0331764}, "macro.dbt.run_hooks": {"unique_id": "macro.dbt.run_hooks", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "name": "run_hooks", "macro_sql": "{% macro run_hooks(hooks, inside_transaction=True) %}\n  {% for hook in hooks | selectattr('transaction', 'equalto', inside_transaction)  %}\n    {% if not inside_transaction and loop.first %}\n      {% call statement(auto_begin=inside_transaction) %}\n        commit;\n      {% endcall %}\n    {% endif %}\n    {% set rendered = render(hook.get('sql')) | trim %}\n    {% if (rendered | length) > 0 %}\n      {% call statement(auto_begin=inside_transaction) %}\n        {{ rendered }}\n      {% endcall %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0354402}, "macro.dbt.make_hook_config": {"unique_id": "macro.dbt.make_hook_config", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "name": "make_hook_config", "macro_sql": "{% macro make_hook_config(sql, inside_transaction) %}\n    {{ tojson({\"sql\": sql, \"transaction\": inside_transaction}) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.035887}, "macro.dbt.before_begin": {"unique_id": "macro.dbt.before_begin", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "name": "before_begin", "macro_sql": "{% macro before_begin(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.036214}, "macro.dbt.in_transaction": {"unique_id": "macro.dbt.in_transaction", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "name": "in_transaction", "macro_sql": "{% macro in_transaction(sql) %}\n    {{ make_hook_config(sql, inside_transaction=True) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0365293}, "macro.dbt.after_commit": {"unique_id": "macro.dbt.after_commit", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "name": "after_commit", "macro_sql": "{% macro after_commit(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0368435}, "macro.dbt.materialization_table_default": {"unique_id": "macro.dbt.materialization_table_default", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/table/table.sql", "original_file_path": "macros/materializations/models/table/table.sql", "name": "materialization_table_default", "macro_sql": "{% materialization table, default %}\n\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='table') %}\n  {%- set intermediate_relation =  make_intermediate_relation(target_relation) -%}\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation) -%}\n  /*\n      See ../view/view.sql for more information about this relation.\n  */\n  {%- set backup_relation_type = 'table' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n  -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_table_as_sql(False, intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  {% if existing_relation is not none %}\n      {{ adapter.rename_relation(existing_relation, backup_relation) }}\n  {% endif %}\n\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% do create_indexes(target_relation) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  -- finally, drop the existing/backup relation after the commit\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.get_create_table_as_sql", "macro.dbt.create_indexes", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0422513}, "macro.dbt.get_create_table_as_sql": {"unique_id": "macro.dbt.get_create_table_as_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/table/create_table_as.sql", "original_file_path": "macros/materializations/models/table/create_table_as.sql", "name": "get_create_table_as_sql", "macro_sql": "{% macro get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ adapter.dispatch('get_create_table_as_sql', 'dbt')(temporary, relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_create_table_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0433095}, "macro.dbt.default__get_create_table_as_sql": {"unique_id": "macro.dbt.default__get_create_table_as_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/table/create_table_as.sql", "original_file_path": "macros/materializations/models/table/create_table_as.sql", "name": "default__get_create_table_as_sql", "macro_sql": "{% macro default__get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ return(create_table_as(temporary, relation, sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0437238}, "macro.dbt.create_table_as": {"unique_id": "macro.dbt.create_table_as", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/table/create_table_as.sql", "original_file_path": "macros/materializations/models/table/create_table_as.sql", "name": "create_table_as", "macro_sql": "{% macro create_table_as(temporary, relation, sql) -%}\n  {{ adapter.dispatch('create_table_as', 'dbt')(temporary, relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.044165}, "macro.dbt.default__create_table_as": {"unique_id": "macro.dbt.default__create_table_as", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/table/create_table_as.sql", "original_file_path": "macros/materializations/models/table/create_table_as.sql", "name": "default__create_table_as", "macro_sql": "{% macro default__create_table_as(temporary, relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n  create {% if temporary: -%}temporary{%- endif %} table\n    {{ relation.include(database=(not temporary), schema=(not temporary)) }}\n  as (\n    {{ sql }}\n  );\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0450435}, "macro.dbt.create_or_replace_view": {"unique_id": "macro.dbt.create_or_replace_view", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/create_or_replace_view.sql", "original_file_path": "macros/materializations/models/view/create_or_replace_view.sql", "name": "create_or_replace_view", "macro_sql": "{% macro create_or_replace_view() %}\n  {%- set identifier = model['alias'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set target_relation = api.Relation.create(\n      identifier=identifier, schema=schema, database=database,\n      type='view') -%}\n  {% set grant_config = config.get('grants') %}\n\n  {{ run_hooks(pre_hooks) }}\n\n  -- If there's a table with the same name and we weren't told to full refresh,\n  -- that's an error. If we were told to full refresh, drop it. This behavior differs\n  -- for Snowflake and BigQuery, so multiple dispatch is used.\n  {%- if old_relation is not none and old_relation.is_table -%}\n    {{ handle_existing_table(should_full_refresh(), old_relation) }}\n  {%- endif -%}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_view_as_sql(target_relation, sql) }}\n  {%- endcall %}\n\n  {% set should_revoke = should_revoke(exists_as_view, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=True) %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.handle_existing_table", "macro.dbt.should_full_refresh", "macro.dbt.statement", "macro.dbt.get_create_view_as_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0481718}, "macro.dbt.handle_existing_table": {"unique_id": "macro.dbt.handle_existing_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/helpers.sql", "original_file_path": "macros/materializations/models/view/helpers.sql", "name": "handle_existing_table", "macro_sql": "{% macro handle_existing_table(full_refresh, old_relation) %}\n    {{ adapter.dispatch('handle_existing_table', 'dbt')(full_refresh, old_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__handle_existing_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0490031}, "macro.dbt.default__handle_existing_table": {"unique_id": "macro.dbt.default__handle_existing_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/helpers.sql", "original_file_path": "macros/materializations/models/view/helpers.sql", "name": "default__handle_existing_table", "macro_sql": "{% macro default__handle_existing_table(full_refresh, old_relation) %}\n    {{ log(\"Dropping relation \" ~ old_relation ~ \" because it is of type \" ~ old_relation.type) }}\n    {{ adapter.drop_relation(old_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0495229}, "macro.dbt.get_create_view_as_sql": {"unique_id": "macro.dbt.get_create_view_as_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/create_view_as.sql", "original_file_path": "macros/materializations/models/view/create_view_as.sql", "name": "get_create_view_as_sql", "macro_sql": "{% macro get_create_view_as_sql(relation, sql) -%}\n  {{ adapter.dispatch('get_create_view_as_sql', 'dbt')(relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_create_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0503566}, "macro.dbt.default__get_create_view_as_sql": {"unique_id": "macro.dbt.default__get_create_view_as_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/create_view_as.sql", "original_file_path": "macros/materializations/models/view/create_view_as.sql", "name": "default__get_create_view_as_sql", "macro_sql": "{% macro default__get_create_view_as_sql(relation, sql) -%}\n  {{ return(create_view_as(relation, sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0507185}, "macro.dbt.create_view_as": {"unique_id": "macro.dbt.create_view_as", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/create_view_as.sql", "original_file_path": "macros/materializations/models/view/create_view_as.sql", "name": "create_view_as", "macro_sql": "{% macro create_view_as(relation, sql) -%}\n  {{ adapter.dispatch('create_view_as', 'dbt')(relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0511155}, "macro.dbt.default__create_view_as": {"unique_id": "macro.dbt.default__create_view_as", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/create_view_as.sql", "original_file_path": "macros/materializations/models/view/create_view_as.sql", "name": "default__create_view_as", "macro_sql": "{% macro default__create_view_as(relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n  create view {{ relation }} as (\n    {{ sql }}\n  );\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0516853}, "macro.dbt.materialization_view_default": {"unique_id": "macro.dbt.materialization_view_default", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/view.sql", "original_file_path": "macros/materializations/models/view/view.sql", "name": "materialization_view_default", "macro_sql": "{%- materialization view, default -%}\n\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='view') -%}\n  {%- set intermediate_relation =  make_intermediate_relation(target_relation) -%}\n\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation) -%}\n  /*\n     This relation (probably) doesn't exist yet. If it does exist, it's a leftover from\n     a previous run, and we're going to try to drop it immediately. At the end of this\n     materialization, we're going to rename the \"existing_relation\" to this identifier,\n     and then we're going to drop it. In order to make sure we run the correct one of:\n       - drop view ...\n       - drop table ...\n\n     We need to set the type of this relation to be the type of the existing_relation, if it exists,\n     or else \"view\" as a sane default if it does not. Note that if the existing_relation does not\n     exist, then there is nothing to move out of the way and subsequentally drop. In that case,\n     this relation will be effectively unused.\n  */\n  {%- set backup_relation_type = 'view' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n  -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_view_as_sql(intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  -- move the existing view out of the way\n  {% if existing_relation is not none %}\n    {{ adapter.rename_relation(existing_relation, backup_relation) }}\n  {% endif %}\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.run_hooks", "macro.dbt.drop_relation_if_exists", "macro.dbt.statement", "macro.dbt.get_create_view_as_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0568519}, "macro.dbt.materialization_incremental_default": {"unique_id": "macro.dbt.materialization_incremental_default", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/incremental.sql", "original_file_path": "macros/materializations/models/incremental/incremental.sql", "name": "materialization_incremental_default", "macro_sql": "{% materialization incremental, default -%}\n\n  -- relations\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='table') -%}\n  {%- set temp_relation = make_temp_relation(target_relation)-%}\n  {%- set intermediate_relation = make_intermediate_relation(target_relation)-%}\n  {%- set backup_relation_type = 'table' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n\n  -- configs\n  {%- set unique_key = config.get('unique_key') -%}\n  {%- set full_refresh_mode = (should_full_refresh()  or existing_relation.is_view) -%}\n  {%- set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), default='ignore') -%}\n\n  -- the temp_ and backup_ relations should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation. This has to happen before\n  -- BEGIN, in a separate transaction\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation)-%}\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n   -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set to_drop = [] %}\n\n  {% if existing_relation is none %}\n      {% set build_sql = get_create_table_as_sql(False, target_relation, sql) %}\n  {% elif full_refresh_mode %}\n      {% set build_sql = get_create_table_as_sql(False, intermediate_relation, sql) %}\n      {% set need_swap = true %}\n  {% else %}\n    {% do run_query(get_create_table_as_sql(True, temp_relation, sql)) %}\n    {% do adapter.expand_target_column_types(\n             from_relation=temp_relation,\n             to_relation=target_relation) %}\n    {#-- Process schema changes. Returns dict of changes if successful. Use source columns for upserting/merging --#}\n    {% set dest_columns = process_schema_changes(on_schema_change, temp_relation, existing_relation) %}\n    {% if not dest_columns %}\n      {% set dest_columns = adapter.get_columns_in_relation(existing_relation) %}\n    {% endif %}\n    {% set build_sql = get_delete_insert_merge_sql(target_relation, temp_relation, unique_key, dest_columns) %}\n\n  {% endif %}\n\n  {% call statement(\"main\") %}\n      {{ build_sql }}\n  {% endcall %}\n\n  {% if need_swap %}\n      {% do adapter.rename_relation(target_relation, backup_relation) %}\n      {% do adapter.rename_relation(intermediate_relation, target_relation) %}\n      {% do to_drop.append(backup_relation) %}\n  {% endif %}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if existing_relation is none or existing_relation.is_view or should_full_refresh() %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {% do adapter.commit() %}\n\n  {% for rel in to_drop %}\n      {% do adapter.drop_relation(rel) %}\n  {% endfor %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_temp_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.should_full_refresh", "macro.dbt.incremental_validate_on_schema_change", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.get_create_table_as_sql", "macro.dbt.run_query", "macro.dbt.process_schema_changes", "macro.dbt.get_delete_insert_merge_sql", "macro.dbt.statement", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0659068}, "macro.dbt.incremental_validate_on_schema_change": {"unique_id": "macro.dbt.incremental_validate_on_schema_change", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "name": "incremental_validate_on_schema_change", "macro_sql": "{% macro incremental_validate_on_schema_change(on_schema_change, default='ignore') %}\n\n   {% if on_schema_change not in ['sync_all_columns', 'append_new_columns', 'fail', 'ignore'] %}\n\n     {% set log_message = 'Invalid value for on_schema_change (%s) specified. Setting default value of %s.' % (on_schema_change, default) %}\n     {% do log(log_message) %}\n\n     {{ return(default) }}\n\n   {% else %}\n\n     {{ return(on_schema_change) }}\n\n   {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0735564}, "macro.dbt.check_for_schema_changes": {"unique_id": "macro.dbt.check_for_schema_changes", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "name": "check_for_schema_changes", "macro_sql": "{% macro check_for_schema_changes(source_relation, target_relation) %}\n\n  {% set schema_changed = False %}\n\n  {%- set source_columns = adapter.get_columns_in_relation(source_relation) -%}\n  {%- set target_columns = adapter.get_columns_in_relation(target_relation) -%}\n  {%- set source_not_in_target = diff_columns(source_columns, target_columns) -%}\n  {%- set target_not_in_source = diff_columns(target_columns, source_columns) -%}\n\n  {% set new_target_types = diff_column_data_types(source_columns, target_columns) %}\n\n  {% if source_not_in_target != [] %}\n    {% set schema_changed = True %}\n  {% elif target_not_in_source != [] or new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% elif new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% endif %}\n\n  {% set changes_dict = {\n    'schema_changed': schema_changed,\n    'source_not_in_target': source_not_in_target,\n    'target_not_in_source': target_not_in_source,\n    'source_columns': source_columns,\n    'target_columns': target_columns,\n    'new_target_types': new_target_types\n  } %}\n\n  {% set msg %}\n    In {{ target_relation }}:\n        Schema changed: {{ schema_changed }}\n        Source columns not in target: {{ source_not_in_target }}\n        Target columns not in source: {{ target_not_in_source }}\n        New column types: {{ new_target_types }}\n  {% endset %}\n\n  {% do log(msg) %}\n\n  {{ return(changes_dict) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.diff_columns", "macro.dbt.diff_column_data_types"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.076233}, "macro.dbt.sync_column_schemas": {"unique_id": "macro.dbt.sync_column_schemas", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "name": "sync_column_schemas", "macro_sql": "{% macro sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n\n  {%- set add_to_target_arr = schema_changes_dict['source_not_in_target'] -%}\n\n  {%- if on_schema_change == 'append_new_columns'-%}\n     {%- if add_to_target_arr | length > 0 -%}\n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, none) -%}\n     {%- endif -%}\n\n  {% elif on_schema_change == 'sync_all_columns' %}\n     {%- set remove_from_target_arr = schema_changes_dict['target_not_in_source'] -%}\n     {%- set new_target_types = schema_changes_dict['new_target_types'] -%}\n\n     {% if add_to_target_arr | length > 0 or remove_from_target_arr | length > 0 %}\n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, remove_from_target_arr) -%}\n     {% endif %}\n\n     {% if new_target_types != [] %}\n       {% for ntt in new_target_types %}\n         {% set column_name = ntt['column_name'] %}\n         {% set new_type = ntt['new_type'] %}\n         {% do alter_column_type(target_relation, column_name, new_type) %}\n       {% endfor %}\n     {% endif %}\n\n  {% endif %}\n\n  {% set schema_change_message %}\n    In {{ target_relation }}:\n        Schema change approach: {{ on_schema_change }}\n        Columns added: {{ add_to_target_arr }}\n        Columns removed: {{ remove_from_target_arr }}\n        Data types changed: {{ new_target_types }}\n  {% endset %}\n\n  {% do log(schema_change_message) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.alter_relation_add_remove_columns", "macro.dbt.alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0788467}, "macro.dbt.process_schema_changes": {"unique_id": "macro.dbt.process_schema_changes", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "name": "process_schema_changes", "macro_sql": "{% macro process_schema_changes(on_schema_change, source_relation, target_relation) %}\n\n    {% if on_schema_change == 'ignore' %}\n\n     {{ return({}) }}\n\n    {% else %}\n\n      {% set schema_changes_dict = check_for_schema_changes(source_relation, target_relation) %}\n\n      {% if schema_changes_dict['schema_changed'] %}\n\n        {% if on_schema_change == 'fail' %}\n\n          {% set fail_msg %}\n              The source and target schemas on this incremental model are out of sync!\n              They can be reconciled in several ways:\n                - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.\n                - Re-run the incremental model with `full_refresh: True` to update the target schema.\n                - update the schema manually and re-run the process.\n          {% endset %}\n\n          {% do exceptions.raise_compiler_error(fail_msg) %}\n\n        {# -- unless we ignore, run the sync operation per the config #}\n        {% else %}\n\n          {% do sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n\n        {% endif %}\n\n      {% endif %}\n\n      {{ return(schema_changes_dict['source_columns']) }}\n\n    {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.check_for_schema_changes", "macro.dbt.sync_column_schemas"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0805137}, "macro.dbt.is_incremental": {"unique_id": "macro.dbt.is_incremental", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/is_incremental.sql", "original_file_path": "macros/materializations/models/incremental/is_incremental.sql", "name": "is_incremental", "macro_sql": "{% macro is_incremental() %}\n    {#-- do not run introspective queries in parsing #}\n    {% if not execute %}\n        {{ return(False) }}\n    {% else %}\n        {% set relation = adapter.get_relation(this.database, this.schema, this.table) %}\n        {{ return(relation is not none\n                  and relation.type == 'table'\n                  and model.config.materialized == 'incremental'\n                  and not should_full_refresh()) }}\n    {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_full_refresh"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.081982}, "macro.dbt.get_merge_sql": {"unique_id": "macro.dbt.get_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "name": "get_merge_sql", "macro_sql": "{% macro get_merge_sql(target, source, unique_key, dest_columns, predicates=none) -%}\n  {{ adapter.dispatch('get_merge_sql', 'dbt')(target, source, unique_key, dest_columns, predicates) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.090263}, "macro.dbt.default__get_merge_sql": {"unique_id": "macro.dbt.default__get_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "name": "default__get_merge_sql", "macro_sql": "{% macro default__get_merge_sql(target, source, unique_key, dest_columns, predicates) -%}\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set update_columns = config.get('merge_update_columns', default = dest_columns | map(attribute=\"quoted\") | list) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {% if unique_key %}\n        {% if unique_key is sequence and unique_key is not mapping and unique_key is not string %}\n            {% for key in unique_key %}\n                {% set this_key_match %}\n                    DBT_INTERNAL_SOURCE.{{ key }} = DBT_INTERNAL_DEST.{{ key }}\n                {% endset %}\n                {% do predicates.append(this_key_match) %}\n            {% endfor %}\n        {% else %}\n            {% set unique_key_match %}\n                DBT_INTERNAL_SOURCE.{{ unique_key }} = DBT_INTERNAL_DEST.{{ unique_key }}\n            {% endset %}\n            {% do predicates.append(unique_key_match) %}\n        {% endif %}\n    {% else %}\n        {% do predicates.append('FALSE') %}\n    {% endif %}\n\n    {{ sql_header if sql_header is not none }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on {{ predicates | join(' and ') }}\n\n    {% if unique_key %}\n    when matched then update set\n        {% for column_name in update_columns -%}\n            {{ column_name }} = DBT_INTERNAL_SOURCE.{{ column_name }}\n            {%- if not loop.last %}, {%- endif %}\n        {%- endfor %}\n    {% endif %}\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.093492}, "macro.dbt.get_delete_insert_merge_sql": {"unique_id": "macro.dbt.get_delete_insert_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "name": "get_delete_insert_merge_sql", "macro_sql": "{% macro get_delete_insert_merge_sql(target, source, unique_key, dest_columns) -%}\n  {{ adapter.dispatch('get_delete_insert_merge_sql', 'dbt')(target, source, unique_key, dest_columns) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_delete_insert_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0940351}, "macro.dbt.default__get_delete_insert_merge_sql": {"unique_id": "macro.dbt.default__get_delete_insert_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "name": "default__get_delete_insert_merge_sql", "macro_sql": "{% macro default__get_delete_insert_merge_sql(target, source, unique_key, dest_columns) -%}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n\n    {% if unique_key %}\n        {% if unique_key is sequence and unique_key is not string %}\n            delete from {{target }}\n            using {{ source }}\n            where (\n                {% for key in unique_key %}\n                    {{ source }}.{{ key }} = {{ target }}.{{ key }}\n                    {{ \"and \" if not loop.last }}\n                {% endfor %}\n            );\n        {% else %}\n            delete from {{ target }}\n            where (\n                {{ unique_key }}) in (\n                select ({{ unique_key }})\n                from {{ source }}\n            );\n\n        {% endif %}\n        {% endif %}\n\n    insert into {{ target }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ source }}\n    )\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0957282}, "macro.dbt.get_insert_overwrite_merge_sql": {"unique_id": "macro.dbt.get_insert_overwrite_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "name": "get_insert_overwrite_merge_sql", "macro_sql": "{% macro get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header=false) -%}\n  {{ adapter.dispatch('get_insert_overwrite_merge_sql', 'dbt')(target, source, dest_columns, predicates, include_sql_header) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_insert_overwrite_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.0963144}, "macro.dbt.default__get_insert_overwrite_merge_sql": {"unique_id": "macro.dbt.default__get_insert_overwrite_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "name": "default__get_insert_overwrite_merge_sql", "macro_sql": "{% macro default__get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header) -%}\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {{ sql_header if sql_header is not none and include_sql_header }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on FALSE\n\n    when not matched by source\n        {% if predicates %} and {{ predicates | join(' and ') }} {% endif %}\n        then delete\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.097697}, "macro.dbt.get_quoted_csv": {"unique_id": "macro.dbt.get_quoted_csv", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "name": "get_quoted_csv", "macro_sql": "{% macro get_quoted_csv(column_names) %}\n\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote(col)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.099355}, "macro.dbt.diff_columns": {"unique_id": "macro.dbt.diff_columns", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "name": "diff_columns", "macro_sql": "{% macro diff_columns(source_columns, target_columns) %}\n\n  {% set result = [] %}\n  {% set source_names = source_columns | map(attribute = 'column') | list %}\n  {% set target_names = target_columns | map(attribute = 'column') | list %}\n\n   {# --check whether the name attribute exists in the target - this does not perform a data type check #}\n   {% for sc in source_columns %}\n     {% if sc.name not in target_names %}\n        {{ result.append(sc) }}\n     {% endif %}\n   {% endfor %}\n\n  {{ return(result) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1006403}, "macro.dbt.diff_column_data_types": {"unique_id": "macro.dbt.diff_column_data_types", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "name": "diff_column_data_types", "macro_sql": "{% macro diff_column_data_types(source_columns, target_columns) %}\n\n  {% set result = [] %}\n  {% for sc in source_columns %}\n    {% set tc = target_columns | selectattr(\"name\", \"equalto\", sc.name) | list | first %}\n    {% if tc %}\n      {% if sc.data_type != tc.data_type %}\n        {{ result.append( { 'column_name': tc.name, 'new_type': sc.data_type } ) }}\n      {% endif %}\n    {% endif %}\n  {% endfor %}\n\n  {{ return(result) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1019905}, "macro.dbt.create_csv_table": {"unique_id": "macro.dbt.create_csv_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "create_csv_table", "macro_sql": "{% macro create_csv_table(model, agate_table) -%}\n  {{ adapter.dispatch('create_csv_table', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1095805}, "macro.dbt.default__create_csv_table": {"unique_id": "macro.dbt.default__create_csv_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "default__create_csv_table", "macro_sql": "{% macro default__create_csv_table(model, agate_table) %}\n  {%- set column_override = model['config'].get('column_types', {}) -%}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n\n  {% set sql %}\n    create table {{ this.render() }} (\n        {%- for col_name in agate_table.column_names -%}\n            {%- set inferred_type = adapter.convert_type(agate_table, loop.index0) -%}\n            {%- set type = column_override.get(col_name, inferred_type) -%}\n            {%- set column_name = (col_name | string) -%}\n            {{ adapter.quote_seed_column(column_name, quote_seed_column) }} {{ type }} {%- if not loop.last -%}, {%- endif -%}\n        {%- endfor -%}\n    )\n  {% endset %}\n\n  {% call statement('_') -%}\n    {{ sql }}\n  {%- endcall %}\n\n  {{ return(sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1116087}, "macro.dbt.reset_csv_table": {"unique_id": "macro.dbt.reset_csv_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "reset_csv_table", "macro_sql": "{% macro reset_csv_table(model, full_refresh, old_relation, agate_table) -%}\n  {{ adapter.dispatch('reset_csv_table', 'dbt')(model, full_refresh, old_relation, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__reset_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.112124}, "macro.dbt.default__reset_csv_table": {"unique_id": "macro.dbt.default__reset_csv_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "default__reset_csv_table", "macro_sql": "{% macro default__reset_csv_table(model, full_refresh, old_relation, agate_table) %}\n    {% set sql = \"\" %}\n    {% if full_refresh %}\n        {{ adapter.drop_relation(old_relation) }}\n        {% set sql = create_csv_table(model, agate_table) %}\n    {% else %}\n        {{ adapter.truncate_relation(old_relation) }}\n        {% set sql = \"truncate table \" ~ old_relation %}\n    {% endif %}\n\n    {{ return(sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1131861}, "macro.dbt.get_csv_sql": {"unique_id": "macro.dbt.get_csv_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "get_csv_sql", "macro_sql": "{% macro get_csv_sql(create_or_truncate_sql, insert_sql) %}\n    {{ adapter.dispatch('get_csv_sql', 'dbt')(create_or_truncate_sql, insert_sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_csv_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1136293}, "macro.dbt.default__get_csv_sql": {"unique_id": "macro.dbt.default__get_csv_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "default__get_csv_sql", "macro_sql": "{% macro default__get_csv_sql(create_or_truncate_sql, insert_sql) %}\n    {{ create_or_truncate_sql }};\n    -- dbt seed --\n    {{ insert_sql }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.113934}, "macro.dbt.get_binding_char": {"unique_id": "macro.dbt.get_binding_char", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "get_binding_char", "macro_sql": "{% macro get_binding_char() -%}\n  {{ adapter.dispatch('get_binding_char', 'dbt')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1142447}, "macro.dbt.default__get_binding_char": {"unique_id": "macro.dbt.default__get_binding_char", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "default__get_binding_char", "macro_sql": "{% macro default__get_binding_char() %}\n  {{ return('%s') }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.114504}, "macro.dbt.get_batch_size": {"unique_id": "macro.dbt.get_batch_size", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "get_batch_size", "macro_sql": "{% macro get_batch_size() -%}\n  {{ return(adapter.dispatch('get_batch_size', 'dbt')()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_batch_size"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1150286}, "macro.dbt.default__get_batch_size": {"unique_id": "macro.dbt.default__get_batch_size", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "default__get_batch_size", "macro_sql": "{% macro default__get_batch_size() %}\n  {{ return(10000) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1153798}, "macro.dbt.get_seed_column_quoted_csv": {"unique_id": "macro.dbt.get_seed_column_quoted_csv", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "get_seed_column_quoted_csv", "macro_sql": "{% macro get_seed_column_quoted_csv(model, column_names) %}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote_seed_column(col, quote_seed_column)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1164176}, "macro.dbt.load_csv_rows": {"unique_id": "macro.dbt.load_csv_rows", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "load_csv_rows", "macro_sql": "{% macro load_csv_rows(model, agate_table) -%}\n  {{ adapter.dispatch('load_csv_rows', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__load_csv_rows"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.116831}, "macro.dbt.default__load_csv_rows": {"unique_id": "macro.dbt.default__load_csv_rows", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "default__load_csv_rows", "macro_sql": "{% macro default__load_csv_rows(model, agate_table) %}\n\n  {% set batch_size = get_batch_size() %}\n\n  {% set cols_sql = get_seed_column_quoted_csv(model, agate_table.column_names) %}\n  {% set bindings = [] %}\n\n  {% set statements = [] %}\n\n  {% for chunk in agate_table.rows | batch(batch_size) %}\n      {% set bindings = [] %}\n\n      {% for row in chunk %}\n          {% do bindings.extend(row) %}\n      {% endfor %}\n\n      {% set sql %}\n          insert into {{ this.render() }} ({{ cols_sql }}) values\n          {% for row in chunk -%}\n              ({%- for column in agate_table.column_names -%}\n                  {{ get_binding_char() }}\n                  {%- if not loop.last%},{%- endif %}\n              {%- endfor -%})\n              {%- if not loop.last%},{%- endif %}\n          {%- endfor %}\n      {% endset %}\n\n      {% do adapter.add_query(sql, bindings=bindings, abridge_sql_log=True) %}\n\n      {% if loop.index0 == 0 %}\n          {% do statements.append(sql) %}\n      {% endif %}\n  {% endfor %}\n\n  {# Return SQL so we can render it out into the compiled files #}\n  {{ return(statements[0]) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_batch_size", "macro.dbt.get_seed_column_quoted_csv", "macro.dbt.get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1194773}, "macro.dbt.materialization_seed_default": {"unique_id": "macro.dbt.materialization_seed_default", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/seed.sql", "original_file_path": "macros/materializations/seeds/seed.sql", "name": "materialization_seed_default", "macro_sql": "{% materialization seed, default %}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set grant_config = config.get('grants') -%}\n  {%- set agate_table = load_agate_table() -%}\n  -- grab current tables grants config for comparision later on\n\n  {%- do store_result('agate_table', response='OK', agate_table=agate_table) -%}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% set create_table_sql = \"\" %}\n  {% if exists_as_view %}\n    {{ exceptions.raise_compiler_error(\"Cannot seed to '{}', it is a view\".format(old_relation)) }}\n  {% elif exists_as_table %}\n    {% set create_table_sql = reset_csv_table(model, full_refresh_mode, old_relation, agate_table) %}\n  {% else %}\n    {% set create_table_sql = create_csv_table(model, agate_table) %}\n  {% endif %}\n\n  {% set code = 'CREATE' if full_refresh_mode else 'INSERT' %}\n  {% set rows_affected = (agate_table.rows | length) %}\n  {% set sql = load_csv_rows(model, agate_table) %}\n\n  {% call noop_statement('main', code ~ ' ' ~ rows_affected, code, rows_affected) %}\n    {{ get_csv_sql(create_table_sql, sql) }};\n  {% endcall %}\n\n  {% set target_relation = this.incorporate(type='table') %}\n\n  {% set should_revoke = should_revoke(old_relation, full_refresh_mode) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if full_refresh_mode or not exists_as_table %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_full_refresh", "macro.dbt.run_hooks", "macro.dbt.reset_csv_table", "macro.dbt.create_csv_table", "macro.dbt.load_csv_rows", "macro.dbt.noop_statement", "macro.dbt.get_csv_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1260338}, "macro.dbt.get_test_sql": {"unique_id": "macro.dbt.get_test_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/tests/helpers.sql", "original_file_path": "macros/materializations/tests/helpers.sql", "name": "get_test_sql", "macro_sql": "{% macro get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n  {{ adapter.dispatch('get_test_sql', 'dbt')(main_sql, fail_calc, warn_if, error_if, limit) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.127081}, "macro.dbt.default__get_test_sql": {"unique_id": "macro.dbt.default__get_test_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/tests/helpers.sql", "original_file_path": "macros/materializations/tests/helpers.sql", "name": "default__get_test_sql", "macro_sql": "{% macro default__get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n    select\n      {{ fail_calc }} as failures,\n      {{ fail_calc }} {{ warn_if }} as should_warn,\n      {{ fail_calc }} {{ error_if }} as should_error\n    from (\n      {{ main_sql }}\n      {{ \"limit \" ~ limit if limit != none }}\n    ) dbt_internal_test\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1277542}, "macro.dbt.materialization_test_default": {"unique_id": "macro.dbt.materialization_test_default", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/tests/test.sql", "original_file_path": "macros/materializations/tests/test.sql", "name": "materialization_test_default", "macro_sql": "{%- materialization test, default -%}\n\n  {% set relations = [] %}\n\n  {% if should_store_failures() %}\n\n    {% set identifier = model['alias'] %}\n    {% set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n    {% set target_relation = api.Relation.create(\n        identifier=identifier, schema=schema, database=database, type='table') -%} %}\n\n    {% if old_relation %}\n        {% do adapter.drop_relation(old_relation) %}\n    {% endif %}\n\n    {% call statement(auto_begin=True) %}\n        {{ create_table_as(False, target_relation, sql) }}\n    {% endcall %}\n\n    {% do relations.append(target_relation) %}\n\n    {% set main_sql %}\n        select *\n        from {{ target_relation }}\n    {% endset %}\n\n    {{ adapter.commit() }}\n\n  {% else %}\n\n      {% set main_sql = sql %}\n\n  {% endif %}\n\n  {% set limit = config.get('limit') %}\n  {% set fail_calc = config.get('fail_calc') %}\n  {% set warn_if = config.get('warn_if') %}\n  {% set error_if = config.get('error_if') %}\n\n  {% call statement('main', fetch_result=True) -%}\n\n    {{ get_test_sql(main_sql, fail_calc, warn_if, error_if, limit)}}\n\n  {%- endcall %}\n\n  {{ return({'relations': relations}) }}\n\n{%- endmaterialization -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_store_failures", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt.get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.132049}, "macro.dbt.get_where_subquery": {"unique_id": "macro.dbt.get_where_subquery", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/tests/where_subquery.sql", "original_file_path": "macros/materializations/tests/where_subquery.sql", "name": "get_where_subquery", "macro_sql": "{% macro get_where_subquery(relation) -%}\n    {% do return(adapter.dispatch('get_where_subquery', 'dbt')(relation)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_where_subquery"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1329303}, "macro.dbt.default__get_where_subquery": {"unique_id": "macro.dbt.default__get_where_subquery", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/tests/where_subquery.sql", "original_file_path": "macros/materializations/tests/where_subquery.sql", "name": "default__get_where_subquery", "macro_sql": "{% macro default__get_where_subquery(relation) -%}\n    {% set where = config.get('where', '') %}\n    {% if where %}\n        {%- set filtered -%}\n            (select * from {{ relation }} where {{ where }}) dbt_subquery\n        {%- endset -%}\n        {% do return(filtered) %}\n    {%- else -%}\n        {% do return(relation) %}\n    {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.133807}, "macro.dbt.create_columns": {"unique_id": "macro.dbt.create_columns", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "create_columns", "macro_sql": "{% macro create_columns(relation, columns) %}\n  {{ adapter.dispatch('create_columns', 'dbt')(relation, columns) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_columns"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1399937}, "macro.dbt.default__create_columns": {"unique_id": "macro.dbt.default__create_columns", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "default__create_columns", "macro_sql": "{% macro default__create_columns(relation, columns) %}\n  {% for column in columns %}\n    {% call statement() %}\n      alter table {{ relation }} add column \"{{ column.name }}\" {{ column.data_type }};\n    {% endcall %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.140627}, "macro.dbt.post_snapshot": {"unique_id": "macro.dbt.post_snapshot", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "post_snapshot", "macro_sql": "{% macro post_snapshot(staging_relation) %}\n  {{ adapter.dispatch('post_snapshot', 'dbt')(staging_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1410894}, "macro.dbt.default__post_snapshot": {"unique_id": "macro.dbt.default__post_snapshot", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "default__post_snapshot", "macro_sql": "{% macro default__post_snapshot(staging_relation) %}\n    {# no-op #}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1413312}, "macro.dbt.get_true_sql": {"unique_id": "macro.dbt.get_true_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "get_true_sql", "macro_sql": "{% macro get_true_sql() %}\n  {{ adapter.dispatch('get_true_sql', 'dbt')() }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_true_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.14167}, "macro.dbt.default__get_true_sql": {"unique_id": "macro.dbt.default__get_true_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "default__get_true_sql", "macro_sql": "{% macro default__get_true_sql() %}\n    {{ return('TRUE') }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.141935}, "macro.dbt.snapshot_staging_table": {"unique_id": "macro.dbt.snapshot_staging_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "snapshot_staging_table", "macro_sql": "{% macro snapshot_staging_table(strategy, source_sql, target_relation) -%}\n  {{ adapter.dispatch('snapshot_staging_table', 'dbt')(strategy, source_sql, target_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__snapshot_staging_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1423764}, "macro.dbt.default__snapshot_staging_table": {"unique_id": "macro.dbt.default__snapshot_staging_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "default__snapshot_staging_table", "macro_sql": "{% macro default__snapshot_staging_table(strategy, source_sql, target_relation) -%}\n\n    with snapshot_query as (\n\n        {{ source_sql }}\n\n    ),\n\n    snapshotted_data as (\n\n        select *,\n            {{ strategy.unique_key }} as dbt_unique_key\n\n        from {{ target_relation }}\n        where dbt_valid_to is null\n\n    ),\n\n    insertions_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key,\n            {{ strategy.updated_at }} as dbt_updated_at,\n            {{ strategy.updated_at }} as dbt_valid_from,\n            nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}) as dbt_valid_to,\n            {{ strategy.scd_id }} as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key,\n            {{ strategy.updated_at }} as dbt_updated_at,\n            {{ strategy.updated_at }} as dbt_valid_from,\n            {{ strategy.updated_at }} as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    {%- if strategy.invalidate_hard_deletes %}\n\n    deletes_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key\n        from snapshot_query\n    ),\n    {% endif %}\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where snapshotted_data.dbt_unique_key is null\n           or (\n                snapshotted_data.dbt_unique_key is not null\n            and (\n                {{ strategy.row_changed }}\n            )\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where (\n            {{ strategy.row_changed }}\n        )\n    )\n\n    {%- if strategy.invalidate_hard_deletes -%}\n    ,\n\n    deletes as (\n\n        select\n            'delete' as dbt_change_type,\n            source_data.*,\n            {{ snapshot_get_time() }} as dbt_valid_from,\n            {{ snapshot_get_time() }} as dbt_updated_at,\n            {{ snapshot_get_time() }} as dbt_valid_to,\n            snapshotted_data.dbt_scd_id\n\n        from snapshotted_data\n        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where source_data.dbt_unique_key is null\n    )\n    {%- endif %}\n\n    select * from insertions\n    union all\n    select * from updates\n    {%- if strategy.invalidate_hard_deletes %}\n    union all\n    select * from deletes\n    {%- endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.144219}, "macro.dbt.build_snapshot_table": {"unique_id": "macro.dbt.build_snapshot_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "build_snapshot_table", "macro_sql": "{% macro build_snapshot_table(strategy, sql) -%}\n  {{ adapter.dispatch('build_snapshot_table', 'dbt')(strategy, sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__build_snapshot_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1447864}, "macro.dbt.default__build_snapshot_table": {"unique_id": "macro.dbt.default__build_snapshot_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "default__build_snapshot_table", "macro_sql": "{% macro default__build_snapshot_table(strategy, sql) %}\n\n    select *,\n        {{ strategy.scd_id }} as dbt_scd_id,\n        {{ strategy.updated_at }} as dbt_updated_at,\n        {{ strategy.updated_at }} as dbt_valid_from,\n        nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}) as dbt_valid_to\n    from (\n        {{ sql }}\n    ) sbq\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1453745}, "macro.dbt.build_snapshot_staging_table": {"unique_id": "macro.dbt.build_snapshot_staging_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "build_snapshot_staging_table", "macro_sql": "{% macro build_snapshot_staging_table(strategy, sql, target_relation) %}\n    {% set temp_relation = make_temp_relation(target_relation) %}\n\n    {% set select = snapshot_staging_table(strategy, sql, target_relation) %}\n\n    {% call statement('build_snapshot_staging_relation') %}\n        {{ create_table_as(True, temp_relation, select) }}\n    {% endcall %}\n\n    {% do return(temp_relation) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_temp_relation", "macro.dbt.snapshot_staging_table", "macro.dbt.statement", "macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1464114}, "macro.dbt.strategy_dispatch": {"unique_id": "macro.dbt.strategy_dispatch", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "strategy_dispatch", "macro_sql": "{% macro strategy_dispatch(name) -%}\n{% set original_name = name %}\n  {% if '.' in name %}\n    {% set package_name, name = name.split(\".\", 1) %}\n  {% else %}\n    {% set package_name = none %}\n  {% endif %}\n\n  {% if package_name is none %}\n    {% set package_context = context %}\n  {% elif package_name in context %}\n    {% set package_context = context[package_name] %}\n  {% else %}\n    {% set error_msg %}\n        Could not find package '{{package_name}}', called with '{{original_name}}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n\n  {%- set search_name = 'snapshot_' ~ name ~ '_strategy' -%}\n\n  {% if search_name not in package_context %}\n    {% set error_msg %}\n        The specified strategy macro '{{name}}' was not found in package '{{ package_name }}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n  {{ return(package_context[search_name]) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1526575}, "macro.dbt.snapshot_hash_arguments": {"unique_id": "macro.dbt.snapshot_hash_arguments", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "snapshot_hash_arguments", "macro_sql": "{% macro snapshot_hash_arguments(args) -%}\n  {{ adapter.dispatch('snapshot_hash_arguments', 'dbt')(args) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.153144}, "macro.dbt.default__snapshot_hash_arguments": {"unique_id": "macro.dbt.default__snapshot_hash_arguments", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "default__snapshot_hash_arguments", "macro_sql": "{% macro default__snapshot_hash_arguments(args) -%}\n    md5({%- for arg in args -%}\n        coalesce(cast({{ arg }} as varchar ), '')\n        {% if not loop.last %} || '|' || {% endif %}\n    {%- endfor -%})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1536663}, "macro.dbt.snapshot_get_time": {"unique_id": "macro.dbt.snapshot_get_time", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "snapshot_get_time", "macro_sql": "{% macro snapshot_get_time() -%}\n  {{ adapter.dispatch('snapshot_get_time', 'dbt')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1539915}, "macro.dbt.default__snapshot_get_time": {"unique_id": "macro.dbt.default__snapshot_get_time", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "default__snapshot_get_time", "macro_sql": "{% macro default__snapshot_get_time() -%}\n  {{ current_timestamp() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.154249}, "macro.dbt.snapshot_timestamp_strategy": {"unique_id": "macro.dbt.snapshot_timestamp_strategy", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "snapshot_timestamp_strategy", "macro_sql": "{% macro snapshot_timestamp_strategy(node, snapshotted_rel, current_rel, config, target_exists) %}\n    {% set primary_key = config['unique_key'] %}\n    {% set updated_at = config['updated_at'] %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes', false) %}\n\n    {#/*\n        The snapshot relation might not have an {{ updated_at }} value if the\n        snapshot strategy is changed from `check` to `timestamp`. We\n        should use a dbt-created column for the comparison in the snapshot\n        table instead of assuming that the user-supplied {{ updated_at }}\n        will be present in the historical data.\n\n        See https://github.com/dbt-labs/dbt-core/issues/2350\n    */ #}\n    {% set row_changed_expr -%}\n        ({{ snapshotted_rel }}.dbt_valid_from < {{ current_rel }}.{{ updated_at }})\n    {%- endset %}\n\n    {% set scd_id_expr = snapshot_hash_arguments([primary_key, updated_at]) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1558967}, "macro.dbt.snapshot_string_as_time": {"unique_id": "macro.dbt.snapshot_string_as_time", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "snapshot_string_as_time", "macro_sql": "{% macro snapshot_string_as_time(timestamp) -%}\n    {{ adapter.dispatch('snapshot_string_as_time', 'dbt')(timestamp) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__snapshot_string_as_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1562834}, "macro.dbt.default__snapshot_string_as_time": {"unique_id": "macro.dbt.default__snapshot_string_as_time", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "default__snapshot_string_as_time", "macro_sql": "{% macro default__snapshot_string_as_time(timestamp) %}\n    {% do exceptions.raise_not_implemented(\n        'snapshot_string_as_time macro not implemented for adapter '+adapter.type()\n    ) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1567636}, "macro.dbt.snapshot_check_all_get_existing_columns": {"unique_id": "macro.dbt.snapshot_check_all_get_existing_columns", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "snapshot_check_all_get_existing_columns", "macro_sql": "{% macro snapshot_check_all_get_existing_columns(node, target_exists, check_cols_config) -%}\n    {%- if not target_exists -%}\n        {#-- no table yet -> return whatever the query does --#}\n        {{ return((false, query_columns)) }}\n    {%- endif -%}\n\n    {#-- handle any schema changes --#}\n    {%- set target_relation = adapter.get_relation(database=node.database, schema=node.schema, identifier=node.alias) -%}\n\n    {% if check_cols_config == 'all' %}\n        {%- set query_columns = get_columns_in_query(node['compiled_sql']) -%}\n\n    {% elif check_cols_config is iterable and (check_cols_config | length) > 0 %}\n        {#-- query for proper casing/quoting, to support comparison below --#}\n        {%- set select_check_cols_from_target -%}\n          select {{ check_cols_config | join(', ') }} from ({{ node['compiled_sql'] }}) subq\n        {%- endset -%}\n        {% set query_columns = get_columns_in_query(select_check_cols_from_target) %}\n\n    {% else %}\n        {% do exceptions.raise_compiler_error(\"Invalid value for 'check_cols': \" ~ check_cols_config) %}\n    {% endif %}\n\n    {%- set existing_cols = adapter.get_columns_in_relation(target_relation) | map(attribute = 'name') | list -%}\n    {%- set ns = namespace() -%} {#-- handle for-loop scoping with a namespace --#}\n    {%- set ns.column_added = false -%}\n\n    {%- set intersection = [] -%}\n    {%- for col in query_columns -%}\n        {%- if col in existing_cols -%}\n            {%- do intersection.append(adapter.quote(col)) -%}\n        {%- else -%}\n            {% set ns.column_added = true %}\n        {%- endif -%}\n    {%- endfor -%}\n    {{ return((ns.column_added, intersection)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1598268}, "macro.dbt.snapshot_check_strategy": {"unique_id": "macro.dbt.snapshot_check_strategy", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "snapshot_check_strategy", "macro_sql": "{% macro snapshot_check_strategy(node, snapshotted_rel, current_rel, config, target_exists) %}\n    {% set check_cols_config = config['check_cols'] %}\n    {% set primary_key = config['unique_key'] %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes', false) %}\n    {% set updated_at = config.get('updated_at', snapshot_get_time()) %}\n\n    {% set column_added = false %}\n\n    {% set column_added, check_cols = snapshot_check_all_get_existing_columns(node, target_exists, check_cols_config) %}\n\n    {%- set row_changed_expr -%}\n    (\n    {%- if column_added -%}\n        {{ get_true_sql() }}\n    {%- else -%}\n    {%- for col in check_cols -%}\n        {{ snapshotted_rel }}.{{ col }} != {{ current_rel }}.{{ col }}\n        or\n        (\n            (({{ snapshotted_rel }}.{{ col }} is null) and not ({{ current_rel }}.{{ col }} is null))\n            or\n            ((not {{ snapshotted_rel }}.{{ col }} is null) and ({{ current_rel }}.{{ col }} is null))\n        )\n        {%- if not loop.last %} or {% endif -%}\n    {%- endfor -%}\n    {%- endif -%}\n    )\n    {%- endset %}\n\n    {% set scd_id_expr = snapshot_hash_arguments([primary_key, updated_at]) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_get_time", "macro.dbt.snapshot_check_all_get_existing_columns", "macro.dbt.get_true_sql", "macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1628935}, "macro.dbt.snapshot_merge_sql": {"unique_id": "macro.dbt.snapshot_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshots/snapshot_merge.sql", "name": "snapshot_merge_sql", "macro_sql": "{% macro snapshot_merge_sql(target, source, insert_cols) -%}\n  {{ adapter.dispatch('snapshot_merge_sql', 'dbt')(target, source, insert_cols) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_postgres.postgres__snapshot_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1638868}, "macro.dbt.default__snapshot_merge_sql": {"unique_id": "macro.dbt.default__snapshot_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshots/snapshot_merge.sql", "name": "default__snapshot_merge_sql", "macro_sql": "{% macro default__snapshot_merge_sql(target, source, insert_cols) -%}\n    {%- set insert_cols_csv = insert_cols | join(', ') -%}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n    using {{ source }} as DBT_INTERNAL_SOURCE\n    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id\n\n    when matched\n     and DBT_INTERNAL_DEST.dbt_valid_to is null\n     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')\n        then update\n        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n\n    when not matched\n     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'\n        then insert ({{ insert_cols_csv }})\n        values ({{ insert_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.164472}, "macro.dbt.materialization_snapshot_default": {"unique_id": "macro.dbt.materialization_snapshot_default", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/snapshot.sql", "original_file_path": "macros/materializations/snapshots/snapshot.sql", "name": "materialization_snapshot_default", "macro_sql": "{% materialization snapshot, default %}\n  {%- set config = model['config'] -%}\n\n  {%- set target_table = model.get('alias', model.get('name')) -%}\n\n  {%- set strategy_name = config.get('strategy') -%}\n  {%- set unique_key = config.get('unique_key') %}\n  -- grab current tables grants config for comparision later on\n  {%- set grant_config = config.get('grants') -%}\n\n  {% set target_relation_exists, target_relation = get_or_create_relation(\n          database=model.database,\n          schema=model.schema,\n          identifier=target_table,\n          type='table') -%}\n\n  {%- if not target_relation.is_table -%}\n    {% do exceptions.relation_wrong_type(target_relation, 'table') %}\n  {%- endif -%}\n\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set strategy_macro = strategy_dispatch(strategy_name) %}\n  {% set strategy = strategy_macro(model, \"snapshotted_data\", \"source_data\", config, target_relation_exists) %}\n\n  {% if not target_relation_exists %}\n\n      {% set build_sql = build_snapshot_table(strategy, model['compiled_sql']) %}\n      {% set final_sql = create_table_as(False, target_relation, build_sql) %}\n\n  {% else %}\n\n      {{ adapter.valid_snapshot_target(target_relation) }}\n\n      {% set staging_table = build_snapshot_staging_table(strategy, sql, target_relation) %}\n\n      -- this may no-op if the database does not require column expansion\n      {% do adapter.expand_target_column_types(from_relation=staging_table,\n                                               to_relation=target_relation) %}\n\n      {% set missing_columns = adapter.get_missing_columns(staging_table, target_relation)\n                                   | rejectattr('name', 'equalto', 'dbt_change_type')\n                                   | rejectattr('name', 'equalto', 'DBT_CHANGE_TYPE')\n                                   | rejectattr('name', 'equalto', 'dbt_unique_key')\n                                   | rejectattr('name', 'equalto', 'DBT_UNIQUE_KEY')\n                                   | list %}\n\n      {% do create_columns(target_relation, missing_columns) %}\n\n      {% set source_columns = adapter.get_columns_in_relation(staging_table)\n                                   | rejectattr('name', 'equalto', 'dbt_change_type')\n                                   | rejectattr('name', 'equalto', 'DBT_CHANGE_TYPE')\n                                   | rejectattr('name', 'equalto', 'dbt_unique_key')\n                                   | rejectattr('name', 'equalto', 'DBT_UNIQUE_KEY')\n                                   | list %}\n\n      {% set quoted_source_columns = [] %}\n      {% for column in source_columns %}\n        {% do quoted_source_columns.append(adapter.quote(column.name)) %}\n      {% endfor %}\n\n      {% set final_sql = snapshot_merge_sql(\n            target = target_relation,\n            source = staging_table,\n            insert_cols = quoted_source_columns\n         )\n      %}\n\n  {% endif %}\n\n  {% call statement('main') %}\n      {{ final_sql }}\n  {% endcall %}\n\n  {% set should_revoke = should_revoke(target_relation_exists, full_refresh_mode=False) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if not target_relation_exists %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {% if staging_table is defined %}\n      {% do post_snapshot(staging_table) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_or_create_relation", "macro.dbt.run_hooks", "macro.dbt.strategy_dispatch", "macro.dbt.build_snapshot_table", "macro.dbt.create_table_as", "macro.dbt.build_snapshot_staging_table", "macro.dbt.create_columns", "macro.dbt.snapshot_merge_sql", "macro.dbt.statement", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt.create_indexes", "macro.dbt.post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1757731}, "macro.dbt.test_unique": {"unique_id": "macro.dbt.test_unique", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "name": "test_unique", "macro_sql": "{% test unique(model, column_name) %}\n    {% set macro = adapter.dispatch('test_unique', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_unique"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1769319}, "macro.dbt.test_not_null": {"unique_id": "macro.dbt.test_not_null", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "name": "test_not_null", "macro_sql": "{% test not_null(model, column_name) %}\n    {% set macro = adapter.dispatch('test_not_null', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_not_null"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1775658}, "macro.dbt.test_accepted_values": {"unique_id": "macro.dbt.test_accepted_values", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "name": "test_accepted_values", "macro_sql": "{% test accepted_values(model, column_name, values, quote=True) %}\n    {% set macro = adapter.dispatch('test_accepted_values', 'dbt') %}\n    {{ macro(model, column_name, values, quote) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_accepted_values"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.178189}, "macro.dbt.test_relationships": {"unique_id": "macro.dbt.test_relationships", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "name": "test_relationships", "macro_sql": "{% test relationships(model, column_name, to, field) %}\n    {% set macro = adapter.dispatch('test_relationships', 'dbt') %}\n    {{ macro(model, column_name, to, field) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_relationships"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1787908}, "macro.dbt_utils.pivot": {"unique_id": "macro.dbt_utils.pivot", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/pivot.sql", "original_file_path": "macros/sql/pivot.sql", "name": "pivot", "macro_sql": "{% macro pivot(column,\n               values,\n               alias=True,\n               agg='sum',\n               cmp='=',\n               prefix='',\n               suffix='',\n               then_value=1,\n               else_value=0,\n               quote_identifiers=True,\n               distinct=False) %}\n    {{ return(adapter.dispatch('pivot', 'dbt_utils')(column, values, alias, agg, cmp, prefix, suffix, then_value, else_value, quote_identifiers, distinct)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__pivot"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1808147}, "macro.dbt_utils.default__pivot": {"unique_id": "macro.dbt_utils.default__pivot", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/pivot.sql", "original_file_path": "macros/sql/pivot.sql", "name": "default__pivot", "macro_sql": "{% macro default__pivot(column,\n               values,\n               alias=True,\n               agg='sum',\n               cmp='=',\n               prefix='',\n               suffix='',\n               then_value=1,\n               else_value=0,\n               quote_identifiers=True,\n               distinct=False) %}\n  {% for value in values %}\n    {{ agg }}(\n      {% if distinct %} distinct {% endif %}\n      case\n      when {{ column }} {{ cmp }} '{{ dbt_utils.escape_single_quotes(value) }}'\n        then {{ then_value }}\n      else {{ else_value }}\n      end\n    )\n    {% if alias %}\n      {% if quote_identifiers %}\n            as {{ adapter.quote(prefix ~ value ~ suffix) }}\n      {% else %}\n        as {{ dbt_utils.slugify(prefix ~ value ~ suffix) }}\n      {% endif %}\n    {% endif %}\n    {% if not loop.last %},{% endif %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.escape_single_quotes", "macro.dbt_utils.slugify"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1827526}, "macro.dbt_utils.star": {"unique_id": "macro.dbt_utils.star", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/star.sql", "original_file_path": "macros/sql/star.sql", "name": "star", "macro_sql": "{% macro star(from, relation_alias=False, except=[], prefix='', suffix='') -%}\n    {{ return(adapter.dispatch('star', 'dbt_utils')(from, relation_alias, except, prefix, suffix)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__star"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1842015}, "macro.dbt_utils.default__star": {"unique_id": "macro.dbt_utils.default__star", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/star.sql", "original_file_path": "macros/sql/star.sql", "name": "default__star", "macro_sql": "{% macro default__star(from, relation_alias=False, except=[], prefix='', suffix='') -%}\n    {%- do dbt_utils._is_relation(from, 'star') -%}\n    {%- do dbt_utils._is_ephemeral(from, 'star') -%}\n\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n    {%- if not execute -%}\n        {{ return('*') }}\n    {%- endif -%}\n\n    {% set cols = dbt_utils.get_filtered_columns_in_relation(from, except) %}\n\n    {%- if cols|length <= 0 -%}\n      {{- return('*') -}}\n    {%- else -%}\n        {%- for col in cols %}\n            {%- if relation_alias %}{{ relation_alias }}.{% else %}{%- endif -%}{{ adapter.quote(col)|trim }} {%- if prefix!='' or suffix!='' %} as {{ adapter.quote(prefix ~ col ~ suffix)|trim }} {%- endif -%}\n            {%- if not loop.last %},{{ '\\n  ' }}{% endif %}\n        {%- endfor -%}\n    {% endif %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.get_filtered_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1863089}, "macro.dbt_utils.get_table_types_sql": {"unique_id": "macro.dbt_utils.get_table_types_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_table_types_sql.sql", "original_file_path": "macros/sql/get_table_types_sql.sql", "name": "get_table_types_sql", "macro_sql": "{%- macro get_table_types_sql() -%}\n  {{ return(adapter.dispatch('get_table_types_sql', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.postgres__get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.187173}, "macro.dbt_utils.default__get_table_types_sql": {"unique_id": "macro.dbt_utils.default__get_table_types_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_table_types_sql.sql", "original_file_path": "macros/sql/get_table_types_sql.sql", "name": "default__get_table_types_sql", "macro_sql": "{% macro default__get_table_types_sql() %}\n            case table_type\n                when 'BASE TABLE' then 'table'\n                when 'EXTERNAL TABLE' then 'external'\n                when 'MATERIALIZED VIEW' then 'materializedview'\n                else lower(table_type)\n            end as {{ adapter.quote('table_type') }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.187571}, "macro.dbt_utils.postgres__get_table_types_sql": {"unique_id": "macro.dbt_utils.postgres__get_table_types_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_table_types_sql.sql", "original_file_path": "macros/sql/get_table_types_sql.sql", "name": "postgres__get_table_types_sql", "macro_sql": "{% macro postgres__get_table_types_sql() %}\n            case table_type\n                when 'BASE TABLE' then 'table'\n                when 'FOREIGN' then 'external'\n                when 'MATERIALIZED VIEW' then 'materializedview'\n                else lower(table_type)\n            end as {{ adapter.quote('table_type') }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1878767}, "macro.dbt_utils.deduplicate": {"unique_id": "macro.dbt_utils.deduplicate", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/deduplicate.sql", "original_file_path": "macros/sql/deduplicate.sql", "name": "deduplicate", "macro_sql": "{%- macro deduplicate(relation, partition_by, order_by=none, relation_alias=none) -%}\n\n    {%- set error_message_group_by -%}\nWarning: the `group_by` parameter of the `deduplicate` macro is no longer supported and will be deprecated in a future release of dbt-utils.\nUse `partition_by` instead.\nThe {{ model.package_name }}.{{ model.name }} model triggered this warning.\n    {%- endset -%}\n\n    {% if kwargs.get('group_by') %}\n    {%- do exceptions.warn(error_message_group_by) -%}\n    {%- endif -%}\n\n    {%- set error_message_order_by -%}\nWarning: `order_by` as an optional parameter of the `deduplicate` macro is no longer supported and will be deprecated in a future release of dbt-utils.\nSupply a non-null value for `order_by` instead.\nThe {{ model.package_name }}.{{ model.name }} model triggered this warning.\n    {%- endset -%}\n\n    {% if not order_by %}\n    {%- do exceptions.warn(error_message_order_by) -%}\n    {%- endif -%}\n\n    {%- set error_message_alias -%}\nWarning: the `relation_alias` parameter of the `deduplicate` macro is no longer supported and will be deprecated in a future release of dbt-utils.\nIf you were using `relation_alias` to point to a CTE previously then you can now pass the alias directly to `relation` instead.\nThe {{ model.package_name }}.{{ model.name }} model triggered this warning.\n    {%- endset -%}\n\n    {% if relation_alias %}\n    {%- do exceptions.warn(error_message_alias) -%}\n    {%- endif -%}\n\n    {% set partition_by = partition_by or kwargs.get('group_by') %}\n    {% set relation = relation_alias or relation %}\n    {% set order_by = order_by or \"'1'\" %}\n\n    {{ return(adapter.dispatch('deduplicate', 'dbt_utils')(relation, partition_by, order_by)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.postgres__deduplicate"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.192445}, "macro.dbt_utils.default__deduplicate": {"unique_id": "macro.dbt_utils.default__deduplicate", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/deduplicate.sql", "original_file_path": "macros/sql/deduplicate.sql", "name": "default__deduplicate", "macro_sql": "\n\n{%- macro default__deduplicate(relation, partition_by, order_by) -%}\n\n    with row_numbered as (\n        select\n            _inner.*,\n            row_number() over (\n                partition by {{ partition_by }}\n                order by {{ order_by }}\n            ) as rn\n        from {{ relation }} as _inner\n    )\n\n    select\n        distinct data.*\n    from {{ relation }} as data\n    {#\n    -- Not all DBs will support natural joins but the ones that do include:\n    -- Oracle, MySQL, SQLite, Redshift, Teradata, Materialize, Databricks\n    -- Apache Spark, SingleStore, Vertica\n    -- Those that do not appear to support natural joins include:\n    -- SQLServer, Trino, Presto, Rockset, Athena\n    #}\n    natural join row_numbered\n    where row_numbered.rn = 1\n\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.192938}, "macro.dbt_utils.redshift__deduplicate": {"unique_id": "macro.dbt_utils.redshift__deduplicate", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/deduplicate.sql", "original_file_path": "macros/sql/deduplicate.sql", "name": "redshift__deduplicate", "macro_sql": "{% macro redshift__deduplicate(relation, partition_by, order_by) -%}\n\n    {{ return(dbt_utils.default__deduplicate(relation, partition_by, order_by=order_by)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__deduplicate"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.193401}, "macro.dbt_utils.postgres__deduplicate": {"unique_id": "macro.dbt_utils.postgres__deduplicate", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/deduplicate.sql", "original_file_path": "macros/sql/deduplicate.sql", "name": "postgres__deduplicate", "macro_sql": "\n{%- macro postgres__deduplicate(relation, partition_by, order_by) -%}\n\n    select\n        distinct on ({{ partition_by }}) *\n    from {{ relation }}\n    order by {{ partition_by }}{{ ',' ~ order_by }}\n\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1938396}, "macro.dbt_utils.snowflake__deduplicate": {"unique_id": "macro.dbt_utils.snowflake__deduplicate", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/deduplicate.sql", "original_file_path": "macros/sql/deduplicate.sql", "name": "snowflake__deduplicate", "macro_sql": "\n{%- macro snowflake__deduplicate(relation, partition_by, order_by) -%}\n\n    select *\n    from {{ relation }}\n    qualify\n        row_number() over (\n            partition by {{ partition_by }}\n            order by {{ order_by }}\n        ) = 1\n\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1942103}, "macro.dbt_utils.bigquery__deduplicate": {"unique_id": "macro.dbt_utils.bigquery__deduplicate", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/deduplicate.sql", "original_file_path": "macros/sql/deduplicate.sql", "name": "bigquery__deduplicate", "macro_sql": "\n{%- macro bigquery__deduplicate(relation, partition_by, order_by) -%}\n\n    select unique.*\n    from (\n        select\n            array_agg (\n                original\n                order by {{ order_by }}\n                limit 1\n            )[offset(0)] unique\n        from {{ relation }} original\n        group by {{ partition_by }}\n    )\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.194587}, "macro.dbt_utils.surrogate_key": {"unique_id": "macro.dbt_utils.surrogate_key", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/surrogate_key.sql", "original_file_path": "macros/sql/surrogate_key.sql", "name": "surrogate_key", "macro_sql": "{%- macro surrogate_key(field_list) -%}\n    {# needed for safe_add to allow for non-keyword arguments see SO post #}\n    {# https://stackoverflow.com/questions/13944751/args-kwargs-in-jinja2-macros #}\n    {% set frustrating_jinja_feature = varargs %}\n    {{ return(adapter.dispatch('surrogate_key', 'dbt_utils')(field_list, *varargs)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__surrogate_key"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1958375}, "macro.dbt_utils.default__surrogate_key": {"unique_id": "macro.dbt_utils.default__surrogate_key", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/surrogate_key.sql", "original_file_path": "macros/sql/surrogate_key.sql", "name": "default__surrogate_key", "macro_sql": "\n\n{%- macro default__surrogate_key(field_list) -%}\n\n{%- if varargs|length >= 1 or field_list is string %}\n\n{%- set error_message = '\nWarning: the `surrogate_key` macro now takes a single list argument instead of \\\nmultiple string arguments. Support for multiple string arguments will be \\\ndeprecated in a future release of dbt-utils. The {}.{} model triggered this warning. \\\n'.format(model.package_name, model.name) -%}\n\n{%- do exceptions.warn(error_message) -%}\n\n{# first argument is not included in varargs, so add first element to field_list_xf #}\n{%- set field_list_xf = [field_list] -%}\n\n{%- for field in varargs %}\n{%- set _ = field_list_xf.append(field) -%}\n{%- endfor -%}\n\n{%- else -%}\n\n{# if using list, just set field_list_xf as field_list #}\n{%- set field_list_xf = field_list -%}\n\n{%- endif -%}\n\n\n{%- set fields = [] -%}\n\n{%- for field in field_list_xf -%}\n\n    {%- set _ = fields.append(\n        \"coalesce(cast(\" ~ field ~ \" as \" ~ type_string() ~ \"), '')\"\n    ) -%}\n\n    {%- if not loop.last %}\n        {%- set _ = fields.append(\"'-'\") -%}\n    {%- endif -%}\n\n{%- endfor -%}\n\n{{ hash(concat(fields)) }}\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string", "macro.dbt_utils.hash", "macro.dbt_utils.concat"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1984038}, "macro.dbt_utils.get_query_results_as_dict": {"unique_id": "macro.dbt_utils.get_query_results_as_dict", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_query_results_as_dict.sql", "original_file_path": "macros/sql/get_query_results_as_dict.sql", "name": "get_query_results_as_dict", "macro_sql": "{% macro get_query_results_as_dict(query) %}\n    {{ return(adapter.dispatch('get_query_results_as_dict', 'dbt_utils')(query)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_query_results_as_dict"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.1993}, "macro.dbt_utils.default__get_query_results_as_dict": {"unique_id": "macro.dbt_utils.default__get_query_results_as_dict", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_query_results_as_dict.sql", "original_file_path": "macros/sql/get_query_results_as_dict.sql", "name": "default__get_query_results_as_dict", "macro_sql": "{% macro default__get_query_results_as_dict(query) %}\n\n{# This macro returns a dictionary of the form {column_name: (tuple_of_results)} #}\n\n    {%- call statement('get_query_results', fetch_result=True,auto_begin=false) -%}\n\n        {{ query }}\n\n    {%- endcall -%}\n\n    {% set sql_results={} %}\n\n    {%- if execute -%}\n        {% set sql_results_table = load_result('get_query_results').table.columns %}\n        {% for column_name, column in sql_results_table.items() %}\n            {% do sql_results.update({column_name: column.values()}) %}\n        {% endfor %}\n    {%- endif -%}\n\n    {{ return(sql_results) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2005637}, "macro.dbt_utils.get_intervals_between": {"unique_id": "macro.dbt_utils.get_intervals_between", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/date_spine.sql", "original_file_path": "macros/sql/date_spine.sql", "name": "get_intervals_between", "macro_sql": "{% macro get_intervals_between(start_date, end_date, datepart) -%}\n    {{ return(adapter.dispatch('get_intervals_between', 'dbt_utils')(start_date, end_date, datepart)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_intervals_between"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2019675}, "macro.dbt_utils.default__get_intervals_between": {"unique_id": "macro.dbt_utils.default__get_intervals_between", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/date_spine.sql", "original_file_path": "macros/sql/date_spine.sql", "name": "default__get_intervals_between", "macro_sql": "{% macro default__get_intervals_between(start_date, end_date, datepart) -%}\n    {%- call statement('get_intervals_between', fetch_result=True) %}\n\n        select {{ datediff(start_date, end_date, datepart) }}\n\n    {%- endcall -%}\n\n    {%- set value_list = load_result('get_intervals_between') -%}\n\n    {%- if value_list and value_list['data'] -%}\n        {%- set values = value_list['data'] | map(attribute=0) | list %}\n        {{ return(values[0]) }}\n    {%- else -%}\n        {{ return(1) }}\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2033103}, "macro.dbt_utils.date_spine": {"unique_id": "macro.dbt_utils.date_spine", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/date_spine.sql", "original_file_path": "macros/sql/date_spine.sql", "name": "date_spine", "macro_sql": "{% macro date_spine(datepart, start_date, end_date) %}\n    {{ return(adapter.dispatch('date_spine', 'dbt_utils')(datepart, start_date, end_date)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__date_spine"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2038183}, "macro.dbt_utils.default__date_spine": {"unique_id": "macro.dbt_utils.default__date_spine", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/date_spine.sql", "original_file_path": "macros/sql/date_spine.sql", "name": "default__date_spine", "macro_sql": "{% macro default__date_spine(datepart, start_date, end_date) %}\n\n\n{# call as follows:\n\ndate_spine(\n    \"day\",\n    \"to_date('01/01/2016', 'mm/dd/yyyy')\",\n    \"dateadd(week, 1, current_date)\"\n) #}\n\n\nwith rawdata as (\n\n    {{dbt_utils.generate_series(\n        dbt_utils.get_intervals_between(start_date, end_date, datepart)\n    )}}\n\n),\n\nall_periods as (\n\n    select (\n        {{\n            dateadd(\n                datepart,\n                \"row_number() over (order by 1) - 1\",\n                start_date\n            )\n        }}\n    ) as date_{{datepart}}\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_{{datepart}} <= {{ end_date }}\n\n)\n\nselect * from filtered\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.generate_series", "macro.dbt_utils.get_intervals_between", "macro.dbt_utils.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2045784}, "macro.dbt_utils.get_column_values": {"unique_id": "macro.dbt_utils.get_column_values", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_column_values.sql", "original_file_path": "macros/sql/get_column_values.sql", "name": "get_column_values", "macro_sql": "{% macro get_column_values(table, column, order_by='count(*) desc', max_records=none, default=none, where=none) -%}\n    {{ return(adapter.dispatch('get_column_values', 'dbt_utils')(table, column, order_by, max_records, default, where)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_column_values"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.206663}, "macro.dbt_utils.default__get_column_values": {"unique_id": "macro.dbt_utils.default__get_column_values", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_column_values.sql", "original_file_path": "macros/sql/get_column_values.sql", "name": "default__get_column_values", "macro_sql": "{% macro default__get_column_values(table, column, order_by='count(*) desc', max_records=none, default=none, where=none) -%}\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n    {%- if not execute -%}\n        {% set default = [] if not default %}\n        {{ return(default) }}\n    {% endif %}\n\n    {%- do dbt_utils._is_ephemeral(table, 'get_column_values') -%}\n\n    {# Not all relations are tables. Renaming for internal clarity without breaking functionality for anyone using named arguments #}\n    {# TODO: Change the method signature in a future 0.x.0 release #}\n    {%- set target_relation = table -%}\n\n    {# adapter.load_relation is a convenience wrapper to avoid building a Relation when we already have one #}\n    {% set relation_exists = (load_relation(target_relation)) is not none %}\n\n    {%- call statement('get_column_values', fetch_result=true) %}\n\n        {%- if not relation_exists and default is none -%}\n\n          {{ exceptions.raise_compiler_error(\"In get_column_values(): relation \" ~ target_relation ~ \" does not exist and no default value was provided.\") }}\n\n        {%- elif not relation_exists and default is not none -%}\n\n          {{ log(\"Relation \" ~ target_relation ~ \" does not exist. Returning the default value: \" ~ default) }}\n\n          {{ return(default) }}\n\n        {%- else -%}\n\n\n            select\n                {{ column }} as value\n\n            from {{ target_relation }}\n\n            {% if where is not none %}\n            where {{ where }}\n            {% endif %}\n\n            group by {{ column }}\n            order by {{ order_by }}\n\n            {% if max_records is not none %}\n            limit {{ max_records }}\n            {% endif %}\n\n        {% endif %}\n\n    {%- endcall -%}\n\n    {%- set value_list = load_result('get_column_values') -%}\n\n    {%- if value_list and value_list['data'] -%}\n        {%- set values = value_list['data'] | map(attribute=0) | list %}\n        {{ return(values) }}\n    {%- else -%}\n        {{ return(default) }}\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_ephemeral", "macro.dbt.load_relation", "macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2100358}, "macro.dbt_utils.group_by": {"unique_id": "macro.dbt_utils.group_by", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/groupby.sql", "original_file_path": "macros/sql/groupby.sql", "name": "group_by", "macro_sql": "{%- macro group_by(n) -%}\n    {{ return(adapter.dispatch('group_by', 'dbt_utils')(n)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__group_by"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.210781}, "macro.dbt_utils.default__group_by": {"unique_id": "macro.dbt_utils.default__group_by", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/groupby.sql", "original_file_path": "macros/sql/groupby.sql", "name": "default__group_by", "macro_sql": "\n\n{%- macro default__group_by(n) -%}\n\n  group by {% for i in range(1, n + 1) -%}\n      {{ i }}{{ ',' if not loop.last }}   \n   {%- endfor -%}\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2113237}, "macro.dbt_utils.get_tables_by_pattern_sql": {"unique_id": "macro.dbt_utils.get_tables_by_pattern_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_tables_by_pattern_sql.sql", "original_file_path": "macros/sql/get_tables_by_pattern_sql.sql", "name": "get_tables_by_pattern_sql", "macro_sql": "{% macro get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_tables_by_pattern_sql', 'dbt_utils')\n        (schema_pattern, table_pattern, exclude, database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2142467}, "macro.dbt_utils.default__get_tables_by_pattern_sql": {"unique_id": "macro.dbt_utils.default__get_tables_by_pattern_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_tables_by_pattern_sql.sql", "original_file_path": "macros/sql/get_tables_by_pattern_sql.sql", "name": "default__get_tables_by_pattern_sql", "macro_sql": "{% macro default__get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\n\n        select distinct\n            table_schema as {{ adapter.quote('table_schema') }},\n            table_name as {{ adapter.quote('table_name') }},\n            {{ dbt_utils.get_table_types_sql() }}\n        from {{ database }}.information_schema.tables\n        where table_schema ilike '{{ schema_pattern }}'\n        and table_name ilike '{{ table_pattern }}'\n        and table_name not ilike '{{ exclude }}'\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2150373}, "macro.dbt_utils.bigquery__get_tables_by_pattern_sql": {"unique_id": "macro.dbt_utils.bigquery__get_tables_by_pattern_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_tables_by_pattern_sql.sql", "original_file_path": "macros/sql/get_tables_by_pattern_sql.sql", "name": "bigquery__get_tables_by_pattern_sql", "macro_sql": "{% macro bigquery__get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\n\n    {% if '%' in schema_pattern %}\n        {% set schemata=dbt_utils._bigquery__get_matching_schemata(schema_pattern, database) %}\n    {% else %}\n        {% set schemata=[schema_pattern] %}\n    {% endif %}\n\n    {% set sql %}\n        {% for schema in schemata %}\n            select distinct\n                table_schema,\n                table_name,\n                {{ dbt_utils.get_table_types_sql() }}\n\n            from {{ adapter.quote(database) }}.{{ schema }}.INFORMATION_SCHEMA.TABLES\n            where lower(table_name) like lower ('{{ table_pattern }}')\n                and lower(table_name) not like lower ('{{ exclude }}')\n\n            {% if not loop.last %} union all {% endif %}\n\n        {% endfor %}\n    {% endset %}\n\n    {{ return(sql) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._bigquery__get_matching_schemata", "macro.dbt_utils.get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.216589}, "macro.dbt_utils._bigquery__get_matching_schemata": {"unique_id": "macro.dbt_utils._bigquery__get_matching_schemata", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_tables_by_pattern_sql.sql", "original_file_path": "macros/sql/get_tables_by_pattern_sql.sql", "name": "_bigquery__get_matching_schemata", "macro_sql": "{% macro _bigquery__get_matching_schemata(schema_pattern, database) %}\n    {% if execute %}\n\n        {% set sql %}\n        select schema_name from {{ adapter.quote(database) }}.INFORMATION_SCHEMA.SCHEMATA\n        where lower(schema_name) like lower('{{ schema_pattern }}')\n        {% endset %}\n\n        {% set results=run_query(sql) %}\n\n        {% set schemata=results.columns['schema_name'].values() %}\n\n        {{ return(schemata) }}\n\n    {% else %}\n\n        {{ return([]) }}\n\n    {% endif %}\n\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2177207}, "macro.dbt_utils.nullcheck_table": {"unique_id": "macro.dbt_utils.nullcheck_table", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/nullcheck_table.sql", "original_file_path": "macros/sql/nullcheck_table.sql", "name": "nullcheck_table", "macro_sql": "{% macro nullcheck_table(relation) %}\n    {{ return(adapter.dispatch('nullcheck_table', 'dbt_utils')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__nullcheck_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2185807}, "macro.dbt_utils.default__nullcheck_table": {"unique_id": "macro.dbt_utils.default__nullcheck_table", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/nullcheck_table.sql", "original_file_path": "macros/sql/nullcheck_table.sql", "name": "default__nullcheck_table", "macro_sql": "{% macro default__nullcheck_table(relation) %}\n\n  {%- do dbt_utils._is_relation(relation, 'nullcheck_table') -%}\n  {%- do dbt_utils._is_ephemeral(relation, 'nullcheck_table') -%}\n  {% set cols = adapter.get_columns_in_relation(relation) %}\n\n  select {{ dbt_utils.nullcheck(cols) }}\n  from {{relation}}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.nullcheck"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.21933}, "macro.dbt_utils.get_tables_by_prefix_sql": {"unique_id": "macro.dbt_utils.get_tables_by_prefix_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_tables_by_prefix_sql.sql", "original_file_path": "macros/sql/get_tables_by_prefix_sql.sql", "name": "get_tables_by_prefix_sql", "macro_sql": "{% macro get_tables_by_prefix_sql(schema, prefix, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_tables_by_prefix_sql', 'dbt_utils')(schema, prefix, exclude, database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_tables_by_prefix_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2202792}, "macro.dbt_utils.default__get_tables_by_prefix_sql": {"unique_id": "macro.dbt_utils.default__get_tables_by_prefix_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_tables_by_prefix_sql.sql", "original_file_path": "macros/sql/get_tables_by_prefix_sql.sql", "name": "default__get_tables_by_prefix_sql", "macro_sql": "{% macro default__get_tables_by_prefix_sql(schema, prefix, exclude='', database=target.database) %}\n\n    {{ dbt_utils.get_tables_by_pattern_sql(\n        schema_pattern = schema,\n        table_pattern = prefix ~ '%',\n        exclude = exclude,\n        database = database\n    ) }}\n    \n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2208884}, "macro.dbt_utils.get_relations_by_pattern": {"unique_id": "macro.dbt_utils.get_relations_by_pattern", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_relations_by_pattern.sql", "original_file_path": "macros/sql/get_relations_by_pattern.sql", "name": "get_relations_by_pattern", "macro_sql": "{% macro get_relations_by_pattern(schema_pattern, table_pattern, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_relations_by_pattern', 'dbt_utils')(schema_pattern, table_pattern, exclude, database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_relations_by_pattern"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2223065}, "macro.dbt_utils.default__get_relations_by_pattern": {"unique_id": "macro.dbt_utils.default__get_relations_by_pattern", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_relations_by_pattern.sql", "original_file_path": "macros/sql/get_relations_by_pattern.sql", "name": "default__get_relations_by_pattern", "macro_sql": "{% macro default__get_relations_by_pattern(schema_pattern, table_pattern, exclude='', database=target.database) %}\n\n    {%- call statement('get_tables', fetch_result=True) %}\n\n      {{ dbt_utils.get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude, database) }}\n\n    {%- endcall -%}\n\n    {%- set table_list = load_result('get_tables') -%}\n\n    {%- if table_list and table_list['table'] -%}\n        {%- set tbl_relations = [] -%}\n        {%- for row in table_list['table'] -%}\n            {%- set tbl_relation = api.Relation.create(\n                database=database,\n                schema=row.table_schema,\n                identifier=row.table_name,\n                type=row.table_type\n            ) -%}\n            {%- do tbl_relations.append(tbl_relation) -%}\n        {%- endfor -%}\n\n        {{ return(tbl_relations) }}\n    {%- else -%}\n        {{ return([]) }}\n    {%- endif -%}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.224369}, "macro.dbt_utils.get_relations_by_prefix": {"unique_id": "macro.dbt_utils.get_relations_by_prefix", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_relations_by_prefix.sql", "original_file_path": "macros/sql/get_relations_by_prefix.sql", "name": "get_relations_by_prefix", "macro_sql": "{% macro get_relations_by_prefix(schema, prefix, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_relations_by_prefix', 'dbt_utils')(schema, prefix, exclude, database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_relations_by_prefix"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.22577}, "macro.dbt_utils.default__get_relations_by_prefix": {"unique_id": "macro.dbt_utils.default__get_relations_by_prefix", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_relations_by_prefix.sql", "original_file_path": "macros/sql/get_relations_by_prefix.sql", "name": "default__get_relations_by_prefix", "macro_sql": "{% macro default__get_relations_by_prefix(schema, prefix, exclude='', database=target.database) %}\n\n    {%- call statement('get_tables', fetch_result=True) %}\n\n      {{ dbt_utils.get_tables_by_prefix_sql(schema, prefix, exclude, database) }}\n\n    {%- endcall -%}\n\n    {%- set table_list = load_result('get_tables') -%}\n\n    {%- if table_list and table_list['table'] -%}\n        {%- set tbl_relations = [] -%}\n        {%- for row in table_list['table'] -%}\n            {%- set tbl_relation = api.Relation.create(\n                database=database,\n                schema=row.table_schema,\n                identifier=row.table_name,\n                type=row.table_type\n            ) -%}\n            {%- do tbl_relations.append(tbl_relation) -%}\n        {%- endfor -%}\n\n        {{ return(tbl_relations) }}\n    {%- else -%}\n        {{ return([]) }}\n    {%- endif -%}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.get_tables_by_prefix_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.227597}, "macro.dbt_utils.safe_add": {"unique_id": "macro.dbt_utils.safe_add", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/safe_add.sql", "original_file_path": "macros/sql/safe_add.sql", "name": "safe_add", "macro_sql": "{%- macro safe_add() -%}\n    {# needed for safe_add to allow for non-keyword arguments see SO post #}\n    {# https://stackoverflow.com/questions/13944751/args-kwargs-in-jinja2-macros #}\n    {% set frustrating_jinja_feature = varargs %}\n    {{ return(adapter.dispatch('safe_add', 'dbt_utils')(*varargs)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__safe_add"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2285266}, "macro.dbt_utils.default__safe_add": {"unique_id": "macro.dbt_utils.default__safe_add", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/safe_add.sql", "original_file_path": "macros/sql/safe_add.sql", "name": "default__safe_add", "macro_sql": "\n\n{%- macro default__safe_add() -%}\n\n{% set fields = [] %}\n\n{%- for field in varargs -%}\n\n    {% do fields.append(\"coalesce(\" ~ field ~ \", 0)\") %}\n\n{%- endfor -%}\n\n{{ fields|join(' +\\n  ') }}\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2292957}, "macro.dbt_utils.degrees_to_radians": {"unique_id": "macro.dbt_utils.degrees_to_radians", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/haversine_distance.sql", "original_file_path": "macros/sql/haversine_distance.sql", "name": "degrees_to_radians", "macro_sql": "{% macro degrees_to_radians(degrees) -%}\n    acos(-1) * {{degrees}} / 180\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.231223}, "macro.dbt_utils.haversine_distance": {"unique_id": "macro.dbt_utils.haversine_distance", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/haversine_distance.sql", "original_file_path": "macros/sql/haversine_distance.sql", "name": "haversine_distance", "macro_sql": "{% macro haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\n    {{ return(adapter.dispatch('haversine_distance', 'dbt_utils')(lat1,lon1,lat2,lon2,unit)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__haversine_distance"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2318892}, "macro.dbt_utils.default__haversine_distance": {"unique_id": "macro.dbt_utils.default__haversine_distance", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/haversine_distance.sql", "original_file_path": "macros/sql/haversine_distance.sql", "name": "default__haversine_distance", "macro_sql": "{% macro default__haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\n{%- if unit == 'mi' %}\n    {% set conversion_rate = 1 %}\n{% elif unit == 'km' %}\n    {% set conversion_rate = 1.60934 %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\"unit input must be one of 'mi' or 'km'. Got \" ~ unit) }}\n{% endif %}\n\n    2 * 3961 * asin(sqrt(power((sin(radians(({{ lat2 }} - {{ lat1 }}) / 2))), 2) +\n    cos(radians({{lat1}})) * cos(radians({{lat2}})) *\n    power((sin(radians(({{ lon2 }} - {{ lon1 }}) / 2))), 2))) * {{ conversion_rate }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2331254}, "macro.dbt_utils.bigquery__haversine_distance": {"unique_id": "macro.dbt_utils.bigquery__haversine_distance", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/haversine_distance.sql", "original_file_path": "macros/sql/haversine_distance.sql", "name": "bigquery__haversine_distance", "macro_sql": "{% macro bigquery__haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\n{% set radians_lat1 = dbt_utils.degrees_to_radians(lat1) %}\n{% set radians_lat2 = dbt_utils.degrees_to_radians(lat2) %}\n{% set radians_lon1 = dbt_utils.degrees_to_radians(lon1) %}\n{% set radians_lon2 = dbt_utils.degrees_to_radians(lon2) %}\n{%- if unit == 'mi' %}\n    {% set conversion_rate = 1 %}\n{% elif unit == 'km' %}\n    {% set conversion_rate = 1.60934 %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\"unit input must be one of 'mi' or 'km'. Got \" ~ unit) }}\n{% endif %}\n    2 * 3961 * asin(sqrt(power(sin(({{ radians_lat2 }} - {{ radians_lat1 }}) / 2), 2) +\n    cos({{ radians_lat1 }}) * cos({{ radians_lat2 }}) *\n    power(sin(({{ radians_lon2 }} - {{ radians_lon1 }}) / 2), 2))) * {{ conversion_rate }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.degrees_to_radians"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.234991}, "macro.dbt_utils.unpivot": {"unique_id": "macro.dbt_utils.unpivot", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/unpivot.sql", "original_file_path": "macros/sql/unpivot.sql", "name": "unpivot", "macro_sql": "{% macro unpivot(relation=none, cast_to='varchar', exclude=none, remove=none, field_name='field_name', value_name='value', table=none) -%}\n    {{ return(adapter.dispatch('unpivot', 'dbt_utils')(relation, cast_to, exclude, remove, field_name, value_name, table)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__unpivot"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2380652}, "macro.dbt_utils.default__unpivot": {"unique_id": "macro.dbt_utils.default__unpivot", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/unpivot.sql", "original_file_path": "macros/sql/unpivot.sql", "name": "default__unpivot", "macro_sql": "{% macro default__unpivot(relation=none, cast_to='varchar', exclude=none, remove=none, field_name='field_name', value_name='value', table=none) -%}\n\n    {% if table %}\n        {%- set error_message = '\n            Warning: the `unpivot` macro no longer accepts a `table` parameter. \\\n            This parameter will be deprecated in a future release of dbt-utils. Use the `relation` parameter instead. \\\n            The {}.{} model triggered this warning. \\\n            '.format(model.package_name, model.name) -%}\n        {%- do exceptions.warn(error_message) -%}\n    {% endif %}\n\n    {% if relation and table %}\n        {{ exceptions.raise_compiler_error(\"Error: both the `relation` and `table` parameters were provided to `unpivot` macro. Choose one only (we recommend `relation`).\") }}\n    {% elif not relation and table %}\n        {% set relation=table %}\n    {% elif not relation and not table %}\n        {{ exceptions.raise_compiler_error(\"Error: argument `relation` is required for `unpivot` macro.\") }}\n    {% endif %}\n\n  {%- set exclude = exclude if exclude is not none else [] %}\n  {%- set remove = remove if remove is not none else [] %}\n\n  {%- set include_cols = [] %}\n\n  {%- set table_columns = {} %}\n\n  {%- do table_columns.update({relation: []}) %}\n\n  {%- do dbt_utils._is_relation(relation, 'unpivot') -%}\n  {%- do dbt_utils._is_ephemeral(relation, 'unpivot') -%}\n  {%- set cols = adapter.get_columns_in_relation(relation) %}\n\n  {%- for col in cols -%}\n    {%- if col.column.lower() not in remove|map('lower') and col.column.lower() not in exclude|map('lower') -%}\n      {% do include_cols.append(col) %}\n    {%- endif %}\n  {%- endfor %}\n\n\n  {%- for col in include_cols -%}\n    select\n      {%- for exclude_col in exclude %}\n        {{ exclude_col }},\n      {%- endfor %}\n\n      cast('{{ col.column }}' as {{ type_string() }}) as {{ field_name }},\n      cast(  {% if col.data_type == 'boolean' %}\n           {{ cast_bool_to_text(col.column) }}\n             {% else %}\n           {{ col.column }}\n             {% endif %}\n           as {{ cast_to }}) as {{ value_name }}\n\n    from {{ relation }}\n\n    {% if not loop.last -%}\n      union all\n    {% endif -%}\n  {%- endfor -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.type_string", "macro.dbt_utils.cast_bool_to_text"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2428534}, "macro.dbt_utils.get_powers_of_two": {"unique_id": "macro.dbt_utils.get_powers_of_two", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/generate_series.sql", "original_file_path": "macros/sql/generate_series.sql", "name": "get_powers_of_two", "macro_sql": "{% macro get_powers_of_two(upper_bound) %}\n    {{ return(adapter.dispatch('get_powers_of_two', 'dbt_utils')(upper_bound)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2445261}, "macro.dbt_utils.default__get_powers_of_two": {"unique_id": "macro.dbt_utils.default__get_powers_of_two", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/generate_series.sql", "original_file_path": "macros/sql/generate_series.sql", "name": "default__get_powers_of_two", "macro_sql": "{% macro default__get_powers_of_two(upper_bound) %}\n\n    {% if upper_bound <= 0 %}\n    {{ exceptions.raise_compiler_error(\"upper bound must be positive\") }}\n    {% endif %}\n\n    {% for _ in range(1, 100) %}\n       {% if upper_bound <= 2 ** loop.index %}{{ return(loop.index) }}{% endif %}\n    {% endfor %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.245473}, "macro.dbt_utils.generate_series": {"unique_id": "macro.dbt_utils.generate_series", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/generate_series.sql", "original_file_path": "macros/sql/generate_series.sql", "name": "generate_series", "macro_sql": "{% macro generate_series(upper_bound) %}\n    {{ return(adapter.dispatch('generate_series', 'dbt_utils')(upper_bound)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__generate_series"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2458987}, "macro.dbt_utils.default__generate_series": {"unique_id": "macro.dbt_utils.default__generate_series", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/generate_series.sql", "original_file_path": "macros/sql/generate_series.sql", "name": "default__generate_series", "macro_sql": "{% macro default__generate_series(upper_bound) %}\n\n    {% set n = dbt_utils.get_powers_of_two(upper_bound) %}\n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    {% for i in range(n) %}\n    p{{i}}.generated_number * power(2, {{i}})\n    {% if not loop.last %} + {% endif %}\n    {% endfor %}\n    + 1\n    as generated_number\n\n    from\n\n    {% for i in range(n) %}\n    p as p{{i}}\n    {% if not loop.last %} cross join {% endif %}\n    {% endfor %}\n\n    )\n\n    select *\n    from unioned\n    where generated_number <= {{upper_bound}}\n    order by generated_number\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2470295}, "macro.dbt_utils.width_bucket": {"unique_id": "macro.dbt_utils.width_bucket", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/width_bucket.sql", "original_file_path": "macros/sql/width_bucket.sql", "name": "width_bucket", "macro_sql": "{% macro width_bucket(expr, min_value, max_value, num_buckets) %}\n  {{ return(adapter.dispatch('width_bucket', 'dbt_utils') (expr, min_value, max_value, num_buckets)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__width_bucket"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2495282}, "macro.dbt_utils.default__width_bucket": {"unique_id": "macro.dbt_utils.default__width_bucket", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/width_bucket.sql", "original_file_path": "macros/sql/width_bucket.sql", "name": "default__width_bucket", "macro_sql": "{% macro default__width_bucket(expr, min_value, max_value, num_buckets) -%}\n\n    {% set bin_size -%}\n    (( {{ max_value }} - {{ min_value }} ) / {{ num_buckets }} )\n    {%- endset %}\n    (\n        -- to break ties when the amount is eaxtly at the bucket egde\n        case\n            when\n                mod(\n                    {{ dbt.safe_cast(expr, type_numeric() ) }},\n                    {{ dbt.safe_cast(bin_size, type_numeric() ) }}\n                ) = 0\n            then 1\n            else 0\n        end\n    ) +\n      -- Anything over max_value goes the N+1 bucket\n    least(\n        ceil(\n            ({{ expr }} - {{ min_value }})/{{ bin_size }}\n        ),\n        {{ num_buckets }} + 1\n    )\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.safe_cast", "macro.dbt_utils.type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2505026}, "macro.dbt_utils.redshift__width_bucket": {"unique_id": "macro.dbt_utils.redshift__width_bucket", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/width_bucket.sql", "original_file_path": "macros/sql/width_bucket.sql", "name": "redshift__width_bucket", "macro_sql": "{% macro redshift__width_bucket(expr, min_value, max_value, num_buckets) -%}\n\n    {% set bin_size -%}\n    (( {{ max_value }} - {{ min_value }} ) / {{ num_buckets }} )\n    {%- endset %}\n    (\n        -- to break ties when the amount is exactly at the bucket edge\n        case\n            when\n                {{ dbt.safe_cast(expr, type_numeric() ) }} %\n                {{ dbt.safe_cast(bin_size, type_numeric() ) }}\n                 = 0\n            then 1\n            else 0\n        end\n    ) +\n      -- Anything over max_value goes the N+1 bucket\n    least(\n        ceil(\n            ({{ expr }} - {{ min_value }})/{{ bin_size }}\n        ),\n        {{ num_buckets }} + 1\n    )\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.safe_cast", "macro.dbt_utils.type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2514663}, "macro.dbt_utils.snowflake__width_bucket": {"unique_id": "macro.dbt_utils.snowflake__width_bucket", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/width_bucket.sql", "original_file_path": "macros/sql/width_bucket.sql", "name": "snowflake__width_bucket", "macro_sql": "{% macro snowflake__width_bucket(expr, min_value, max_value, num_buckets) %}\n    width_bucket({{ expr }}, {{ min_value }}, {{ max_value }}, {{ num_buckets }} )\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2518878}, "macro.dbt_utils.nullcheck": {"unique_id": "macro.dbt_utils.nullcheck", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/nullcheck.sql", "original_file_path": "macros/sql/nullcheck.sql", "name": "nullcheck", "macro_sql": "{% macro nullcheck(cols) %}\n    {{ return(adapter.dispatch('nullcheck', 'dbt_utils')(cols)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__nullcheck"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2526932}, "macro.dbt_utils.default__nullcheck": {"unique_id": "macro.dbt_utils.default__nullcheck", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/nullcheck.sql", "original_file_path": "macros/sql/nullcheck.sql", "name": "default__nullcheck", "macro_sql": "{% macro default__nullcheck(cols) %}\n{%- for col in cols %}\n\n    {% if col.is_string() -%}\n\n    nullif({{col.name}},'') as {{col.name}}\n\n    {%- else -%}\n\n    {{col.name}}\n\n    {%- endif -%}\n\n{%- if not loop.last -%} , {%- endif -%}\n\n{%- endfor -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2534842}, "macro.dbt_utils.union_relations": {"unique_id": "macro.dbt_utils.union_relations", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/union.sql", "original_file_path": "macros/sql/union.sql", "name": "union_relations", "macro_sql": "{%- macro union_relations(relations, column_override=none, include=[], exclude=[], source_column_name='_dbt_source_relation', where=none) -%}\n    {{ return(adapter.dispatch('union_relations', 'dbt_utils')(relations, column_override, include, exclude, source_column_name, where)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__union_relations"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.2580593}, "macro.dbt_utils.default__union_relations": {"unique_id": "macro.dbt_utils.default__union_relations", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/union.sql", "original_file_path": "macros/sql/union.sql", "name": "default__union_relations", "macro_sql": "\n\n{%- macro default__union_relations(relations, column_override=none, include=[], exclude=[], source_column_name='_dbt_source_relation', where=none) -%}\n\n    {%- if exclude and include -%}\n        {{ exceptions.raise_compiler_error(\"Both an exclude and include list were provided to the `union` macro. Only one is allowed\") }}\n    {%- endif -%}\n\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. -#}\n    {%- if not execute %}\n        {{ return('') }}\n    {% endif -%}\n\n    {%- set column_override = column_override if column_override is not none else {} -%}\n\n    {%- set relation_columns = {} -%}\n    {%- set column_superset = {} -%}\n\n    {%- for relation in relations -%}\n\n        {%- do relation_columns.update({relation: []}) -%}\n\n        {%- do dbt_utils._is_relation(relation, 'union_relations') -%}\n        {%- do dbt_utils._is_ephemeral(relation, 'union_relations') -%}\n        {%- set cols = adapter.get_columns_in_relation(relation) -%}\n        {%- for col in cols -%}\n\n        {#- If an exclude list was provided and the column is in the list, do nothing -#}\n        {%- if exclude and col.column in exclude -%}\n\n        {#- If an include list was provided and the column is not in the list, do nothing -#}\n        {%- elif include and col.column not in include -%}\n\n        {#- Otherwise add the column to the column superset -#}\n        {%- else -%}\n\n            {#- update the list of columns in this relation -#}\n            {%- do relation_columns[relation].append(col.column) -%}\n\n            {%- if col.column in column_superset -%}\n\n                {%- set stored = column_superset[col.column] -%}\n                {%- if col.is_string() and stored.is_string() and col.string_size() > stored.string_size() -%}\n\n                    {%- do column_superset.update({col.column: col}) -%}\n\n                {%- endif %}\n\n            {%- else -%}\n\n                {%- do column_superset.update({col.column: col}) -%}\n\n            {%- endif -%}\n\n        {%- endif -%}\n\n        {%- endfor -%}\n    {%- endfor -%}\n\n    {%- set ordered_column_names = column_superset.keys() -%}\n    {%- set dbt_command = flags.WHICH -%}\n\n\n    {% if dbt_command in ['run', 'build'] %}\n    {% if (include | length > 0 or exclude | length > 0) and not column_superset.keys() %}\n        {%- set relations_string -%}\n            {%- for relation in relations -%}\n                {{ relation.name }}\n            {%- if not loop.last %}, {% endif -%}\n            {%- endfor -%}\n        {%- endset -%}\n\n        {%- set error_message -%}\n            There were no columns found to union for relations {{ relations_string }}\n        {%- endset -%}\n\n        {{ exceptions.raise_compiler_error(error_message) }}\n    {%- endif -%}\n    {%- endif -%}\n\n    {%- for relation in relations %}\n\n        (\n            select\n\n                {%- if source_column_name is not none %}\n                cast({{ string_literal(relation) }} as {{ type_string() }}) as {{ source_column_name }},\n                {%- endif %}\n\n                {% for col_name in ordered_column_names -%}\n\n                    {%- set col = column_superset[col_name] %}\n                    {%- set col_type = column_override.get(col.column, col.data_type) %}\n                    {%- set col_name = adapter.quote(col_name) if col_name in relation_columns[relation] else 'null' %}\n                    cast({{ col_name }} as {{ col_type }}) as {{ col.quoted }} {% if not loop.last %},{% endif -%}\n\n                {%- endfor %}\n\n            from {{ relation }}\n\n            {% if where -%}\n            where {{ where }}\n            {%- endif %}\n        )\n\n        {% if not loop.last -%}\n            union all\n        {% endif -%}\n\n    {%- endfor -%}\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.string_literal", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3047898}, "macro.dbt_utils.get_filtered_columns_in_relation": {"unique_id": "macro.dbt_utils.get_filtered_columns_in_relation", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_filtered_columns_in_relation.sql", "original_file_path": "macros/sql/get_filtered_columns_in_relation.sql", "name": "get_filtered_columns_in_relation", "macro_sql": "{% macro get_filtered_columns_in_relation(from, except=[]) -%}\n    {{ return(adapter.dispatch('get_filtered_columns_in_relation', 'dbt_utils')(from, except)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_filtered_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3061252}, "macro.dbt_utils.default__get_filtered_columns_in_relation": {"unique_id": "macro.dbt_utils.default__get_filtered_columns_in_relation", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/sql/get_filtered_columns_in_relation.sql", "original_file_path": "macros/sql/get_filtered_columns_in_relation.sql", "name": "default__get_filtered_columns_in_relation", "macro_sql": "{% macro default__get_filtered_columns_in_relation(from, except=[]) -%}\n    {%- do dbt_utils._is_relation(from, 'get_filtered_columns_in_relation') -%}\n    {%- do dbt_utils._is_ephemeral(from, 'get_filtered_columns_in_relation') -%}\n\n    {# -- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n    {%- if not execute -%}\n        {{ return('') }}\n    {% endif %}\n\n    {%- set include_cols = [] %}\n    {%- set cols = adapter.get_columns_in_relation(from) -%}\n    {%- set except = except | map(\"lower\") | list %}\n    {%- for col in cols -%}\n        {%- if col.column|lower not in except -%}\n            {% do include_cols.append(col.column) %}\n        {%- endif %}\n    {%- endfor %}\n\n    {{ return(include_cols) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3077226}, "macro.dbt_utils.get_period_boundaries": {"unique_id": "macro.dbt_utils.get_period_boundaries", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/materializations/insert_by_period_materialization.sql", "original_file_path": "macros/materializations/insert_by_period_materialization.sql", "name": "get_period_boundaries", "macro_sql": "{% macro get_period_boundaries(target_schema, target_table, timestamp_field, start_date, stop_date, period) -%}\n    {{ return(adapter.dispatch('get_period_boundaries', 'dbt_utils')(target_schema, target_table, timestamp_field, start_date, stop_date, period)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_period_boundaries"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3178914}, "macro.dbt_utils.default__get_period_boundaries": {"unique_id": "macro.dbt_utils.default__get_period_boundaries", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/materializations/insert_by_period_materialization.sql", "original_file_path": "macros/materializations/insert_by_period_materialization.sql", "name": "default__get_period_boundaries", "macro_sql": "{% macro default__get_period_boundaries(target_schema, target_table, timestamp_field, start_date, stop_date, period) -%}\n\n  {% call statement('period_boundaries', fetch_result=True) -%}\n    with data as (\n      select\n          coalesce(max(\"{{timestamp_field}}\"), '{{start_date}}')::timestamp as start_timestamp,\n          coalesce(\n            {{ dateadd('millisecond',\n                                -1,\n                                \"nullif('\" ~ stop_date ~ \"','')::timestamp\") }},\n            {{ dbt_utils.current_timestamp() }}\n          ) as stop_timestamp\n      from \"{{target_schema}}\".\"{{target_table}}\"\n    )\n\n    select\n      start_timestamp,\n      stop_timestamp,\n      {{ datediff('start_timestamp',\n                           'stop_timestamp',\n                           period) }}  + 1 as num_periods\n    from data\n  {%- endcall %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.dateadd", "macro.dbt_utils.current_timestamp", "macro.dbt_utils.datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3189735}, "macro.dbt_utils.get_period_sql": {"unique_id": "macro.dbt_utils.get_period_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/materializations/insert_by_period_materialization.sql", "original_file_path": "macros/materializations/insert_by_period_materialization.sql", "name": "get_period_sql", "macro_sql": "{% macro get_period_sql(target_cols_csv, sql, timestamp_field, period, start_timestamp, stop_timestamp, offset) -%}\n    {{ return(adapter.dispatch('get_period_sql', 'dbt_utils')(target_cols_csv, sql, timestamp_field, period, start_timestamp, stop_timestamp, offset)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_period_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3196652}, "macro.dbt_utils.default__get_period_sql": {"unique_id": "macro.dbt_utils.default__get_period_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/materializations/insert_by_period_materialization.sql", "original_file_path": "macros/materializations/insert_by_period_materialization.sql", "name": "default__get_period_sql", "macro_sql": "{% macro default__get_period_sql(target_cols_csv, sql, timestamp_field, period, start_timestamp, stop_timestamp, offset) -%}\n\n  {%- set period_filter -%}\n    (\"{{timestamp_field}}\" >  '{{start_timestamp}}'::timestamp + interval '{{offset}} {{period}}' and\n     \"{{timestamp_field}}\" <= '{{start_timestamp}}'::timestamp + interval '{{offset}} {{period}}' + interval '1 {{period}}' and\n     \"{{timestamp_field}}\" <  '{{stop_timestamp}}'::timestamp)\n  {%- endset -%}\n\n  {%- set filtered_sql = sql | replace(\"__PERIOD_FILTER__\", period_filter) -%}\n\n  select\n    {{target_cols_csv}}\n  from (\n    {{filtered_sql}}\n  )\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3207412}, "macro.dbt_utils.materialization_insert_by_period_default": {"unique_id": "macro.dbt_utils.materialization_insert_by_period_default", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/materializations/insert_by_period_materialization.sql", "original_file_path": "macros/materializations/insert_by_period_materialization.sql", "name": "materialization_insert_by_period_default", "macro_sql": "{% materialization insert_by_period, default -%}\n  {%- set timestamp_field = config.require('timestamp_field') -%}\n  {%- set start_date = config.require('start_date') -%}\n  {%- set stop_date = config.get('stop_date') or '' -%}\n  {%- set period = config.get('period') or 'week' -%}\n\n  {%- set deprecation_warning = \"Warning: the `insert_by_period` materialization will be removed from dbt_utils in version 1.0.0. Install from dbt-labs/dbt-labs-experimental-features instead (see https://github.com/dbt-labs/dbt-utils/discussions/487). The \" ~ package ~ \".\" ~ model ~ \" model triggered this warning.\" -%}\n  {%- do exceptions.warn(deprecation_warning) -%}\n\n  {%- if sql.find('__PERIOD_FILTER__') == -1 -%}\n    {%- set error_message -%}\n      Model '{{ model.unique_id }}' does not include the required string '__PERIOD_FILTER__' in its sql\n    {%- endset -%}\n    {{ exceptions.raise_compiler_error(error_message) }}\n  {%- endif -%}\n\n  {%- set identifier = model['name'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier, schema=schema, type='table') -%}\n\n  {%- set non_destructive_mode = (flags.NON_DESTRUCTIVE == True) -%}\n  {%- set full_refresh_mode = (flags.FULL_REFRESH == True) -%}\n\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n  {%- set exists_not_as_table = (old_relation is not none and not old_relation.is_table) -%}\n\n  {%- set should_truncate = (non_destructive_mode and full_refresh_mode and exists_as_table) -%}\n  {%- set should_drop = (not should_truncate and (full_refresh_mode or exists_not_as_table)) -%}\n  {%- set force_create = (flags.FULL_REFRESH and not flags.NON_DESTRUCTIVE) -%}\n\n  -- setup\n  {% if old_relation is none -%}\n    -- noop\n  {%- elif should_truncate -%}\n    {{adapter.truncate_relation(old_relation)}}\n  {%- elif should_drop -%}\n    {{adapter.drop_relation(old_relation)}}\n    {%- set old_relation = none -%}\n  {%- endif %}\n\n  {{run_hooks(pre_hooks, inside_transaction=False)}}\n\n  -- `begin` happens here, so `commit` after it to finish the transaction\n  {{run_hooks(pre_hooks, inside_transaction=True)}}\n  {% call statement() -%}\n    begin; -- make extra sure we've closed out the transaction\n    commit;\n  {%- endcall %}\n\n  -- build model\n  {% if force_create or old_relation is none -%}\n    {# Create an empty target table -#}\n    {% call statement('main') -%}\n      {%- set empty_sql = sql | replace(\"__PERIOD_FILTER__\", 'false') -%}\n      {{create_table_as(False, target_relation, empty_sql)}}\n    {%- endcall %}\n  {%- endif %}\n\n  {% set _ = dbt_utils.get_period_boundaries(schema,\n                                              identifier,\n                                              timestamp_field,\n                                              start_date,\n                                              stop_date,\n                                              period) %}\n  {%- set start_timestamp = load_result('period_boundaries')['data'][0][0] | string -%}\n  {%- set stop_timestamp = load_result('period_boundaries')['data'][0][1] | string -%}\n  {%- set num_periods = load_result('period_boundaries')['data'][0][2] | int -%}\n\n  {% set target_columns = adapter.get_columns_in_relation(target_relation) %}\n  {%- set target_cols_csv = target_columns | map(attribute='quoted') | join(', ') -%}\n  {%- set loop_vars = {'sum_rows_inserted': 0} -%}\n\n  -- commit each period as a separate transaction\n  {% for i in range(num_periods) -%}\n    {%- set msg = \"Running for \" ~ period ~ \" \" ~ (i + 1) ~ \" of \" ~ (num_periods) -%}\n    {{ dbt_utils.log_info(msg) }}\n\n    {%- set tmp_identifier = model['name'] ~ '__dbt_incremental_period' ~ i ~ '_tmp' -%}\n    {%- set tmp_relation = api.Relation.create(identifier=tmp_identifier,\n                                               schema=schema, type='table') -%}\n    {% call statement() -%}\n      {% set tmp_table_sql = dbt_utils.get_period_sql(target_cols_csv,\n                                                       sql,\n                                                       timestamp_field,\n                                                       period,\n                                                       start_timestamp,\n                                                       stop_timestamp,\n                                                       i) %}\n      {{dbt.create_table_as(True, tmp_relation, tmp_table_sql)}}\n    {%- endcall %}\n\n    {{adapter.expand_target_column_types(from_relation=tmp_relation,\n                                         to_relation=target_relation)}}\n    {%- set name = 'main-' ~ i -%}\n    {% call statement(name, fetch_result=True) -%}\n      insert into {{target_relation}} ({{target_cols_csv}})\n      (\n          select\n              {{target_cols_csv}}\n          from {{tmp_relation.include(schema=False)}}\n      );\n    {%- endcall %}\n    {% set result = load_result('main-' ~ i) %}\n    {% if 'response' in result.keys() %} {# added in v0.19.0 #}\n        {% set rows_inserted = result['response']['rows_affected'] %}\n    {% else %} {# older versions #}\n        {% set rows_inserted = result['status'].split(\" \")[2] | int %}\n    {% endif %}\n\n    {%- set sum_rows_inserted = loop_vars['sum_rows_inserted'] + rows_inserted -%}\n    {%- if loop_vars.update({'sum_rows_inserted': sum_rows_inserted}) %} {% endif -%}\n\n    {%- set msg = \"Ran for \" ~ period ~ \" \" ~ (i + 1) ~ \" of \" ~ (num_periods) ~ \"; \" ~ rows_inserted ~ \" records inserted\" -%}\n    {{ dbt_utils.log_info(msg) }}\n\n  {%- endfor %}\n\n  {% call statement() -%}\n    begin;\n  {%- endcall %}\n\n  {{run_hooks(post_hooks, inside_transaction=True)}}\n\n  {% call statement() -%}\n    commit;\n  {%- endcall %}\n\n  {{run_hooks(post_hooks, inside_transaction=False)}}\n\n  {%- set status_string = \"INSERT \" ~ loop_vars['sum_rows_inserted'] -%}\n\n  {% call noop_statement('main', status_string) -%}\n    -- no-op\n  {%- endcall %}\n\n  -- Return the relations created in this materialization\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt_utils.get_period_boundaries", "macro.dbt_utils.log_info", "macro.dbt_utils.get_period_sql", "macro.dbt.noop_statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3319356}, "macro.dbt_utils.pretty_time": {"unique_id": "macro.dbt_utils.pretty_time", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/pretty_time.sql", "original_file_path": "macros/jinja_helpers/pretty_time.sql", "name": "pretty_time", "macro_sql": "{% macro pretty_time(format='%H:%M:%S') %}\n    {{ return(adapter.dispatch('pretty_time', 'dbt_utils')(format)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__pretty_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3327563}, "macro.dbt_utils.default__pretty_time": {"unique_id": "macro.dbt_utils.default__pretty_time", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/pretty_time.sql", "original_file_path": "macros/jinja_helpers/pretty_time.sql", "name": "default__pretty_time", "macro_sql": "{% macro default__pretty_time(format='%H:%M:%S') %}\n    {{ return(modules.datetime.datetime.now().strftime(format)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3332179}, "macro.dbt_utils._is_relation": {"unique_id": "macro.dbt_utils._is_relation", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/_is_relation.sql", "original_file_path": "macros/jinja_helpers/_is_relation.sql", "name": "_is_relation", "macro_sql": "{% macro _is_relation(obj, macro) %}\n    {%- if not (obj is mapping and obj.get('metadata', {}).get('type', '').endswith('Relation')) -%}\n        {%- do exceptions.raise_compiler_error(\"Macro \" ~ macro ~ \" expected a Relation but received the value: \" ~ obj) -%}\n    {%- endif -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3343}, "macro.dbt_utils.slugify": {"unique_id": "macro.dbt_utils.slugify", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/slugify.sql", "original_file_path": "macros/jinja_helpers/slugify.sql", "name": "slugify", "macro_sql": "{% macro slugify(string) %}\n\n{#- Lower case the string -#}\n{% set string = string | lower %}\n{#- Replace spaces and dashes with underscores -#}\n{% set string = modules.re.sub('[ -]+', '_', string) %}\n{#- Only take letters, numbers, and underscores -#}\n{% set string = modules.re.sub('[^a-z0-9_]+', '', string) %}\n\n{{ return(string) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3354185}, "macro.dbt_utils._is_ephemeral": {"unique_id": "macro.dbt_utils._is_ephemeral", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/_is_ephemeral.sql", "original_file_path": "macros/jinja_helpers/_is_ephemeral.sql", "name": "_is_ephemeral", "macro_sql": "{% macro _is_ephemeral(obj, macro) %}\n    {%- if obj.is_cte -%}\n        {% set ephemeral_prefix = api.Relation.add_ephemeral_prefix('') %}\n        {% if obj.name.startswith(ephemeral_prefix) %}\n            {% set model_name = obj.name[(ephemeral_prefix|length):] %}\n        {% else %}\n            {% set model_name = obj.name %}\n        {%- endif -%}\n        {% set error_message %}\nThe `{{ macro }}` macro cannot be used with ephemeral models, as it relies on the information schema.\n\n`{{ model_name }}` is an ephemeral model. Consider making it a view or table instead.\n        {% endset %}\n        {%- do exceptions.raise_compiler_error(error_message) -%}\n    {%- endif -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3373158}, "macro.dbt_utils.log_info": {"unique_id": "macro.dbt_utils.log_info", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/log_info.sql", "original_file_path": "macros/jinja_helpers/log_info.sql", "name": "log_info", "macro_sql": "{% macro log_info(message) %}\n    {{ return(adapter.dispatch('log_info', 'dbt_utils')(message)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__log_info"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3380263}, "macro.dbt_utils.default__log_info": {"unique_id": "macro.dbt_utils.default__log_info", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/log_info.sql", "original_file_path": "macros/jinja_helpers/log_info.sql", "name": "default__log_info", "macro_sql": "{% macro default__log_info(message) %}\n    {{ log(dbt_utils.pretty_log_format(message), info=True) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.pretty_log_format"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3384142}, "macro.dbt_utils.pretty_log_format": {"unique_id": "macro.dbt_utils.pretty_log_format", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/pretty_log_format.sql", "original_file_path": "macros/jinja_helpers/pretty_log_format.sql", "name": "pretty_log_format", "macro_sql": "{% macro pretty_log_format(message) %}\n    {{ return(adapter.dispatch('pretty_log_format', 'dbt_utils')(message)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__pretty_log_format"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3390872}, "macro.dbt_utils.default__pretty_log_format": {"unique_id": "macro.dbt_utils.default__pretty_log_format", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/pretty_log_format.sql", "original_file_path": "macros/jinja_helpers/pretty_log_format.sql", "name": "default__pretty_log_format", "macro_sql": "{% macro default__pretty_log_format(message) %}\n    {{ return( dbt_utils.pretty_time() ~ ' + ' ~ message) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.pretty_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3394551}, "macro.dbt_utils.get_url_parameter": {"unique_id": "macro.dbt_utils.get_url_parameter", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/web/get_url_parameter.sql", "original_file_path": "macros/web/get_url_parameter.sql", "name": "get_url_parameter", "macro_sql": "{% macro get_url_parameter(field, url_parameter) -%}\n    {{ return(adapter.dispatch('get_url_parameter', 'dbt_utils')(field, url_parameter)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_url_parameter"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3402164}, "macro.dbt_utils.default__get_url_parameter": {"unique_id": "macro.dbt_utils.default__get_url_parameter", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/web/get_url_parameter.sql", "original_file_path": "macros/web/get_url_parameter.sql", "name": "default__get_url_parameter", "macro_sql": "{% macro default__get_url_parameter(field, url_parameter) -%}\n\n{%- set formatted_url_parameter = \"'\" + url_parameter + \"='\" -%}\n\n{%- set split = split_part(split_part(field, formatted_url_parameter, 2), \"'&'\", 1) -%}\n\nnullif({{ split }},'')\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.split_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.340875}, "macro.dbt_utils.get_url_path": {"unique_id": "macro.dbt_utils.get_url_path", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/web/get_url_path.sql", "original_file_path": "macros/web/get_url_path.sql", "name": "get_url_path", "macro_sql": "{% macro get_url_path(field) -%}\n    {{ return(adapter.dispatch('get_url_path', 'dbt_utils')(field)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_url_path"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3418956}, "macro.dbt_utils.default__get_url_path": {"unique_id": "macro.dbt_utils.default__get_url_path", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/web/get_url_path.sql", "original_file_path": "macros/web/get_url_path.sql", "name": "default__get_url_path", "macro_sql": "{% macro default__get_url_path(field) -%}\n\n    {%- set stripped_url =\n        replace(\n            replace(field, \"'http://'\", \"''\"), \"'https://'\", \"''\")\n    -%}\n\n    {%- set first_slash_pos -%}\n        coalesce(\n            nullif({{ position(\"'/'\", stripped_url) }}, 0),\n            {{ position(\"'?'\", stripped_url) }} - 1\n            )\n    {%- endset -%}\n\n    {%- set parsed_path =\n        split_part(\n            right(\n                stripped_url,\n                length(stripped_url) ~ \"-\" ~ first_slash_pos\n                ),\n            \"'?'\", 1\n            )\n    -%}\n\n    {{ safe_cast(\n        parsed_path,\n        type_string()\n    )}}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.replace", "macro.dbt_utils.position", "macro.dbt_utils.split_part", "macro.dbt_utils.right", "macro.dbt_utils.length", "macro.dbt_utils.safe_cast", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3432417}, "macro.dbt_utils.get_url_host": {"unique_id": "macro.dbt_utils.get_url_host", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/web/get_url_host.sql", "original_file_path": "macros/web/get_url_host.sql", "name": "get_url_host", "macro_sql": "{% macro get_url_host(field) -%}\n    {{ return(adapter.dispatch('get_url_host', 'dbt_utils')(field)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_url_host"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.34406}, "macro.dbt_utils.default__get_url_host": {"unique_id": "macro.dbt_utils.default__get_url_host", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/web/get_url_host.sql", "original_file_path": "macros/web/get_url_host.sql", "name": "default__get_url_host", "macro_sql": "{% macro default__get_url_host(field) -%}\n\n{%- set parsed =\n    split_part(\n        split_part(\n            replace(\n                replace(\n                    replace(field, \"'android-app://'\", \"''\"\n                    ), \"'http://'\", \"''\"\n                ), \"'https://'\", \"''\"\n            ), \"'/'\", 1\n        ), \"'?'\", 1\n    )\n\n-%}\n\n\n    {{ dbt.safe_cast(\n        parsed,\n        type_string()\n        )}}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.split_part", "macro.dbt_utils.replace", "macro.dbt_utils.safe_cast", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.344955}, "macro.dbt_utils.array_concat": {"unique_id": "macro.dbt_utils.array_concat", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/array_concat.sql", "original_file_path": "macros/cross_db_utils/array_concat.sql", "name": "array_concat", "macro_sql": "{% macro array_concat(array_1, array_2) -%}\n  {% do dbt_utils.xdb_deprecation_warning_without_replacement('array_concat', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('array_concat', 'dbt_utils')(array_1, array_2)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning_without_replacement", "macro.dbt_utils.default__array_concat"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3461096}, "macro.dbt_utils.default__array_concat": {"unique_id": "macro.dbt_utils.default__array_concat", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/array_concat.sql", "original_file_path": "macros/cross_db_utils/array_concat.sql", "name": "default__array_concat", "macro_sql": "{% macro default__array_concat(array_1, array_2) -%}\n    array_cat({{ array_1 }}, {{ array_2 }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.346421}, "macro.dbt_utils.bigquery__array_concat": {"unique_id": "macro.dbt_utils.bigquery__array_concat", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/array_concat.sql", "original_file_path": "macros/cross_db_utils/array_concat.sql", "name": "bigquery__array_concat", "macro_sql": "{% macro bigquery__array_concat(array_1, array_2) -%}\n    array_concat({{ array_1 }}, {{ array_2 }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3467128}, "macro.dbt_utils.redshift__array_concat": {"unique_id": "macro.dbt_utils.redshift__array_concat", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/array_concat.sql", "original_file_path": "macros/cross_db_utils/array_concat.sql", "name": "redshift__array_concat", "macro_sql": "{% macro redshift__array_concat(array_1, array_2) -%}\n    array_concat({{ array_1 }}, {{ array_2 }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3472362}, "macro.dbt_utils.current_timestamp": {"unique_id": "macro.dbt_utils.current_timestamp", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "current_timestamp", "macro_sql": "{% macro current_timestamp() -%}\n  {% do dbt_utils.xdb_deprecation_warning_without_replacement('current_timestamp', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('current_timestamp', 'dbt_utils')()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning_without_replacement", "macro.dbt_utils.default__current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3487074}, "macro.dbt_utils.default__current_timestamp": {"unique_id": "macro.dbt_utils.default__current_timestamp", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "default__current_timestamp", "macro_sql": "{% macro default__current_timestamp() %}\n    current_timestamp::{{ type_timestamp() }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3489602}, "macro.dbt_utils.redshift__current_timestamp": {"unique_id": "macro.dbt_utils.redshift__current_timestamp", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "redshift__current_timestamp", "macro_sql": "{% macro redshift__current_timestamp() %}\n    getdate()\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3491564}, "macro.dbt_utils.bigquery__current_timestamp": {"unique_id": "macro.dbt_utils.bigquery__current_timestamp", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "bigquery__current_timestamp", "macro_sql": "{% macro bigquery__current_timestamp() %}\n    current_timestamp\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3493276}, "macro.dbt_utils.current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "current_timestamp_in_utc", "macro_sql": "{% macro current_timestamp_in_utc() -%}\n  {% do dbt_utils.xdb_deprecation_warning_without_replacement('current_timestamp_in_utc', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('current_timestamp_in_utc', 'dbt_utils')()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning_without_replacement", "macro.dbt_utils.postgres__current_timestamp_in_utc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.349895}, "macro.dbt_utils.default__current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.default__current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "default__current_timestamp_in_utc", "macro_sql": "{% macro default__current_timestamp_in_utc() %}\n    {{ dbt_utils.current_timestamp() }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3501613}, "macro.dbt_utils.snowflake__current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.snowflake__current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "snowflake__current_timestamp_in_utc", "macro_sql": "{% macro snowflake__current_timestamp_in_utc() %}\n    convert_timezone('UTC', {{ dbt_utils.current_timestamp() }})::{{ type_timestamp() }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.current_timestamp", "macro.dbt_utils.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3504794}, "macro.dbt_utils.postgres__current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.postgres__current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "postgres__current_timestamp_in_utc", "macro_sql": "{% macro postgres__current_timestamp_in_utc() %}\n    (current_timestamp at time zone 'utc')::{{ type_timestamp() }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.350719}, "macro.dbt_utils.redshift__current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.redshift__current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "redshift__current_timestamp_in_utc", "macro_sql": "{% macro redshift__current_timestamp_in_utc() %}\n    {{ return(dbt_utils.default__current_timestamp_in_utc()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__current_timestamp_in_utc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3510118}, "macro.dbt_utils.array_append": {"unique_id": "macro.dbt_utils.array_append", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/array_append.sql", "original_file_path": "macros/cross_db_utils/array_append.sql", "name": "array_append", "macro_sql": "{% macro array_append(array, new_element) -%}\n  {% do dbt_utils.xdb_deprecation_warning_without_replacement('array_append', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('array_append', 'dbt_utils')(array, new_element)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning_without_replacement", "macro.dbt_utils.default__array_append"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3521018}, "macro.dbt_utils.default__array_append": {"unique_id": "macro.dbt_utils.default__array_append", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/array_append.sql", "original_file_path": "macros/cross_db_utils/array_append.sql", "name": "default__array_append", "macro_sql": "{% macro default__array_append(array, new_element) -%}\n    array_append({{ array }}, {{ new_element }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3525248}, "macro.dbt_utils.bigquery__array_append": {"unique_id": "macro.dbt_utils.bigquery__array_append", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/array_append.sql", "original_file_path": "macros/cross_db_utils/array_append.sql", "name": "bigquery__array_append", "macro_sql": "{% macro bigquery__array_append(array, new_element) -%}\n    {{ dbt_utils.array_concat(array, dbt_utils.array_construct([new_element])) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.array_concat", "macro.dbt_utils.array_construct"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3529418}, "macro.dbt_utils.redshift__array_append": {"unique_id": "macro.dbt_utils.redshift__array_append", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/array_append.sql", "original_file_path": "macros/cross_db_utils/array_append.sql", "name": "redshift__array_append", "macro_sql": "{% macro redshift__array_append(array, new_element) -%}\n    {{ dbt_utils.array_concat(array, dbt_utils.array_construct([new_element])) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.array_concat", "macro.dbt_utils.array_construct"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.353381}, "macro.dbt_utils.array_construct": {"unique_id": "macro.dbt_utils.array_construct", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/array_construct.sql", "original_file_path": "macros/cross_db_utils/array_construct.sql", "name": "array_construct", "macro_sql": "{% macro array_construct(inputs = [], data_type = api.Column.translate_type('integer')) -%}\n  {% do dbt_utils.xdb_deprecation_warning_without_replacement('array_construct', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('array_construct', 'dbt_utils')(inputs, data_type)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning_without_replacement", "macro.dbt_utils.default__array_construct"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3547564}, "macro.dbt_utils.default__array_construct": {"unique_id": "macro.dbt_utils.default__array_construct", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/array_construct.sql", "original_file_path": "macros/cross_db_utils/array_construct.sql", "name": "default__array_construct", "macro_sql": "{% macro default__array_construct(inputs, data_type) -%}\n    {% if inputs|length > 0 %}\n    array[ {{ inputs|join(' , ') }} ]\n    {% else %}\n    array[]::{{data_type}}[]\n    {% endif %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.355312}, "macro.dbt_utils.snowflake__array_construct": {"unique_id": "macro.dbt_utils.snowflake__array_construct", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/array_construct.sql", "original_file_path": "macros/cross_db_utils/array_construct.sql", "name": "snowflake__array_construct", "macro_sql": "{% macro snowflake__array_construct(inputs, data_type) -%}\n    array_construct( {{ inputs|join(' , ') }} )\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.355636}, "macro.dbt_utils.redshift__array_construct": {"unique_id": "macro.dbt_utils.redshift__array_construct", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/array_construct.sql", "original_file_path": "macros/cross_db_utils/array_construct.sql", "name": "redshift__array_construct", "macro_sql": "{% macro redshift__array_construct(inputs, data_type) -%}\n    array( {{ inputs|join(' , ') }} )\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3559508}, "macro.dbt_utils.bigquery__array_construct": {"unique_id": "macro.dbt_utils.bigquery__array_construct", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/array_construct.sql", "original_file_path": "macros/cross_db_utils/array_construct.sql", "name": "bigquery__array_construct", "macro_sql": "{% macro bigquery__array_construct(inputs, data_type) -%}\n    [ {{ inputs|join(' , ') }} ]\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3562653}, "macro.dbt_utils.cast_array_to_string": {"unique_id": "macro.dbt_utils.cast_array_to_string", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/cast_array_to_string.sql", "original_file_path": "macros/cross_db_utils/cast_array_to_string.sql", "name": "cast_array_to_string", "macro_sql": "{% macro cast_array_to_string(array) %}\n  {% do dbt_utils.xdb_deprecation_warning_without_replacement('cast_array_to_string', model.package_name, model.name) %}\n  {{ adapter.dispatch('cast_array_to_string', 'dbt_utils') (array) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning_without_replacement", "macro.dbt_utils.postgres__cast_array_to_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3575158}, "macro.dbt_utils.default__cast_array_to_string": {"unique_id": "macro.dbt_utils.default__cast_array_to_string", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/cast_array_to_string.sql", "original_file_path": "macros/cross_db_utils/cast_array_to_string.sql", "name": "default__cast_array_to_string", "macro_sql": "{% macro default__cast_array_to_string(array) %}\n    cast({{ array }} as {{ type_string() }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3578458}, "macro.dbt_utils.postgres__cast_array_to_string": {"unique_id": "macro.dbt_utils.postgres__cast_array_to_string", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/cast_array_to_string.sql", "original_file_path": "macros/cross_db_utils/cast_array_to_string.sql", "name": "postgres__cast_array_to_string", "macro_sql": "{% macro postgres__cast_array_to_string(array) %}\n    {%- set array_as_string -%}cast({{ array }} as {{ type_string() }}){%- endset -%}\n    {{ replace(replace(array_as_string,\"'}'\",\"']'\"),\"'{'\",\"'['\") }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string", "macro.dbt_utils.replace"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3586233}, "macro.dbt_utils.redshift__cast_array_to_string": {"unique_id": "macro.dbt_utils.redshift__cast_array_to_string", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/cast_array_to_string.sql", "original_file_path": "macros/cross_db_utils/cast_array_to_string.sql", "name": "redshift__cast_array_to_string", "macro_sql": "{% macro redshift__cast_array_to_string(array) %}\n    cast({{ array }} as {{ type_string() }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3589358}, "macro.dbt_utils.bigquery__cast_array_to_string": {"unique_id": "macro.dbt_utils.bigquery__cast_array_to_string", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/cast_array_to_string.sql", "original_file_path": "macros/cross_db_utils/cast_array_to_string.sql", "name": "bigquery__cast_array_to_string", "macro_sql": "{% macro bigquery__cast_array_to_string(array) %}\n    '['||(select string_agg(cast(element as string), ',') from unnest({{ array }}) element)||']'\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3591745}, "macro.dbt_utils.split_part": {"unique_id": "macro.dbt_utils.split_part", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/split_part.sql", "original_file_path": "macros/cross_db_utils/deprecated/split_part.sql", "name": "split_part", "macro_sql": "{% macro split_part(string_text, delimiter_text, part_number) %}\n  {{ return(adapter.dispatch('split_part', 'dbt_utils') (string_text, delimiter_text, part_number)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__split_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.360014}, "macro.dbt_utils.default__split_part": {"unique_id": "macro.dbt_utils.default__split_part", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/split_part.sql", "original_file_path": "macros/cross_db_utils/deprecated/split_part.sql", "name": "default__split_part", "macro_sql": "{% macro default__split_part(string_text, delimiter_text, part_number) %}\n  {% do dbt_utils.xdb_deprecation_warning('split_part', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('split_part', 'dbt') (string_text, delimiter_text, part_number)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.split_part", "macro.dbt_postgres.postgres__split_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.360732}, "macro.dbt_utils.escape_single_quotes": {"unique_id": "macro.dbt_utils.escape_single_quotes", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/escape_single_quotes.sql", "original_file_path": "macros/cross_db_utils/deprecated/escape_single_quotes.sql", "name": "escape_single_quotes", "macro_sql": "{% macro escape_single_quotes(expression) %}\n      {{ return(adapter.dispatch('escape_single_quotes', 'dbt_utils') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__escape_single_quotes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3615167}, "macro.dbt_utils.default__escape_single_quotes": {"unique_id": "macro.dbt_utils.default__escape_single_quotes", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/escape_single_quotes.sql", "original_file_path": "macros/cross_db_utils/deprecated/escape_single_quotes.sql", "name": "default__escape_single_quotes", "macro_sql": "{% macro default__escape_single_quotes(expression) %}\n      {% do dbt_utils.xdb_deprecation_warning('escape_single_quotes', model.package_name, model.name) %}\n      {{ return(adapter.dispatch('escape_single_quotes', 'dbt') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.escape_single_quotes", "macro.dbt_utils.default__escape_single_quotes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3621504}, "macro.dbt_utils.length": {"unique_id": "macro.dbt_utils.length", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/length.sql", "original_file_path": "macros/cross_db_utils/deprecated/length.sql", "name": "length", "macro_sql": "{% macro length(expression) -%}\n    {{ return(adapter.dispatch('length', 'dbt_utils') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__length"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3629637}, "macro.dbt_utils.default__length": {"unique_id": "macro.dbt_utils.default__length", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/length.sql", "original_file_path": "macros/cross_db_utils/deprecated/length.sql", "name": "default__length", "macro_sql": "{% macro default__length(expression) -%}\n    {% do dbt_utils.xdb_deprecation_warning('length', model.package_name, model.name) %}\n    {{ return(adapter.dispatch('length', 'dbt') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.length", "macro.dbt_utils.default__length"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3635955}, "macro.dbt_utils.right": {"unique_id": "macro.dbt_utils.right", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/right.sql", "original_file_path": "macros/cross_db_utils/deprecated/right.sql", "name": "right", "macro_sql": "{% macro right(string_text, length_expression) -%}\n    {{ return(adapter.dispatch('right', 'dbt_utils') (string_text, length_expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__right"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.364384}, "macro.dbt_utils.default__right": {"unique_id": "macro.dbt_utils.default__right", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/right.sql", "original_file_path": "macros/cross_db_utils/deprecated/right.sql", "name": "default__right", "macro_sql": "{% macro default__right(string_text, length_expression) -%}\n    {% do dbt_utils.xdb_deprecation_warning('right', model.package_name, model.name) %}\n    {{ return(adapter.dispatch('right', 'dbt') (string_text, length_expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.right", "macro.dbt_utils.default__right"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3650339}, "macro.dbt_utils.hash": {"unique_id": "macro.dbt_utils.hash", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/hash.sql", "original_file_path": "macros/cross_db_utils/deprecated/hash.sql", "name": "hash", "macro_sql": "{% macro hash(field) -%}\n  {{ return(adapter.dispatch('hash', 'dbt_utils') (field)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__hash"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3657842}, "macro.dbt_utils.default__hash": {"unique_id": "macro.dbt_utils.default__hash", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/hash.sql", "original_file_path": "macros/cross_db_utils/deprecated/hash.sql", "name": "default__hash", "macro_sql": "{% macro default__hash(field) -%}\n  {% do dbt_utils.xdb_deprecation_warning('hash', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('hash', 'dbt') (field)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.hash", "macro.dbt_utils.default__hash"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3663862}, "macro.dbt_utils.any_value": {"unique_id": "macro.dbt_utils.any_value", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/any_value.sql", "original_file_path": "macros/cross_db_utils/deprecated/any_value.sql", "name": "any_value", "macro_sql": "{% macro any_value(expression) -%}\n    {{ return(adapter.dispatch('any_value', 'dbt_utils') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__any_value"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3670964}, "macro.dbt_utils.default__any_value": {"unique_id": "macro.dbt_utils.default__any_value", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/any_value.sql", "original_file_path": "macros/cross_db_utils/deprecated/any_value.sql", "name": "default__any_value", "macro_sql": "{% macro default__any_value(expression) -%}\n    {% do dbt_utils.xdb_deprecation_warning('any_value', model.package_name, model.name) %}\n    {{ return(adapter.dispatch('any_value', 'dbt') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.any_value", "macro.dbt_postgres.postgres__any_value"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3677895}, "macro.dbt_utils.replace": {"unique_id": "macro.dbt_utils.replace", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/replace.sql", "original_file_path": "macros/cross_db_utils/deprecated/replace.sql", "name": "replace", "macro_sql": "{% macro replace(field, old_chars, new_chars) -%}\n    {{ return(adapter.dispatch('replace', 'dbt_utils') (field, old_chars, new_chars)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__replace"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.368614}, "macro.dbt_utils.default__replace": {"unique_id": "macro.dbt_utils.default__replace", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/replace.sql", "original_file_path": "macros/cross_db_utils/deprecated/replace.sql", "name": "default__replace", "macro_sql": "{% macro default__replace(field, old_chars, new_chars) -%}\n  {% do dbt_utils.xdb_deprecation_warning('replace', model.package_name, model.name) %}\n    {{ return(adapter.dispatch('replace', 'dbt') (field, old_chars, new_chars)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.replace", "macro.dbt_utils.default__replace"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.369347}, "macro.dbt_utils.cast_bool_to_text": {"unique_id": "macro.dbt_utils.cast_bool_to_text", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/cast_bool_to_text.sql", "original_file_path": "macros/cross_db_utils/deprecated/cast_bool_to_text.sql", "name": "cast_bool_to_text", "macro_sql": "{% macro cast_bool_to_text(field) %}\n  {{ adapter.dispatch('cast_bool_to_text', 'dbt_utils') (field) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__cast_bool_to_text"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3700485}, "macro.dbt_utils.default__cast_bool_to_text": {"unique_id": "macro.dbt_utils.default__cast_bool_to_text", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/cast_bool_to_text.sql", "original_file_path": "macros/cross_db_utils/deprecated/cast_bool_to_text.sql", "name": "default__cast_bool_to_text", "macro_sql": "{% macro default__cast_bool_to_text(field) %}\n  {% do dbt_utils.xdb_deprecation_warning('cast_bool_to_text', model.package_name, model.name) %}\n  {{ adapter.dispatch('cast_bool_to_text', 'dbt') (field) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.cast_bool_to_text", "macro.dbt_utils.default__cast_bool_to_text"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3706236}, "macro.dbt_utils.bool_or": {"unique_id": "macro.dbt_utils.bool_or", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/bool_or.sql", "original_file_path": "macros/cross_db_utils/deprecated/bool_or.sql", "name": "bool_or", "macro_sql": "{% macro bool_or(expression) -%}\n    {{ return(adapter.dispatch('bool_or', 'dbt_utils') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__bool_or"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3713286}, "macro.dbt_utils.default__bool_or": {"unique_id": "macro.dbt_utils.default__bool_or", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/bool_or.sql", "original_file_path": "macros/cross_db_utils/deprecated/bool_or.sql", "name": "default__bool_or", "macro_sql": "{% macro default__bool_or(expression) -%}\n    {% do dbt_utils.xdb_deprecation_warning('bool_or', model.package_name, model.name) %}\n    {{ return(adapter.dispatch('bool_or', 'dbt') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.bool_or", "macro.dbt_utils.default__bool_or"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.371937}, "macro.dbt_utils.concat": {"unique_id": "macro.dbt_utils.concat", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/concat.sql", "original_file_path": "macros/cross_db_utils/deprecated/concat.sql", "name": "concat", "macro_sql": "{% macro concat(fields) -%}\n  {{ return(adapter.dispatch('concat', 'dbt_utils')(fields)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__concat"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3726268}, "macro.dbt_utils.default__concat": {"unique_id": "macro.dbt_utils.default__concat", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/concat.sql", "original_file_path": "macros/cross_db_utils/deprecated/concat.sql", "name": "default__concat", "macro_sql": "{% macro default__concat(fields) -%}\n  {% do dbt_utils.xdb_deprecation_warning('concat', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('concat', 'dbt')(fields)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.concat", "macro.dbt_utils.default__concat"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3735106}, "macro.dbt_utils.xdb_deprecation_warning": {"unique_id": "macro.dbt_utils.xdb_deprecation_warning", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/xdb_deprecation_warning.sql", "original_file_path": "macros/cross_db_utils/deprecated/xdb_deprecation_warning.sql", "name": "xdb_deprecation_warning", "macro_sql": "{% macro xdb_deprecation_warning(macro, package, model) %}\n    {%- set error_message = \"Warning: the `\" ~ macro ~\"` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `\" ~ macro ~ \"` (no prefix) instead. The \" ~ package ~ \".\" ~ model ~ \" model triggered this warning.\" -%}\n    {%- do exceptions.warn(error_message) -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3744977}, "macro.dbt_utils.xdb_deprecation_warning_without_replacement": {"unique_id": "macro.dbt_utils.xdb_deprecation_warning_without_replacement", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/xdb_deprecation_warning.sql", "original_file_path": "macros/cross_db_utils/deprecated/xdb_deprecation_warning.sql", "name": "xdb_deprecation_warning_without_replacement", "macro_sql": "{% macro xdb_deprecation_warning_without_replacement(macro, package, model) %}\n    {%- set error_message = \"Warning: the `\" ~ macro ~\"` macro is deprecated and will be removed in a future version of the package, once equivalent functionality is implemented in dbt Core. The \" ~ package ~ \".\" ~ model ~ \" model triggered this warning.\" -%}\n    {%- do exceptions.warn(error_message) -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3750405}, "macro.dbt_utils.identifier": {"unique_id": "macro.dbt_utils.identifier", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/identifier.sql", "original_file_path": "macros/cross_db_utils/deprecated/identifier.sql", "name": "identifier", "macro_sql": "{% macro identifier(value) %}\t\n  {%- set error_message = '\n    Warning: the `identifier` macro is no longer supported and will be deprecated in a future release of dbt-utils. \\\n    Use `adapter.quote` instead. The {}.{} model triggered this warning. \\\n    '.format(model.package_name, model.name) -%}\n  {%- do exceptions.warn(error_message) -%}\n  {{ return(adapter.dispatch('identifier', 'dbt_utils') (value)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__identifier"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.376116}, "macro.dbt_utils.default__identifier": {"unique_id": "macro.dbt_utils.default__identifier", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/identifier.sql", "original_file_path": "macros/cross_db_utils/deprecated/identifier.sql", "name": "default__identifier", "macro_sql": "{% macro default__identifier(value) -%}\t\n    \"{{ value }}\"\t\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.376365}, "macro.dbt_utils.bigquery__identifier": {"unique_id": "macro.dbt_utils.bigquery__identifier", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/identifier.sql", "original_file_path": "macros/cross_db_utils/deprecated/identifier.sql", "name": "bigquery__identifier", "macro_sql": "{% macro bigquery__identifier(value) -%}\t\n    `{{ value }}`\t\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3765974}, "macro.dbt_utils.listagg": {"unique_id": "macro.dbt_utils.listagg", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/listagg.sql", "original_file_path": "macros/cross_db_utils/deprecated/listagg.sql", "name": "listagg", "macro_sql": "{% macro listagg(measure, delimiter_text=\"','\", order_by_clause=none, limit_num=none) -%}\n    {{ return(adapter.dispatch('listagg', 'dbt_utils') (measure, delimiter_text, order_by_clause, limit_num)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__listagg"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3775775}, "macro.dbt_utils.default__listagg": {"unique_id": "macro.dbt_utils.default__listagg", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/listagg.sql", "original_file_path": "macros/cross_db_utils/deprecated/listagg.sql", "name": "default__listagg", "macro_sql": "{% macro default__listagg(measure, delimiter_text=\"','\", order_by_clause=none, limit_num=none) -%}\n    {% do dbt_utils.xdb_deprecation_warning('listagg', model.package_name, model.name) %}\n    {{ return(adapter.dispatch('listagg', 'dbt') (measure, delimiter_text, order_by_clause, limit_num)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.listagg", "macro.dbt_postgres.postgres__listagg"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.378492}, "macro.dbt_utils.datediff": {"unique_id": "macro.dbt_utils.datediff", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/datediff.sql", "original_file_path": "macros/cross_db_utils/deprecated/datediff.sql", "name": "datediff", "macro_sql": "{% macro datediff(first_date, second_date, datepart) %}\n  {{ return(adapter.dispatch('datediff', 'dbt_utils')(first_date, second_date, datepart)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3793268}, "macro.dbt_utils.default__datediff": {"unique_id": "macro.dbt_utils.default__datediff", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/datediff.sql", "original_file_path": "macros/cross_db_utils/deprecated/datediff.sql", "name": "default__datediff", "macro_sql": "{% macro default__datediff(first_date, second_date, datepart) %}\n  {% do dbt_utils.xdb_deprecation_warning('datediff', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('datediff', 'dbt')(first_date, second_date, datepart)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.datediff", "macro.dbt_postgres.postgres__datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3800402}, "macro.dbt_utils.dateadd": {"unique_id": "macro.dbt_utils.dateadd", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/dateadd.sql", "original_file_path": "macros/cross_db_utils/deprecated/dateadd.sql", "name": "dateadd", "macro_sql": "{% macro dateadd(datepart, interval, from_date_or_timestamp) %}\n  {{ return(adapter.dispatch('dateadd', 'dbt_utils')(datepart, interval, from_date_or_timestamp)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3808646}, "macro.dbt_utils.default__dateadd": {"unique_id": "macro.dbt_utils.default__dateadd", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/dateadd.sql", "original_file_path": "macros/cross_db_utils/deprecated/dateadd.sql", "name": "default__dateadd", "macro_sql": "{% macro default__dateadd(datepart, interval, from_date_or_timestamp) %}\n  {% do dbt_utils.xdb_deprecation_warning('dateadd', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('dateadd', 'dbt')(datepart, interval, from_date_or_timestamp)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.dateadd", "macro.dbt_postgres.postgres__dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.381624}, "macro.dbt_utils.type_string": {"unique_id": "macro.dbt_utils.type_string", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/datatypes.sql", "original_file_path": "macros/cross_db_utils/deprecated/datatypes.sql", "name": "type_string", "macro_sql": "\n\n{%- macro type_string() -%}\n    {{ return(adapter.dispatch('type_string', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.382996}, "macro.dbt_utils.default__type_string": {"unique_id": "macro.dbt_utils.default__type_string", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/datatypes.sql", "original_file_path": "macros/cross_db_utils/deprecated/datatypes.sql", "name": "default__type_string", "macro_sql": "{% macro default__type_string() %}\n    {% do dbt_utils.xdb_deprecation_warning('type_string', model.package_name, model.name) %}\n    {{ return(adapter.dispatch('type_string', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.type_string", "macro.dbt_utils.default__type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3836722}, "macro.dbt_utils.type_timestamp": {"unique_id": "macro.dbt_utils.type_timestamp", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/datatypes.sql", "original_file_path": "macros/cross_db_utils/deprecated/datatypes.sql", "name": "type_timestamp", "macro_sql": "\n\n{%- macro type_timestamp() -%}\n    {{ return(adapter.dispatch('type_timestamp', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3840404}, "macro.dbt_utils.default__type_timestamp": {"unique_id": "macro.dbt_utils.default__type_timestamp", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/datatypes.sql", "original_file_path": "macros/cross_db_utils/deprecated/datatypes.sql", "name": "default__type_timestamp", "macro_sql": "{% macro default__type_timestamp() %}\n    {% do dbt_utils.xdb_deprecation_warning('type_timestamp', model.package_name, model.name) %}\n    {{ return(adapter.dispatch('type_timestamp', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.type_timestamp", "macro.dbt_utils.default__type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.384614}, "macro.dbt_utils.type_float": {"unique_id": "macro.dbt_utils.type_float", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/datatypes.sql", "original_file_path": "macros/cross_db_utils/deprecated/datatypes.sql", "name": "type_float", "macro_sql": "\n\n{%- macro type_float() -%}\n    {{ return(adapter.dispatch('type_float', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_float"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3849754}, "macro.dbt_utils.default__type_float": {"unique_id": "macro.dbt_utils.default__type_float", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/datatypes.sql", "original_file_path": "macros/cross_db_utils/deprecated/datatypes.sql", "name": "default__type_float", "macro_sql": "{% macro default__type_float() %}\n    {% do dbt_utils.xdb_deprecation_warning('type_float', model.package_name, model.name) %}\n    {{ return(adapter.dispatch('type_float', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.type_float", "macro.dbt_utils.default__type_float"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.385587}, "macro.dbt_utils.type_numeric": {"unique_id": "macro.dbt_utils.type_numeric", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/datatypes.sql", "original_file_path": "macros/cross_db_utils/deprecated/datatypes.sql", "name": "type_numeric", "macro_sql": "\n\n{%- macro type_numeric() -%}\n    {{ return(adapter.dispatch('type_numeric', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3859549}, "macro.dbt_utils.default__type_numeric": {"unique_id": "macro.dbt_utils.default__type_numeric", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/datatypes.sql", "original_file_path": "macros/cross_db_utils/deprecated/datatypes.sql", "name": "default__type_numeric", "macro_sql": "{% macro default__type_numeric() %}\n    {% do dbt_utils.xdb_deprecation_warning('type_numeric', model.package_name, model.name) %}\n    {{ return(adapter.dispatch('type_numeric', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.type_numeric", "macro.dbt_utils.default__type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3865304}, "macro.dbt_utils.type_bigint": {"unique_id": "macro.dbt_utils.type_bigint", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/datatypes.sql", "original_file_path": "macros/cross_db_utils/deprecated/datatypes.sql", "name": "type_bigint", "macro_sql": "\n\n{%- macro type_bigint() -%}\n    {{ return(adapter.dispatch('type_bigint', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3870504}, "macro.dbt_utils.default__type_bigint": {"unique_id": "macro.dbt_utils.default__type_bigint", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/datatypes.sql", "original_file_path": "macros/cross_db_utils/deprecated/datatypes.sql", "name": "default__type_bigint", "macro_sql": "{% macro default__type_bigint() %}\n    {% do dbt_utils.xdb_deprecation_warning('type_bigint', model.package_name, model.name) %}\n    {{ return(adapter.dispatch('type_bigint', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.type_bigint", "macro.dbt_utils.default__type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3876355}, "macro.dbt_utils.type_int": {"unique_id": "macro.dbt_utils.type_int", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/datatypes.sql", "original_file_path": "macros/cross_db_utils/deprecated/datatypes.sql", "name": "type_int", "macro_sql": "\n\n{%- macro type_int() -%}\n    {{ return(adapter.dispatch('type_int', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3879976}, "macro.dbt_utils.default__type_int": {"unique_id": "macro.dbt_utils.default__type_int", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/datatypes.sql", "original_file_path": "macros/cross_db_utils/deprecated/datatypes.sql", "name": "default__type_int", "macro_sql": "{% macro default__type_int() %}\n    {% do dbt_utils.xdb_deprecation_warning('type_int', model.package_name, model.name) %}\n    {{ return(adapter.dispatch('type_int', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.type_int", "macro.dbt_utils.default__type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3886619}, "macro.dbt_utils.position": {"unique_id": "macro.dbt_utils.position", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/position.sql", "original_file_path": "macros/cross_db_utils/deprecated/position.sql", "name": "position", "macro_sql": "{% macro position(substring_text, string_text) -%}\n    {{ return(adapter.dispatch('position', 'dbt_utils') (substring_text, string_text)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__position"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3894804}, "macro.dbt_utils.default__position": {"unique_id": "macro.dbt_utils.default__position", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/position.sql", "original_file_path": "macros/cross_db_utils/deprecated/position.sql", "name": "default__position", "macro_sql": "{% macro default__position(substring_text, string_text) -%}\n    {% do dbt_utils.xdb_deprecation_warning('position', model.package_name, model.name) %}\n    {{ return(adapter.dispatch('position', 'dbt') (substring_text, string_text)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.position", "macro.dbt_utils.default__position"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3901398}, "macro.dbt_utils.string_literal": {"unique_id": "macro.dbt_utils.string_literal", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/literal.sql", "original_file_path": "macros/cross_db_utils/deprecated/literal.sql", "name": "string_literal", "macro_sql": "{%- macro string_literal(value) -%}\n  {{ return(adapter.dispatch('string_literal', 'dbt_utils') (value)) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__string_literal"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3908494}, "macro.dbt_utils.default__string_literal": {"unique_id": "macro.dbt_utils.default__string_literal", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/literal.sql", "original_file_path": "macros/cross_db_utils/deprecated/literal.sql", "name": "default__string_literal", "macro_sql": "{%- macro default__string_literal(value) -%}\n  {% do dbt_utils.xdb_deprecation_warning('string_literal', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('string_literal', 'dbt') (value)) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.string_literal", "macro.dbt_utils.default__string_literal"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3914518}, "macro.dbt_utils.date_trunc": {"unique_id": "macro.dbt_utils.date_trunc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/date_trunc.sql", "original_file_path": "macros/cross_db_utils/deprecated/date_trunc.sql", "name": "date_trunc", "macro_sql": "{% macro date_trunc(datepart, date) -%}\n  {{ return(adapter.dispatch('date_trunc', 'dbt_utils') (datepart, date)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.392209}, "macro.dbt_utils.default__date_trunc": {"unique_id": "macro.dbt_utils.default__date_trunc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/date_trunc.sql", "original_file_path": "macros/cross_db_utils/deprecated/date_trunc.sql", "name": "default__date_trunc", "macro_sql": "{% macro default__date_trunc(datepart, date) -%}\n  {% do dbt_utils.xdb_deprecation_warning('date_trunc', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('date_trunc', 'dbt') (datepart, date)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.date_trunc", "macro.dbt_utils.default__date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3928564}, "macro.dbt_utils.except": {"unique_id": "macro.dbt_utils.except", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/except.sql", "original_file_path": "macros/cross_db_utils/deprecated/except.sql", "name": "except", "macro_sql": "{% macro except() %}\n  {{ return(adapter.dispatch('except', 'dbt_utils')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__except"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3936446}, "macro.dbt_utils.default__except": {"unique_id": "macro.dbt_utils.default__except", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/except.sql", "original_file_path": "macros/cross_db_utils/deprecated/except.sql", "name": "default__except", "macro_sql": "{% macro default__except() %}\n  {% do dbt_utils.xdb_deprecation_warning('except', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('except', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.except", "macro.dbt_utils.default__except"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3942308}, "macro.dbt_utils.safe_cast": {"unique_id": "macro.dbt_utils.safe_cast", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/safe_cast.sql", "original_file_path": "macros/cross_db_utils/deprecated/safe_cast.sql", "name": "safe_cast", "macro_sql": "{% macro safe_cast(field, type) %}\n  {{ return(adapter.dispatch('safe_cast', 'dbt_utils') (field, type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__safe_cast"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3949976}, "macro.dbt_utils.default__safe_cast": {"unique_id": "macro.dbt_utils.default__safe_cast", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/safe_cast.sql", "original_file_path": "macros/cross_db_utils/deprecated/safe_cast.sql", "name": "default__safe_cast", "macro_sql": "{% macro default__safe_cast(field, type) %}\n  {% do dbt_utils.xdb_deprecation_warning('safe_cast', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('safe_cast', 'dbt') (field, type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.safe_cast", "macro.dbt_utils.default__safe_cast"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3956563}, "macro.dbt_utils.last_day": {"unique_id": "macro.dbt_utils.last_day", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/last_day.sql", "original_file_path": "macros/cross_db_utils/deprecated/last_day.sql", "name": "last_day", "macro_sql": "{% macro last_day(date, datepart) %}\n  {{ return(adapter.dispatch('last_day', 'dbt_utils') (date, datepart)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3964267}, "macro.dbt_utils.default__last_day": {"unique_id": "macro.dbt_utils.default__last_day", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/last_day.sql", "original_file_path": "macros/cross_db_utils/deprecated/last_day.sql", "name": "default__last_day", "macro_sql": "{% macro default__last_day(date, datepart) %}\n  {% do dbt_utils.xdb_deprecation_warning('last_day', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('last_day', 'dbt') (date, datepart)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.last_day", "macro.dbt_postgres.postgres__last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3970845}, "macro.dbt_utils.intersect": {"unique_id": "macro.dbt_utils.intersect", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/intersect.sql", "original_file_path": "macros/cross_db_utils/deprecated/intersect.sql", "name": "intersect", "macro_sql": "{% macro intersect() %}\n  {{ return(adapter.dispatch('intersect', 'dbt_utils')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__intersect"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3977902}, "macro.dbt_utils.default__intersect": {"unique_id": "macro.dbt_utils.default__intersect", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/deprecated/intersect.sql", "original_file_path": "macros/cross_db_utils/deprecated/intersect.sql", "name": "default__intersect", "macro_sql": "{% macro default__intersect() %}\n  {% do dbt_utils.xdb_deprecation_warning('intersect', model.package_name, model.name) %}\n  {{ return(adapter.dispatch('intersect', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.xdb_deprecation_warning", "macro.dbt_utils.intersect", "macro.dbt_utils.default__intersect"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3983693}, "macro.dbt_utils.test_expression_is_true": {"unique_id": "macro.dbt_utils.test_expression_is_true", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/expression_is_true.sql", "original_file_path": "macros/generic_tests/expression_is_true.sql", "name": "test_expression_is_true", "macro_sql": "{% test expression_is_true(model, expression, column_name=None, condition='1=1') %}\n{# T-SQL has no boolean data type so we use 1=1 which returns TRUE #}\n{# ref https://stackoverflow.com/a/7170753/3842610 #}\n  {{ return(adapter.dispatch('test_expression_is_true', 'dbt_utils')(model, expression, column_name, condition)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.3995082}, "macro.dbt_utils.default__test_expression_is_true": {"unique_id": "macro.dbt_utils.default__test_expression_is_true", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/expression_is_true.sql", "original_file_path": "macros/generic_tests/expression_is_true.sql", "name": "default__test_expression_is_true", "macro_sql": "{% macro default__test_expression_is_true(model, expression, column_name, condition) %}\n\nwith meet_condition as (\n    select * from {{ model }} where {{ condition }}\n)\n\nselect\n    *\nfrom meet_condition\n{% if column_name is none %}\nwhere not({{ expression }})\n{%- else %}\nwhere not({{ column_name }} {{ expression }})\n{%- endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4001586}, "macro.dbt_utils.test_not_constant": {"unique_id": "macro.dbt_utils.test_not_constant", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/not_constant.sql", "original_file_path": "macros/generic_tests/not_constant.sql", "name": "test_not_constant", "macro_sql": "{% test not_constant(model, column_name) %}\n  {{ return(adapter.dispatch('test_not_constant', 'dbt_utils')(model, column_name)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_constant"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.400939}, "macro.dbt_utils.default__test_not_constant": {"unique_id": "macro.dbt_utils.default__test_not_constant", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/not_constant.sql", "original_file_path": "macros/generic_tests/not_constant.sql", "name": "default__test_not_constant", "macro_sql": "{% macro default__test_not_constant(model, column_name) %}\n\n\nselect\n    {# In TSQL, subquery aggregate columns need aliases #}\n    {# thus: a filler col name, 'filler_column' #}\n    count(distinct {{ column_name }}) as filler_column\n\nfrom {{ model }}\n\nhaving count(distinct {{ column_name }}) = 1\n\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4013555}, "macro.dbt_utils.test_sequential_values": {"unique_id": "macro.dbt_utils.test_sequential_values", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/sequential_values.sql", "original_file_path": "macros/generic_tests/sequential_values.sql", "name": "test_sequential_values", "macro_sql": "{% test sequential_values(model, column_name, interval=1, datepart=None) %}\n\n  {{ return(adapter.dispatch('test_sequential_values', 'dbt_utils')(model, column_name, interval, datepart)) }}\n\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_sequential_values"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4028423}, "macro.dbt_utils.default__test_sequential_values": {"unique_id": "macro.dbt_utils.default__test_sequential_values", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/sequential_values.sql", "original_file_path": "macros/generic_tests/sequential_values.sql", "name": "default__test_sequential_values", "macro_sql": "{% macro default__test_sequential_values(model, column_name, interval=1, datepart=None) %}\n\n{% set previous_column_name = \"previous_\" ~ dbt_utils.slugify(column_name) %}\n\nwith windowed as (\n\n    select\n        {{ column_name }},\n        lag({{ column_name }}) over (\n            order by {{ column_name }}\n        ) as {{ previous_column_name }}\n    from {{ model }}\n),\n\nvalidation_errors as (\n    select\n        *\n    from windowed\n    {% if datepart %}\n    where not(cast({{ column_name }} as {{ type_timestamp() }})= cast({{ dateadd(datepart, interval, previous_column_name) }} as {{ type_timestamp() }}))\n    {% else %}\n    where not({{ column_name }} = {{ previous_column_name }} + {{ interval }})\n    {% endif %}\n)\n\nselect *\nfrom validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.slugify", "macro.dbt_utils.type_timestamp", "macro.dbt_utils.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4042225}, "macro.dbt_utils.test_not_null_proportion": {"unique_id": "macro.dbt_utils.test_not_null_proportion", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/not_null_proportion.sql", "original_file_path": "macros/generic_tests/not_null_proportion.sql", "name": "test_not_null_proportion", "macro_sql": "{% macro test_not_null_proportion(model) %}\n  {{ return(adapter.dispatch('test_not_null_proportion', 'dbt_utils')(model, **kwargs)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_null_proportion"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4052112}, "macro.dbt_utils.default__test_not_null_proportion": {"unique_id": "macro.dbt_utils.default__test_not_null_proportion", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/not_null_proportion.sql", "original_file_path": "macros/generic_tests/not_null_proportion.sql", "name": "default__test_not_null_proportion", "macro_sql": "{% macro default__test_not_null_proportion(model) %}\n\n{% set column_name = kwargs.get('column_name', kwargs.get('arg')) %}\n{% set at_least = kwargs.get('at_least', kwargs.get('arg')) %}\n{% set at_most = kwargs.get('at_most', kwargs.get('arg', 1)) %}\n\nwith validation as (\n  select\n    sum(case when {{ column_name }} is null then 0 else 1 end) / cast(count(*) as numeric) as not_null_proportion\n  from {{ model }}\n),\nvalidation_errors as (\n  select\n    not_null_proportion\n  from validation\n  where not_null_proportion < {{ at_least }} or not_null_proportion > {{ at_most }}\n)\nselect\n  *\nfrom validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.406344}, "macro.dbt_utils.test_at_least_one": {"unique_id": "macro.dbt_utils.test_at_least_one", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/at_least_one.sql", "original_file_path": "macros/generic_tests/at_least_one.sql", "name": "test_at_least_one", "macro_sql": "{% test at_least_one(model, column_name) %}\n  {{ return(adapter.dispatch('test_at_least_one', 'dbt_utils')(model, column_name)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_at_least_one"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4071481}, "macro.dbt_utils.default__test_at_least_one": {"unique_id": "macro.dbt_utils.default__test_at_least_one", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/at_least_one.sql", "original_file_path": "macros/generic_tests/at_least_one.sql", "name": "default__test_at_least_one", "macro_sql": "{% macro default__test_at_least_one(model, column_name) %}\n\nselect *\nfrom (\n    select\n        {# In TSQL, subquery aggregate columns need aliases #}\n        {# thus: a filler col name, 'filler_column' #}\n      count({{ column_name }}) as filler_column\n\n    from {{ model }}\n\n    having count({{ column_name }}) = 0\n\n) validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4075456}, "macro.dbt_utils.test_equality": {"unique_id": "macro.dbt_utils.test_equality", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/equality.sql", "original_file_path": "macros/generic_tests/equality.sql", "name": "test_equality", "macro_sql": "{% test equality(model, compare_model, compare_columns=None) %}\n  {{ return(adapter.dispatch('test_equality', 'dbt_utils')(model, compare_model, compare_columns)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_equality"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.409157}, "macro.dbt_utils.default__test_equality": {"unique_id": "macro.dbt_utils.default__test_equality", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/equality.sql", "original_file_path": "macros/generic_tests/equality.sql", "name": "default__test_equality", "macro_sql": "{% macro default__test_equality(model, compare_model, compare_columns=None) %}\n\n{% set set_diff %}\n    count(*) + coalesce(abs(\n        sum(case when which_diff = 'a_minus_b' then 1 else 0 end) -\n        sum(case when which_diff = 'b_minus_a' then 1 else 0 end)\n    ), 0)\n{% endset %}\n\n{#-- Needs to be set at parse time, before we return '' below --#}\n{{ config(fail_calc = set_diff) }}\n\n{#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n{%- if not execute -%}\n    {{ return('') }}\n{% endif %}\n\n-- setup\n{%- do dbt_utils._is_relation(model, 'test_equality') -%}\n\n{#-\nIf the compare_cols arg is provided, we can run this test without querying the\ninformation schema\u00a0\u2014 this allows the model to be an ephemeral model\n-#}\n\n{%- if not compare_columns -%}\n    {%- do dbt_utils._is_ephemeral(model, 'test_equality') -%}\n    {%- set compare_columns = adapter.get_columns_in_relation(model) | map(attribute='quoted') -%}\n{%- endif -%}\n\n{% set compare_cols_csv = compare_columns | join(', ') %}\n\nwith a as (\n\n    select * from {{ model }}\n\n),\n\nb as (\n\n    select * from {{ compare_model }}\n\n),\n\na_minus_b as (\n\n    select {{compare_cols_csv}} from a\n    {{ except() }}\n    select {{compare_cols_csv}} from b\n\n),\n\nb_minus_a as (\n\n    select {{compare_cols_csv}} from b\n    {{ except() }}\n    select {{compare_cols_csv}} from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.except"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4110582}, "macro.dbt_utils.test_not_null_where": {"unique_id": "macro.dbt_utils.test_not_null_where", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/test_not_null_where.sql", "original_file_path": "macros/generic_tests/test_not_null_where.sql", "name": "test_not_null_where", "macro_sql": "{% test not_null_where(model, column_name) %}\r\n  {%- set deprecation_warning = '\r\n    Warning: `dbt_utils.not_null_where` is no longer supported.\r\n    Starting in dbt v0.20.0, the built-in `not_null` test supports a `where` config.\r\n    ' -%}\r\n  {%- do exceptions.warn(deprecation_warning) -%}\r\n  {{ return(adapter.dispatch('test_not_null_where', 'dbt_utils')(model, column_name)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_null_where"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.412056}, "macro.dbt_utils.default__test_not_null_where": {"unique_id": "macro.dbt_utils.default__test_not_null_where", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/test_not_null_where.sql", "original_file_path": "macros/generic_tests/test_not_null_where.sql", "name": "default__test_not_null_where", "macro_sql": "{% macro default__test_not_null_where(model, column_name) %}\r\n  {{ return(test_not_null(model, column_name)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.test_not_null"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.412429}, "macro.dbt_utils.test_equal_rowcount": {"unique_id": "macro.dbt_utils.test_equal_rowcount", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/equal_rowcount.sql", "original_file_path": "macros/generic_tests/equal_rowcount.sql", "name": "test_equal_rowcount", "macro_sql": "{% test equal_rowcount(model, compare_model) %}\n  {{ return(adapter.dispatch('test_equal_rowcount', 'dbt_utils')(model, compare_model)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_equal_rowcount"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4133384}, "macro.dbt_utils.default__test_equal_rowcount": {"unique_id": "macro.dbt_utils.default__test_equal_rowcount", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/equal_rowcount.sql", "original_file_path": "macros/generic_tests/equal_rowcount.sql", "name": "default__test_equal_rowcount", "macro_sql": "{% macro default__test_equal_rowcount(model, compare_model) %}\n\n{#-- Needs to be set at parse time, before we return '' below --#}\n{{ config(fail_calc = 'coalesce(diff_count, 0)') }}\n\n{#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n{%- if not execute -%}\n    {{ return('') }}\n{% endif %}\n\nwith a as (\n\n    select count(*) as count_a from {{ model }}\n\n),\nb as (\n\n    select count(*) as count_b from {{ compare_model }}\n\n),\nfinal as (\n\n    select\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n    from a\n    cross join b\n\n)\n\nselect * from final\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.414091}, "macro.dbt_utils.test_not_accepted_values": {"unique_id": "macro.dbt_utils.test_not_accepted_values", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/not_accepted_values.sql", "original_file_path": "macros/generic_tests/not_accepted_values.sql", "name": "test_not_accepted_values", "macro_sql": "{% test not_accepted_values(model, column_name, values, quote=True) %}\n  {{ return(adapter.dispatch('test_not_accepted_values', 'dbt_utils')(model, column_name, values, quote)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_accepted_values"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4152472}, "macro.dbt_utils.default__test_not_accepted_values": {"unique_id": "macro.dbt_utils.default__test_not_accepted_values", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/not_accepted_values.sql", "original_file_path": "macros/generic_tests/not_accepted_values.sql", "name": "default__test_not_accepted_values", "macro_sql": "{% macro default__test_not_accepted_values(model, column_name, values, quote=True) %}\nwith all_values as (\n\n    select distinct\n        {{ column_name }} as value_field\n\n    from {{ model }}\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field in (\n        {% for value in values -%}\n            {% if quote -%}\n            '{{ value }}'\n            {%- else -%}\n            {{ value }}\n            {%- endif -%}\n            {%- if not loop.last -%},{%- endif %}\n        {%- endfor %}\n        )\n\n)\n\nselect *\nfrom validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4160838}, "macro.dbt_utils.test_unique_where": {"unique_id": "macro.dbt_utils.test_unique_where", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/test_unique_where.sql", "original_file_path": "macros/generic_tests/test_unique_where.sql", "name": "test_unique_where", "macro_sql": "{% test unique_where(model, column_name) %}\r\n  {%- set deprecation_warning = '\r\n    Warning: `dbt_utils.unique_where` is no longer supported.\r\n    Starting in dbt v0.20.0, the built-in `unique` test supports a `where` config.\r\n    ' -%}\r\n  {%- do exceptions.warn(deprecation_warning) -%}\r\n  {{ return(adapter.dispatch('test_unique_where', 'dbt_utils')(model, column_name)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_unique_where"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4170535}, "macro.dbt_utils.default__test_unique_where": {"unique_id": "macro.dbt_utils.default__test_unique_where", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/test_unique_where.sql", "original_file_path": "macros/generic_tests/test_unique_where.sql", "name": "default__test_unique_where", "macro_sql": "{% macro default__test_unique_where(model, column_name) %}\r\n  {{ return(test_unique(model, column_name)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.test_unique"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4174678}, "macro.dbt_utils.test_mutually_exclusive_ranges": {"unique_id": "macro.dbt_utils.test_mutually_exclusive_ranges", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/mutually_exclusive_ranges.sql", "original_file_path": "macros/generic_tests/mutually_exclusive_ranges.sql", "name": "test_mutually_exclusive_ranges", "macro_sql": "{% test mutually_exclusive_ranges(model, lower_bound_column, upper_bound_column, partition_by=None, gaps='allowed', zero_length_range_allowed=False) %}\n  {{ return(adapter.dispatch('test_mutually_exclusive_ranges', 'dbt_utils')(model, lower_bound_column, upper_bound_column, partition_by, gaps, zero_length_range_allowed)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_mutually_exclusive_ranges"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4227996}, "macro.dbt_utils.default__test_mutually_exclusive_ranges": {"unique_id": "macro.dbt_utils.default__test_mutually_exclusive_ranges", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/mutually_exclusive_ranges.sql", "original_file_path": "macros/generic_tests/mutually_exclusive_ranges.sql", "name": "default__test_mutually_exclusive_ranges", "macro_sql": "{% macro default__test_mutually_exclusive_ranges(model, lower_bound_column, upper_bound_column, partition_by=None, gaps='allowed', zero_length_range_allowed=False) %}\n{% if gaps == 'not_allowed' %}\n    {% set allow_gaps_operator='=' %}\n    {% set allow_gaps_operator_in_words='equal_to' %}\n{% elif gaps == 'allowed' %}\n    {% set allow_gaps_operator='<=' %}\n    {% set allow_gaps_operator_in_words='less_than_or_equal_to' %}\n{% elif gaps == 'required' %}\n    {% set allow_gaps_operator='<' %}\n    {% set allow_gaps_operator_in_words='less_than' %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\n        \"`gaps` argument for mutually_exclusive_ranges test must be one of ['not_allowed', 'allowed', 'required'] Got: '\" ~ gaps ~\"'.'\"\n    ) }}\n{% endif %}\n{% if not zero_length_range_allowed %}\n    {% set allow_zero_length_operator='<' %}\n    {% set allow_zero_length_operator_in_words='less_than' %}\n{% elif zero_length_range_allowed %}\n    {% set allow_zero_length_operator='<=' %}\n    {% set allow_zero_length_operator_in_words='less_than_or_equal_to' %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\n        \"`zero_length_range_allowed` argument for mutually_exclusive_ranges test must be one of [true, false] Got: '\" ~ zero_length_range_allowed ~\"'.'\"\n    ) }}\n{% endif %}\n\n{% set partition_clause=\"partition by \" ~ partition_by if partition_by else '' %}\n\nwith window_functions as (\n\n    select\n        {% if partition_by %}\n        {{ partition_by }} as partition_by_col,\n        {% endif %}\n        {{ lower_bound_column }} as lower_bound,\n        {{ upper_bound_column }} as upper_bound,\n\n        lead({{ lower_bound_column }}) over (\n            {{ partition_clause }}\n            order by {{ lower_bound_column }}, {{ upper_bound_column }}\n        ) as next_lower_bound,\n\n        row_number() over (\n            {{ partition_clause }}\n            order by {{ lower_bound_column }} desc, {{ upper_bound_column }} desc\n        ) = 1 as is_last_record\n\n    from {{ model }}\n\n),\n\ncalc as (\n    -- We want to return records where one of our assumptions fails, so we'll use\n    -- the `not` function with `and` statements so we can write our assumptions nore cleanly\n    select\n        *,\n\n        -- For each record: lower_bound should be < upper_bound.\n        -- Coalesce it to return an error on the null case (implicit assumption\n        -- these columns are not_null)\n        coalesce(\n            lower_bound {{ allow_zero_length_operator }} upper_bound,\n            false\n        ) as lower_bound_{{ allow_zero_length_operator_in_words }}_upper_bound,\n\n        -- For each record: upper_bound {{ allow_gaps_operator }} the next lower_bound.\n        -- Coalesce it to handle null cases for the last record.\n        coalesce(\n            upper_bound {{ allow_gaps_operator }} next_lower_bound,\n            is_last_record,\n            false\n        ) as upper_bound_{{ allow_gaps_operator_in_words }}_next_lower_bound\n\n    from window_functions\n\n),\n\nvalidation_errors as (\n\n    select\n        *\n    from calc\n\n    where not(\n        -- THE FOLLOWING SHOULD BE TRUE --\n        lower_bound_{{ allow_zero_length_operator_in_words }}_upper_bound\n        and upper_bound_{{ allow_gaps_operator_in_words }}_next_lower_bound\n    )\n)\n\nselect * from validation_errors\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4263659}, "macro.dbt_utils.test_relationships_where": {"unique_id": "macro.dbt_utils.test_relationships_where", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/relationships_where.sql", "original_file_path": "macros/generic_tests/relationships_where.sql", "name": "test_relationships_where", "macro_sql": "{% test relationships_where(model, column_name, to, field, from_condition=\"1=1\", to_condition=\"1=1\") %}\n  {{ return(adapter.dispatch('test_relationships_where', 'dbt_utils')(model, column_name, to, field, from_condition, to_condition)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_relationships_where"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4277046}, "macro.dbt_utils.default__test_relationships_where": {"unique_id": "macro.dbt_utils.default__test_relationships_where", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/relationships_where.sql", "original_file_path": "macros/generic_tests/relationships_where.sql", "name": "default__test_relationships_where", "macro_sql": "{% macro default__test_relationships_where(model, column_name, to, field, from_condition=\"1=1\", to_condition=\"1=1\") %}\n\n{# T-SQL has no boolean data type so we use 1=1 which returns TRUE #}\n{# ref https://stackoverflow.com/a/7170753/3842610 #}\n\nwith left_table as (\n\n  select\n    {{column_name}} as id\n\n  from {{model}}\n\n  where {{column_name}} is not null\n    and {{from_condition}}\n\n),\n\nright_table as (\n\n  select\n    {{field}} as id\n\n  from {{to}}\n\n  where {{field}} is not null\n    and {{to_condition}}\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4284441}, "macro.dbt_utils.test_accepted_range": {"unique_id": "macro.dbt_utils.test_accepted_range", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/accepted_range.sql", "original_file_path": "macros/generic_tests/accepted_range.sql", "name": "test_accepted_range", "macro_sql": "{% test accepted_range(model, column_name, min_value=none, max_value=none, inclusive=true) %}\n  {{ return(adapter.dispatch('test_accepted_range', 'dbt_utils')(model, column_name, min_value, max_value, inclusive)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_accepted_range"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4298167}, "macro.dbt_utils.default__test_accepted_range": {"unique_id": "macro.dbt_utils.default__test_accepted_range", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/accepted_range.sql", "original_file_path": "macros/generic_tests/accepted_range.sql", "name": "default__test_accepted_range", "macro_sql": "{% macro default__test_accepted_range(model, column_name, min_value=none, max_value=none, inclusive=true) %}\n\nwith meet_condition as(\n  select *\n  from {{ model }}\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n\n  {%- if min_value is not none %}\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not {{ column_name }} > {{- \"=\" if inclusive }} {{ min_value }}\n  {%- endif %}\n\n  {%- if max_value is not none %}\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not {{ column_name }} < {{- \"=\" if inclusive }} {{ max_value }}\n  {%- endif %}\n)\n\nselect *\nfrom validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4308436}, "macro.dbt_utils.test_fewer_rows_than": {"unique_id": "macro.dbt_utils.test_fewer_rows_than", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/fewer_rows_than.sql", "original_file_path": "macros/generic_tests/fewer_rows_than.sql", "name": "test_fewer_rows_than", "macro_sql": "{% test fewer_rows_than(model, compare_model) %}\n  {{ return(adapter.dispatch('test_fewer_rows_than', 'dbt_utils')(model, compare_model)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_fewer_rows_than"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.431935}, "macro.dbt_utils.default__test_fewer_rows_than": {"unique_id": "macro.dbt_utils.default__test_fewer_rows_than", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/fewer_rows_than.sql", "original_file_path": "macros/generic_tests/fewer_rows_than.sql", "name": "default__test_fewer_rows_than", "macro_sql": "{% macro default__test_fewer_rows_than(model, compare_model) %}\n\n{{ config(fail_calc = 'coalesce(row_count_delta, 0)') }}\n\nwith a as (\n\n    select count(*) as count_our_model from {{ model }}\n\n),\nb as (\n\n    select count(*) as count_comparison_model from {{ compare_model }}\n\n),\ncounts as (\n\n    select\n        count_our_model,\n        count_comparison_model\n    from a\n    cross join b\n\n),\nfinal as (\n\n    select *,\n        case\n            -- fail the test if we have more rows than the reference model and return the row count delta\n            when count_our_model > count_comparison_model then (count_our_model - count_comparison_model)\n            -- fail the test if they are the same number\n            when count_our_model = count_comparison_model then 1\n            -- pass the test if the delta is positive (i.e. return the number 0)\n            else 0\n    end as row_count_delta\n    from counts\n\n)\n\nselect * from final\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4324267}, "macro.dbt_utils.test_unique_combination_of_columns": {"unique_id": "macro.dbt_utils.test_unique_combination_of_columns", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/unique_combination_of_columns.sql", "original_file_path": "macros/generic_tests/unique_combination_of_columns.sql", "name": "test_unique_combination_of_columns", "macro_sql": "{% test unique_combination_of_columns(model, combination_of_columns, quote_columns=false) %}\n  {{ return(adapter.dispatch('test_unique_combination_of_columns', 'dbt_utils')(model, combination_of_columns, quote_columns)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_unique_combination_of_columns"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4337456}, "macro.dbt_utils.default__test_unique_combination_of_columns": {"unique_id": "macro.dbt_utils.default__test_unique_combination_of_columns", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/unique_combination_of_columns.sql", "original_file_path": "macros/generic_tests/unique_combination_of_columns.sql", "name": "default__test_unique_combination_of_columns", "macro_sql": "{% macro default__test_unique_combination_of_columns(model, combination_of_columns, quote_columns=false) %}\n\n{% if not quote_columns %}\n    {%- set column_list=combination_of_columns %}\n{% elif quote_columns %}\n    {%- set column_list=[] %}\n        {% for column in combination_of_columns -%}\n            {% set column_list = column_list.append( adapter.quote(column) ) %}\n        {%- endfor %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\n        \"`quote_columns` argument for unique_combination_of_columns test must be one of [True, False] Got: '\" ~ quote ~\"'.'\"\n    ) }}\n{% endif %}\n\n{%- set columns_csv=column_list | join(', ') %}\n\n\nwith validation_errors as (\n\n    select\n        {{ columns_csv }}\n    from {{ model }}\n    group by {{ columns_csv }}\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.435224}, "macro.dbt_utils.test_recency": {"unique_id": "macro.dbt_utils.test_recency", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/recency.sql", "original_file_path": "macros/generic_tests/recency.sql", "name": "test_recency", "macro_sql": "{% test recency(model, field, datepart, interval) %}\n  {{ return(adapter.dispatch('test_recency', 'dbt_utils')(model, field, datepart, interval)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_recency"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.436161}, "macro.dbt_utils.default__test_recency": {"unique_id": "macro.dbt_utils.default__test_recency", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/recency.sql", "original_file_path": "macros/generic_tests/recency.sql", "name": "default__test_recency", "macro_sql": "{% macro default__test_recency(model, field, datepart, interval) %}\n\n{% set threshold = dateadd(datepart, interval * -1, current_timestamp()) %}\n\nwith recency as (\n\n    select max({{field}}) as most_recent\n    from {{ model }}\n\n)\n\nselect\n\n    most_recent,\n    {{ threshold }} as threshold\n\nfrom recency\nwhere most_recent < {{ threshold }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.dateadd", "macro.dbt_utils.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4368403}, "macro.dbt_utils.test_cardinality_equality": {"unique_id": "macro.dbt_utils.test_cardinality_equality", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/cardinality_equality.sql", "original_file_path": "macros/generic_tests/cardinality_equality.sql", "name": "test_cardinality_equality", "macro_sql": "{% test cardinality_equality(model, column_name, to, field) %}\n    {{ return(adapter.dispatch('test_cardinality_equality', 'dbt_utils')(model, column_name, to, field)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_cardinality_equality"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.437979}, "macro.dbt_utils.default__test_cardinality_equality": {"unique_id": "macro.dbt_utils.default__test_cardinality_equality", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_utils", "path": "macros/generic_tests/cardinality_equality.sql", "original_file_path": "macros/generic_tests/cardinality_equality.sql", "name": "default__test_cardinality_equality", "macro_sql": "{% macro default__test_cardinality_equality(model, column_name, to, field) %}\n\n{# T-SQL does not let you use numbers as aliases for columns #}\n{# Thus, no \"GROUP BY 1\" #}\n\nwith table_a as (\nselect\n  {{ column_name }},\n  count(*) as num_rows\nfrom {{ model }}\ngroup by {{ column_name }}\n),\n\ntable_b as (\nselect\n  {{ field }},\n  count(*) as num_rows\nfrom {{ to }}\ngroup by {{ field }}\n),\n\nexcept_a as (\n  select *\n  from table_a\n  {{ except() }}\n  select *\n  from table_b\n),\n\nexcept_b as (\n  select *\n  from table_b\n  {{ except() }}\n  select *\n  from table_a\n),\n\nunioned as (\n  select *\n  from except_a\n  union all\n  select *\n  from except_b\n)\n\nselect *\nfrom unioned\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.except"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4386806}, "macro.dbt_external_tables.bigquery__get_external_build_plan": {"unique_id": "macro.dbt_external_tables.bigquery__get_external_build_plan", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/bigquery/get_external_build_plan.sql", "original_file_path": "macros/plugins/bigquery/get_external_build_plan.sql", "name": "bigquery__get_external_build_plan", "macro_sql": "{% macro bigquery__get_external_build_plan(source_node) %}\n\n    {% set build_plan = [] %}\n    \n    {% set old_relation = adapter.get_relation(\n        database = source_node.database,\n        schema = source_node.schema,\n        identifier = source_node.identifier\n    ) %}\n    \n    {% set create_or_replace = (old_relation is none or var('ext_full_refresh', false)) %}\n\n    {% if create_or_replace %}\n        {% set build_plan = build_plan + [dbt_external_tables.create_external_table(source_node)] %}\n    {% else %}\n        {% set build_plan = build_plan + dbt_external_tables.refresh_external_table(source_node) %}\n    {% endif %}\n\n    {% do return(build_plan) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.create_external_table", "macro.dbt_external_tables.refresh_external_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4406228}, "macro.dbt_external_tables.bigquery__create_external_table": {"unique_id": "macro.dbt_external_tables.bigquery__create_external_table", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/bigquery/create_external_table.sql", "original_file_path": "macros/plugins/bigquery/create_external_table.sql", "name": "bigquery__create_external_table", "macro_sql": "{% macro bigquery__create_external_table(source_node) %}\n\n    {%- set columns = source_node.columns.values() -%}\n    {%- set external = source_node.external -%}\n    {%- set partitions = external.partitions -%}\n    {%- set options = external.options -%}\n    \n    {%- set uris = [] -%}\n    {%- if options is mapping and options.get('uris', none) -%}\n        {%- set uris = external.options.get('uris') -%}\n    {%- else -%}\n        {%- set uris = [external.location] -%}\n    {%- endif -%}\n\n    create or replace external table {{source(source_node.source_name, source_node.name)}}\n        {%- if columns -%}(\n            {% for column in columns %}\n                {{column.name}} {{column.data_type}} {{- ',' if not loop.last -}}\n            {%- endfor -%}\n        )\n        {% endif %}\n        {% if options and options.get('hive_partition_uri_prefix', none) %}\n        with partition columns {%- if partitions %} (\n            {%- for partition in partitions %}\n                {{partition.name}} {{partition.data_type}}{{',' if not loop.last}}\n            {%- endfor -%}\n        ) {% endif -%}\n        {% endif %}\n        options (\n            uris = [{%- for uri in uris -%} '{{uri}}' {{- \",\" if not loop.last}} {%- endfor -%}]\n            {%- if options is mapping -%}\n            {%- for key, value in options.items() if key != 'uris' %}\n                {%- if value is string -%}\n                , {{key}} = '{{value}}'\n                {%- else -%}\n                , {{key}} = {{value}}\n                {%- endif -%}\n            {%- endfor -%}\n            {%- endif -%}\n        )\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4462209}, "macro.dbt_external_tables.snowflake__refresh_external_table": {"unique_id": "macro.dbt_external_tables.snowflake__refresh_external_table", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/snowflake/refresh_external_table.sql", "original_file_path": "macros/plugins/snowflake/refresh_external_table.sql", "name": "snowflake__refresh_external_table", "macro_sql": "{% macro snowflake__refresh_external_table(source_node) %}\n\n    {% set external = source_node.external %}\n    {% set snowpipe = source_node.external.get('snowpipe', none) %}\n    \n    {% set auto_refresh = external.get('auto_refresh', false) %}\n    {% set partitions = external.get('partitions', none) %}\n    \n    {% set manual_refresh = (partitions and not auto_refresh) %}\n    \n    {% if manual_refresh %}\n\n        {% set ddl %}\n        begin;\n        alter external table {{source(source_node.source_name, source_node.name)}} refresh;\n        commit;\n        {% endset %}\n        \n        {% do return([ddl]) %}\n    \n    {% else %}\n    \n        {% do return([]) %}\n    \n    {% endif %}\n    \n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.448379}, "macro.dbt_external_tables.snowflake__get_external_build_plan": {"unique_id": "macro.dbt_external_tables.snowflake__get_external_build_plan", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/snowflake/get_external_build_plan.sql", "original_file_path": "macros/plugins/snowflake/get_external_build_plan.sql", "name": "snowflake__get_external_build_plan", "macro_sql": "{% macro snowflake__get_external_build_plan(source_node) %}\n\n    {% set build_plan = [] %}\n    \n    {% set old_relation = adapter.get_relation(\n        database = source_node.database,\n        schema = source_node.schema,\n        identifier = source_node.identifier\n    ) %}\n    \n    {% set create_or_replace = (old_relation is none or var('ext_full_refresh', false)) %}\n\n    {% if source_node.external.get('snowpipe', none) is not none %}\n    \n        {% if create_or_replace %}\n            {% set build_plan = build_plan + [\n                dbt_external_tables.snowflake_create_empty_table(source_node),\n                dbt_external_tables.snowflake_get_copy_sql(source_node, explicit_transaction=true),\n                dbt_external_tables.snowflake_create_snowpipe(source_node)\n            ] %}\n        {% else %}\n            {% set build_plan = build_plan + dbt_external_tables.snowflake_refresh_snowpipe(source_node) %}\n        {% endif %}\n            \n    {% else %}\n    \n        {% if create_or_replace %}\n            {% set build_plan = build_plan + [dbt_external_tables.create_external_table(source_node)] %}\n        {% else %}\n            {% set build_plan = build_plan + dbt_external_tables.refresh_external_table(source_node) %}\n        {% endif %}\n        \n    {% endif %}\n\n    {% do return(build_plan) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.snowflake_create_empty_table", "macro.dbt_external_tables.snowflake_get_copy_sql", "macro.dbt_external_tables.snowflake_create_snowpipe", "macro.dbt_external_tables.snowflake_refresh_snowpipe", "macro.dbt_external_tables.create_external_table", "macro.dbt_external_tables.refresh_external_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4517024}, "macro.dbt_external_tables.snowflake__create_external_table": {"unique_id": "macro.dbt_external_tables.snowflake__create_external_table", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/snowflake/create_external_table.sql", "original_file_path": "macros/plugins/snowflake/create_external_table.sql", "name": "snowflake__create_external_table", "macro_sql": "{% macro snowflake__create_external_table(source_node) %}\n\n    {%- set columns = source_node.columns.values() -%}\n    {%- set external = source_node.external -%}\n    {%- set partitions = external.partitions -%}\n\n    {%- set is_csv = dbt_external_tables.is_csv(external.file_format) -%}\n\n{# https://docs.snowflake.net/manuals/sql-reference/sql/create-external-table.html #}\n{# This assumes you have already created an external stage #}\n    create or replace external table {{source(source_node.source_name, source_node.name)}}\n    {%- if columns or partitions -%}\n    (\n        {%- if partitions -%}{%- for partition in partitions %}\n            {{partition.name}} {{partition.data_type}} as {{partition.expression}}{{- ',' if not loop.last or columns|length > 0 -}}\n        {%- endfor -%}{%- endif -%}\n        {%- for column in columns %}\n            {%- set column_quoted = adapter.quote(column.name) if column.quote else column.name %}\n            {%- set col_expression -%}\n                {%- set col_id = 'value:c' ~ loop.index if is_csv else 'value:' ~ column.name -%}\n                (case when is_null_value({{col_id}}) or lower({{col_id}}) = 'null' then null else {{col_id}} end)\n            {%- endset %}\n            {{column_quoted}} {{column.data_type}} as ({{col_expression}}::{{column.data_type}})\n            {{- ',' if not loop.last -}}\n        {% endfor %}\n    )\n    {%- endif -%}\n    {% if partitions %} partition by ({{partitions|map(attribute='name')|join(', ')}}) {% endif %}\n    location = {{external.location}} {# stage #}\n    {% if external.auto_refresh in (true, false) -%}\n      auto_refresh = {{external.auto_refresh}}\n    {%- endif %}\n    {% if external.pattern -%} pattern = '{{external.pattern}}' {%- endif %}\n    {% if external.integration -%} integration = '{{external.integration}}' {%- endif %}\n    file_format = {{external.file_format}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.is_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4566417}, "macro.dbt_external_tables.snowflake_create_snowpipe": {"unique_id": "macro.dbt_external_tables.snowflake_create_snowpipe", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/snowflake/snowpipe/create_snowpipe.sql", "original_file_path": "macros/plugins/snowflake/snowpipe/create_snowpipe.sql", "name": "snowflake_create_snowpipe", "macro_sql": "{% macro snowflake_create_snowpipe(source_node) %}\n\n    {%- set external = source_node.external -%}\n    {%- set snowpipe = external.snowpipe -%}\n\n{# https://docs.snowflake.com/en/sql-reference/sql/create-pipe.html #}\n    create or replace pipe {{source(source_node.source_name, source_node.name)}}\n        {% if snowpipe.auto_ingest -%} auto_ingest = {{snowpipe.auto_ingest}} {%- endif %}\n        {% if snowpipe.aws_sns_topic -%} aws_sns_topic = '{{snowpipe.aws_sns_topic}}' {%- endif %}\n        {% if snowpipe.integration -%} integration = '{{snowpipe.integration}}' {%- endif %}\n        as {{ dbt_external_tables.snowflake_get_copy_sql(source_node) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.snowflake_get_copy_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4582827}, "macro.dbt_external_tables.snowflake_refresh_snowpipe": {"unique_id": "macro.dbt_external_tables.snowflake_refresh_snowpipe", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/snowflake/snowpipe/refresh_snowpipe.sql", "original_file_path": "macros/plugins/snowflake/snowpipe/refresh_snowpipe.sql", "name": "snowflake_refresh_snowpipe", "macro_sql": "{% macro snowflake_refresh_snowpipe(source_node) %}\n\n    {% set snowpipe = source_node.external.snowpipe %}\n    {% set auto_ingest = snowpipe.get('auto_ingest', false) if snowpipe is mapping %}\n    \n    {% if auto_ingest is true %}\n    \n        {% do return([]) %}\n    \n    {% else %}\n    \n        {% set ddl %}\n        alter pipe {{source(source_node.source_name, source_node.name)}} refresh\n        {% endset %}\n        \n        {{ return([ddl]) }}\n    \n    {% endif %}\n    \n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4598675}, "macro.dbt_external_tables.snowflake_create_empty_table": {"unique_id": "macro.dbt_external_tables.snowflake_create_empty_table", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/snowflake/snowpipe/create_empty_table.sql", "original_file_path": "macros/plugins/snowflake/snowpipe/create_empty_table.sql", "name": "snowflake_create_empty_table", "macro_sql": "{% macro snowflake_create_empty_table(source_node) %}\n\n    {%- set columns = source_node.columns.values() %}\n\n    create or replace table {{source(source_node.source_name, source_node.name)}} (\n        {% if columns|length == 0 %}\n            value variant,\n        {% else -%}\n        {%- for column in columns -%}\n            {{column.name}} {{column.data_type}},\n        {% endfor -%}\n        {% endif %}\n            metadata_filename varchar,\n            metadata_file_row_number bigint,\n            _dbt_copied_at timestamp\n    );\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.461299}, "macro.dbt_external_tables.snowflake_get_copy_sql": {"unique_id": "macro.dbt_external_tables.snowflake_get_copy_sql", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/snowflake/snowpipe/get_copy_sql.sql", "original_file_path": "macros/plugins/snowflake/snowpipe/get_copy_sql.sql", "name": "snowflake_get_copy_sql", "macro_sql": "{% macro snowflake_get_copy_sql(source_node, explicit_transaction=false) %}\n{# This assumes you have already created an external stage #}\n\n    {%- set columns = source_node.columns.values() -%}\n    {%- set external = source_node.external -%}\n    {%- set is_csv = dbt_external_tables.is_csv(external.file_format) %}\n    {%- set copy_options = external.snowpipe.get('copy_options', none) -%}\n   \n    {%- if explicit_transaction -%} begin; {%- endif %}\n    \n    copy into {{source(source_node.source_name, source_node.name)}}\n    from ( \n        select\n        {% if columns|length == 0 %}\n            $1::variant as value,\n        {% else -%}\n        {%- for column in columns -%}\n            {%- set col_expression -%}\n                {%- if is_csv -%}nullif(${{loop.index}},''){# special case: get columns by ordinal position #}\n                {%- else -%}nullif($1:{{column.name}},''){# standard behavior: get columns by name #}\n                {%- endif -%}\n            {%- endset -%}\n            {{col_expression}}::{{column.data_type}} as {{column.name}},\n        {% endfor -%}\n        {% endif %}\n            metadata$filename::varchar as metadata_filename,\n            metadata$file_row_number::bigint as metadata_file_row_number,\n            current_timestamp::timestamp as _dbt_copied_at\n        from {{external.location}} {# stage #}\n    )\n    file_format = {{external.file_format}}\n    {% if external.pattern -%} pattern = '{{external.pattern}}' {%- endif %}\n    {% if copy_options %} {{copy_options}} {% endif %};\n    \n    {% if explicit_transaction -%} commit; {%- endif -%}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.is_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4645112}, "macro.dbt_external_tables.is_csv": {"unique_id": "macro.dbt_external_tables.is_csv", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/snowflake/helpers/is_csv.sql", "original_file_path": "macros/plugins/snowflake/helpers/is_csv.sql", "name": "is_csv", "macro_sql": "{% macro is_csv(file_format) %}\n\n{# From https://docs.snowflake.net/manuals/sql-reference/sql/create-external-table.html:\n\nImportant: The external table does not inherit the file format, if any, in the \nstage definition. You must explicitly specify any file format options for the \nexternal table using the FILE_FORMAT parameter.\n\nNote: FORMAT_NAME and TYPE are mutually exclusive; to avoid unintended behavior, \nyou should only specify one or the other when creating an external table.\n\n#}\n\n    {% set ff_ltrimmed = file_format|lower|replace(' ','') %}\n\n    {% if 'type=' in ff_ltrimmed %}\n    \n        {% if 'type=csv' in ff_ltrimmed %}\n\n            {{return(true)}}\n\n        {% else %}\n\n            {{return(false)}}\n            \n        {% endif %}\n        \n    {% else %}\n    \n        {% set ff_standardized = ff_ltrimmed\n            | replace('(','') | replace(')','')\n            | replace('format_name=','') %}\n        {% set fqn = ff_standardized.split('.') %}\n        \n        {% if fqn | length == 3 %}\n            {% set ff_database, ff_schema, ff_identifier = fqn[0], fqn[1], fqn[2] %}\n        {% elif fqn | length == 2 %}\n            {% set ff_database, ff_schema, ff_identifier = target.database, fqn[0], fqn[1] %}\n        {% else %}\n            {% set ff_database, ff_schema, ff_identifier = target.database, target.schema, fqn[0] %}\n        {% endif %}\n    \n        {% call statement('get_file_format', fetch_result = True) %}\n            show file formats in {{ff_database}}.{{ff_schema}}\n        {% endcall %}\n        \n        {% set ffs = load_result('get_file_format').table %}\n        \n        {% for ff in ffs %}\n            \n            {% if ff['name']|lower == ff_identifier and ff['type']|lower == 'csv' %}\n            \n                {{return(true)}}\n            \n            {% endif %}\n        \n        {% endfor %}\n        \n        {{return(false)}}        \n    \n    {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.469875}, "macro.dbt_external_tables.spark__refresh_external_table": {"unique_id": "macro.dbt_external_tables.spark__refresh_external_table", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/spark/refresh_external_table.sql", "original_file_path": "macros/plugins/spark/refresh_external_table.sql", "name": "spark__refresh_external_table", "macro_sql": "{% macro spark__refresh_external_table(source_node) %}\n    \n    {% set refresh %}\n        refresh table {{source(source_node.source_name, source_node.name)}}\n    {% endset %}\n    \n    {% do return([refresh]) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4708512}, "macro.dbt_external_tables.spark__get_external_build_plan": {"unique_id": "macro.dbt_external_tables.spark__get_external_build_plan", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/spark/get_external_build_plan.sql", "original_file_path": "macros/plugins/spark/get_external_build_plan.sql", "name": "spark__get_external_build_plan", "macro_sql": "{% macro spark__get_external_build_plan(source_node) %}\n\n    {% set build_plan = [] %}\n\n    {% set old_relation = adapter.get_relation(\n        database = none,\n        schema = source_node.schema,\n        identifier = source_node.identifier\n    ) %}\n\n    {% set create_or_replace = (old_relation is none or var('ext_full_refresh', false)) %}\n\n    {% if create_or_replace %}\n        {% set build_plan = build_plan + [\n            dbt_external_tables.dropif(source_node), \n            dbt_external_tables.create_external_table(source_node)\n        ] %}\n    {% else %}\n        {% set build_plan = build_plan + dbt_external_tables.refresh_external_table(source_node) %}\n    {% endif %}\n\n    {% set recover_partitions = spark__recover_partitions(source_node) %}\n    {% if recover_partitions|length > 0 %}\n    {% set build_plan = build_plan + [\n        recover_partitions\n    ] %}\n    {% endif %}\n\n    {% do return(build_plan) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.dropif", "macro.dbt_external_tables.create_external_table", "macro.dbt_external_tables.refresh_external_table", "macro.dbt_external_tables.spark__recover_partitions"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4733052}, "macro.dbt_external_tables.spark__create_external_table": {"unique_id": "macro.dbt_external_tables.spark__create_external_table", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/spark/create_external_table.sql", "original_file_path": "macros/plugins/spark/create_external_table.sql", "name": "spark__create_external_table", "macro_sql": "{% macro spark__create_external_table(source_node) %}\n\n    {%- set columns = source_node.columns.values() -%}\n    {%- set external = source_node.external -%}\n    {%- set partitions = external.partitions -%}\n    {%- set options = external.options -%}\n\n{# https://spark.apache.org/docs/latest/sql-data-sources-hive-tables.html #}\n    create table {{source(source_node.source_name, source_node.name)}} \n    {%- if columns|length > 0 %} (\n        {% for column in columns %}\n            {{column.name}} {{column.data_type}}\n            {{- ',' if not loop.last -}}\n        {% endfor %}\n    ) {% endif -%}\n    {% if external.using %} using {{external.using}} {%- endif %}\n    {% if options -%} options (\n        {%- for key, value in options.items() -%}\n            '{{ key }}' = '{{value}}' {{- ', \\n' if not loop.last -}}\n        {%- endfor -%}\n    ) {%- endif %}\n    {% if partitions -%} partitioned by (\n        {%- for partition in partitions -%}\n            {{partition.name}} {{partition.data_type}}{{', ' if not loop.last}}\n        {%- endfor -%}\n    ) {%- endif %}\n    {% if external.row_format -%} row format {{external.row_format}} {%- endif %}\n    {% if external.file_format -%} stored as {{external.file_format}} {%- endif %}\n    {% if external.location -%} location '{{external.location}}' {%- endif %}\n    {% if external.table_properties -%} tblproperties {{ external.table_properties }} {%- endif -%}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.47762}, "macro.dbt_external_tables.spark__recover_partitions": {"unique_id": "macro.dbt_external_tables.spark__recover_partitions", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/spark/helpers/recover_partitions.sql", "original_file_path": "macros/plugins/spark/helpers/recover_partitions.sql", "name": "spark__recover_partitions", "macro_sql": "{% macro spark__recover_partitions(source_node) %}\n    {# https://docs.databricks.com/sql/language-manual/sql-ref-syntax-ddl-alter-table.html #}\n\n    {% set ddl %}\n    {%- if source_node.external.partitions and source_node.external.using and source_node.external.using|lower != 'delta' -%}\n        ALTER TABLE {{ source(source_node.source_name, source_node.name) }} RECOVER PARTITIONS\n    {%- endif -%}\n    {% endset %}\n\n    {{return(ddl)}}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.478782}, "macro.dbt_external_tables.spark__dropif": {"unique_id": "macro.dbt_external_tables.spark__dropif", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/spark/helpers/dropif.sql", "original_file_path": "macros/plugins/spark/helpers/dropif.sql", "name": "spark__dropif", "macro_sql": "{% macro spark__dropif(node) %}\n    \n    {% set ddl %}\n        drop table if exists {{source(node.source_name, node.name)}}\n    {% endset %}\n    \n    {{return(ddl)}}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4795513}, "macro.dbt_external_tables.redshift__refresh_external_table": {"unique_id": "macro.dbt_external_tables.redshift__refresh_external_table", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/redshift/refresh_external_table.sql", "original_file_path": "macros/plugins/redshift/refresh_external_table.sql", "name": "redshift__refresh_external_table", "macro_sql": "{% macro redshift__refresh_external_table(source_node) %}\n\n    {%- set partitions = source_node.external.get('partitions',[]) -%}\n\n    {%- if partitions -%}\n    \n        {%- set part_len = partitions|length -%}\n    \n        {%- set get_partitions_sql -%}\n        \n        select * from\n        \n        {%- for partition in partitions %} (\n        \n            {%- set part_num = loop.index -%}\n            \n            {%- if partition.vals.macro -%}\n                {%- set vals = dbt_external_tables.render_from_context(partition.vals.macro, **partition.vals.args) -%}\n            {%- elif partition.vals is string -%}\n                {%- set vals = [partition.vals] -%}\n            {%- else -%}\n                {%- set vals = partition.vals -%}\n            {%- endif -%}\n        \n            {%- for val in vals %}\n            \n                select\n                    '\"{{ partition.name }}\"' as name_{{ part_num }},\n                    '\"{{ val }}\"' as val_{{ part_num }},\n                    '\"{{ dbt_external_tables.render_from_context(partition.path_macro, partition.name, val) }}\"' as path_{{ part_num }}\n                \n                {{ 'union all' if not loop.last else ') ' }}\n            \n            {%- endfor -%}\n            \n            {{ 'cross join' if not loop.last }}\n            \n        {%- endfor -%}\n        \n        {%- endset -%}\n        \n        {%- set finals = [] -%}\n        \n        {%- if execute -%}\n            {%- set results = run_query(get_partitions_sql) -%}\n            {%- for row in results -%}\n                \n                {%- set partition_parts = [] -%}\n                {%- set path_parts = [] -%}\n                \n                {%- for i in range(0, part_len) -%}\n                    {%- do partition_parts.append({\n                        'name': row[i * 3][1:-1],\n                        'value': row[i * 3 + 1][1:-1]\n                    }) -%}\n                    {%- do path_parts.append(row[i * 3 + 2][1:-1]) -%}\n                {%- endfor -%}\n                \n                {%- set construct = {\n                    'partition_by': partition_parts,\n                    'path': path_parts | join('/')\n                }  -%}\n                \n                {% do finals.append(construct) %}\n            {%- endfor -%}\n        {%- endif -%}\n    \n        {%- set ddl = dbt_external_tables.redshift_alter_table_add_partitions(source_node, finals) -%}\n        {{ return(ddl) }}\n    \n    {% else %}\n    \n        {% do return([]) %}\n    \n    {% endif %}\n    \n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.render_from_context", "macro.dbt.run_query", "macro.dbt_external_tables.redshift_alter_table_add_partitions"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.488533}, "macro.dbt_external_tables.redshift__get_external_build_plan": {"unique_id": "macro.dbt_external_tables.redshift__get_external_build_plan", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/redshift/get_external_build_plan.sql", "original_file_path": "macros/plugins/redshift/get_external_build_plan.sql", "name": "redshift__get_external_build_plan", "macro_sql": "{% macro redshift__get_external_build_plan(source_node) %}\n\n    {% set build_plan = [] %}\n    \n    {% set create_or_replace = (var('ext_full_refresh', false) or not redshift_is_ext_tbl(source_node)) %}\n    \n    {% if create_or_replace %}\n\n        {% set build_plan = [\n                dbt_external_tables.dropif(source_node),\n                dbt_external_tables.create_external_table(source_node)\n            ] + dbt_external_tables.refresh_external_table(source_node) \n        %}\n        \n    {% else %}\n    \n        {% set build_plan = dbt_external_tables.refresh_external_table(source_node) %}\n        \n    {% endif %}\n    \n    {% do return(build_plan) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.redshift_is_ext_tbl", "macro.dbt_external_tables.dropif", "macro.dbt_external_tables.create_external_table", "macro.dbt_external_tables.refresh_external_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4903133}, "macro.dbt_external_tables.redshift__create_external_table": {"unique_id": "macro.dbt_external_tables.redshift__create_external_table", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/redshift/create_external_table.sql", "original_file_path": "macros/plugins/redshift/create_external_table.sql", "name": "redshift__create_external_table", "macro_sql": "{% macro redshift__create_external_table(source_node) %}\n\n    {%- set columns = source_node.columns.values() -%}\n    {%- set external = source_node.external -%}\n    {%- set partitions = external.partitions -%}\n\n{# https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE.html #}\n{# This assumes you have already created an external schema #}\n\n    create external table {{source(source_node.source_name, source_node.name)}} (\n        {% for column in columns %}\n            {{adapter.quote(column.name)}} {{column.data_type}}\n            {{- ',' if not loop.last -}}\n        {% endfor %}\n    )\n    {% if partitions -%} partitioned by (\n        {%- for partition in partitions -%}\n            {{adapter.quote(partition.name)}} {{partition.data_type}}{{', ' if not loop.last}}\n        {%- endfor -%}\n    ) {%- endif %}\n    {% if external.row_format -%} row format {{external.row_format}} {%- endif %}\n    {% if external.file_format -%} stored as {{external.file_format}} {%- endif %}\n    {% if external.location -%} location '{{external.location}}' {%- endif %}\n    {% if external.table_properties -%} table properties {{external.table_properties}} {%- endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4935062}, "macro.dbt_external_tables.redshift__exit_transaction": {"unique_id": "macro.dbt_external_tables.redshift__exit_transaction", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/redshift/helpers/transaction.sql", "original_file_path": "macros/plugins/redshift/helpers/transaction.sql", "name": "redshift__exit_transaction", "macro_sql": "{% macro redshift__exit_transaction() %}\n    {{ return('begin; commit;') }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.494011}, "macro.dbt_external_tables.redshift__dropif": {"unique_id": "macro.dbt_external_tables.redshift__dropif", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/redshift/helpers/dropif.sql", "original_file_path": "macros/plugins/redshift/helpers/dropif.sql", "name": "redshift__dropif", "macro_sql": "{% macro redshift__dropif(node) %}\n    \n    {% set ddl %}\n        drop table if exists {{source(node.source_name, node.name)}} cascade\n    {% endset %}\n    \n    {{return(ddl)}}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4947803}, "macro.dbt_external_tables.year_month_day": {"unique_id": "macro.dbt_external_tables.year_month_day", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/redshift/helpers/paths.sql", "original_file_path": "macros/plugins/redshift/helpers/paths.sql", "name": "year_month_day", "macro_sql": "{% macro year_month_day(name, value) %}\n    {% set path = value.replace('-','/') %}\n    {{return(path)}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.replace"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4956095}, "macro.dbt_external_tables.key_value": {"unique_id": "macro.dbt_external_tables.key_value", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/redshift/helpers/paths.sql", "original_file_path": "macros/plugins/redshift/helpers/paths.sql", "name": "key_value", "macro_sql": "{% macro key_value(name, value) %}\n    {% set path = name ~ '=' ~ value %}\n    {{return(path)}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4960504}, "macro.dbt_external_tables.value_only": {"unique_id": "macro.dbt_external_tables.value_only", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/redshift/helpers/paths.sql", "original_file_path": "macros/plugins/redshift/helpers/paths.sql", "name": "value_only", "macro_sql": "{% macro value_only(name, value) %}\n    {% set path = value %}\n    {{return(path)}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.4965255}, "macro.dbt_external_tables.redshift_alter_table_add_partitions": {"unique_id": "macro.dbt_external_tables.redshift_alter_table_add_partitions", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/redshift/helpers/add_partitions.sql", "original_file_path": "macros/plugins/redshift/helpers/add_partitions.sql", "name": "redshift_alter_table_add_partitions", "macro_sql": "{% macro redshift_alter_table_add_partitions(source_node, partitions) %}\n\n  {{ log(\"Generating ADD PARTITION statement for partition set between \" \n         ~ partitions[0]['path'] ~ \" and \" ~ (partitions|last)['path']) }}\n\n  {% set ddl = [] %}\n  \n  {% if partitions|length > 0 %}\n  \n    {% set alter_table_add %}\n        alter table {{source(source_node.source_name, source_node.name)}} add if not exists \n    {% endset %}\n  \n    {%- set alters -%}\n\n      {{ alter_table_add }}\n\n    {%- for partition in partitions -%}\n\n      {%- if loop.index0 != 0 and loop.index0 % 100 == 0 -%}\n\n        ; {{ alter_table_add }}\n\n      {%- endif -%}\n\n        partition ({%- for part in partition.partition_by -%}{{ part.name }}='{{ part.value }}'{{', ' if not loop.last}}{%- endfor -%})\n        location '{{ source_node.external.location }}/{{ partition.path }}/'\n\n    {% endfor -%}\n    \n    {%- endset -%}\n    \n    {% set ddl = ddl + alters.split(';') %}\n\n  {% else %}\n\n    {{ log(\"No partitions to be added\") }}\n\n  {% endif %}\n  \n  {% do return(ddl) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.499934}, "macro.dbt_external_tables.redshift_is_ext_tbl": {"unique_id": "macro.dbt_external_tables.redshift_is_ext_tbl", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/redshift/helpers/is_ext_tbl.sql", "original_file_path": "macros/plugins/redshift/helpers/is_ext_tbl.sql", "name": "redshift_is_ext_tbl", "macro_sql": "{% macro redshift_is_ext_tbl(node) %}\n\n    {% set existing_relation = load_relation(node) %}\n    \n    {#  external tables don't appear in information_schema.tables,\n        so dbt doesn't cache them #}\n    {% if existing_relation is none %}\n\n        {% set find_ext_tbl %}\n        \n            select count(*) from svv_external_tables\n            where schemaname = '{{node.schema}}'\n            and tablename = '{{node.identifier}}'\n        \n        {% endset %}\n        \n        {% if execute %}\n            {% set result = run_query(find_ext_tbl)[0][0] %}\n        {% else %}\n            {% set result = 0 %}\n        {% endif %}\n\n        {% set is_ext_tbl = (result > 0) %}\n        {% do return(is_ext_tbl) %}\n        \n    {% else %}\n    \n        {% do return(false) %}\n        \n    {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.load_relation", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5021813}, "macro.dbt_external_tables.render_from_context": {"unique_id": "macro.dbt_external_tables.render_from_context", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/redshift/helpers/render_macro.sql", "original_file_path": "macros/plugins/redshift/helpers/render_macro.sql", "name": "render_from_context", "macro_sql": "{% macro render_from_context(name) -%}\n{% set original_name = name %}\n  {% if '.' in name %}\n    {% set package_name, name = name.split(\".\", 1) %}\n  {% else %}\n    {% set package_name = none %}\n  {% endif %}\n\n  {% if package_name is none %}\n    {% set package_context = context %}\n  {% elif package_name in context %}\n    {% set package_context = context[package_name] %}\n  {% else %}\n    {% set error_msg %}\n        Could not find package '{{package_name}}', called by macro '{{original_name}}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n  \n    {{ return(package_context[name](*varargs, **kwargs)) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5044749}, "macro.dbt_external_tables.sqlserver__get_external_build_plan": {"unique_id": "macro.dbt_external_tables.sqlserver__get_external_build_plan", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/sqlserver/get_external_build_plan.sql", "original_file_path": "macros/plugins/sqlserver/get_external_build_plan.sql", "name": "sqlserver__get_external_build_plan", "macro_sql": "{% macro sqlserver__get_external_build_plan(source_node) %}\n\n    {% set build_plan = [] %}\n\n    {% set old_relation = adapter.get_relation(\n        database = source_node.database,\n        schema = source_node.schema,\n        identifier = source_node.identifier\n    ) %}\n\n    {% set create_or_replace = (old_relation is none or var('ext_full_refresh', false)) %}\n\n    {% if create_or_replace %}\n        {% set build_plan = build_plan + [ \n            dbt_external_tables.dropif(source_node), \n            dbt_external_tables.create_external_table(source_node)\n        ] %}\n    {% else %}\n        {% set build_plan = build_plan + dbt_external_tables.refresh_external_table(source_node) %}\n    {% endif %}\n    {% do return(build_plan) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.dropif", "macro.dbt_external_tables.create_external_table", "macro.dbt_external_tables.refresh_external_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5064461}, "macro.dbt_external_tables.sqlserver__create_external_table": {"unique_id": "macro.dbt_external_tables.sqlserver__create_external_table", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/sqlserver/create_external_table.sql", "original_file_path": "macros/plugins/sqlserver/create_external_table.sql", "name": "sqlserver__create_external_table", "macro_sql": "{% macro sqlserver__create_external_table(source_node) %}\n\n    {%- set columns = source_node.columns.values() -%}\n    {%- set external = source_node.external -%}\n\n    {% if external.ansi_nulls is true -%} SET ANSI_NULLS ON; {%- endif %}\n    {% if external.quoted_identifier is true -%} SET QUOTED_IDENTIFIER ON; {%- endif %}\n\n    create external table {{source(source_node.source_name, source_node.name)}} (\n        {% for column in columns %}\n            {# TODO set nullity based on schema tests?? #}\n            {%- set nullity = 'NOT NULL' if 'not_null' in columns.tests else 'NULL'-%}\n            {{adapter.quote(column.name)}} {{column.data_type}} {{nullity}}\n            {{- ',' if not loop.last -}}\n        {% endfor %}\n    )\n    WITH (\n        {# remove keys that are None (i.e. not defined for a given source) #}\n        {%- for key, value in external.items() if value is not none and key not in ['ansi_nulls', 'quoted_identifier'] -%}\n            {{key}} = \n                {%- if key in [\"location\", \"schema_name\", \"object_name\"] -%}\n                    '{{value}}'\n                {% elif key in [\"data_source\",\"file_format\"] -%}\n                    [{{value}}]\n                {% else -%}\n                    {{value}}\n                {%- endif -%}\n            {{- ',' if not loop.last -}}\n            {%- endfor -%}\n    )\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5098329}, "macro.dbt_external_tables.sqlserver__dropif": {"unique_id": "macro.dbt_external_tables.sqlserver__dropif", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/plugins/sqlserver/helpers/dropif.sql", "original_file_path": "macros/plugins/sqlserver/helpers/dropif.sql", "name": "sqlserver__dropif", "macro_sql": "{% macro sqlserver__dropif(node) %}\n    \n    {% set ddl %}\n      if object_id ('{{source(node.source_name, node.name)}}') is not null\n        begin\n        drop external table {{source(node.source_name, node.name)}}\n        end\n    {% endset %}\n    \n    {{return(ddl)}}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5108144}, "macro.dbt_external_tables.refresh_external_table": {"unique_id": "macro.dbt_external_tables.refresh_external_table", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/common/refresh_external_table.sql", "original_file_path": "macros/common/refresh_external_table.sql", "name": "refresh_external_table", "macro_sql": "{% macro refresh_external_table(source_node) %}\n    {{ return(adapter.dispatch('refresh_external_table', 'dbt_external_tables')(source_node)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.acton_marketing_data.default__refresh_external_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5114837}, "macro.dbt_external_tables.default__refresh_external_table": {"unique_id": "macro.dbt_external_tables.default__refresh_external_table", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/common/refresh_external_table.sql", "original_file_path": "macros/common/refresh_external_table.sql", "name": "default__refresh_external_table", "macro_sql": "{% macro default__refresh_external_table(source_node) %}\n    {% do return([]) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5118783}, "macro.dbt_external_tables.get_external_build_plan": {"unique_id": "macro.dbt_external_tables.get_external_build_plan", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/common/get_external_build_plan.sql", "original_file_path": "macros/common/get_external_build_plan.sql", "name": "get_external_build_plan", "macro_sql": "{% macro get_external_build_plan(source_node) %}\n    {{ return(adapter.dispatch('get_external_build_plan', 'dbt_external_tables')(source_node)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.acton_marketing_data.default__get_external_build_plan"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5125825}, "macro.dbt_external_tables.default__get_external_build_plan": {"unique_id": "macro.dbt_external_tables.default__get_external_build_plan", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/common/get_external_build_plan.sql", "original_file_path": "macros/common/get_external_build_plan.sql", "name": "default__get_external_build_plan", "macro_sql": "{% macro default__get_external_build_plan(source_node) %}\n    {{ exceptions.raise_compiler_error(\"Staging external sources is not implemented for the default adapter\") }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5128913}, "macro.dbt_external_tables.create_external_table": {"unique_id": "macro.dbt_external_tables.create_external_table", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/common/create_external_table.sql", "original_file_path": "macros/common/create_external_table.sql", "name": "create_external_table", "macro_sql": "{% macro create_external_table(source_node) %}\n    {{ adapter.dispatch('create_external_table', 'dbt_external_tables')(source_node) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.acton_marketing_data.default__create_external_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5135896}, "macro.dbt_external_tables.default__create_external_table": {"unique_id": "macro.dbt_external_tables.default__create_external_table", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/common/create_external_table.sql", "original_file_path": "macros/common/create_external_table.sql", "name": "default__create_external_table", "macro_sql": "{% macro default__create_external_table(source_node) %}\n    {{ exceptions.raise_compiler_error(\"External table creation is not implemented for the default adapter\") }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.513897}, "macro.dbt_external_tables.stage_external_sources": {"unique_id": "macro.dbt_external_tables.stage_external_sources", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/common/stage_external_sources.sql", "original_file_path": "macros/common/stage_external_sources.sql", "name": "stage_external_sources", "macro_sql": "{% macro stage_external_sources(select=none) %}\n\n    {% set sources_to_stage = [] %}\n    \n    {% set source_nodes = graph.sources.values() if graph.sources else [] %}\n    \n    {% for node in source_nodes %}\n        {% if node.external %}\n            \n            {% if select %}\n            \n                {% for src in select.split(' ') %}\n                \n                    {% if '.' in src %}\n                        {% set src_s = src.split('.') %}\n                        {% if src_s[0] == node.source_name and src_s[1] == node.name %}\n                            {% do sources_to_stage.append(node) %}\n                        {% endif %}\n                    {% else %}\n                        {% if src == node.source_name %}\n                            {% do sources_to_stage.append(node) %}\n                        {% endif %}\n                    {% endif %}\n                    \n                {% endfor %}\n                        \n            {% else %}\n            \n                {% do sources_to_stage.append(node) %}\n                \n            {% endif %}\n        {% endif %}\n        \n    {% endfor %}\n    \n    {% if sources_to_stage|length == 0 %}\n        {% do log('No external sources selected', info = true) %}\n    {% endif %}\n            \n    {% for node in sources_to_stage %}\n\n        {% set loop_label = loop.index ~ ' of ' ~ loop.length %}\n\n        {% do log(loop_label ~ ' START external source ' ~ node.schema ~ '.' ~ node.identifier, info = true) -%}\n        \n        {% set run_queue = dbt_external_tables.get_external_build_plan(node) %}\n        \n        {% do log(loop_label ~ ' SKIP', info = true) if run_queue == [] %}\n        {% set width = flags.PRINTER_WIDTH %}\n        \n        {% for q in run_queue %}\n        \n            {% set q_msg = q|replace('\\n','')|replace('begin;','')|trim %}\n            {% set q_log = q_msg[:width] ~ '...  ' if q_msg|length > width else q_msg %}\n        \n            {% do log(loop_label ~ ' (' ~ loop.index ~ ') ' ~ q_log, info = true) %}\n            {% set exit_txn = dbt_external_tables.exit_transaction() %}\n        \n            {% call statement('runner', fetch_result = True, auto_begin = False) %}\n                {{ exit_txn }} {{ q }}\n            {% endcall %}\n            \n            {% set runner = load_result('runner') %}\n            {% set log_msg = runner['response'] if 'response' in runner.keys() else runner['status'] %}\n            {% do log(loop_label ~ ' (' ~ loop.index ~ ') ' ~ log_msg, info = true) %}\n            \n        {% endfor %}\n        \n    {% endfor %}\n    \n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.get_external_build_plan", "macro.dbt_external_tables.exit_transaction", "macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.523854}, "macro.dbt_external_tables.exit_transaction": {"unique_id": "macro.dbt_external_tables.exit_transaction", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/common/helpers/transaction.sql", "original_file_path": "macros/common/helpers/transaction.sql", "name": "exit_transaction", "macro_sql": "{% macro exit_transaction() %}\n    {{ return(adapter.dispatch('exit_transaction', 'dbt_external_tables')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.default__exit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5245411}, "macro.dbt_external_tables.default__exit_transaction": {"unique_id": "macro.dbt_external_tables.default__exit_transaction", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/common/helpers/transaction.sql", "original_file_path": "macros/common/helpers/transaction.sql", "name": "default__exit_transaction", "macro_sql": "{% macro default__exit_transaction() %}\n    {{ return('') }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.524808}, "macro.dbt_external_tables.dropif": {"unique_id": "macro.dbt_external_tables.dropif", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/common/helpers/dropif.sql", "original_file_path": "macros/common/helpers/dropif.sql", "name": "dropif", "macro_sql": "{% macro dropif(node) %}\n    {{ adapter.dispatch('dropif', 'dbt_external_tables')(node) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.default__dropif"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5255}, "macro.dbt_external_tables.default__dropif": {"unique_id": "macro.dbt_external_tables.default__dropif", "package_name": "dbt_external_tables", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_external_tables", "path": "macros/common/helpers/dropif.sql", "original_file_path": "macros/common/helpers/dropif.sql", "name": "default__dropif", "macro_sql": "{% macro default__dropif() %}\n    {{ exceptions.raise_compiler_error(\n        \"Dropping external tables is not implemented for the default adapter\"\n    ) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5257971}, "macro.dbt_date.get_date_dimension": {"unique_id": "macro.dbt_date.get_date_dimension", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/get_date_dimension.sql", "original_file_path": "macros/get_date_dimension.sql", "name": "get_date_dimension", "macro_sql": "{% macro get_date_dimension(start_date, end_date) %}\n    {{ adapter.dispatch('get_date_dimension', 'dbt_date') (start_date, end_date) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.postgres__get_date_dimension"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5389376}, "macro.dbt_date.default__get_date_dimension": {"unique_id": "macro.dbt_date.default__get_date_dimension", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/get_date_dimension.sql", "original_file_path": "macros/get_date_dimension.sql", "name": "default__get_date_dimension", "macro_sql": "{% macro default__get_date_dimension(start_date, end_date) %}\nwith base_dates as (\n    {{ dbt_date.get_base_dates(start_date, end_date) }}\n),\ndates_with_prior_year_dates as (\n\n    select\n        cast(d.date_day as date) as date_day,\n        cast({{ dateadd('year', -1 , 'd.date_day') }} as date) as prior_year_date_day,\n        cast({{ dateadd('day', -364 , 'd.date_day') }} as date) as prior_year_over_year_date_day\n    from\n    \tbase_dates d\n\n)\nselect\n    d.date_day,\n    {{ dbt_date.yesterday('d.date_day') }} as prior_date_day,\n    {{ dbt_date.tomorrow('d.date_day') }} as next_date_day,\n    d.prior_year_date_day as prior_year_date_day,\n    d.prior_year_over_year_date_day,\n    {{ dbt_date.day_of_week('d.date_day', isoweek=false) }} as day_of_week,\n    {{ dbt_date.day_of_week('d.date_day', isoweek=true) }} as day_of_week_iso,\n    {{ dbt_date.day_name('d.date_day', short=false) }} as day_of_week_name,\n    {{ dbt_date.day_name('d.date_day', short=true) }} as day_of_week_name_short,\n    {{ dbt_date.day_of_month('d.date_day') }} as day_of_month,\n    {{ dbt_date.day_of_year('d.date_day') }} as day_of_year,\n\n    {{ dbt_date.week_start('d.date_day') }} as week_start_date,\n    {{ dbt_date.week_end('d.date_day') }} as week_end_date,\n    {{ dbt_date.week_start('d.prior_year_over_year_date_day') }} as prior_year_week_start_date,\n    {{ dbt_date.week_end('d.prior_year_over_year_date_day') }} as prior_year_week_end_date,\n    {{ dbt_date.week_of_year('d.date_day') }} as week_of_year,\n\n    {{ dbt_date.iso_week_start('d.date_day') }} as iso_week_start_date,\n    {{ dbt_date.iso_week_end('d.date_day') }} as iso_week_end_date,\n    {{ dbt_date.iso_week_start('d.prior_year_over_year_date_day') }} as prior_year_iso_week_start_date,\n    {{ dbt_date.iso_week_end('d.prior_year_over_year_date_day') }} as prior_year_iso_week_end_date,\n    {{ dbt_date.iso_week_of_year('d.date_day') }} as iso_week_of_year,\n\n    {{ dbt_date.week_of_year('d.prior_year_over_year_date_day') }} as prior_year_week_of_year,\n    {{ dbt_date.iso_week_of_year('d.prior_year_over_year_date_day') }} as prior_year_iso_week_of_year,\n\n    cast({{ dbt_date.date_part('month', 'd.date_day') }} as {{ type_int() }}) as month_of_year,\n    {{ dbt_date.month_name('d.date_day', short=false) }}  as month_name,\n    {{ dbt_date.month_name('d.date_day', short=true) }}  as month_name_short,\n\n    cast({{ date_trunc('month', 'd.date_day') }} as date) as month_start_date,\n    cast({{ last_day('d.date_day', 'month') }} as date) as month_end_date,\n\n    cast({{ date_trunc('month', 'd.prior_year_date_day') }} as date) as prior_year_month_start_date,\n    cast({{ last_day('d.prior_year_date_day', 'month') }} as date) as prior_year_month_end_date,\n\n    cast({{ dbt_date.date_part('quarter', 'd.date_day') }} as {{ type_int() }}) as quarter_of_year,\n    cast({{ date_trunc('quarter', 'd.date_day') }} as date) as quarter_start_date,\n    cast({{ last_day('d.date_day', 'quarter') }} as date) as quarter_end_date,\n\n    cast({{ dbt_date.date_part('year', 'd.date_day') }} as {{ type_int() }}) as year_number,\n    cast({{ date_trunc('year', 'd.date_day') }} as date) as year_start_date,\n    cast({{ last_day('d.date_day', 'year') }} as date) as year_end_date\nfrom\n    dates_with_prior_year_dates d\norder by 1\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.get_base_dates", "macro.dbt_utils.dateadd", "macro.dbt_date.yesterday", "macro.dbt_date.tomorrow", "macro.dbt_date.day_of_week", "macro.dbt_date.day_name", "macro.dbt_date.day_of_month", "macro.dbt_date.day_of_year", "macro.dbt_date.week_start", "macro.dbt_date.week_end", "macro.dbt_date.week_of_year", "macro.dbt_date.iso_week_start", "macro.dbt_date.iso_week_end", "macro.dbt_date.iso_week_of_year", "macro.dbt_date.date_part", "macro.dbt_utils.type_int", "macro.dbt_date.month_name", "macro.dbt_utils.date_trunc", "macro.dbt_utils.last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5436113}, "macro.dbt_date.postgres__get_date_dimension": {"unique_id": "macro.dbt_date.postgres__get_date_dimension", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/get_date_dimension.sql", "original_file_path": "macros/get_date_dimension.sql", "name": "postgres__get_date_dimension", "macro_sql": "{% macro postgres__get_date_dimension(start_date, end_date) %}\nwith base_dates as (\n    {{ dbt_date.get_base_dates(start_date, end_date) }}\n),\ndates_with_prior_year_dates as (\n\n    select\n        cast(d.date_day as date) as date_day,\n        cast({{ dateadd('year', -1 , 'd.date_day') }} as date) as prior_year_date_day,\n        cast({{ dateadd('day', -364 , 'd.date_day') }} as date) as prior_year_over_year_date_day\n    from\n    \tbase_dates d\n\n)\nselect\n    d.date_day,\n    {{ dbt_date.yesterday('d.date_day') }} as prior_date_day,\n    {{ dbt_date.tomorrow('d.date_day') }} as next_date_day,\n    d.prior_year_date_day as prior_year_date_day,\n    d.prior_year_over_year_date_day,\n    {{ dbt_date.day_of_week('d.date_day', isoweek=true) }} as day_of_week,\n\n    {{ dbt_date.day_name('d.date_day', short=false) }} as day_of_week_name,\n    {{ dbt_date.day_name('d.date_day', short=true) }} as day_of_week_name_short,\n    {{ dbt_date.day_of_month('d.date_day') }} as day_of_month,\n    {{ dbt_date.day_of_year('d.date_day') }} as day_of_year,\n\n    {{ dbt_date.week_start('d.date_day') }} as week_start_date,\n    {{ dbt_date.week_end('d.date_day') }} as week_end_date,\n    {{ dbt_date.week_start('d.prior_year_over_year_date_day') }} as prior_year_week_start_date,\n    {{ dbt_date.week_end('d.prior_year_over_year_date_day') }} as prior_year_week_end_date,\n    {{ dbt_date.week_of_year('d.date_day') }} as week_of_year,\n\n    {{ dbt_date.iso_week_start('d.date_day') }} as iso_week_start_date,\n    {{ dbt_date.iso_week_end('d.date_day') }} as iso_week_end_date,\n    {{ dbt_date.iso_week_start('d.prior_year_over_year_date_day') }} as prior_year_iso_week_start_date,\n    {{ dbt_date.iso_week_end('d.prior_year_over_year_date_day') }} as prior_year_iso_week_end_date,\n    {{ dbt_date.iso_week_of_year('d.date_day') }} as iso_week_of_year,\n\n    {{ dbt_date.week_of_year('d.prior_year_over_year_date_day') }} as prior_year_week_of_year,\n    {{ dbt_date.iso_week_of_year('d.prior_year_over_year_date_day') }} as prior_year_iso_week_of_year,\n\n    cast({{ dbt_date.date_part('month', 'd.date_day') }} as {{ type_int() }}) as month_of_year,\n    {{ dbt_date.month_name('d.date_day', short=false) }}  as month_name,\n    {{ dbt_date.month_name('d.date_day', short=true) }}  as month_name_short,\n\n    cast({{ date_trunc('month', 'd.date_day') }} as date) as month_start_date,\n    cast({{ last_day('d.date_day', 'month') }} as date) as month_end_date,\n\n    cast({{ date_trunc('month', 'd.prior_year_date_day') }} as date) as prior_year_month_start_date,\n    cast({{ last_day('d.prior_year_date_day', 'month') }} as date) as prior_year_month_end_date,\n\n    cast({{ dbt_date.date_part('quarter', 'd.date_day') }} as {{ type_int() }}) as quarter_of_year,\n    cast({{ date_trunc('quarter', 'd.date_day') }} as date) as quarter_start_date,\n    {# last_day does not support quarter because postgresql does not support quarter interval. #}\n    cast({{dateadd('day', '-1', dateadd('month', '3', date_trunc('quarter', 'd.date_day')))}} as date) as quarter_end_date,\n\n    cast({{ dbt_date.date_part('year', 'd.date_day') }} as {{ type_int() }}) as year_number,\n    cast({{ date_trunc('year', 'd.date_day') }} as date) as year_start_date,\n    cast({{ last_day('d.date_day', 'year') }} as date) as year_end_date\nfrom\n    dates_with_prior_year_dates d\norder by 1\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.get_base_dates", "macro.dbt_utils.dateadd", "macro.dbt_date.yesterday", "macro.dbt_date.tomorrow", "macro.dbt_date.day_of_week", "macro.dbt_date.day_name", "macro.dbt_date.day_of_month", "macro.dbt_date.day_of_year", "macro.dbt_date.week_start", "macro.dbt_date.week_end", "macro.dbt_date.week_of_year", "macro.dbt_date.iso_week_start", "macro.dbt_date.iso_week_end", "macro.dbt_date.iso_week_of_year", "macro.dbt_date.date_part", "macro.dbt_utils.type_int", "macro.dbt_date.month_name", "macro.dbt_utils.date_trunc", "macro.dbt_utils.last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5485063}, "macro.dbt_date.get_base_dates": {"unique_id": "macro.dbt_date.get_base_dates", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/get_base_dates.sql", "original_file_path": "macros/get_base_dates.sql", "name": "get_base_dates", "macro_sql": "{% macro get_base_dates(start_date=None, end_date=None, n_dateparts=None, datepart=\"day\") %}\n    {{ adapter.dispatch('get_base_dates', 'dbt_date') (start_date, end_date, n_dateparts, datepart) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__get_base_dates"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5504303}, "macro.dbt_date.default__get_base_dates": {"unique_id": "macro.dbt_date.default__get_base_dates", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/get_base_dates.sql", "original_file_path": "macros/get_base_dates.sql", "name": "default__get_base_dates", "macro_sql": "{% macro default__get_base_dates(start_date, end_date, n_dateparts, datepart) %}\n\n{%- if start_date and end_date -%}\n{%- set start_date=\"cast('\" ~ start_date ~ \"' as \" ~ type_timestamp() ~ \")\" -%}\n{%- set end_date=\"cast('\" ~ end_date ~ \"' as \" ~ type_timestamp() ~ \")\"  -%}\n\n{%- elif n_dateparts and datepart -%}\n\n{%- set start_date = dateadd(datepart, -1 * n_dateparts, dbt_date.today()) -%}\n{%- set end_date = dbt_date.tomorrow() -%}\n{%- endif -%}\n\nwith date_spine as\n(\n\n    {{ dbt_utils.date_spine(\n        datepart=datepart,\n        start_date=start_date,\n        end_date=end_date,\n       )\n    }}\n\n)\nselect\n    cast(d.date_{{ datepart }} as {{ type_timestamp() }}) as date_{{ datepart }}\nfrom\n    date_spine d\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp", "macro.dbt_utils.dateadd", "macro.dbt_date.today", "macro.dbt_date.tomorrow", "macro.dbt_utils.date_spine"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5519602}, "macro.dbt_date.bigquery__get_base_dates": {"unique_id": "macro.dbt_date.bigquery__get_base_dates", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/get_base_dates.sql", "original_file_path": "macros/get_base_dates.sql", "name": "bigquery__get_base_dates", "macro_sql": "{% macro bigquery__get_base_dates(start_date, end_date, n_dateparts, datepart) %}\n\n{%- if start_date and end_date -%}\n{%- set start_date=\"cast('\" ~ start_date ~ \"' as date )\" -%}\n{%- set end_date=\"cast('\" ~ end_date ~ \"' as date )\" -%}\n\n{%- elif n_dateparts and datepart -%}\n\n{%- set start_date = dateadd(datepart, -1 * n_dateparts, dbt_date.today()) -%}\n{%- set end_date = dbt_date.tomorrow() -%}\n{%- endif -%}\n\nwith date_spine as\n(\n\n    {{ dbt_utils.date_spine(\n        datepart=datepart,\n        start_date=start_date,\n        end_date=end_date,\n       )\n    }}\n\n)\nselect\n    cast(d.date_{{ datepart }} as {{ type_timestamp() }}) as date_{{ datepart }}\nfrom\n    date_spine d\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.dateadd", "macro.dbt_date.today", "macro.dbt_date.tomorrow", "macro.dbt_utils.date_spine", "macro.dbt_utils.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5535026}, "macro.dbt_date.week_end": {"unique_id": "macro.dbt_date.week_end", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/week_end.sql", "original_file_path": "macros/calendar_date/week_end.sql", "name": "week_end", "macro_sql": "{%- macro week_end(date=None, tz=None) -%}\n{%-set dt = date if date else dbt_date.today(tz) -%}\n{{ adapter.dispatch('week_end', 'dbt_date') (dt) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.postgres__week_end"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5545785}, "macro.dbt_date.default__week_end": {"unique_id": "macro.dbt_date.default__week_end", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/week_end.sql", "original_file_path": "macros/calendar_date/week_end.sql", "name": "default__week_end", "macro_sql": "{%- macro default__week_end(date) -%}\n{{ last_day(date, 'week') }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.554883}, "macro.dbt_date.snowflake__week_end": {"unique_id": "macro.dbt_date.snowflake__week_end", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/week_end.sql", "original_file_path": "macros/calendar_date/week_end.sql", "name": "snowflake__week_end", "macro_sql": "\n\n{%- macro snowflake__week_end(date) -%}\n{%- set dt = dbt_date.week_start(date) -%}\n{{ dbt_date.n_days_away(6, dt) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.week_start", "macro.dbt_date.n_days_away"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5553236}, "macro.dbt_date.postgres__week_end": {"unique_id": "macro.dbt_date.postgres__week_end", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/week_end.sql", "original_file_path": "macros/calendar_date/week_end.sql", "name": "postgres__week_end", "macro_sql": "\n\n{%- macro postgres__week_end(date) -%}\n{%- set dt = dbt_date.week_start(date) -%}\n{{ dbt_date.n_days_away(6, dt) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.week_start", "macro.dbt_date.n_days_away"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5557647}, "macro.dbt_date.n_weeks_ago": {"unique_id": "macro.dbt_date.n_weeks_ago", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/n_weeks_ago.sql", "original_file_path": "macros/calendar_date/n_weeks_ago.sql", "name": "n_weeks_ago", "macro_sql": "{%- macro n_weeks_ago(n, tz=None) -%}\n{%- set n = n|int -%}\n{{ date_trunc('week',\n    dateadd('week', -1 * n,\n        dbt_date.today(tz)\n        )\n    ) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.date_trunc", "macro.dbt_utils.dateadd", "macro.dbt_date.today"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.556635}, "macro.dbt_date.day_of_year": {"unique_id": "macro.dbt_date.day_of_year", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_of_year.sql", "original_file_path": "macros/calendar_date/day_of_year.sql", "name": "day_of_year", "macro_sql": "{%- macro day_of_year(date) -%}\n{{ adapter.dispatch('day_of_year', 'dbt_date') (date) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.postgres__day_of_year"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.557417}, "macro.dbt_date.default__day_of_year": {"unique_id": "macro.dbt_date.default__day_of_year", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_of_year.sql", "original_file_path": "macros/calendar_date/day_of_year.sql", "name": "default__day_of_year", "macro_sql": "\n\n{%- macro default__day_of_year(date) -%}\n    {{ dbt_date.date_part('dayofyear', date) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.557754}, "macro.dbt_date.postgres__day_of_year": {"unique_id": "macro.dbt_date.postgres__day_of_year", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_of_year.sql", "original_file_path": "macros/calendar_date/day_of_year.sql", "name": "postgres__day_of_year", "macro_sql": "\n\n{%- macro postgres__day_of_year(date) -%}\n    {{ dbt_date.date_part('doy', date) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5581596}, "macro.dbt_date.redshift__day_of_year": {"unique_id": "macro.dbt_date.redshift__day_of_year", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_of_year.sql", "original_file_path": "macros/calendar_date/day_of_year.sql", "name": "redshift__day_of_year", "macro_sql": "\n\n{%- macro redshift__day_of_year(date) -%}\n    cast({{ dbt_date.date_part('dayofyear', date) }} as {{ type_bigint() }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt_utils.type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5585573}, "macro.dbt_date.to_unixtimestamp": {"unique_id": "macro.dbt_date.to_unixtimestamp", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/to_unixtimestamp.sql", "original_file_path": "macros/calendar_date/to_unixtimestamp.sql", "name": "to_unixtimestamp", "macro_sql": "{%- macro to_unixtimestamp(timestamp) -%}\n    {{ adapter.dispatch('to_unixtimestamp', 'dbt_date') (timestamp) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__to_unixtimestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.559302}, "macro.dbt_date.default__to_unixtimestamp": {"unique_id": "macro.dbt_date.default__to_unixtimestamp", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/to_unixtimestamp.sql", "original_file_path": "macros/calendar_date/to_unixtimestamp.sql", "name": "default__to_unixtimestamp", "macro_sql": "\n\n{%- macro default__to_unixtimestamp(timestamp) -%}\n    {{ dbt_date.date_part('epoch', timestamp) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5596194}, "macro.dbt_date.snowflake__to_unixtimestamp": {"unique_id": "macro.dbt_date.snowflake__to_unixtimestamp", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/to_unixtimestamp.sql", "original_file_path": "macros/calendar_date/to_unixtimestamp.sql", "name": "snowflake__to_unixtimestamp", "macro_sql": "\n\n{%- macro snowflake__to_unixtimestamp(timestamp) -%}\n    {{ dbt_date.date_part('epoch_seconds', timestamp) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5599277}, "macro.dbt_date.bigquery__to_unixtimestamp": {"unique_id": "macro.dbt_date.bigquery__to_unixtimestamp", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/to_unixtimestamp.sql", "original_file_path": "macros/calendar_date/to_unixtimestamp.sql", "name": "bigquery__to_unixtimestamp", "macro_sql": "\n\n{%- macro bigquery__to_unixtimestamp(timestamp) -%}\n    unix_seconds({{ timestamp }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.560162}, "macro.dbt_date.next_week": {"unique_id": "macro.dbt_date.next_week", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/next_week.sql", "original_file_path": "macros/calendar_date/next_week.sql", "name": "next_week", "macro_sql": "{%- macro next_week(tz=None) -%}\n{{ dbt_date.n_weeks_away(1, tz) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.n_weeks_away"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5606835}, "macro.dbt_date.yesterday": {"unique_id": "macro.dbt_date.yesterday", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/yesterday.sql", "original_file_path": "macros/calendar_date/yesterday.sql", "name": "yesterday", "macro_sql": "{%- macro yesterday(date=None, tz=None) -%}\n{{ dbt_date.n_days_ago(1, date, tz) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.n_days_ago"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5612895}, "macro.dbt_date.iso_week_of_year": {"unique_id": "macro.dbt_date.iso_week_of_year", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/iso_week_of_year.sql", "original_file_path": "macros/calendar_date/iso_week_of_year.sql", "name": "iso_week_of_year", "macro_sql": "{%- macro iso_week_of_year(date=None, tz=None) -%}\n{%-set dt = date if date else dbt_date.today(tz) -%}\n{{ adapter.dispatch('iso_week_of_year', 'dbt_date') (dt) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.postgres__iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5624578}, "macro.dbt_date._iso_week_of_year": {"unique_id": "macro.dbt_date._iso_week_of_year", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/iso_week_of_year.sql", "original_file_path": "macros/calendar_date/iso_week_of_year.sql", "name": "_iso_week_of_year", "macro_sql": "{%- macro _iso_week_of_year(date, week_type) -%}\ncast({{ dbt_date.date_part(week_type, date) }} as {{ type_int() }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt_utils.type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.563516}, "macro.dbt_date.default__iso_week_of_year": {"unique_id": "macro.dbt_date.default__iso_week_of_year", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/iso_week_of_year.sql", "original_file_path": "macros/calendar_date/iso_week_of_year.sql", "name": "default__iso_week_of_year", "macro_sql": "\n\n{%- macro default__iso_week_of_year(date) -%}\n{{ dbt_date._iso_week_of_year(date, 'isoweek') }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5638454}, "macro.dbt_date.snowflake__iso_week_of_year": {"unique_id": "macro.dbt_date.snowflake__iso_week_of_year", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/iso_week_of_year.sql", "original_file_path": "macros/calendar_date/iso_week_of_year.sql", "name": "snowflake__iso_week_of_year", "macro_sql": "\n\n{%- macro snowflake__iso_week_of_year(date) -%}\n{{ dbt_date._iso_week_of_year(date, 'weekiso') }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5641525}, "macro.dbt_date.postgres__iso_week_of_year": {"unique_id": "macro.dbt_date.postgres__iso_week_of_year", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/iso_week_of_year.sql", "original_file_path": "macros/calendar_date/iso_week_of_year.sql", "name": "postgres__iso_week_of_year", "macro_sql": "\n\n{%- macro postgres__iso_week_of_year(date) -%}\n-- postgresql week is isoweek, the first week of a year containing January 4 of that year.\n{{ dbt_date._iso_week_of_year(date, 'week') }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5644736}, "macro.dbt_date.month_name": {"unique_id": "macro.dbt_date.month_name", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/month_name.sql", "original_file_path": "macros/calendar_date/month_name.sql", "name": "month_name", "macro_sql": "{%- macro month_name(date, short=True) -%}\n    {{ adapter.dispatch('month_name', 'dbt_date') (date, short) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.postgres__month_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5655499}, "macro.dbt_date.default__month_name": {"unique_id": "macro.dbt_date.default__month_name", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/month_name.sql", "original_file_path": "macros/calendar_date/month_name.sql", "name": "default__month_name", "macro_sql": "\n\n{%- macro default__month_name(date, short) -%}\n{%- set f = 'MON' if short else 'MONTH' -%}\n    to_char({{ date }}, '{{ f }}')\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5660048}, "macro.dbt_date.bigquery__month_name": {"unique_id": "macro.dbt_date.bigquery__month_name", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/month_name.sql", "original_file_path": "macros/calendar_date/month_name.sql", "name": "bigquery__month_name", "macro_sql": "\n\n{%- macro bigquery__month_name(date, short) -%}\n{%- set f = '%b' if short else '%B' -%}\n    format_date('{{ f }}', cast({{ date }} as date))\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5664487}, "macro.dbt_date.snowflake__month_name": {"unique_id": "macro.dbt_date.snowflake__month_name", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/month_name.sql", "original_file_path": "macros/calendar_date/month_name.sql", "name": "snowflake__month_name", "macro_sql": "\n\n{%- macro snowflake__month_name(date, short) -%}\n{%- set f = 'MON' if short else 'MMMM' -%}\n    to_char({{ date }}, '{{ f }}')\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5668917}, "macro.dbt_date.postgres__month_name": {"unique_id": "macro.dbt_date.postgres__month_name", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/month_name.sql", "original_file_path": "macros/calendar_date/month_name.sql", "name": "postgres__month_name", "macro_sql": "\n\n{%- macro postgres__month_name(date, short) -%}\n{# FM = Fill mode, which suppresses padding blanks #}\n{%- set f = 'FMMon' if short else 'FMMonth' -%}\n    to_char({{ date }}, '{{ f }}')\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.567345}, "macro.dbt_date.day_name": {"unique_id": "macro.dbt_date.day_name", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_name.sql", "original_file_path": "macros/calendar_date/day_name.sql", "name": "day_name", "macro_sql": "{%- macro day_name(date, short=True) -%}\n    {{ adapter.dispatch('day_name', 'dbt_date') (date, short) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.postgres__day_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.568701}, "macro.dbt_date.default__day_name": {"unique_id": "macro.dbt_date.default__day_name", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_name.sql", "original_file_path": "macros/calendar_date/day_name.sql", "name": "default__day_name", "macro_sql": "\n\n{%- macro default__day_name(date, short) -%}\n{%- set f = 'Dy' if short else 'Day' -%}\n    to_char({{ date }}, '{{ f }}')\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5691788}, "macro.dbt_date.snowflake__day_name": {"unique_id": "macro.dbt_date.snowflake__day_name", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_name.sql", "original_file_path": "macros/calendar_date/day_name.sql", "name": "snowflake__day_name", "macro_sql": "\n\n{%- macro snowflake__day_name(date, short) -%}\n    {%- if short -%}\n    dayname({{ date }})\n    {%- else -%}\n    -- long version not implemented on Snowflake so we're doing it manually :/\n    case dayname({{ date }})\n        when 'Mon' then 'Monday'\n        when 'Tue' then 'Tuesday'\n        when 'Wed' then 'Wednesday'\n        when 'Thu' then 'Thursday'\n        when 'Fri' then 'Friday'\n        when 'Sat' then 'Saturday'\n        when 'Sun' then 'Sunday'\n    end\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5696561}, "macro.dbt_date.bigquery__day_name": {"unique_id": "macro.dbt_date.bigquery__day_name", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_name.sql", "original_file_path": "macros/calendar_date/day_name.sql", "name": "bigquery__day_name", "macro_sql": "\n\n{%- macro bigquery__day_name(date, short) -%}\n{%- set f = '%a' if short else '%A' -%}\n    format_date('{{ f }}', cast({{ date }} as date))\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5700982}, "macro.dbt_date.postgres__day_name": {"unique_id": "macro.dbt_date.postgres__day_name", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_name.sql", "original_file_path": "macros/calendar_date/day_name.sql", "name": "postgres__day_name", "macro_sql": "\n\n{%- macro postgres__day_name(date, short) -%}\n{# FM = Fill mode, which suppresses padding blanks #}\n{%- set f = 'FMDy' if short else 'FMDay' -%}\n    to_char({{ date }}, '{{ f }}')\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.570548}, "macro.dbt_date.next_month_name": {"unique_id": "macro.dbt_date.next_month_name", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/next_month_name.sql", "original_file_path": "macros/calendar_date/next_month_name.sql", "name": "next_month_name", "macro_sql": "{%- macro next_month_name(short=True, tz=None) -%}\n{{ dbt_date.month_name(dbt_date.next_month(1, tz), short=short) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.month_name", "macro.dbt_date.next_month"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5712337}, "macro.dbt_date.date_part": {"unique_id": "macro.dbt_date.date_part", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/date_part.sql", "original_file_path": "macros/calendar_date/date_part.sql", "name": "date_part", "macro_sql": "{% macro date_part(datepart, date) -%}\n    {{ adapter.dispatch('date_part', 'dbt_date') (datepart, date) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__date_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5719686}, "macro.dbt_date.default__date_part": {"unique_id": "macro.dbt_date.default__date_part", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/date_part.sql", "original_file_path": "macros/calendar_date/date_part.sql", "name": "default__date_part", "macro_sql": "{% macro default__date_part(datepart, date) -%}\n    date_part('{{ datepart }}', {{  date }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5722716}, "macro.dbt_date.bigquery__date_part": {"unique_id": "macro.dbt_date.bigquery__date_part", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/date_part.sql", "original_file_path": "macros/calendar_date/date_part.sql", "name": "bigquery__date_part", "macro_sql": "{% macro bigquery__date_part(datepart, date) -%}\n    extract({{ datepart }} from {{ date }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5725656}, "macro.dbt_date.n_days_ago": {"unique_id": "macro.dbt_date.n_days_ago", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/n_days_ago.sql", "original_file_path": "macros/calendar_date/n_days_ago.sql", "name": "n_days_ago", "macro_sql": "{%- macro n_days_ago(n, date=None, tz=None) -%}\n{%-set dt = date if date else dbt_date.today(tz) -%}\n{%- set n = n|int -%}\ncast({{ dateadd('day', -1 * n, dt) }} as date)\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_utils.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5736523}, "macro.dbt_date.now": {"unique_id": "macro.dbt_date.now", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/now.sql", "original_file_path": "macros/calendar_date/now.sql", "name": "now", "macro_sql": "{%- macro now(tz=None) -%}\n{{ dbt_date.convert_timezone(dbt_date.current_timestamp(), tz) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.convert_timezone", "macro.dbt_date.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5744362}, "macro.dbt_date.current_timestamp": {"unique_id": "macro.dbt_date.current_timestamp", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/now.sql", "original_file_path": "macros/calendar_date/now.sql", "name": "current_timestamp", "macro_sql": "{% macro current_timestamp() -%}\n  {{ return(adapter.dispatch('current_timestamp', 'dbt_date')()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5748005}, "macro.dbt_date.default__current_timestamp": {"unique_id": "macro.dbt_date.default__current_timestamp", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/now.sql", "original_file_path": "macros/calendar_date/now.sql", "name": "default__current_timestamp", "macro_sql": "{% macro default__current_timestamp() %}\n    current_timestamp::{{ type_timestamp() }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5750475}, "macro.dbt_date.redshift__current_timestamp": {"unique_id": "macro.dbt_date.redshift__current_timestamp", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/now.sql", "original_file_path": "macros/calendar_date/now.sql", "name": "redshift__current_timestamp", "macro_sql": "{% macro redshift__current_timestamp() %}\n    getdate()\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5752192}, "macro.dbt_date.bigquery__current_timestamp": {"unique_id": "macro.dbt_date.bigquery__current_timestamp", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/now.sql", "original_file_path": "macros/calendar_date/now.sql", "name": "bigquery__current_timestamp", "macro_sql": "{% macro bigquery__current_timestamp() %}\n    current_timestamp\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.575385}, "macro.dbt_date.next_month": {"unique_id": "macro.dbt_date.next_month", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/next_month.sql", "original_file_path": "macros/calendar_date/next_month.sql", "name": "next_month", "macro_sql": "{%- macro next_month(tz=None) -%}\n{{ dbt_date.n_months_away(1, tz) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.n_months_away"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5760722}, "macro.dbt_date.iso_week_end": {"unique_id": "macro.dbt_date.iso_week_end", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/iso_week_end.sql", "original_file_path": "macros/calendar_date/iso_week_end.sql", "name": "iso_week_end", "macro_sql": "{%- macro iso_week_end(date=None, tz=None) -%}\n{%-set dt = date if date else dbt_date.today(tz) -%}\n{{ adapter.dispatch('iso_week_end', 'dbt_date') (dt) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.default__iso_week_end"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.577132}, "macro.dbt_date._iso_week_end": {"unique_id": "macro.dbt_date._iso_week_end", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/iso_week_end.sql", "original_file_path": "macros/calendar_date/iso_week_end.sql", "name": "_iso_week_end", "macro_sql": "{%- macro _iso_week_end(date, week_type) -%}\n{%- set dt = dbt_date.iso_week_start(date) -%}\n{{ dbt_date.n_days_away(6, dt) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.iso_week_start", "macro.dbt_date.n_days_away"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5776174}, "macro.dbt_date.default__iso_week_end": {"unique_id": "macro.dbt_date.default__iso_week_end", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/iso_week_end.sql", "original_file_path": "macros/calendar_date/iso_week_end.sql", "name": "default__iso_week_end", "macro_sql": "\n\n{%- macro default__iso_week_end(date) -%}\n{{ dbt_date._iso_week_end(date, 'isoweek') }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_end"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5779362}, "macro.dbt_date.snowflake__iso_week_end": {"unique_id": "macro.dbt_date.snowflake__iso_week_end", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/iso_week_end.sql", "original_file_path": "macros/calendar_date/iso_week_end.sql", "name": "snowflake__iso_week_end", "macro_sql": "\n\n{%- macro snowflake__iso_week_end(date) -%}\n{{ dbt_date._iso_week_end(date, 'weekiso') }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_end"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.578247}, "macro.dbt_date.n_months_ago": {"unique_id": "macro.dbt_date.n_months_ago", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/n_months_ago.sql", "original_file_path": "macros/calendar_date/n_months_ago.sql", "name": "n_months_ago", "macro_sql": "{%- macro n_months_ago(n, tz=None) -%}\n{%- set n = n|int -%}\n{{ date_trunc('month',\n    dateadd('month', -1 * n,\n        dbt_date.today(tz)\n        )\n    ) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.date_trunc", "macro.dbt_utils.dateadd", "macro.dbt_date.today"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5792115}, "macro.dbt_date.next_month_number": {"unique_id": "macro.dbt_date.next_month_number", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/next_month_number.sql", "original_file_path": "macros/calendar_date/next_month_number.sql", "name": "next_month_number", "macro_sql": "{%- macro next_month_number(tz=None) -%}\n{{ dbt_date.date_part('month', dbt_date.next_month(1, tz)) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt_date.next_month"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5798507}, "macro.dbt_date.week_of_year": {"unique_id": "macro.dbt_date.week_of_year", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/week_of_year.sql", "original_file_path": "macros/calendar_date/week_of_year.sql", "name": "week_of_year", "macro_sql": "{%- macro week_of_year(date=None, tz=None) -%}\n{%-set dt = date if date else dbt_date.today(tz) -%}\n{{ adapter.dispatch('week_of_year', 'dbt_date') (dt) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.postgres__week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5808086}, "macro.dbt_date.default__week_of_year": {"unique_id": "macro.dbt_date.default__week_of_year", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/week_of_year.sql", "original_file_path": "macros/calendar_date/week_of_year.sql", "name": "default__week_of_year", "macro_sql": "{%- macro default__week_of_year(date) -%}\ncast({{ dbt_date.date_part('week', date) }} as {{ type_int() }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt_utils.type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5812292}, "macro.dbt_date.postgres__week_of_year": {"unique_id": "macro.dbt_date.postgres__week_of_year", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/week_of_year.sql", "original_file_path": "macros/calendar_date/week_of_year.sql", "name": "postgres__week_of_year", "macro_sql": "\n\n{%- macro postgres__week_of_year(date) -%}\n{# postgresql 'week' returns isoweek. Use to_char instead.\n   WW = the first week starts on the first day of the year #}\ncast(to_char({{ date }}, 'WW') as {{ type_int() }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5815575}, "macro.dbt_date.iso_week_start": {"unique_id": "macro.dbt_date.iso_week_start", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/iso_week_start.sql", "original_file_path": "macros/calendar_date/iso_week_start.sql", "name": "iso_week_start", "macro_sql": "{%- macro iso_week_start(date=None, tz=None) -%}\n{%-set dt = date if date else dbt_date.today(tz) -%}\n{{ adapter.dispatch('iso_week_start', 'dbt_date') (dt) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.postgres__iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5826464}, "macro.dbt_date._iso_week_start": {"unique_id": "macro.dbt_date._iso_week_start", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/iso_week_start.sql", "original_file_path": "macros/calendar_date/iso_week_start.sql", "name": "_iso_week_start", "macro_sql": "{%- macro _iso_week_start(date, week_type) -%}\ncast({{ date_trunc(week_type, date) }} as date)\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.582985}, "macro.dbt_date.default__iso_week_start": {"unique_id": "macro.dbt_date.default__iso_week_start", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/iso_week_start.sql", "original_file_path": "macros/calendar_date/iso_week_start.sql", "name": "default__iso_week_start", "macro_sql": "\n\n{%- macro default__iso_week_start(date) -%}\n{{ dbt_date._iso_week_start(date, 'isoweek') }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5832953}, "macro.dbt_date.snowflake__iso_week_start": {"unique_id": "macro.dbt_date.snowflake__iso_week_start", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/iso_week_start.sql", "original_file_path": "macros/calendar_date/iso_week_start.sql", "name": "snowflake__iso_week_start", "macro_sql": "\n\n{%- macro snowflake__iso_week_start(date) -%}\n{{ dbt_date._iso_week_start(date, 'week') }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5836027}, "macro.dbt_date.postgres__iso_week_start": {"unique_id": "macro.dbt_date.postgres__iso_week_start", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/iso_week_start.sql", "original_file_path": "macros/calendar_date/iso_week_start.sql", "name": "postgres__iso_week_start", "macro_sql": "\n\n{%- macro postgres__iso_week_start(date) -%}\n{{ dbt_date._iso_week_start(date, 'week') }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5839937}, "macro.dbt_date.from_unixtimestamp": {"unique_id": "macro.dbt_date.from_unixtimestamp", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/from_unixtimestamp.sql", "original_file_path": "macros/calendar_date/from_unixtimestamp.sql", "name": "from_unixtimestamp", "macro_sql": "{%- macro from_unixtimestamp(epochs, format=\"seconds\") -%}\n    {{ adapter.dispatch('from_unixtimestamp', 'dbt_date') (epochs, format) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.postgres__from_unixtimestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5863583}, "macro.dbt_date.default__from_unixtimestamp": {"unique_id": "macro.dbt_date.default__from_unixtimestamp", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/from_unixtimestamp.sql", "original_file_path": "macros/calendar_date/from_unixtimestamp.sql", "name": "default__from_unixtimestamp", "macro_sql": "\n\n{%- macro default__from_unixtimestamp(epochs, format=\"seconds\") -%}\n    {%- if format != \"seconds\" -%}\n    {{ exceptions.raise_compiler_error(\n        \"value \" ~ format ~ \" for `format` for from_unixtimestamp is not supported.\"\n        )\n    }}\n    {% endif -%}\n    to_timestamp({{ epochs }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.586932}, "macro.dbt_date.postgres__from_unixtimestamp": {"unique_id": "macro.dbt_date.postgres__from_unixtimestamp", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/from_unixtimestamp.sql", "original_file_path": "macros/calendar_date/from_unixtimestamp.sql", "name": "postgres__from_unixtimestamp", "macro_sql": "\n\n{%- macro postgres__from_unixtimestamp(epochs, format=\"seconds\") -%}\n    {%- if format != \"seconds\" -%}\n    {{ exceptions.raise_compiler_error(\n        \"value \" ~ format ~ \" for `format` for from_unixtimestamp is not supported.\"\n        )\n    }}\n    {% endif -%}\n    cast(to_timestamp({{ epochs }}) at time zone 'UTC' as timestamp)\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5874941}, "macro.dbt_date.snowflake__from_unixtimestamp": {"unique_id": "macro.dbt_date.snowflake__from_unixtimestamp", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/from_unixtimestamp.sql", "original_file_path": "macros/calendar_date/from_unixtimestamp.sql", "name": "snowflake__from_unixtimestamp", "macro_sql": "\n\n{%- macro snowflake__from_unixtimestamp(epochs, format) -%}\n    {%- if format == \"seconds\" -%}\n    {%- set scale = 0 -%}\n    {%- elif format == \"milliseconds\" -%}\n    {%- set scale = 3 -%}\n    {%- elif format == \"microseconds\" -%}\n    {%- set scale = 6 -%}\n    {%- else -%}\n    {{ exceptions.raise_compiler_error(\n        \"value \" ~ format ~ \" for `format` for from_unixtimestamp is not supported.\"\n        )\n    }}\n    {% endif -%}\n    to_timestamp_ntz({{ epochs }}, {{ scale }})\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5884888}, "macro.dbt_date.bigquery__from_unixtimestamp": {"unique_id": "macro.dbt_date.bigquery__from_unixtimestamp", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/from_unixtimestamp.sql", "original_file_path": "macros/calendar_date/from_unixtimestamp.sql", "name": "bigquery__from_unixtimestamp", "macro_sql": "\n\n{%- macro bigquery__from_unixtimestamp(epochs, format) -%}\n    {%- if format == \"seconds\" -%}\n        timestamp_seconds({{ epochs }})\n    {%- elif format == \"milliseconds\" -%}\n        timestamp_millis({{ epochs }})\n    {%- elif format == \"microseconds\" -%}\n        timestamp_micros({{ epochs }})\n    {%- else -%}\n    {{ exceptions.raise_compiler_error(\n        \"value \" ~ format ~ \" for `format` for from_unixtimestamp is not supported.\"\n        )\n    }}\n    {% endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.589611}, "macro.dbt_date.convert_timezone": {"unique_id": "macro.dbt_date.convert_timezone", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/convert_timezone.sql", "original_file_path": "macros/calendar_date/convert_timezone.sql", "name": "convert_timezone", "macro_sql": "{%- macro convert_timezone(column, target_tz=None, source_tz=None) -%}\n{%- set source_tz = \"UTC\" if not source_tz else source_tz -%}\n{%- set target_tz = var(\"dbt_date:time_zone\") if not target_tz else target_tz -%}\n{{ adapter.dispatch('convert_timezone', 'dbt_date') (column, target_tz, source_tz) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.postgres__convert_timezone"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5918217}, "macro.dbt_date.default__convert_timezone": {"unique_id": "macro.dbt_date.default__convert_timezone", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/convert_timezone.sql", "original_file_path": "macros/calendar_date/convert_timezone.sql", "name": "default__convert_timezone", "macro_sql": "{% macro default__convert_timezone(column, target_tz, source_tz) -%}\n{%- if not source_tz -%}\ncast(convert_timezone('{{ target_tz }}', {{ column }}) as {{ type_timestamp() }})\n{%- else -%}\ncast(convert_timezone('{{ source_tz }}', '{{ target_tz }}', {{ column }}) as {{ type_timestamp() }})\n{%- endif -%}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5925324}, "macro.dbt_date.bigquery__convert_timezone": {"unique_id": "macro.dbt_date.bigquery__convert_timezone", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/convert_timezone.sql", "original_file_path": "macros/calendar_date/convert_timezone.sql", "name": "bigquery__convert_timezone", "macro_sql": "{%- macro bigquery__convert_timezone(column, target_tz, source_tz=None) -%}\ntimestamp(datetime({{ column }}, '{{ target_tz}}'))\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.59288}, "macro.dbt_date.spark__convert_timezone": {"unique_id": "macro.dbt_date.spark__convert_timezone", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/convert_timezone.sql", "original_file_path": "macros/calendar_date/convert_timezone.sql", "name": "spark__convert_timezone", "macro_sql": "{%- macro spark__convert_timezone(column, target_tz, source_tz) -%}\nfrom_utc_timestamp(\n        to_utc_timestamp({{ column }}, '{{ source_tz }}'),\n        '{{ target_tz }}'\n        )\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.593265}, "macro.dbt_date.postgres__convert_timezone": {"unique_id": "macro.dbt_date.postgres__convert_timezone", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/convert_timezone.sql", "original_file_path": "macros/calendar_date/convert_timezone.sql", "name": "postgres__convert_timezone", "macro_sql": "{% macro postgres__convert_timezone(column, target_tz, source_tz) -%}\n{%- if source_tz -%}\ncast({{ column }} at time zone '{{ source_tz }}' at time zone '{{ target_tz }}' as {{ type_timestamp() }})\n{%- else -%}\ncast({{ column }} at time zone '{{ target_tz }}' as {{ type_timestamp() }})\n{%- endif -%}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5939543}, "macro.dbt_date.redshift__convert_timezone": {"unique_id": "macro.dbt_date.redshift__convert_timezone", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/convert_timezone.sql", "original_file_path": "macros/calendar_date/convert_timezone.sql", "name": "redshift__convert_timezone", "macro_sql": "{%- macro redshift__convert_timezone(column, target_tz, source_tz) -%}\n{{ return(dbt_date.default__convert_timezone(column, target_tz, source_tz)) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__convert_timezone"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5944517}, "macro.dbt_date.round_timestamp": {"unique_id": "macro.dbt_date.round_timestamp", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/round_timestamp.sql", "original_file_path": "macros/calendar_date/round_timestamp.sql", "name": "round_timestamp", "macro_sql": "{% macro round_timestamp(timestamp) %}\n    {{ date_trunc(\"day\", dateadd(\"hour\", 12, timestamp)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.date_trunc", "macro.dbt_utils.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5950873}, "macro.dbt_date.day_of_month": {"unique_id": "macro.dbt_date.day_of_month", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_of_month.sql", "original_file_path": "macros/calendar_date/day_of_month.sql", "name": "day_of_month", "macro_sql": "{%- macro day_of_month(date) -%}\n{{ dbt_date.date_part('day', date) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5956614}, "macro.dbt_date.redshift__day_of_month": {"unique_id": "macro.dbt_date.redshift__day_of_month", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_of_month.sql", "original_file_path": "macros/calendar_date/day_of_month.sql", "name": "redshift__day_of_month", "macro_sql": "\n\n{%- macro redshift__day_of_month(date) -%}\ncast({{ dbt_date.date_part('day', date) }} as {{ type_bigint() }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt_utils.type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5960586}, "macro.dbt_date.periods_since": {"unique_id": "macro.dbt_date.periods_since", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/periods_since.sql", "original_file_path": "macros/calendar_date/periods_since.sql", "name": "periods_since", "macro_sql": "{%- macro periods_since(date_col, period_name='day', tz=None) -%}\n{{ datediff(date_col, dbt_date.now(tz), period_name) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.datediff", "macro.dbt_date.now"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5967262}, "macro.dbt_date.n_months_away": {"unique_id": "macro.dbt_date.n_months_away", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/n_months_away.sql", "original_file_path": "macros/calendar_date/n_months_away.sql", "name": "n_months_away", "macro_sql": "{%- macro n_months_away(n, tz=None) -%}\n{%- set n = n|int -%}\n{{ date_trunc('month',\n    dateadd('month', n,\n        dbt_date.today(tz)\n        )\n    ) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.date_trunc", "macro.dbt_utils.dateadd", "macro.dbt_date.today"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5975845}, "macro.dbt_date.n_days_away": {"unique_id": "macro.dbt_date.n_days_away", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/n_days_away.sql", "original_file_path": "macros/calendar_date/n_days_away.sql", "name": "n_days_away", "macro_sql": "{%- macro n_days_away(n, date=None, tz=None) -%}\n{{ dbt_date.n_days_ago(-1 * n, date, tz) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.n_days_ago"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5982416}, "macro.dbt_date.last_week": {"unique_id": "macro.dbt_date.last_week", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/last_week.sql", "original_file_path": "macros/calendar_date/last_week.sql", "name": "last_week", "macro_sql": "{%- macro last_week(tz=None) -%}\n{{ dbt_date.n_weeks_ago(1, tz) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.n_weeks_ago"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.5987656}, "macro.dbt_date.day_of_week": {"unique_id": "macro.dbt_date.day_of_week", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "name": "day_of_week", "macro_sql": "{%- macro day_of_week(date, isoweek=true) -%}\n{{ adapter.dispatch('day_of_week', 'dbt_date') (date, isoweek) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.postgres__day_of_week"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.60178}, "macro.dbt_date.default__day_of_week": {"unique_id": "macro.dbt_date.default__day_of_week", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "name": "default__day_of_week", "macro_sql": "\n\n{%- macro default__day_of_week(date, isoweek) -%}\n\n    {%- set dow = dbt_date.date_part('dayofweek', date) -%}\n\n    {%- if isoweek -%}\n    case\n        -- Shift start of week from Sunday (0) to Monday (1)\n        when {{ dow }} = 0 then 7\n        else {{ dow }}\n    end\n    {%- else -%}\n    {{ dow }} + 1\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6024232}, "macro.dbt_date.snowflake__day_of_week": {"unique_id": "macro.dbt_date.snowflake__day_of_week", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "name": "snowflake__day_of_week", "macro_sql": "\n\n{%- macro snowflake__day_of_week(date, isoweek) -%}\n\n    {%- if isoweek -%}\n        {%- set dow_part = 'dayofweekiso' -%}\n        {{ dbt_date.date_part(dow_part, date) }}\n    {%- else -%}\n        {%- set dow_part = 'dayofweek' -%}\n        case\n            when {{ dbt_date.date_part(dow_part, date) }} = 7 then 1\n            else {{ dbt_date.date_part(dow_part, date) }} + 1\n        end\n    {%- endif -%}\n\n\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6032934}, "macro.dbt_date.bigquery__day_of_week": {"unique_id": "macro.dbt_date.bigquery__day_of_week", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "name": "bigquery__day_of_week", "macro_sql": "\n\n{%- macro bigquery__day_of_week(date, isoweek) -%}\n\n    {%- set dow = dbt_date.date_part('dayofweek', date) -%}\n\n    {%- if isoweek -%}\n    case\n        -- Shift start of week from Sunday (1) to Monday (2)\n        when {{ dow }} = 1 then 7\n        else {{ dow }} - 1\n    end\n    {%- else -%}\n    {{ dow }}\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6039236}, "macro.dbt_date.postgres__day_of_week": {"unique_id": "macro.dbt_date.postgres__day_of_week", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "name": "postgres__day_of_week", "macro_sql": "\n\n\n{%- macro postgres__day_of_week(date, isoweek) -%}\n\n    {%- if isoweek -%}\n        {%- set dow_part = 'isodow' -%}\n        -- Monday(1) to Sunday (7)\n        cast({{ dbt_date.date_part(dow_part, date) }} as {{ type_int() }})\n    {%- else -%}\n        {%- set dow_part = 'dow' -%}\n        -- Sunday(1) to Saturday (7)\n        cast({{ dbt_date.date_part(dow_part, date) }} + 1 as {{ type_int() }})\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt_utils.type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6048906}, "macro.dbt_date.redshift__day_of_week": {"unique_id": "macro.dbt_date.redshift__day_of_week", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/day_of_week.sql", "original_file_path": "macros/calendar_date/day_of_week.sql", "name": "redshift__day_of_week", "macro_sql": "\n\n\n{%- macro redshift__day_of_week(date, isoweek) -%}\n\n    {%- set dow = dbt_date.date_part('dayofweek', date) -%}\n\n    {%- if isoweek -%}\n    case\n        -- Shift start of week from Sunday (0) to Monday (1)\n        when {{ dow }} = 0 then 7\n        else cast({{ dow }} as {{ type_bigint() }})\n    end\n    {%- else -%}\n    cast({{ dow }} + 1 as {{ type_bigint() }})\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt_utils.type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.605852}, "macro.dbt_date.n_weeks_away": {"unique_id": "macro.dbt_date.n_weeks_away", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/n_weeks_away.sql", "original_file_path": "macros/calendar_date/n_weeks_away.sql", "name": "n_weeks_away", "macro_sql": "{%- macro n_weeks_away(n, tz=None) -%}\n{%- set n = n|int -%}\n{{ date_trunc('week',\n    dateadd('week', n,\n        dbt_date.today(tz)\n        )\n    ) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.date_trunc", "macro.dbt_utils.dateadd", "macro.dbt_date.today"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6067002}, "macro.dbt_date.tomorrow": {"unique_id": "macro.dbt_date.tomorrow", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/tomorrow.sql", "original_file_path": "macros/calendar_date/tomorrow.sql", "name": "tomorrow", "macro_sql": "{%- macro tomorrow(date=None, tz=None) -%}\n{{ dbt_date.n_days_away(1, date, tz) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.n_days_away"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6072998}, "macro.dbt_date.last_month": {"unique_id": "macro.dbt_date.last_month", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/last_month.sql", "original_file_path": "macros/calendar_date/last_month.sql", "name": "last_month", "macro_sql": "{%- macro last_month(tz=None) -%}\n{{ dbt_date.n_months_ago(1, tz) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.n_months_ago"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6078131}, "macro.dbt_date.week_start": {"unique_id": "macro.dbt_date.week_start", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/week_start.sql", "original_file_path": "macros/calendar_date/week_start.sql", "name": "week_start", "macro_sql": "{%- macro week_start(date=None, tz=None) -%}\n{%-set dt = date if date else dbt_date.today(tz) -%}\n{{ adapter.dispatch('week_start', 'dbt_date') (dt) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.postgres__week_start"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6088576}, "macro.dbt_date.default__week_start": {"unique_id": "macro.dbt_date.default__week_start", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/week_start.sql", "original_file_path": "macros/calendar_date/week_start.sql", "name": "default__week_start", "macro_sql": "{%- macro default__week_start(date) -%}\ncast({{ date_trunc('week', date) }} as date)\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6092057}, "macro.dbt_date.snowflake__week_start": {"unique_id": "macro.dbt_date.snowflake__week_start", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/week_start.sql", "original_file_path": "macros/calendar_date/week_start.sql", "name": "snowflake__week_start", "macro_sql": "\n\n{%- macro snowflake__week_start(date) -%}\n    {#\n        Get the day of week offset: e.g. if the date is a Sunday,\n        dbt_date.day_of_week returns 1, so we subtract 1 to get a 0 offset\n    #}\n    {% set off_set = dbt_date.day_of_week(date, isoweek=False) ~ \" - 1\" %}\n    cast({{ dateadd(\"day\", \"-1 * (\" ~ off_set ~ \")\", date) }} as date)\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.day_of_week", "macro.dbt_utils.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6099524}, "macro.dbt_date.postgres__week_start": {"unique_id": "macro.dbt_date.postgres__week_start", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/week_start.sql", "original_file_path": "macros/calendar_date/week_start.sql", "name": "postgres__week_start", "macro_sql": "\n\n{%- macro postgres__week_start(date) -%}\n-- Sunday as week start date\ncast({{ dateadd('day', -1, date_trunc('week', dateadd('day', 1, date))) }} as date)\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.dateadd", "macro.dbt_utils.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6104798}, "macro.dbt_date.last_month_name": {"unique_id": "macro.dbt_date.last_month_name", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/last_month_name.sql", "original_file_path": "macros/calendar_date/last_month_name.sql", "name": "last_month_name", "macro_sql": "{%- macro last_month_name(short=True, tz=None) -%}\n{{ dbt_date.month_name(dbt_date.last_month(1, tz), short=short) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.month_name", "macro.dbt_date.last_month"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6111667}, "macro.dbt_date.today": {"unique_id": "macro.dbt_date.today", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/today.sql", "original_file_path": "macros/calendar_date/today.sql", "name": "today", "macro_sql": "{%- macro today(tz=None) -%}\ncast({{ dbt_date.now(tz) }} as date)\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.now"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6116815}, "macro.dbt_date.last_month_number": {"unique_id": "macro.dbt_date.last_month_number", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/calendar_date/last_month_number.sql", "original_file_path": "macros/calendar_date/last_month_number.sql", "name": "last_month_number", "macro_sql": "{%- macro last_month_number(tz=None) -%}\n{{ dbt_date.date_part('month', dbt_date.last_month(1, tz)) }}\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt_date.last_month"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6122944}, "macro.dbt_date.get_fiscal_periods": {"unique_id": "macro.dbt_date.get_fiscal_periods", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/fiscal_date/get_fiscal_periods.sql", "original_file_path": "macros/fiscal_date/get_fiscal_periods.sql", "name": "get_fiscal_periods", "macro_sql": "{% macro get_fiscal_periods(dates, year_end_month, week_start_day, shift_year=1) %}\n{#\nThis macro requires you to pass in a ref to a date dimension, created via\ndbt_date.get_date_dimension()s\n#}\nwith fscl_year_dates_for_periods as (\n    {{ dbt_date.get_fiscal_year_dates(dates, year_end_month, week_start_day, shift_year) }}\n),\nfscl_year_w13 as (\n\n    select\n        f.*,\n        -- We count the weeks in a 13 week period\n        -- and separate the 4-5-4 week sequences\n        mod(cast(\n            (f.fiscal_week_of_year-1) as {{ type_int() }}\n            ), 13) as w13_number,\n        -- Chop weeks into 13 week merch quarters\n        cast(\n            least(\n                floor((f.fiscal_week_of_year-1)/13.0)\n                , 3)\n            as {{ type_int() }}) as quarter_number\n    from\n        fscl_year_dates_for_periods f\n\n),\nfscl_periods as (\n\n    select\n        f.date_day,\n        f.fiscal_year_number,\n        f.week_start_date,\n        f.week_end_date,\n        f.fiscal_week_of_year,\n        case\n            -- we move week 53 into the 3rd period of the quarter\n            when f.fiscal_week_of_year = 53 then 3\n            when f.w13_number between 0 and 3 then 1\n            when f.w13_number between 4 and 8 then 2\n            when f.w13_number between 9 and 12 then 3\n        end as period_of_quarter,\n        f.quarter_number\n    from\n        fscl_year_w13 f\n\n),\nfscl_periods_quarters as (\n\n    select\n        f.*,\n        cast((\n            (f.quarter_number * 3) + f.period_of_quarter\n         ) as {{ type_int() }}) as fiscal_period_number\n    from\n        fscl_periods f\n\n)\nselect\n    date_day,\n    fiscal_year_number,\n    week_start_date,\n    week_end_date,\n    fiscal_week_of_year,\n    dense_rank() over(partition by fiscal_period_number order by fiscal_week_of_year) as fiscal_week_of_period,\n    fiscal_period_number,\n    quarter_number+1 as fiscal_quarter_number,\n    period_of_quarter as fiscal_period_of_quarter\nfrom\n    fscl_periods_quarters\norder by 1,2\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.get_fiscal_year_dates", "macro.dbt_utils.type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.613931}, "macro.dbt_date.get_fiscal_year_dates": {"unique_id": "macro.dbt_date.get_fiscal_year_dates", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/fiscal_date/get_fiscal_year_dates.sql", "original_file_path": "macros/fiscal_date/get_fiscal_year_dates.sql", "name": "get_fiscal_year_dates", "macro_sql": "{% macro get_fiscal_year_dates(dates, year_end_month=12, week_start_day=1, shift_year=1) %}\n{{ adapter.dispatch('get_fiscal_year_dates', 'dbt_date') (dates, year_end_month, week_start_day, shift_year) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__get_fiscal_year_dates"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.6166878}, "macro.dbt_date.default__get_fiscal_year_dates": {"unique_id": "macro.dbt_date.default__get_fiscal_year_dates", "package_name": "dbt_date", "root_path": "/usr/src/develop/user-23113/environment-95395/repository-76981/dbt_packages/dbt_date", "path": "macros/fiscal_date/get_fiscal_year_dates.sql", "original_file_path": "macros/fiscal_date/get_fiscal_year_dates.sql", "name": "default__get_fiscal_year_dates", "macro_sql": "{% macro default__get_fiscal_year_dates(dates, year_end_month, week_start_day, shift_year) %}\n-- this gets all the dates within a fiscal year\n-- determined by the given year-end-month\n-- ending on the saturday closest to that month's end date\nwith date_dimension as (\n    select * from {{ dates }}\n),\nyear_month_end as (\n\n    select\n       d.year_number - {{ shift_year }} as fiscal_year_number,\n       d.month_end_date\n    from\n        date_dimension d\n    where\n        d.month_of_year = {{ year_end_month }}\n    group by 1,2\n\n),\nweeks as (\n\n    select\n        d.year_number,\n        d.month_of_year,\n        d.date_day as week_start_date,\n        cast({{ dateadd('day', 6, 'd.date_day') }} as date) as week_end_date\n    from\n        date_dimension d\n    where\n        d.day_of_week = {{ week_start_day }}\n\n),\n-- get all the weeks that start in the month the year ends\nyear_week_ends as (\n\n    select\n        d.year_number - {{ shift_year }} as fiscal_year_number,\n        d.week_end_date\n    from\n        weeks d\n    where\n        d.month_of_year = {{ year_end_month }}\n    group by\n        1,2\n\n),\n-- then calculate which Saturday is closest to month end\nweeks_at_month_end as (\n\n    select\n        d.fiscal_year_number,\n        d.week_end_date,\n        m.month_end_date,\n        rank() over\n            (partition by d.fiscal_year_number\n                order by\n                abs({{ datediff('d.week_end_date', 'm.month_end_date', 'day') }})\n\n            ) as closest_to_month_end\n    from\n        year_week_ends d\n        join\n        year_month_end m on d.fiscal_year_number = m.fiscal_year_number\n),\nfiscal_year_range as (\n\n    select\n        w.fiscal_year_number,\n        cast(\n            {{ dateadd('day', 1,\n            'lag(w.week_end_date) over(order by w.week_end_date)') }}\n            as date) as fiscal_year_start_date,\n        w.week_end_date as fiscal_year_end_date\n    from\n        weeks_at_month_end w\n    where\n        w.closest_to_month_end = 1\n\n),\nfiscal_year_dates as (\n\n    select\n        d.date_day,\n        m.fiscal_year_number,\n        m.fiscal_year_start_date,\n        m.fiscal_year_end_date,\n        w.week_start_date,\n        w.week_end_date,\n        -- we reset the weeks of the year starting with the merch year start date\n        dense_rank()\n            over(\n                partition by m.fiscal_year_number\n                order by w.week_start_date\n                ) as fiscal_week_of_year\n    from\n        date_dimension d\n        join\n        fiscal_year_range m on d.date_day between m.fiscal_year_start_date and m.fiscal_year_end_date\n        join\n        weeks w on d.date_day between w.week_start_date and w.week_end_date\n\n)\nselect * from fiscal_year_dates order by 1\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.dateadd", "macro.dbt_utils.datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1666469549.617869}}, "docs": {"dbt.__overview__": {"unique_id": "dbt.__overview__", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "overview.md", "original_file_path": "docs/overview.md", "name": "__overview__", "block_contents": "### Welcome!\n\nWelcome to the auto-generated documentation for your dbt project!\n\n### Navigation\n\nYou can use the `Project` and `Database` navigation tabs on the left side of the window to explore the models\nin your project.\n\n#### Project Tab\nThe `Project` tab mirrors the directory structure of your dbt project. In this tab, you can see all of the\nmodels defined in your dbt project, as well as models imported from dbt packages.\n\n#### Database Tab\nThe `Database` tab also exposes your models, but in a format that looks more like a database explorer. This view\nshows relations (tables and views) grouped into database schemas. Note that ephemeral models are _not_ shown\nin this interface, as they do not exist in the database.\n\n### Graph Exploration\nYou can click the blue icon on the bottom-right corner of the page to view the lineage graph of your models.\n\nOn model pages, you'll see the immediate parents and children of the model you're exploring. By clicking the `Expand`\nbutton at the top-right of this lineage pane, you'll be able to see all of the models that are used to build,\nor are built from, the model you're exploring.\n\nOnce expanded, you'll be able to use the `--select` and `--exclude` model selection syntax to filter the\nmodels in the graph. For more information on model selection, check out the [dbt docs](https://docs.getdbt.com/docs/model-selection-syntax).\n\nNote that you can also right-click on models to interactively filter and explore the graph.\n\n---\n\n### More information\n\n- [What is dbt](https://docs.getdbt.com/docs/introduction)?\n- Read the [dbt viewpoint](https://docs.getdbt.com/docs/viewpoint)\n- [Installation](https://docs.getdbt.com/docs/installation)\n- Join the [dbt Community](https://www.getdbt.com/community/) for questions and discussion"}}, "exposures": {}, "metrics": {}, "selectors": {}, "disabled": {}, "parent_map": {"model.acton_marketing_data.test": ["source.acton_marketing_data.salesforce.lead"], "model.acton_marketing_data.funnel_report_all_time_filters_industry": ["model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_lost", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.funnel_report_all_time_mql2sql_velocity": ["model.acton_marketing_data.opportunities_with_contacts"], "model.acton_marketing_data.funnel_report_all_time_l20_velocity_opp": ["model.acton_marketing_data.opportunities_with_contacts"], "model.acton_marketing_data.funnel_report_all_time_lost": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.opp_source_xf"], "model.acton_marketing_data.funnel_report_all_time_sqos_to_target": ["model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.kpi_targets"], "model.acton_marketing_data.funnel_report_all_time_sqos": ["model.acton_marketing_data.sqo_source_xf"], "model.acton_marketing_data.funnel_report_all_time_filters_date": ["model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_lost", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.funnel_report_all_time_pipeline": ["model.acton_marketing_data.sqo_source_xf"], "model.acton_marketing_data.funnel_report_all_time_asp_to_target": ["model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.kpi_targets"], "model.acton_marketing_data.funnel_report_all_time_intrapipe_to_target": ["model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.kpi_targets"], "model.acton_marketing_data.funnel_report_all_time_won": ["model.acton_marketing_data.opp_sales_source_xf"], "model.acton_marketing_data.funnel_report_all_time_sal2sql_velocity": ["model.acton_marketing_data.opportunities_with_contacts"], "model.acton_marketing_data.funnel_report_all_time_cwpipe_to_target": ["model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.kpi_targets"], "model.acton_marketing_data.funnel_report_all_time_l20_velocity_opp_annual": ["model.acton_marketing_data.opportunities_with_contacts"], "model.acton_marketing_data.funnel_report_all_time_sqo2demo_velocity": ["model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_sqos"], "model.acton_marketing_data.funnel_report_all_time_voc": ["model.acton_marketing_data.opp_voc_source_xf"], "model.acton_marketing_data.funnel_report_all_time_filters_segment": ["model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_lost", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.funnel_report_all_time_clos2cw_velocity": ["model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.funnel_report_all_time_sqls_to_target": ["model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.kpi_targets"], "model.acton_marketing_data.funnel_report_all_time_sals": ["model.acton_marketing_data.sal_source_xf"], "model.acton_marketing_data.funnel_report_all_time_sql2sqo_velocity": ["model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos"], "model.acton_marketing_data.funnel_report_all_time_l2m_to_target": ["model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.kpi_targets"], "model.acton_marketing_data.funnel_report_all_time_sqls": ["model.acton_marketing_data.sql_source_xf"], "model.acton_marketing_data.funnel_report_all_time_cohort": ["model.acton_marketing_data.lead_to_cw_cohort"], "model.acton_marketing_data.funnel_report_all_time_closing": ["model.acton_marketing_data.opp_closing_source_xf"], "model.acton_marketing_data.funnel_report_all_time_filters_channelbucket": ["model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_lost", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.funnel_report_all_time_filters_leadsource": ["model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_lost", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.funnel_report_all_time_sqo2won_velocity": ["model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.funnel_report_all_time_filters_companysizerev": ["model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_lost", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.funnel_report_all_time_close_won_velocity": ["model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.funnel_report_all_time_l20_velocity_mlc": ["model.acton_marketing_data.opportunities_with_contacts"], "model.acton_marketing_data.funnel_report_all_time_m2sql_to_target": ["model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.kpi_targets"], "model.acton_marketing_data.funnel_report_all_time_voc2closing_velocity": ["model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_voc"], "model.acton_marketing_data.funnel_report_all_time_m2sal_velocity": ["model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals"], "model.acton_marketing_data.funnel_report_all_time_filters_globalregion": ["model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_lost", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.funnel_report_all_time_mqls": ["model.acton_marketing_data.lead_mql_source_xf"], "model.acton_marketing_data.funnel_report_all_time_sql2sqo_to_target": ["model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.kpi_targets"], "model.acton_marketing_data.funnel_report_all_time_demo2voc_velocity": ["model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_voc"], "model.acton_marketing_data.funnel_report_all_time_mqls_to_target": ["model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.kpi_targets"], "model.acton_marketing_data.funnel_report_all_time_l20_velocity_mlc_annual": ["model.acton_marketing_data.opportunities_with_contacts"], "model.acton_marketing_data.funnel_report_all_time_demo": ["model.acton_marketing_data.opp_demo_source_xf"], "model.acton_marketing_data.funnel_report_all_time_close_won_velocity_annual": ["model.acton_marketing_data.opp_sales_source_xf", "model.acton_marketing_data.sql_source_xf"], "model.acton_marketing_data.funnel_report_all_time_leads_to_target": ["model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.kpi_targets"], "model.acton_marketing_data.funnel_report_all_time_filters": ["model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_lost", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.funnel_report_all_time_sqopipe_to_target": ["model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.kpi_targets"], "model.acton_marketing_data.funnel_report_all_time_l2m_velocity": ["model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_mqls"], "model.acton_marketing_data.funnel_report_all_time_all": ["model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_closing", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_demo", "model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.funnel_report_all_time_lost", "model.acton_marketing_data.funnel_report_all_time_lost", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_mqls", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sals", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqls", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_sqos", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_voc", "model.acton_marketing_data.funnel_report_all_time_won", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.funnel_report_all_time_conversions": ["model.acton_marketing_data.funnel_report_all_time_all"], "model.acton_marketing_data.funnel_report_all_time_leads": ["model.acton_marketing_data.person_source_xf"], "model.acton_marketing_data.date_base_xf": [], "model.acton_marketing_data.account_source_xf": ["model.acton_marketing_data.contract_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf", "source.acton_marketing_data.salesforce.account"], "model.acton_marketing_data.contact_history_xf": ["source.acton_marketing_data.salesforce.contact_history"], "model.acton_marketing_data.product_xf": ["source.acton_marketing_data.salesforce.product_2"], "model.acton_marketing_data.lead_history_xf": ["model.acton_marketing_data.lead_source_xf", "source.acton_marketing_data.salesforce.lead_history"], "model.acton_marketing_data.campaign_member_source_xf": ["source.acton_marketing_data.salesforce.campaign_member"], "model.acton_marketing_data.user_source_xf": ["source.acton_marketing_data.salesforce.user"], "model.acton_marketing_data.opp_source_xf": ["model.acton_marketing_data.contract_source_xf", "model.acton_marketing_data.opportunity_line_item_xf", "model.acton_marketing_data.quote_line", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf", "source.acton_marketing_data.salesforce.opportunity"], "model.acton_marketing_data.lead_source_ss_xf": [], "model.acton_marketing_data.task_source_xf": ["model.acton_marketing_data.person_source_xf", "source.acton_marketing_data.salesforce.task"], "model.acton_marketing_data.lead_source_xf": ["model.acton_marketing_data.user_source_xf", "source.acton_marketing_data.salesforce.lead"], "model.acton_marketing_data.contract_source_xf": ["source.acton_marketing_data.salesforce.contract"], "model.acton_marketing_data.opportunity_history_xf": ["source.acton_marketing_data.salesforce.opportunity_field_history"], "model.acton_marketing_data.ao_instance_user_source_xf": ["model.acton_marketing_data.ao_instance_source_xf", "source.acton_marketing_data.salesforce.act_on_instance_user_c"], "model.acton_marketing_data.opportunity_line_item_xf": ["source.acton_marketing_data.salesforce.opportunity_line_item"], "model.acton_marketing_data.quote_line": ["model.acton_marketing_data.product_xf"], "model.acton_marketing_data.campaign_influence_xf": ["source.acton_marketing_data.salesforce.campaign_influence"], "model.acton_marketing_data.campaign_source_xf": ["source.acton_marketing_data.salesforce.campaign"], "model.acton_marketing_data.contact_source_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf", "source.acton_marketing_data.salesforce.contact"], "model.acton_marketing_data.ao_instance_source_xf": ["source.acton_marketing_data.salesforce.act_on_instance_c"], "model.acton_marketing_data.ao_emails": ["source.acton_marketing_data.data_studio_s3.data_studio_emails"], "model.acton_marketing_data.ao_webinars": ["source.acton_marketing_data.data_studio_s3.data_studio_webinars"], "model.acton_marketing_data.ao_email_to_uid": ["model.acton_marketing_data.ao_emails", "model.acton_marketing_data.ao_forms", "model.acton_marketing_data.ao_landingpages", "model.acton_marketing_data.ao_media", "model.acton_marketing_data.ao_webinars", "model.acton_marketing_data.ao_webpages"], "model.acton_marketing_data.ao_forms": ["source.acton_marketing_data.data_studio_s3.data_studio_forms"], "model.acton_marketing_data.ao_landingpages": ["source.acton_marketing_data.data_studio_s3.data_studio_landingpages"], "model.acton_marketing_data.ao_media": ["source.acton_marketing_data.data_studio_s3.data_studio_media"], "model.acton_marketing_data.ao_webpages": ["source.acton_marketing_data.data_studio_s3.data_studio_webpages"], "model.acton_marketing_data.ao_webpages_xf": ["model.acton_marketing_data.ao_webpages"], "model.acton_marketing_data.ao_media_xf": ["model.acton_marketing_data.ao_media"], "model.acton_marketing_data.ao_combined": ["model.acton_marketing_data.ao_emails_xf", "model.acton_marketing_data.ao_forms_xf", "model.acton_marketing_data.ao_landingpages_xf", "model.acton_marketing_data.ao_media_xf", "model.acton_marketing_data.ao_webinars_xf", "model.acton_marketing_data.ao_webpages_xf", "model.acton_marketing_data.task_source_xf"], "model.acton_marketing_data.ao_forms_xf": ["model.acton_marketing_data.ao_forms"], "model.acton_marketing_data.ao_emails_xf": ["model.acton_marketing_data.ao_emails"], "model.acton_marketing_data.ao_webinars_xf": ["model.acton_marketing_data.ao_webinars"], "model.acton_marketing_data.ao_landingpages_xf": ["model.acton_marketing_data.ao_landingpages"], "model.acton_marketing_data.topo_leads": ["model.acton_marketing_data.date_base_xf", "model.acton_marketing_data.funnel_report_all_time_leads"], "model.acton_marketing_data.topo_all": ["model.acton_marketing_data.topo_closing", "model.acton_marketing_data.topo_demos", "model.acton_marketing_data.topo_leads", "model.acton_marketing_data.topo_lost", "model.acton_marketing_data.topo_mqls", "model.acton_marketing_data.topo_pipe", "model.acton_marketing_data.topo_sals", "model.acton_marketing_data.topo_sqls", "model.acton_marketing_data.topo_sqos", "model.acton_marketing_data.topo_voc", "model.acton_marketing_data.topo_won", "model.acton_marketing_data.topo_won_acv"], "model.acton_marketing_data.topo_won_acv": ["model.acton_marketing_data.date_base_xf", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.topo_mqls": ["model.acton_marketing_data.date_base_xf", "model.acton_marketing_data.funnel_report_all_time_mqls"], "model.acton_marketing_data.topo_sqls": ["model.acton_marketing_data.date_base_xf", "model.acton_marketing_data.funnel_report_all_time_sqls"], "model.acton_marketing_data.topo_sals": ["model.acton_marketing_data.date_base_xf", "model.acton_marketing_data.funnel_report_all_time_sals"], "model.acton_marketing_data.topo_closing": ["model.acton_marketing_data.date_base_xf", "model.acton_marketing_data.funnel_report_all_time_closing"], "model.acton_marketing_data.topo_lost": ["model.acton_marketing_data.date_base_xf", "model.acton_marketing_data.funnel_report_all_time_lost"], "model.acton_marketing_data.topo_sqos": ["model.acton_marketing_data.date_base_xf", "model.acton_marketing_data.funnel_report_all_time_sqos"], "model.acton_marketing_data.topo_pipe": ["model.acton_marketing_data.date_base_xf", "model.acton_marketing_data.funnel_report_all_time_sqos"], "model.acton_marketing_data.topo_won": ["model.acton_marketing_data.date_base_xf", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.topo_demos": ["model.acton_marketing_data.date_base_xf", "model.acton_marketing_data.funnel_report_all_time_demo"], "model.acton_marketing_data.topo_voc": ["model.acton_marketing_data.date_base_xf", "model.acton_marketing_data.funnel_report_all_time_voc"], "model.acton_marketing_data.marketing_lead_creation_date_history_xf": ["model.acton_marketing_data.contact_history_xf", "model.acton_marketing_data.contact_source_xf", "model.acton_marketing_data.lead_history_xf", "model.acton_marketing_data.lead_source_xf"], "model.acton_marketing_data.opp_demo_date_history_xf": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.opportunity_history_xf"], "model.acton_marketing_data.working_date_history_xf": ["model.acton_marketing_data.contact_history_xf", "model.acton_marketing_data.contact_source_xf", "model.acton_marketing_data.lead_history_xf", "model.acton_marketing_data.lead_source_xf"], "model.acton_marketing_data.opp_closing_date_history_xf": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.opportunity_history_xf"], "model.acton_marketing_data.mql_date_history_xf": ["model.acton_marketing_data.contact_history_xf", "model.acton_marketing_data.contact_source_xf", "model.acton_marketing_data.lead_history_xf", "model.acton_marketing_data.lead_source_xf"], "model.acton_marketing_data.opp_discovery_date_history_xf": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.opportunity_history_xf"], "model.acton_marketing_data.opp_voc_date_history_xf": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.opportunity_history_xf"], "model.acton_marketing_data.marketo_persons_influenced": ["model.acton_marketing_data.person_source_xf"], "model.acton_marketing_data.campaign_primary_source": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.campaign_influence_xf", "model.acton_marketing_data.campaign_member_source_xf", "model.acton_marketing_data.campaign_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.person_source_xf"], "model.acton_marketing_data.first_touch": ["model.acton_marketing_data.ao_combined"], "model.acton_marketing_data.lead_creation": ["model.acton_marketing_data.ao_combined", "model.acton_marketing_data.person_source_xf"], "model.acton_marketing_data.last_touch": ["model.acton_marketing_data.ao_combined"], "model.acton_marketing_data.lead_creation2": ["model.acton_marketing_data.ao_combined", "model.acton_marketing_data.person_source_xf"], "model.acton_marketing_data.first_touch2": ["model.acton_marketing_data.ao_combined"], "model.acton_marketing_data.opportunity_creation2": ["model.acton_marketing_data.ao_combined", "model.acton_marketing_data.lead_to_cw_cohort"], "model.acton_marketing_data.custom_model": [], "model.acton_marketing_data.combined_attribution2": ["model.acton_marketing_data.ao_combined", "model.acton_marketing_data.first_touch2", "model.acton_marketing_data.last_touch", "model.acton_marketing_data.lead_creation2", "model.acton_marketing_data.lead_to_cw_cohort", "model.acton_marketing_data.opportunity_creation2"], "model.acton_marketing_data.combined_attribution": ["model.acton_marketing_data.ao_combined", "model.acton_marketing_data.first_touch", "model.acton_marketing_data.last_touch", "model.acton_marketing_data.lead_creation", "model.acton_marketing_data.lead_to_cw_cohort", "model.acton_marketing_data.opportunity_creation"], "model.acton_marketing_data.opportunity_creation": ["model.acton_marketing_data.ao_combined", "model.acton_marketing_data.lead_to_cw_cohort"], "model.acton_marketing_data.customer_power_ups": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.campaign_influence_xf", "model.acton_marketing_data.campaign_member_source_xf", "model.acton_marketing_data.campaign_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.person_source_xf"], "model.acton_marketing_data.new_account_welcome_series_list": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.ao_instance_user_source_xf", "model.acton_marketing_data.contact_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf"], "model.acton_marketing_data.new_user_welcome_series_list": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.ao_instance_user_source_xf", "model.acton_marketing_data.contact_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf", "model.acton_marketing_data.user_source_xf"], "model.acton_marketing_data.sal_source_ss_xf": ["model.acton_marketing_data.lead_source_ss_xf"], "model.acton_marketing_data.sql_source_ss_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.opp_source_xf"], "model.acton_marketing_data.opp_closing_source_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf"], "model.acton_marketing_data.person_source_xf": ["model.acton_marketing_data.contact_source_xf", "model.acton_marketing_data.lead_source_xf"], "model.acton_marketing_data.lead_mql_source_xf": ["model.acton_marketing_data.person_source_xf"], "model.acton_marketing_data.opp_voc_source_ss_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf"], "model.acton_marketing_data.sqo_source_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf"], "model.acton_marketing_data.opp_demo_source_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf"], "model.acton_marketing_data.opp_sales_source_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf"], "model.acton_marketing_data.opp_voc_source_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf"], "model.acton_marketing_data.opp_closing_source_ss_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf"], "model.acton_marketing_data.sqo_source_ss_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf"], "model.acton_marketing_data.opp_demo_source_ss_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf"], "model.acton_marketing_data.sql_source_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.opp_source_xf"], "model.acton_marketing_data.kpi_targets": [], "model.acton_marketing_data.sal_source_xf": ["model.acton_marketing_data.person_source_xf"], "model.acton_marketing_data.lead_mql_source_ss_xf": ["model.acton_marketing_data.lead_source_ss_xf"], "model.acton_marketing_data.wow_disco_scheduled": ["model.acton_marketing_data.opp_source_xf"], "model.acton_marketing_data.wow_disco_pastdue": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf"], "model.acton_marketing_data.wow_disco_missing": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.user_source_xf"], "model.acton_marketing_data.opportunities_with_contacts": ["model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.person_source_xf"], "model.acton_marketing_data.avg_lead_to_cw_cohort_count": ["model.acton_marketing_data.lead_to_cw_cohort"], "model.acton_marketing_data.avg_lead_to_cw_cohort": ["model.acton_marketing_data.lead_to_cw_cohort"], "model.acton_marketing_data.lead_to_cw_cohort": ["model.acton_marketing_data.opportunities_with_contacts"], "snapshot.acton_marketing_data.sfdc_ao_instance_snapshot2": ["model.acton_marketing_data.ao_instance_source_xf"], "snapshot.acton_marketing_data.sfdc_contact_snapshot3": ["model.acton_marketing_data.contact_source_xf"], "snapshot.acton_marketing_data.sfdc_lead_snapshot2": ["model.acton_marketing_data.lead_source_xf"], "snapshot.acton_marketing_data.sfdc_contract_snapshot2": ["model.acton_marketing_data.contract_source_xf"], "snapshot.acton_marketing_data.sfdc_ao_instance_user_snapshot2": ["model.acton_marketing_data.ao_instance_user_source_xf"], "snapshot.acton_marketing_data.sfdc_account_snapshot4": ["model.acton_marketing_data.account_source_xf"], "snapshot.acton_marketing_data.sfdc_opportunity_snapshot2": ["model.acton_marketing_data.opp_source_xf"], "source.acton_marketing_data.salesforce.account": [], "source.acton_marketing_data.salesforce.act_on_instance_c": [], "source.acton_marketing_data.salesforce.act_on_instance_user_c": [], "source.acton_marketing_data.salesforce.campaign_influence": [], "source.acton_marketing_data.salesforce.campaign_member": [], "source.acton_marketing_data.salesforce.campaign": [], "source.acton_marketing_data.salesforce.contact_history": [], "source.acton_marketing_data.salesforce.contact": [], "source.acton_marketing_data.salesforce.contract": [], "source.acton_marketing_data.salesforce.lead_history": [], "source.acton_marketing_data.salesforce.lead": [], "source.acton_marketing_data.salesforce.opportunity": [], "source.acton_marketing_data.salesforce.opportunity_field_history": [], "source.acton_marketing_data.salesforce.opportunity_line_item": [], "source.acton_marketing_data.salesforce.product_2": [], "source.acton_marketing_data.salesforce.task": [], "source.acton_marketing_data.salesforce.user": [], "source.acton_marketing_data.data_studio_s3.data_studio_emails": [], "source.acton_marketing_data.data_studio_s3.data_studio_forms": [], "source.acton_marketing_data.data_studio_s3.data_studio_landingpages": [], "source.acton_marketing_data.data_studio_s3.data_studio_media": [], "source.acton_marketing_data.data_studio_s3.data_studio_webinars": [], "source.acton_marketing_data.data_studio_s3.data_studio_webpages": [], "source.acton_marketing_data.datastudio1.email_clicks_ao_20220330": []}, "child_map": {"model.acton_marketing_data.test": [], "model.acton_marketing_data.funnel_report_all_time_filters_industry": [], "model.acton_marketing_data.funnel_report_all_time_mql2sql_velocity": [], "model.acton_marketing_data.funnel_report_all_time_l20_velocity_opp": [], "model.acton_marketing_data.funnel_report_all_time_lost": ["model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_filters", "model.acton_marketing_data.funnel_report_all_time_filters_channelbucket", "model.acton_marketing_data.funnel_report_all_time_filters_companysizerev", "model.acton_marketing_data.funnel_report_all_time_filters_date", "model.acton_marketing_data.funnel_report_all_time_filters_globalregion", "model.acton_marketing_data.funnel_report_all_time_filters_industry", "model.acton_marketing_data.funnel_report_all_time_filters_leadsource", "model.acton_marketing_data.funnel_report_all_time_filters_segment", "model.acton_marketing_data.topo_lost"], "model.acton_marketing_data.funnel_report_all_time_sqos_to_target": [], "model.acton_marketing_data.funnel_report_all_time_sqos": ["model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_asp_to_target", "model.acton_marketing_data.funnel_report_all_time_filters", "model.acton_marketing_data.funnel_report_all_time_filters_channelbucket", "model.acton_marketing_data.funnel_report_all_time_filters_companysizerev", "model.acton_marketing_data.funnel_report_all_time_filters_date", "model.acton_marketing_data.funnel_report_all_time_filters_globalregion", "model.acton_marketing_data.funnel_report_all_time_filters_industry", "model.acton_marketing_data.funnel_report_all_time_filters_leadsource", "model.acton_marketing_data.funnel_report_all_time_filters_segment", "model.acton_marketing_data.funnel_report_all_time_intrapipe_to_target", "model.acton_marketing_data.funnel_report_all_time_sql2sqo_to_target", "model.acton_marketing_data.funnel_report_all_time_sql2sqo_velocity", "model.acton_marketing_data.funnel_report_all_time_sqo2demo_velocity", "model.acton_marketing_data.funnel_report_all_time_sqo2won_velocity", "model.acton_marketing_data.funnel_report_all_time_sqopipe_to_target", "model.acton_marketing_data.funnel_report_all_time_sqos_to_target", "model.acton_marketing_data.topo_pipe", "model.acton_marketing_data.topo_sqos"], "model.acton_marketing_data.funnel_report_all_time_filters_date": [], "model.acton_marketing_data.funnel_report_all_time_pipeline": [], "model.acton_marketing_data.funnel_report_all_time_asp_to_target": [], "model.acton_marketing_data.funnel_report_all_time_intrapipe_to_target": [], "model.acton_marketing_data.funnel_report_all_time_won": ["model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_clos2cw_velocity", "model.acton_marketing_data.funnel_report_all_time_close_won_velocity", "model.acton_marketing_data.funnel_report_all_time_cwpipe_to_target", "model.acton_marketing_data.funnel_report_all_time_filters", "model.acton_marketing_data.funnel_report_all_time_filters_channelbucket", "model.acton_marketing_data.funnel_report_all_time_filters_companysizerev", "model.acton_marketing_data.funnel_report_all_time_filters_date", "model.acton_marketing_data.funnel_report_all_time_filters_globalregion", "model.acton_marketing_data.funnel_report_all_time_filters_industry", "model.acton_marketing_data.funnel_report_all_time_filters_leadsource", "model.acton_marketing_data.funnel_report_all_time_filters_segment", "model.acton_marketing_data.funnel_report_all_time_sqo2won_velocity", "model.acton_marketing_data.topo_won", "model.acton_marketing_data.topo_won_acv"], "model.acton_marketing_data.funnel_report_all_time_sal2sql_velocity": [], "model.acton_marketing_data.funnel_report_all_time_cwpipe_to_target": [], "model.acton_marketing_data.funnel_report_all_time_l20_velocity_opp_annual": [], "model.acton_marketing_data.funnel_report_all_time_sqo2demo_velocity": [], "model.acton_marketing_data.funnel_report_all_time_voc": ["model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_demo2voc_velocity", "model.acton_marketing_data.funnel_report_all_time_filters", "model.acton_marketing_data.funnel_report_all_time_filters_channelbucket", "model.acton_marketing_data.funnel_report_all_time_filters_companysizerev", "model.acton_marketing_data.funnel_report_all_time_filters_date", "model.acton_marketing_data.funnel_report_all_time_filters_globalregion", "model.acton_marketing_data.funnel_report_all_time_filters_industry", "model.acton_marketing_data.funnel_report_all_time_filters_leadsource", "model.acton_marketing_data.funnel_report_all_time_filters_segment", "model.acton_marketing_data.funnel_report_all_time_voc2closing_velocity", "model.acton_marketing_data.topo_voc"], "model.acton_marketing_data.funnel_report_all_time_filters_segment": [], "model.acton_marketing_data.funnel_report_all_time_clos2cw_velocity": [], "model.acton_marketing_data.funnel_report_all_time_sqls_to_target": [], "model.acton_marketing_data.funnel_report_all_time_sals": ["model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_filters", "model.acton_marketing_data.funnel_report_all_time_filters_channelbucket", "model.acton_marketing_data.funnel_report_all_time_filters_companysizerev", "model.acton_marketing_data.funnel_report_all_time_filters_date", "model.acton_marketing_data.funnel_report_all_time_filters_globalregion", "model.acton_marketing_data.funnel_report_all_time_filters_industry", "model.acton_marketing_data.funnel_report_all_time_filters_leadsource", "model.acton_marketing_data.funnel_report_all_time_filters_segment", "model.acton_marketing_data.funnel_report_all_time_m2sal_velocity", "model.acton_marketing_data.topo_sals"], "model.acton_marketing_data.funnel_report_all_time_sql2sqo_velocity": [], "model.acton_marketing_data.funnel_report_all_time_l2m_to_target": [], "model.acton_marketing_data.funnel_report_all_time_sqls": ["model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_close_won_velocity", "model.acton_marketing_data.funnel_report_all_time_filters", "model.acton_marketing_data.funnel_report_all_time_filters_channelbucket", "model.acton_marketing_data.funnel_report_all_time_filters_companysizerev", "model.acton_marketing_data.funnel_report_all_time_filters_date", "model.acton_marketing_data.funnel_report_all_time_filters_globalregion", "model.acton_marketing_data.funnel_report_all_time_filters_industry", "model.acton_marketing_data.funnel_report_all_time_filters_leadsource", "model.acton_marketing_data.funnel_report_all_time_filters_segment", "model.acton_marketing_data.funnel_report_all_time_m2sql_to_target", "model.acton_marketing_data.funnel_report_all_time_sql2sqo_to_target", "model.acton_marketing_data.funnel_report_all_time_sql2sqo_velocity", "model.acton_marketing_data.funnel_report_all_time_sqls_to_target", "model.acton_marketing_data.topo_sqls"], "model.acton_marketing_data.funnel_report_all_time_cohort": [], "model.acton_marketing_data.funnel_report_all_time_closing": ["model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_clos2cw_velocity", "model.acton_marketing_data.funnel_report_all_time_filters", "model.acton_marketing_data.funnel_report_all_time_filters_channelbucket", "model.acton_marketing_data.funnel_report_all_time_filters_companysizerev", "model.acton_marketing_data.funnel_report_all_time_filters_date", "model.acton_marketing_data.funnel_report_all_time_filters_globalregion", "model.acton_marketing_data.funnel_report_all_time_filters_industry", "model.acton_marketing_data.funnel_report_all_time_filters_leadsource", "model.acton_marketing_data.funnel_report_all_time_filters_segment", "model.acton_marketing_data.funnel_report_all_time_voc2closing_velocity", "model.acton_marketing_data.topo_closing"], "model.acton_marketing_data.funnel_report_all_time_filters_channelbucket": [], "model.acton_marketing_data.funnel_report_all_time_filters_leadsource": [], "model.acton_marketing_data.funnel_report_all_time_sqo2won_velocity": [], "model.acton_marketing_data.funnel_report_all_time_filters_companysizerev": [], "model.acton_marketing_data.funnel_report_all_time_close_won_velocity": [], "model.acton_marketing_data.funnel_report_all_time_l20_velocity_mlc": [], "model.acton_marketing_data.funnel_report_all_time_m2sql_to_target": [], "model.acton_marketing_data.funnel_report_all_time_voc2closing_velocity": [], "model.acton_marketing_data.funnel_report_all_time_m2sal_velocity": [], "model.acton_marketing_data.funnel_report_all_time_filters_globalregion": [], "model.acton_marketing_data.funnel_report_all_time_mqls": ["model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_filters", "model.acton_marketing_data.funnel_report_all_time_filters_channelbucket", "model.acton_marketing_data.funnel_report_all_time_filters_companysizerev", "model.acton_marketing_data.funnel_report_all_time_filters_date", "model.acton_marketing_data.funnel_report_all_time_filters_globalregion", "model.acton_marketing_data.funnel_report_all_time_filters_industry", "model.acton_marketing_data.funnel_report_all_time_filters_leadsource", "model.acton_marketing_data.funnel_report_all_time_filters_segment", "model.acton_marketing_data.funnel_report_all_time_l2m_to_target", "model.acton_marketing_data.funnel_report_all_time_l2m_velocity", "model.acton_marketing_data.funnel_report_all_time_m2sal_velocity", "model.acton_marketing_data.funnel_report_all_time_m2sql_to_target", "model.acton_marketing_data.funnel_report_all_time_mqls_to_target", "model.acton_marketing_data.topo_mqls"], "model.acton_marketing_data.funnel_report_all_time_sql2sqo_to_target": [], "model.acton_marketing_data.funnel_report_all_time_demo2voc_velocity": [], "model.acton_marketing_data.funnel_report_all_time_mqls_to_target": [], "model.acton_marketing_data.funnel_report_all_time_l20_velocity_mlc_annual": [], "model.acton_marketing_data.funnel_report_all_time_demo": ["model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_demo2voc_velocity", "model.acton_marketing_data.funnel_report_all_time_filters", "model.acton_marketing_data.funnel_report_all_time_filters_channelbucket", "model.acton_marketing_data.funnel_report_all_time_filters_companysizerev", "model.acton_marketing_data.funnel_report_all_time_filters_date", "model.acton_marketing_data.funnel_report_all_time_filters_globalregion", "model.acton_marketing_data.funnel_report_all_time_filters_industry", "model.acton_marketing_data.funnel_report_all_time_filters_leadsource", "model.acton_marketing_data.funnel_report_all_time_filters_segment", "model.acton_marketing_data.funnel_report_all_time_sqo2demo_velocity", "model.acton_marketing_data.topo_demos"], "model.acton_marketing_data.funnel_report_all_time_close_won_velocity_annual": [], "model.acton_marketing_data.funnel_report_all_time_leads_to_target": [], "model.acton_marketing_data.funnel_report_all_time_filters": [], "model.acton_marketing_data.funnel_report_all_time_sqopipe_to_target": [], "model.acton_marketing_data.funnel_report_all_time_l2m_velocity": [], "model.acton_marketing_data.funnel_report_all_time_all": ["model.acton_marketing_data.funnel_report_all_time_conversions"], "model.acton_marketing_data.funnel_report_all_time_conversions": [], "model.acton_marketing_data.funnel_report_all_time_leads": ["model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_all", "model.acton_marketing_data.funnel_report_all_time_filters", "model.acton_marketing_data.funnel_report_all_time_filters_channelbucket", "model.acton_marketing_data.funnel_report_all_time_filters_companysizerev", "model.acton_marketing_data.funnel_report_all_time_filters_date", "model.acton_marketing_data.funnel_report_all_time_filters_globalregion", "model.acton_marketing_data.funnel_report_all_time_filters_industry", "model.acton_marketing_data.funnel_report_all_time_filters_leadsource", "model.acton_marketing_data.funnel_report_all_time_filters_segment", "model.acton_marketing_data.funnel_report_all_time_l2m_to_target", "model.acton_marketing_data.funnel_report_all_time_l2m_velocity", "model.acton_marketing_data.funnel_report_all_time_leads_to_target", "model.acton_marketing_data.topo_leads"], "model.acton_marketing_data.date_base_xf": ["model.acton_marketing_data.topo_closing", "model.acton_marketing_data.topo_demos", "model.acton_marketing_data.topo_leads", "model.acton_marketing_data.topo_lost", "model.acton_marketing_data.topo_mqls", "model.acton_marketing_data.topo_pipe", "model.acton_marketing_data.topo_sals", "model.acton_marketing_data.topo_sqls", "model.acton_marketing_data.topo_sqos", "model.acton_marketing_data.topo_voc", "model.acton_marketing_data.topo_won", "model.acton_marketing_data.topo_won_acv"], "model.acton_marketing_data.account_source_xf": ["model.acton_marketing_data.campaign_primary_source", "model.acton_marketing_data.contact_source_xf", "model.acton_marketing_data.customer_power_ups", "model.acton_marketing_data.funnel_report_all_time_lost", "model.acton_marketing_data.new_account_welcome_series_list", "model.acton_marketing_data.new_user_welcome_series_list", "model.acton_marketing_data.opp_closing_source_ss_xf", "model.acton_marketing_data.opp_closing_source_xf", "model.acton_marketing_data.opp_demo_source_ss_xf", "model.acton_marketing_data.opp_demo_source_xf", "model.acton_marketing_data.opp_sales_source_xf", "model.acton_marketing_data.opp_voc_source_ss_xf", "model.acton_marketing_data.opp_voc_source_xf", "model.acton_marketing_data.sql_source_ss_xf", "model.acton_marketing_data.sql_source_xf", "model.acton_marketing_data.sqo_source_ss_xf", "model.acton_marketing_data.sqo_source_xf", "snapshot.acton_marketing_data.sfdc_account_snapshot4"], "model.acton_marketing_data.contact_history_xf": ["model.acton_marketing_data.marketing_lead_creation_date_history_xf", "model.acton_marketing_data.mql_date_history_xf", "model.acton_marketing_data.working_date_history_xf"], "model.acton_marketing_data.product_xf": ["model.acton_marketing_data.quote_line"], "model.acton_marketing_data.lead_history_xf": ["model.acton_marketing_data.marketing_lead_creation_date_history_xf", "model.acton_marketing_data.mql_date_history_xf", "model.acton_marketing_data.working_date_history_xf"], "model.acton_marketing_data.campaign_member_source_xf": ["model.acton_marketing_data.campaign_primary_source", "model.acton_marketing_data.customer_power_ups"], "model.acton_marketing_data.user_source_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.contact_source_xf", "model.acton_marketing_data.contact_source_xf", "model.acton_marketing_data.lead_source_xf", "model.acton_marketing_data.new_account_welcome_series_list", "model.acton_marketing_data.new_account_welcome_series_list", "model.acton_marketing_data.new_user_welcome_series_list", "model.acton_marketing_data.new_user_welcome_series_list", "model.acton_marketing_data.opp_closing_source_ss_xf", "model.acton_marketing_data.opp_closing_source_xf", "model.acton_marketing_data.opp_demo_source_ss_xf", "model.acton_marketing_data.opp_demo_source_xf", "model.acton_marketing_data.opp_sales_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.opp_source_xf", "model.acton_marketing_data.opp_voc_source_ss_xf", "model.acton_marketing_data.opp_voc_source_xf", "model.acton_marketing_data.sqo_source_ss_xf", "model.acton_marketing_data.sqo_source_xf", "model.acton_marketing_data.wow_disco_missing", "model.acton_marketing_data.wow_disco_pastdue"], "model.acton_marketing_data.opp_source_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.campaign_primary_source", "model.acton_marketing_data.customer_power_ups", "model.acton_marketing_data.funnel_report_all_time_lost", "model.acton_marketing_data.new_account_welcome_series_list", "model.acton_marketing_data.new_user_welcome_series_list", "model.acton_marketing_data.opp_closing_date_history_xf", "model.acton_marketing_data.opp_closing_source_ss_xf", "model.acton_marketing_data.opp_closing_source_xf", "model.acton_marketing_data.opp_demo_date_history_xf", "model.acton_marketing_data.opp_demo_source_ss_xf", "model.acton_marketing_data.opp_demo_source_xf", "model.acton_marketing_data.opp_discovery_date_history_xf", "model.acton_marketing_data.opp_sales_source_xf", "model.acton_marketing_data.opp_voc_date_history_xf", "model.acton_marketing_data.opp_voc_source_ss_xf", "model.acton_marketing_data.opp_voc_source_xf", "model.acton_marketing_data.opportunities_with_contacts", "model.acton_marketing_data.sql_source_ss_xf", "model.acton_marketing_data.sql_source_xf", "model.acton_marketing_data.sqo_source_ss_xf", "model.acton_marketing_data.sqo_source_xf", "model.acton_marketing_data.wow_disco_missing", "model.acton_marketing_data.wow_disco_pastdue", "model.acton_marketing_data.wow_disco_scheduled", "snapshot.acton_marketing_data.sfdc_opportunity_snapshot2"], "model.acton_marketing_data.lead_source_ss_xf": ["model.acton_marketing_data.lead_mql_source_ss_xf", "model.acton_marketing_data.sal_source_ss_xf"], "model.acton_marketing_data.task_source_xf": ["model.acton_marketing_data.ao_combined"], "model.acton_marketing_data.lead_source_xf": ["model.acton_marketing_data.lead_history_xf", "model.acton_marketing_data.marketing_lead_creation_date_history_xf", "model.acton_marketing_data.mql_date_history_xf", "model.acton_marketing_data.person_source_xf", "model.acton_marketing_data.working_date_history_xf", "snapshot.acton_marketing_data.sfdc_lead_snapshot2"], "model.acton_marketing_data.contract_source_xf": ["model.acton_marketing_data.account_source_xf", "model.acton_marketing_data.opp_source_xf", "snapshot.acton_marketing_data.sfdc_contract_snapshot2"], "model.acton_marketing_data.opportunity_history_xf": ["model.acton_marketing_data.opp_closing_date_history_xf", "model.acton_marketing_data.opp_demo_date_history_xf", "model.acton_marketing_data.opp_discovery_date_history_xf", "model.acton_marketing_data.opp_voc_date_history_xf"], "model.acton_marketing_data.ao_instance_user_source_xf": ["model.acton_marketing_data.new_account_welcome_series_list", "model.acton_marketing_data.new_user_welcome_series_list", "snapshot.acton_marketing_data.sfdc_ao_instance_user_snapshot2"], "model.acton_marketing_data.opportunity_line_item_xf": ["model.acton_marketing_data.opp_source_xf"], "model.acton_marketing_data.quote_line": ["model.acton_marketing_data.opp_source_xf"], "model.acton_marketing_data.campaign_influence_xf": ["model.acton_marketing_data.campaign_primary_source", "model.acton_marketing_data.customer_power_ups"], "model.acton_marketing_data.campaign_source_xf": ["model.acton_marketing_data.campaign_primary_source", "model.acton_marketing_data.customer_power_ups"], "model.acton_marketing_data.contact_source_xf": ["model.acton_marketing_data.marketing_lead_creation_date_history_xf", "model.acton_marketing_data.mql_date_history_xf", "model.acton_marketing_data.new_account_welcome_series_list", "model.acton_marketing_data.new_user_welcome_series_list", "model.acton_marketing_data.person_source_xf", "model.acton_marketing_data.working_date_history_xf", "snapshot.acton_marketing_data.sfdc_contact_snapshot3"], "model.acton_marketing_data.ao_instance_source_xf": ["model.acton_marketing_data.ao_instance_user_source_xf", "snapshot.acton_marketing_data.sfdc_ao_instance_snapshot2"], "model.acton_marketing_data.ao_emails": ["model.acton_marketing_data.ao_email_to_uid", "model.acton_marketing_data.ao_emails_xf"], "model.acton_marketing_data.ao_webinars": ["model.acton_marketing_data.ao_email_to_uid", "model.acton_marketing_data.ao_webinars_xf"], "model.acton_marketing_data.ao_email_to_uid": [], "model.acton_marketing_data.ao_forms": ["model.acton_marketing_data.ao_email_to_uid", "model.acton_marketing_data.ao_forms_xf"], "model.acton_marketing_data.ao_landingpages": ["model.acton_marketing_data.ao_email_to_uid", "model.acton_marketing_data.ao_landingpages_xf"], "model.acton_marketing_data.ao_media": ["model.acton_marketing_data.ao_email_to_uid", "model.acton_marketing_data.ao_media_xf"], "model.acton_marketing_data.ao_webpages": ["model.acton_marketing_data.ao_email_to_uid", "model.acton_marketing_data.ao_webpages_xf"], "model.acton_marketing_data.ao_webpages_xf": ["model.acton_marketing_data.ao_combined"], "model.acton_marketing_data.ao_media_xf": ["model.acton_marketing_data.ao_combined"], "model.acton_marketing_data.ao_combined": ["model.acton_marketing_data.combined_attribution", "model.acton_marketing_data.combined_attribution2", "model.acton_marketing_data.first_touch", "model.acton_marketing_data.first_touch2", "model.acton_marketing_data.last_touch", "model.acton_marketing_data.lead_creation", "model.acton_marketing_data.lead_creation2", "model.acton_marketing_data.opportunity_creation", "model.acton_marketing_data.opportunity_creation2"], "model.acton_marketing_data.ao_forms_xf": ["model.acton_marketing_data.ao_combined"], "model.acton_marketing_data.ao_emails_xf": ["model.acton_marketing_data.ao_combined"], "model.acton_marketing_data.ao_webinars_xf": ["model.acton_marketing_data.ao_combined"], "model.acton_marketing_data.ao_landingpages_xf": ["model.acton_marketing_data.ao_combined"], "model.acton_marketing_data.topo_leads": ["model.acton_marketing_data.topo_all"], "model.acton_marketing_data.topo_all": [], "model.acton_marketing_data.topo_won_acv": ["model.acton_marketing_data.topo_all"], "model.acton_marketing_data.topo_mqls": ["model.acton_marketing_data.topo_all"], "model.acton_marketing_data.topo_sqls": ["model.acton_marketing_data.topo_all"], "model.acton_marketing_data.topo_sals": ["model.acton_marketing_data.topo_all"], "model.acton_marketing_data.topo_closing": ["model.acton_marketing_data.topo_all"], "model.acton_marketing_data.topo_lost": ["model.acton_marketing_data.topo_all"], "model.acton_marketing_data.topo_sqos": ["model.acton_marketing_data.topo_all"], "model.acton_marketing_data.topo_pipe": ["model.acton_marketing_data.topo_all"], "model.acton_marketing_data.topo_won": ["model.acton_marketing_data.topo_all"], "model.acton_marketing_data.topo_demos": ["model.acton_marketing_data.topo_all"], "model.acton_marketing_data.topo_voc": ["model.acton_marketing_data.topo_all"], "model.acton_marketing_data.marketing_lead_creation_date_history_xf": [], "model.acton_marketing_data.opp_demo_date_history_xf": [], "model.acton_marketing_data.working_date_history_xf": [], "model.acton_marketing_data.opp_closing_date_history_xf": [], "model.acton_marketing_data.mql_date_history_xf": [], "model.acton_marketing_data.opp_discovery_date_history_xf": [], "model.acton_marketing_data.opp_voc_date_history_xf": [], "model.acton_marketing_data.marketo_persons_influenced": [], "model.acton_marketing_data.campaign_primary_source": [], "model.acton_marketing_data.first_touch": ["model.acton_marketing_data.combined_attribution"], "model.acton_marketing_data.lead_creation": ["model.acton_marketing_data.combined_attribution"], "model.acton_marketing_data.last_touch": ["model.acton_marketing_data.combined_attribution", "model.acton_marketing_data.combined_attribution2"], "model.acton_marketing_data.lead_creation2": ["model.acton_marketing_data.combined_attribution2"], "model.acton_marketing_data.first_touch2": ["model.acton_marketing_data.combined_attribution2"], "model.acton_marketing_data.opportunity_creation2": ["model.acton_marketing_data.combined_attribution2"], "model.acton_marketing_data.custom_model": [], "model.acton_marketing_data.combined_attribution2": [], "model.acton_marketing_data.combined_attribution": [], "model.acton_marketing_data.opportunity_creation": ["model.acton_marketing_data.combined_attribution"], "model.acton_marketing_data.customer_power_ups": [], "model.acton_marketing_data.new_account_welcome_series_list": [], "model.acton_marketing_data.new_user_welcome_series_list": [], "model.acton_marketing_data.sal_source_ss_xf": [], "model.acton_marketing_data.sql_source_ss_xf": [], "model.acton_marketing_data.opp_closing_source_xf": ["model.acton_marketing_data.funnel_report_all_time_closing"], "model.acton_marketing_data.person_source_xf": ["model.acton_marketing_data.campaign_primary_source", "model.acton_marketing_data.customer_power_ups", "model.acton_marketing_data.funnel_report_all_time_leads", "model.acton_marketing_data.lead_creation", "model.acton_marketing_data.lead_creation2", "model.acton_marketing_data.lead_mql_source_xf", "model.acton_marketing_data.marketo_persons_influenced", "model.acton_marketing_data.opportunities_with_contacts", "model.acton_marketing_data.sal_source_xf", "model.acton_marketing_data.task_source_xf"], "model.acton_marketing_data.lead_mql_source_xf": ["model.acton_marketing_data.funnel_report_all_time_mqls"], "model.acton_marketing_data.opp_voc_source_ss_xf": [], "model.acton_marketing_data.sqo_source_xf": ["model.acton_marketing_data.funnel_report_all_time_pipeline", "model.acton_marketing_data.funnel_report_all_time_sqos"], "model.acton_marketing_data.opp_demo_source_xf": ["model.acton_marketing_data.funnel_report_all_time_demo"], "model.acton_marketing_data.opp_sales_source_xf": ["model.acton_marketing_data.funnel_report_all_time_close_won_velocity_annual", "model.acton_marketing_data.funnel_report_all_time_won"], "model.acton_marketing_data.opp_voc_source_xf": ["model.acton_marketing_data.funnel_report_all_time_voc"], "model.acton_marketing_data.opp_closing_source_ss_xf": [], "model.acton_marketing_data.sqo_source_ss_xf": [], "model.acton_marketing_data.opp_demo_source_ss_xf": [], "model.acton_marketing_data.sql_source_xf": ["model.acton_marketing_data.funnel_report_all_time_close_won_velocity_annual", "model.acton_marketing_data.funnel_report_all_time_sqls"], "model.acton_marketing_data.kpi_targets": ["model.acton_marketing_data.funnel_report_all_time_asp_to_target", "model.acton_marketing_data.funnel_report_all_time_cwpipe_to_target", "model.acton_marketing_data.funnel_report_all_time_intrapipe_to_target", "model.acton_marketing_data.funnel_report_all_time_l2m_to_target", "model.acton_marketing_data.funnel_report_all_time_leads_to_target", "model.acton_marketing_data.funnel_report_all_time_m2sql_to_target", "model.acton_marketing_data.funnel_report_all_time_mqls_to_target", "model.acton_marketing_data.funnel_report_all_time_sql2sqo_to_target", "model.acton_marketing_data.funnel_report_all_time_sqls_to_target", "model.acton_marketing_data.funnel_report_all_time_sqopipe_to_target", "model.acton_marketing_data.funnel_report_all_time_sqos_to_target"], "model.acton_marketing_data.sal_source_xf": ["model.acton_marketing_data.funnel_report_all_time_sals"], "model.acton_marketing_data.lead_mql_source_ss_xf": [], "model.acton_marketing_data.wow_disco_scheduled": [], "model.acton_marketing_data.wow_disco_pastdue": [], "model.acton_marketing_data.wow_disco_missing": [], "model.acton_marketing_data.opportunities_with_contacts": ["model.acton_marketing_data.funnel_report_all_time_l20_velocity_mlc", "model.acton_marketing_data.funnel_report_all_time_l20_velocity_mlc_annual", "model.acton_marketing_data.funnel_report_all_time_l20_velocity_opp", "model.acton_marketing_data.funnel_report_all_time_l20_velocity_opp_annual", "model.acton_marketing_data.funnel_report_all_time_mql2sql_velocity", "model.acton_marketing_data.funnel_report_all_time_sal2sql_velocity", "model.acton_marketing_data.lead_to_cw_cohort"], "model.acton_marketing_data.avg_lead_to_cw_cohort_count": [], "model.acton_marketing_data.avg_lead_to_cw_cohort": [], "model.acton_marketing_data.lead_to_cw_cohort": ["model.acton_marketing_data.avg_lead_to_cw_cohort", "model.acton_marketing_data.avg_lead_to_cw_cohort_count", "model.acton_marketing_data.combined_attribution", "model.acton_marketing_data.combined_attribution2", "model.acton_marketing_data.funnel_report_all_time_cohort", "model.acton_marketing_data.opportunity_creation", "model.acton_marketing_data.opportunity_creation2"], "snapshot.acton_marketing_data.sfdc_ao_instance_snapshot2": [], "snapshot.acton_marketing_data.sfdc_contact_snapshot3": [], "snapshot.acton_marketing_data.sfdc_lead_snapshot2": [], "snapshot.acton_marketing_data.sfdc_contract_snapshot2": [], "snapshot.acton_marketing_data.sfdc_ao_instance_user_snapshot2": [], "snapshot.acton_marketing_data.sfdc_account_snapshot4": [], "snapshot.acton_marketing_data.sfdc_opportunity_snapshot2": [], "source.acton_marketing_data.salesforce.account": ["model.acton_marketing_data.account_source_xf"], "source.acton_marketing_data.salesforce.act_on_instance_c": ["model.acton_marketing_data.ao_instance_source_xf"], "source.acton_marketing_data.salesforce.act_on_instance_user_c": ["model.acton_marketing_data.ao_instance_user_source_xf"], "source.acton_marketing_data.salesforce.campaign_influence": ["model.acton_marketing_data.campaign_influence_xf"], "source.acton_marketing_data.salesforce.campaign_member": ["model.acton_marketing_data.campaign_member_source_xf"], "source.acton_marketing_data.salesforce.campaign": ["model.acton_marketing_data.campaign_source_xf"], "source.acton_marketing_data.salesforce.contact_history": ["model.acton_marketing_data.contact_history_xf"], "source.acton_marketing_data.salesforce.contact": ["model.acton_marketing_data.contact_source_xf"], "source.acton_marketing_data.salesforce.contract": ["model.acton_marketing_data.contract_source_xf"], "source.acton_marketing_data.salesforce.lead_history": ["model.acton_marketing_data.lead_history_xf"], "source.acton_marketing_data.salesforce.lead": ["model.acton_marketing_data.lead_source_xf", "model.acton_marketing_data.test"], "source.acton_marketing_data.salesforce.opportunity": ["model.acton_marketing_data.opp_source_xf"], "source.acton_marketing_data.salesforce.opportunity_field_history": ["model.acton_marketing_data.opportunity_history_xf"], "source.acton_marketing_data.salesforce.opportunity_line_item": ["model.acton_marketing_data.opportunity_line_item_xf"], "source.acton_marketing_data.salesforce.product_2": ["model.acton_marketing_data.product_xf"], "source.acton_marketing_data.salesforce.task": ["model.acton_marketing_data.task_source_xf"], "source.acton_marketing_data.salesforce.user": ["model.acton_marketing_data.user_source_xf"], "source.acton_marketing_data.data_studio_s3.data_studio_emails": ["model.acton_marketing_data.ao_emails"], "source.acton_marketing_data.data_studio_s3.data_studio_forms": ["model.acton_marketing_data.ao_forms"], "source.acton_marketing_data.data_studio_s3.data_studio_landingpages": ["model.acton_marketing_data.ao_landingpages"], "source.acton_marketing_data.data_studio_s3.data_studio_media": ["model.acton_marketing_data.ao_media"], "source.acton_marketing_data.data_studio_s3.data_studio_webinars": ["model.acton_marketing_data.ao_webinars"], "source.acton_marketing_data.data_studio_s3.data_studio_webpages": ["model.acton_marketing_data.ao_webpages"], "source.acton_marketing_data.datastudio1.email_clicks_ao_20220330": []}}