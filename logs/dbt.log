

============================== 2022-10-23 16:22:57.967337 | f8c00c04-20d3-4e2f-a5a7-f3292c670a16 ==============================
[0m16:22:57.967337 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:22:57.967337 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\JP\\Dropbox\\PC (3)\\Desktop\\Git\\generalsql-main', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['combined_attribution2'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:22:57.968317 [debug] [MainThread]: Tracking: do not track
[0m16:22:58.029516 [debug] [MainThread]: Failed to load parsed file from disk at C:\Users\JP\Dropbox\PC (3)\Desktop\Git\generalsql-main\target\partial_parse.msgpack: Field "nodes" of type MutableMapping[str, Union[CompiledAnalysisNode, CompiledSingularTestNode, CompiledModelNode, CompiledHookNode, CompiledRPCNode, CompiledSqlNode, CompiledGenericTestNode, CompiledSeedNode, CompiledSnapshotNode, ParsedAnalysisNode, ParsedSingularTestNode, ParsedHookNode, ParsedModelNode, ParsedRPCNode, ParsedSqlNode, ParsedGenericTestNode, ParsedSeedNode, ParsedSnapshotNode]] in Manifest has invalid value {'model.acton_marketing_data.test': {'raw_sql': 'WITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source(\'salesforce\', \'lead\') }}\r\n\r\n), intermediate AS (\r\n\r\nSELECT\r\n    created_date::Timestamp AS created_date\r\nFROM base\r\nWHERE email =\'100443596@alumnos.uc3m.es\'\r\n\r\n)\r\n\r\nSELECT\r\n    {{ dbt_date.convert_timezone("created_date", "America/Los_Angeles") }} As create_date\r\nFROM intermediate', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_date.convert_timezone'], 'nodes': ['source.acton_marketing_data.salesforce.lead']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'test', 'test'], 'unique_id': 'model.acton_marketing_data.test', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'test/test.sql', 'original_file_path': 'models/test/test.sql', 'name': 'test', 'alias': 'test', 'checksum': {'name': 'sha256', 'checksum': 'a7f9b3ad0ae5a655e81d1cf01fe74d84876e043b967ebec778c29e1e6de035bd'}, 'tags': [], 'refs': [], 'sources': [['salesforce', 'lead']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.1227105, 'config_call_dict': {}}, 'model.acton_marketing_data.funnel_report_all_time_filters_industry': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n), final AS (\r\n\r\n    SELECT DISTINCT\r\n        base.industry\r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_leads', 'model.acton_marketing_data.funnel_report_all_time_mqls', 'model.acton_marketing_data.funnel_report_all_time_sals', 'model.acton_marketing_data.funnel_report_all_time_sqls', 'model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.funnel_report_all_time_demo', 'model.acton_marketing_data.funnel_report_all_time_voc', 'model.acton_marketing_data.funnel_report_all_time_closing', 'model.acton_marketing_data.funnel_report_all_time_won', 'model.acton_marketing_data.funnel_report_all_time_lost']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_filters_industry'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_filters_industry', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_filters_industry.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_filters_industry.sql', 'name': 'funnel_report_all_time_filters_industry', 'alias': 'funnel_report_all_time_filters_industry', 'checksum': {'name': 'sha256', 'checksum': 'c7d4c98370b026ce59cb26641d423445561759d5062cc9dc9d1c6a7a48c375d2'}, 'tags': [], 'refs': [['funnel_report_all_time_leads'], ['funnel_report_all_time_mqls'], ['funnel_report_all_time_sals'], ['funnel_report_all_time_sqls'], ['funnel_report_all_time_sqos'], ['funnel_report_all_time_demo'], ['funnel_report_all_time_voc'], ['funnel_report_all_time_closing'], ['funnel_report_all_time_won'], ['funnel_report_all_time_lost']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.1429906, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_mql2sql_velocity': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        mql_created_date AS mql_date,\r\n        opportunity_id,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket,\r\n        opp_created_date AS sql_date,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket\r\n    FROM {{ref(\'opportunities_with_contacts\')}}\r\n    WHERE type=\'New Business\'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        mql_date,\r\n        sql_date,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        account_global_region,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket,\r\n        {{ dbt_utils.datediff("mql_date","sql_date",\'day\')}} AS mql2sql_velocity\r\n    FROM base\r\n    WHERE sql_date >= mql_date\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    opp_company_size_rev,\r\n    opp_lead_source,\r\n    opp_segment,\r\n    opp_industry,\r\n    opp_channel_bucket,\r\n    opp_industry_bucket,\r\n    sql_date,\r\n    mql2sql_velocity\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.opportunities_with_contacts']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_mql2sql_velocity'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_mql2sql_velocity', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_mql2sql_velocity.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_mql2sql_velocity.sql', 'name': 'funnel_report_all_time_mql2sql_velocity', 'alias': 'funnel_report_all_time_mql2sql_velocity', 'checksum': {'name': 'sha256', 'checksum': 'c664b0df81c7668addc6bcfcc46cc1f8dcfcff51d86720a5f51eefd4e42bebe0'}, 'tags': [], 'refs': [['opportunities_with_contacts']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.1466982, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_l20_velocity_opp': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opportunity_id,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket,\r\n        opp_created_date,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket\r\n    FROM {{ref(\'opportunities_with_contacts\')}}\r\n    WHERE type=\'New Business\'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opp_created_date,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket,\r\n        {{ dbt_utils.datediff("marketing_created_date","opp_created_date",\'day\')}} AS lead_to_opp_velocity\r\n    FROM base\r\n    WHERE opp_created_date >= marketing_created_date\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    opp_company_size_rev,\r\n    opp_lead_source,\r\n    opp_segment,\r\n    opp_industry,\r\n    opp_channel_bucket,\r\n    opp_industry_bucket,\r\n    opp_created_date,\r\n    lead_to_opp_velocity\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.opportunities_with_contacts']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_l20_velocity_opp'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_l20_velocity_opp', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_l20_velocity_opp.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_l20_velocity_opp.sql', 'name': 'funnel_report_all_time_l20_velocity_opp', 'alias': 'funnel_report_all_time_l20_velocity_opp', 'checksum': {'name': 'sha256', 'checksum': '9254fe4c290baa246bf90a18727ab413d8b3ef3f56d6d411a5a93ee7c6eda82b'}, 'tags': [], 'refs': [['opportunities_with_contacts']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.1655686, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_lost': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n        SELECT DISTINCT\r\n        opp_source_xf.opportunity_id AS lost_id,\r\n        CONCAT('https://acton.my.salesforce.com/',opp_source_xf.opportunity_id) AS lost_url,\r\n        opp_source_xf.account_name,\r\n        opp_source_xf.type AS opp_type,\r\n        acv_deal_size_usd,\r\n        opp_source_xf.close_date AS lost_date,\r\n        CASE\r\n        WHEN opp_source_xf.account_global_region IS null THEN 'blank'\r\n        ELSE opp_source_xf.account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN opp_source_xf.company_size_rev IS null THEN 'blank'\r\n        ELSE opp_source_xf.company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_source_xf.opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_source_xf.opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN opp_source_xf.segment IS null THEN 'blank'\r\n        ELSE opp_source_xf.segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN opp_source_xf.industry IS null THEN 'blank'\r\n        ELSE opp_source_xf.industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN opp_source_xf.industry_bucket IS null THEN 'blank'\r\n        ELSE opp_source_xf.industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN opp_source_xf.channel_bucket IS null THEN 'blank'\r\n        ELSE opp_source_xf.channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE opp_offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation\r\n    FROM {{ref('opp_source_xf')}}\r\n    LEFT JOIN {{ref('account_source_xf')}} ON\r\n    opp_source_xf.account_id=account_source_xf.account_id\r\n    WHERE opp_source_xf.close_date IS NOT null\r\n    AND opp_source_xf.stage_name IN ('Closed â€“ Lost No Resources / Budget','Closed â€“ Lost Not Ready / No Decision','Closed â€“ Lost Product Deficiency','Closed - Lost to Competitor', 'Closed Lost')\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.account_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_lost'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_lost', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_lost.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_lost.sql', 'name': 'funnel_report_all_time_lost', 'alias': 'funnel_report_all_time_lost', 'checksum': {'name': 'sha256', 'checksum': '8a9d6d2bda7b023c0abfd65560801adedc69d085e336fbc412db057ff53d8e7a'}, 'tags': [], 'refs': [['opp_source_xf'], ['account_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.1720326, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_sqos_to_target': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH sqo_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS sqos_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_sqos'\r\n\r\n), actual_sqos AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sqo_date)::Date AS sqos_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT sqo_id) AS sqos\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    WHERE sqo_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    sqos_month,\r\n    actual_sqos.region,\r\n    sqos,\r\n    sqos_target,\r\n    sqos/sqos_target AS actual_vs_target\r\nFROM actual_sqos\r\nLEFT JOIN sqo_target ON\r\nactual_sqos.sqos_month=sqo_target.kpi_month\r\nAND actual_sqos.region=sqo_target.kpi_region\r\nWHERE region IS NOT null", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.kpi_targets', 'model.acton_marketing_data.funnel_report_all_time_sqos']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_sqos_to_target'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_sqos_to_target', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_sqos_to_target.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_sqos_to_target.sql', 'name': 'funnel_report_all_time_sqos_to_target', 'alias': 'funnel_report_all_time_sqos_to_target', 'checksum': {'name': 'sha256', 'checksum': '83987d935de3b1bf18b1efa42c564969679b9fac98f394fb80a1e5c70c5c5124'}, 'tags': [], 'refs': [['kpi_targets'], ['funnel_report_all_time_sqos']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.1744523, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_sqos': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        sqo_source_xf.opportunity_id AS sqo_id,\r\n        CONCAT('https://acton.my.salesforce.com/',sqo_source_xf.opportunity_id) AS sqo_url,\r\n        sqo_source_xf.discovery_date AS sqo_date,\r\n        account_name,\r\n        opportunity_name,\r\n        type AS opp_type,\r\n        owner_name,\r\n        sdr_name,\r\n        created_date,\r\n        close_date,\r\n        acv,\r\n        CASE\r\n        WHEN account_global_region IS null THEN 'blank'\r\n        ELSE account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE opp_offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation\r\n    FROM {{ref('sqo_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.sqo_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_sqos'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_sqos', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_sqos.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_sqos.sql', 'name': 'funnel_report_all_time_sqos', 'alias': 'funnel_report_all_time_sqos', 'checksum': {'name': 'sha256', 'checksum': '0188fc0bca8f02a7752cacba955f164af129befc3138bec71bc0c1740b836ce2'}, 'tags': [], 'refs': [['sqo_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.1766112, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_filters_date': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n), final AS (\r\n\r\n    SELECT DISTINCT\r\n        base.date    \r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_leads', 'model.acton_marketing_data.funnel_report_all_time_mqls', 'model.acton_marketing_data.funnel_report_all_time_sals', 'model.acton_marketing_data.funnel_report_all_time_sqls', 'model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.funnel_report_all_time_demo', 'model.acton_marketing_data.funnel_report_all_time_voc', 'model.acton_marketing_data.funnel_report_all_time_closing', 'model.acton_marketing_data.funnel_report_all_time_won', 'model.acton_marketing_data.funnel_report_all_time_lost']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_filters_date'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_filters_date', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_filters_date.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_filters_date.sql', 'name': 'funnel_report_all_time_filters_date', 'alias': 'funnel_report_all_time_filters_date', 'checksum': {'name': 'sha256', 'checksum': '2222effdd84473f6e1fd863cf5c4b90979c4cec5a9d0f08043886aa6254d0255'}, 'tags': [], 'refs': [['funnel_report_all_time_leads'], ['funnel_report_all_time_mqls'], ['funnel_report_all_time_sals'], ['funnel_report_all_time_sqls'], ['funnel_report_all_time_sqos'], ['funnel_report_all_time_demo'], ['funnel_report_all_time_voc'], ['funnel_report_all_time_closing'], ['funnel_report_all_time_won'], ['funnel_report_all_time_lost']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.1790948, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_pipeline': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        sqo_source_xf.opportunity_id AS sqo_id,\r\n        CONCAT('https://acton.my.salesforce.com/',sqo_source_xf.opportunity_id) AS sqo_url,\r\n        sqo_source_xf.discovery_date AS sqo_date,\r\n        account_name,\r\n        opportunity_name,\r\n        stage_name,\r\n        type AS opp_type,\r\n        owner_name,\r\n        sdr_name,\r\n        created_date,\r\n        close_date,\r\n        acv,\r\n        CASE\r\n        WHEN account_global_region IS null THEN 'blank'\r\n        ELSE account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket\r\n    FROM {{ref('sqo_source_xf')}}\r\n\r\n) , final AS (\r\n\r\n    SELECT\r\n        sqo_id,\r\n        sqo_date,\r\n        opportunity_name,\r\n        stage_name,\r\n        opp_type,\r\n        acv,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        CASE\r\n            WHEN stage_name = 'Discovery' THEN '1.SQO'\r\n            WHEN stage_name = 'Demo' THEN '2.Demo'\r\n            WHEN stage_name = 'VOC/Negotiate' THEN '3.VOC'\r\n            WHEN stage_name = 'Closing' THEN '4.Closing'\r\n            WHEN stage_name = 'Implement' THEN '5.Closed Won'\r\n            WHEN LOWER(stage_name) LIKE '%lost%' THEN '6.Closed Lost'\r\n            WHEN stage_name = 'Not Renewed' THEN '7.Not Renewed'\r\n        END AS current_stage\r\n    FROM base\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.sqo_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_pipeline'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_pipeline', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_pipeline.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_pipeline.sql', 'name': 'funnel_report_all_time_pipeline', 'alias': 'funnel_report_all_time_pipeline', 'checksum': {'name': 'sha256', 'checksum': 'd673b787eb32b5aeb73b1fa0ec4cfb17048d34a579f5089cef15c6986d5a3a65'}, 'tags': [], 'refs': [['sqo_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.1819956, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_asp_to_target': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH asp_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS asp_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_asp'\r\n\r\n), actual_asp AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sqo_date)::Date AS asp_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        SUM(acv)/COUNT(DISTINCT sqo_id) AS asp\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    WHERE sqo_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    asp_month,\r\n    actual_asp.region,\r\n    asp,\r\n    asp_target,\r\n    asp/asp_target AS actual_vs_target\r\nFROM actual_asp\r\nLEFT JOIN asp_target ON\r\nactual_asp.asp_month=asp_target.kpi_month\r\nAND actual_asp.region=asp_target.kpi_region\r\nWHERE region IS NOT null", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.kpi_targets', 'model.acton_marketing_data.funnel_report_all_time_sqos']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_asp_to_target'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_asp_to_target', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_asp_to_target.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_asp_to_target.sql', 'name': 'funnel_report_all_time_asp_to_target', 'alias': 'funnel_report_all_time_asp_to_target', 'checksum': {'name': 'sha256', 'checksum': 'a3d211cf0c544e1ec6fab862d5ae7eb38fac299557f806be29cd96fe597b42cd'}, 'tags': [], 'refs': [['kpi_targets'], ['funnel_report_all_time_sqos']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.1841855, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_intrapipe_to_target': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH intrapipe_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS intrapipe_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_intra_qtr_pipe'\r\n\r\n), actual_intrapipe AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sqo_date)::Date AS intrapipe_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        SUM(acv)/COUNT(DISTINCT sqo_id) AS intrapipe\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    WHERE sqo_date >= '2022-04-01'\r\n    AND DATE_TRUNC('month',sqo_date)=DATE_TRUNC('month',close_date)\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    intrapipe_month,\r\n    actual_intrapipe.region,\r\n    intrapipe,\r\n    intrapipe_target,\r\n    intrapipe/intrapipe_target AS actual_vs_target\r\nFROM actual_intrapipe\r\nLEFT JOIN intrapipe_target ON\r\nactual_intrapipe.intrapipe_month=intrapipe_target.kpi_month\r\nAND actual_intrapipe.region=intrapipe_target.kpi_region\r\nWHERE region IS NOT null", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.kpi_targets', 'model.acton_marketing_data.funnel_report_all_time_sqos']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_intrapipe_to_target'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_intrapipe_to_target', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_intrapipe_to_target.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_intrapipe_to_target.sql', 'name': 'funnel_report_all_time_intrapipe_to_target', 'alias': 'funnel_report_all_time_intrapipe_to_target', 'checksum': {'name': 'sha256', 'checksum': 'fc09779f6aec80abc31d0448010f40f2ac4eb7d6c6ac4d2569ea219ea2cf233b'}, 'tags': [], 'refs': [['kpi_targets'], ['funnel_report_all_time_sqos']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.1864383, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_won': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        opp_sales_source_xf.opportunity_id AS won_id,\r\n        CONCAT('https://acton.my.salesforce.com/',opp_sales_source_xf.opportunity_id) AS won_url,\r\n        opp_sales_source_xf.close_date AS won_date,\r\n        account_name,\r\n        type AS opp_type,\r\n        acv,\r\n        opp_offer_asset_subtype_lead_creation,\r\n        opp_offer_asset_topic_lead_creation,\r\n        opp_offer_asset_type_lead_creation,\r\n        CASE\r\n        WHEN account_global_region IS null THEN 'blank'\r\n        ELSE account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE opp_offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation\r\n    FROM {{ref('opp_sales_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_sales_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_won'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_won', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_won.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_won.sql', 'name': 'funnel_report_all_time_won', 'alias': 'funnel_report_all_time_won', 'checksum': {'name': 'sha256', 'checksum': '6d1e6156888e9ede507ed4d8592a40dba9451ffcc17592bd42c7f059645f8820'}, 'tags': [], 'refs': [['opp_sales_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.1887493, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_sal2sql_velocity': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        working_date,\r\n        opportunity_id,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket,\r\n        opp_created_date,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket\r\n    FROM {{ref(\'opportunities_with_contacts\')}}\r\n    WHERE type=\'New Business\'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        working_date,\r\n        opp_created_date,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket,\r\n        {{ dbt_utils.datediff("working_date","opp_created_date",\'day\')}} AS sal2sql_velocity\r\n    FROM base\r\n    WHERE opp_created_date >= working_date\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    opp_company_size_rev,\r\n    opp_lead_source,\r\n    opp_segment,\r\n    opp_industry,\r\n    opp_channel_bucket,\r\n    opp_industry_bucket,\r\n    opp_created_date,\r\n    sal2sql_velocity\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.opportunities_with_contacts']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_sal2sql_velocity'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_sal2sql_velocity', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_sal2sql_velocity.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_sal2sql_velocity.sql', 'name': 'funnel_report_all_time_sal2sql_velocity', 'alias': 'funnel_report_all_time_sal2sql_velocity', 'checksum': {'name': 'sha256', 'checksum': '142cfbb5a0c6d43f5e9787b78b67a26105dd9ac86deb20e9e2b39cd39b25a634'}, 'tags': [], 'refs': [['opportunities_with_contacts']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.1910484, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_cwpipe_to_target': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH won_pipe_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS won_pipe_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_cw_pipe'\r\n\r\n), actual_won_pipe AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',won_date)::Date AS won_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        SUM(acv) AS won_pipe\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    WHERE won_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    won_month,\r\n    actual_won_pipe.region,\r\n    won_pipe,\r\n    won_pipe_target,\r\n    won_pipe/won_pipe_target AS actual_vs_target\r\nFROM actual_won_pipe\r\nLEFT JOIN won_pipe_target ON\r\nactual_won_pipe.won_month=won_pipe_target.kpi_month\r\nAND actual_won_pipe.region=won_pipe_target.kpi_region\r\nWHERE region IS NOT null", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.kpi_targets', 'model.acton_marketing_data.funnel_report_all_time_won']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_cwpipe_to_target'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_cwpipe_to_target', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_cwpipe_to_target.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_cwpipe_to_target.sql', 'name': 'funnel_report_all_time_cwpipe_to_target', 'alias': 'funnel_report_all_time_cwpipe_to_target', 'checksum': {'name': 'sha256', 'checksum': '4407cd2039748d8c5803af007f7dff2448bcdd6c96ac210a4a6061580c129165'}, 'tags': [], 'refs': [['kpi_targets'], ['funnel_report_all_time_won']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.1968102, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_l20_velocity_opp_annual': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opportunity_id,\r\n        opp_created_date,\r\n        type AS opp_type,\r\n        opp_segment\r\n    FROM {{ref(\'opportunities_with_contacts\')}}\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opp_created_date,\r\n        opp_type,\r\n        opp_segment,\r\n        {{ dbt_utils.datediff("marketing_created_date","opp_created_date",\'day\')}} AS lead_to_opp_velocity\r\n    FROM base\r\n    WHERE opp_created_date >= marketing_created_date\r\n)\r\n\r\nSELECT\r\nopp_segment,\r\nopp_type,\r\nDATE_TRUNC(\'year\',opp_created_date) AS opp_created_year,\r\nAVG(lead_to_opp_velocity) AS avg_lead_to_opp_velocity\r\nFROM final\r\nGROUP BY 1,2,3', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.opportunities_with_contacts']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_l20_velocity_opp_annual'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_l20_velocity_opp_annual', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_l20_velocity_opp_annual.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_l20_velocity_opp_annual.sql', 'name': 'funnel_report_all_time_l20_velocity_opp_annual', 'alias': 'funnel_report_all_time_l20_velocity_opp_annual', 'checksum': {'name': 'sha256', 'checksum': '34311d431bb4fe95a29daa9cf08e885570a2d53ba83249a4e33e7b8eeec5d76e'}, 'tags': [], 'refs': [['opportunities_with_contacts']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.199063, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_sqo2demo_velocity': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH sqo_opp AS (\r\n\r\n    SELECT\r\n        sqo_id,\r\n        sqo_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_sqos\')}}\r\n\r\n),  demo_opp AS (\r\n\r\n    SELECT\r\n        demo_id,\r\n        demo_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_demo\')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        demo_id,\r\n        demo_date,\r\n        sqo_date,\r\n        demo_opp.account_global_region,\r\n        demo_opp.company_size_rev,\r\n        demo_opp.opp_lead_source,\r\n        demo_opp.segment,\r\n        demo_opp.industry,\r\n        demo_opp.channel_bucket,\r\n        demo_opp.industry_bucket,\r\n        {{ dbt_utils.datediff("sqo_date","demo_date",\'day\')}} AS sqo2demo_velocity\r\n    FROM demo_opp\r\n    LEFT JOIN sqo_opp ON \r\n    demo_opp.demo_id=sqo_opp.sqo_id\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    company_size_rev,\r\n    opp_lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    demo_date,\r\n    sqo2demo_velocity\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.funnel_report_all_time_demo']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_sqo2demo_velocity'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_sqo2demo_velocity', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_sqo2demo_velocity.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_sqo2demo_velocity.sql', 'name': 'funnel_report_all_time_sqo2demo_velocity', 'alias': 'funnel_report_all_time_sqo2demo_velocity', 'checksum': {'name': 'sha256', 'checksum': '5350e1a0a85829b70086e07ea6501a4262afd1630e9d88aecebdfd60517720cd'}, 'tags': [], 'refs': [['funnel_report_all_time_sqos'], ['funnel_report_all_time_demo']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.204639, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_voc': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        opp_voc_source_xf.opportunity_id AS voc_id,\r\n        CONCAT('https://acton.my.salesforce.com/',opp_voc_source_xf.opportunity_id) AS voc_url,\r\n        account_name,\r\n        type AS opp_type,\r\n        acv,\r\n        opp_voc_source_xf.negotiation_date AS voc_date,\r\n        CASE\r\n        WHEN account_global_region IS null THEN 'blank'\r\n        ELSE account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE opp_offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation\r\n    FROM {{ref('opp_voc_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_voc_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_voc'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_voc', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_voc.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_voc.sql', 'name': 'funnel_report_all_time_voc', 'alias': 'funnel_report_all_time_voc', 'checksum': {'name': 'sha256', 'checksum': '6730b38978cb34ed83af8d488cc29f8fd6d9b7dd7fd247211a885fc8f76258a9'}, 'tags': [], 'refs': [['opp_voc_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2105553, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_filters_segment': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n), final AS (\r\n\r\n    SELECT DISTINCT\r\n        base.segment   \r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_leads', 'model.acton_marketing_data.funnel_report_all_time_mqls', 'model.acton_marketing_data.funnel_report_all_time_sals', 'model.acton_marketing_data.funnel_report_all_time_sqls', 'model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.funnel_report_all_time_demo', 'model.acton_marketing_data.funnel_report_all_time_voc', 'model.acton_marketing_data.funnel_report_all_time_closing', 'model.acton_marketing_data.funnel_report_all_time_won', 'model.acton_marketing_data.funnel_report_all_time_lost']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_filters_segment'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_filters_segment', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_filters_segment.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_filters_segment.sql', 'name': 'funnel_report_all_time_filters_segment', 'alias': 'funnel_report_all_time_filters_segment', 'checksum': {'name': 'sha256', 'checksum': '489d54ed8a58c1e660f065985d24f82fbc2cd387425b2a52098ec16317fa5850'}, 'tags': [], 'refs': [['funnel_report_all_time_leads'], ['funnel_report_all_time_mqls'], ['funnel_report_all_time_sals'], ['funnel_report_all_time_sqls'], ['funnel_report_all_time_sqos'], ['funnel_report_all_time_demo'], ['funnel_report_all_time_voc'], ['funnel_report_all_time_closing'], ['funnel_report_all_time_won'], ['funnel_report_all_time_lost']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2125778, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_clos2cw_velocity': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH won_opp AS (\r\n\r\n    SELECT\r\n        won_id,\r\n        won_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_won\')}}\r\n\r\n),  closing_opp AS (\r\n\r\n    SELECT\r\n        closing_id,\r\n        closing_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket\r\n    FROM {{ref(\'funnel_report_all_time_closing\')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        won_id,\r\n        closing_date,\r\n        won_date,\r\n        won_opp.account_global_region,\r\n        won_opp.company_size_rev,\r\n        won_opp.opp_lead_source,\r\n        won_opp.segment,\r\n        won_opp.industry,\r\n        won_opp.industry_bucket,\r\n        won_opp.channel_bucket,\r\n        {{ dbt_utils.datediff("closing_date","won_date",\'day\')}} AS closing2cw_velocity\r\n    FROM won_opp\r\n    LEFT JOIN closing_opp ON \r\n    won_opp.won_id=closing_opp.closing_id\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    company_size_rev,\r\n    opp_lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    won_date,\r\n    closing2cw_velocity\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_won', 'model.acton_marketing_data.funnel_report_all_time_closing']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_clos2cw_velocity'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_clos2cw_velocity', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_clos2cw_velocity.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_clos2cw_velocity.sql', 'name': 'funnel_report_all_time_clos2cw_velocity', 'alias': 'funnel_report_all_time_clos2cw_velocity', 'checksum': {'name': 'sha256', 'checksum': 'a5892c1d0e05e973c553b284be66c558d02e89156f3b909d16b2c258c37c0727'}, 'tags': [], 'refs': [['funnel_report_all_time_won'], ['funnel_report_all_time_closing']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2152762, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_sqls_to_target': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH sql_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS sqls_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_sqls'\r\n\r\n), actual_sqls AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sql_date)::Date AS sqls_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT sql_id) AS sqls\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    WHERE sql_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    sqls_month,\r\n    actual_sqls.region,\r\n    sqls,\r\n    sqls_target,\r\n    sqls/sqls_target AS actual_vs_target\r\nFROM actual_sqls\r\nLEFT JOIN sql_target ON\r\nactual_sqls.sqls_month=sql_target.kpi_month\r\nAND actual_sqls.region=sql_target.kpi_region\r\nWHERE region IS NOT null", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.kpi_targets', 'model.acton_marketing_data.funnel_report_all_time_sqls']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_sqls_to_target'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_sqls_to_target', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_sqls_to_target.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_sqls_to_target.sql', 'name': 'funnel_report_all_time_sqls_to_target', 'alias': 'funnel_report_all_time_sqls_to_target', 'checksum': {'name': 'sha256', 'checksum': 'd640d8dac89fafd2cda15a540b0cc1a75a51aa48f14b8a861d9f769d0aef1253'}, 'tags': [], 'refs': [['kpi_targets'], ['funnel_report_all_time_sqls']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2215614, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_sals': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        sal_source_xf.person_id AS sal_id,\r\n        CONCAT('https://acton.my.salesforce.com/',sal_source_xf.person_id) AS sal_url,\r\n        sal_source_xf.working_date AS sal_date,\r\n        sal_source_xf.mql_most_recent_date AS mql_date,\r\n        company,\r\n        is_hand_raiser,\r\n        CASE\r\n        WHEN global_region IS null THEN 'blank'\r\n        ELSE global_region\r\n    END AS global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN lead_source IS null THEN 'blank'\r\n        ELSE lead_source\r\n    END AS lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation,\r\n    CASE\r\n        WHEN campaign_lead_creation IS null THEN 'blank'\r\n        ELSE campaign_lead_creation\r\n    END AS campaign_lead_creation\r\n    FROM {{ref('sal_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.sal_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_sals'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_sals', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_sals.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_sals.sql', 'name': 'funnel_report_all_time_sals', 'alias': 'funnel_report_all_time_sals', 'checksum': {'name': 'sha256', 'checksum': '75d6daed90c026fefd325367ae1d6028e748cc9b6174b86a0d922e58bd7bd0f9'}, 'tags': [], 'refs': [['sal_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.223625, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_sql2sqo_velocity': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH sqo_opp AS (\r\n\r\n    SELECT\r\n        sqo_id,\r\n        sqo_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_sqos\')}}\r\n\r\n),  sql_opp AS (\r\n\r\n    SELECT\r\n        sql_id,\r\n        sql_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_sqls\')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        sqo_id,\r\n        sql_date,\r\n        sqo_date,\r\n        sqo_opp.account_global_region,\r\n        sqo_opp.company_size_rev,\r\n        sqo_opp.opp_lead_source,\r\n        sqo_opp.segment,\r\n        sqo_opp.industry,\r\n        sqo_opp.channel_bucket,\r\n        sqo_opp.industry_bucket,\r\n        {{ dbt_utils.datediff("sql_date","sqo_date",\'day\')}} AS sql2sqo_velocity\r\n    FROM sqo_opp\r\n    LEFT JOIN sql_opp ON \r\n    sqo_opp.sqo_id=sql_opp.sql_id\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    company_size_rev,\r\n    opp_lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    sqo_date,\r\n    sql2sqo_velocity\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.funnel_report_all_time_sqls']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_sql2sqo_velocity'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_sql2sqo_velocity', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_sql2sqo_velocity.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_sql2sqo_velocity.sql', 'name': 'funnel_report_all_time_sql2sqo_velocity', 'alias': 'funnel_report_all_time_sql2sqo_velocity', 'checksum': {'name': 'sha256', 'checksum': '0cbde095c5bd5f94bdd8e7a3ed2989ef87697e6dc7f834eac1e9d726a1db1ccf'}, 'tags': [], 'refs': [['funnel_report_all_time_sqos'], ['funnel_report_all_time_sqls']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2257864, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_l2m_to_target': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH l2m_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS l2m_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_l2m_conv'\r\n\r\n), actual_leads AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',created_date)::Date AS leads_month,\r\n        CASE \r\n            WHEN global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT lead_id) AS leads\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    WHERE created_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n\r\n), actual_mqls AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',mql_date)::Date AS mqls_month,\r\n        CASE \r\n            WHEN global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT mql_id) AS mqls\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    WHERE mql_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n\r\n), actual_l2m AS (\r\n\r\n    SELECT\r\n        mqls_month,\r\n        actual_mqls.region,\r\n        SUM(mqls)/SUM(leads) AS l2m_actual\r\n    FROM actual_mqls\r\n    LEFT JOIN actual_leads ON \r\n    actual_mqls.region=actual_leads.region\r\n    AND actual_mqls.mqls_month=actual_leads.leads_month\r\n    WHERE actual_mqls.region IS NOT null\r\n    GROUP BY 1,2\r\n\r\n)\r\n\r\nSELECT\r\n    mqls_month,\r\n    actual_l2m.region,\r\n    l2m_actual,\r\n    l2m_target,\r\n    l2m_actual/l2m_target AS actual_vs_target\r\nFROM actual_l2m\r\nLEFT JOIN l2m_target ON\r\nactual_l2m.mqls_month=l2m_target.kpi_month\r\nAND actual_l2m.region=l2m_target.kpi_region\r\nWHERE region IS NOT null", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.kpi_targets', 'model.acton_marketing_data.funnel_report_all_time_leads', 'model.acton_marketing_data.funnel_report_all_time_mqls']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_l2m_to_target'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_l2m_to_target', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_l2m_to_target.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_l2m_to_target.sql', 'name': 'funnel_report_all_time_l2m_to_target', 'alias': 'funnel_report_all_time_l2m_to_target', 'checksum': {'name': 'sha256', 'checksum': '562ee0943739a8efd0266ee4c1b62d1655b6a81cd9bab6ba5ca8aa7f8d86f200'}, 'tags': [], 'refs': [['kpi_targets'], ['funnel_report_all_time_leads'], ['funnel_report_all_time_mqls']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.232143, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_sqls': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        sql_source_xf.sql_id,\r\n        CONCAT('https://acton.my.salesforce.com/',sql_source_xf.sql_id) AS sql_url,\r\n        sql_source_xf.created_date AS sql_date,\r\n        account_name,\r\n        opportunity_name,\r\n        type AS opp_type,\r\n        owner_name,\r\n        sdr_name,\r\n        CASE\r\n        WHEN account_global_region IS null THEN 'blank'\r\n        ELSE account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE opp_offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation\r\n    FROM {{ref('sql_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.sql_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_sqls'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_sqls', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_sqls.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_sqls.sql', 'name': 'funnel_report_all_time_sqls', 'alias': 'funnel_report_all_time_sqls', 'checksum': {'name': 'sha256', 'checksum': '0b0594cc8c572526c613201d9bd6c6a6fb9916f8578d9af5ea5f0c4e3da9c994'}, 'tags': [], 'refs': [['sql_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.234674, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_cohort': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n    --person fields\r\n        person_id,\r\n        marketing_created_date,\r\n        mql_created_date,\r\n        sal_created_date,\r\n        person_status,\r\n        email,\r\n        person_owner_id,\r\n\r\n    --opp fields\r\n        opportunity_id,\r\n        stage_name,\r\n        opp_type,\r\n        opp_created_date,\r\n        discovery_date,\r\n        demo_date,\r\n        voc_date,\r\n        closing_date,\r\n        close_date,\r\n        cw_date,\r\n        cl_date,\r\n\r\n    --Info\r\n        CASE\r\n            WHEN global_region IS null THEN 'blank'\r\n            ELSE global_region\r\n        END AS global_region,\r\n        CASE\r\n            WHEN company_size_rev IS null THEN 'blank'\r\n            ELSE company_size_rev\r\n        END AS company_size_rev,\r\n        CASE\r\n            WHEN lead_source IS null THEN 'blank'\r\n            ELSE lead_source\r\n        END AS lead_source,\r\n        CASE\r\n            WHEN segment IS null THEN 'blank'\r\n            ELSE segment\r\n        END AS segment,\r\n        CASE\r\n            WHEN industry IS null THEN 'blank'\r\n            ELSE industry\r\n        END AS industry,\r\n        CASE\r\n            WHEN industry_bucket IS null THEN 'blank'\r\n            ELSE industry_bucket\r\n        END AS industry_bucket,\r\n        CASE\r\n            WHEN channel_bucket IS null THEN 'blank'\r\n            ELSE channel_bucket\r\n        END AS channel_bucket,\r\n        CASE\r\n            WHEN person_offer_asset_name_lead_creation IS null THEN 'blank'\r\n            ELSE person_offer_asset_name_lead_creation\r\n        END AS offer_asset_name_lead_creation,\r\n        CASE\r\n            WHEN account_global_region IS null THEN 'blank'\r\n            ELSE account_global_region\r\n        END AS account_global_region,\r\n        CASE\r\n            WHEN opp_company_size_rev IS null THEN 'blank'\r\n            ELSE opp_company_size_rev\r\n        END AS opp_company_size_rev,\r\n        CASE\r\n            WHEN opp_lead_source IS null THEN 'blank'\r\n            ELSE opp_lead_source\r\n        END AS opp_lead_source,\r\n        CASE\r\n            WHEN opp_segment IS null THEN 'blank'\r\n            ELSE opp_segment\r\n        END AS opp_segment,\r\n        CASE\r\n            WHEN opp_industry IS null THEN 'blank'\r\n            ELSE opp_industry\r\n        END AS opp_industry,\r\n        CASE\r\n            WHEN opp_industry_bucket IS null THEN 'blank'\r\n            ELSE opp_industry_bucket\r\n        END AS opp_industry_bucket,\r\n        CASE\r\n            WHEN opp_channel_bucket IS null THEN 'blank'\r\n            ELSE opp_channel_bucket\r\n        END AS opp_channel_bucket,\r\n        CASE\r\n            WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n            ELSE opp_offer_asset_name_lead_creation\r\n        END AS opp_offer_asset_name_lead_creation,\r\n\r\n    --Flags\r\n        is_hand_raiser,\r\n        is_mql,\r\n        is_sal,\r\n        is_sql,\r\n        is_sqo,\r\n        is_demo,\r\n        is_voc,\r\n        is_closing,\r\n        is_cl,\r\n        is_cw,\r\n        is_won\r\n    FROM {{ref('lead_to_cw_cohort')}}\r\n\r\n)\r\n\r\nSELECT\r\n--ID Fields\r\n    person_id,\r\n    CASE\r\n        WHEN is_mql = 1 THEN person_id\r\n        ELSE null\r\n    END AS mql_id,\r\n    CASE\r\n        WHEN is_sal = 1 THEN person_id\r\n        ELSE null\r\n    END AS sal_id,\r\n    CASE\r\n        WHEN is_sql = 1 THEN opportunity_id\r\n        ELSE null\r\n    END AS sql_id,\r\n    CASE\r\n        WHEN is_sqo = 1 THEN opportunity_id\r\n        ELSE null\r\n    END AS sqo_id,\r\n    CASE\r\n        WHEN is_demo = 1 THEN opportunity_id\r\n        ELSE null\r\n    END AS demo_id,\r\n    CASE\r\n        WHEN is_voc = 1 THEN opportunity_id\r\n        ELSE null\r\n    END AS voc_id,\r\n    CASE\r\n        WHEN is_closing = 1 THEN opportunity_id\r\n        ELSE null\r\n    END AS closing_id,\r\n    CASE\r\n        WHEN is_cl = 1 THEN opportunity_id\r\n        ELSE null\r\n    END AS cl_id,\r\n    CASE\r\n        WHEN is_cw = 1 THEN opportunity_id\r\n        ELSE null\r\n    END AS cw_id,\r\n\r\n--person fields\r\n        marketing_created_date,\r\n        mql_created_date,\r\n        sal_created_date,\r\n        person_status,\r\n\r\n--opp fields\r\n        opportunity_id,\r\n        opp_type,\r\n        stage_name,\r\n        opp_created_date,\r\n        discovery_date,\r\n        demo_date,\r\n        voc_date,\r\n        closing_date,\r\n        close_date,\r\n        cw_date,\r\n        cl_date,\r\n\r\n-- person data\r\n    global_region,\r\n    company_size_rev,\r\n    lead_source,\r\n    segment,\r\n    industry,\r\n    industry_bucket,\r\n    channel_bucket,\r\n    offer_asset_name_lead_creation,\r\n\r\n-- opp data\r\n    account_global_region,\r\n    opp_company_size_rev,\r\n    opp_lead_source,\r\n    opp_segment,\r\n    opp_industry,\r\n    opp_industry_bucket,\r\n    opp_channel_bucket,\r\n    opp_offer_asset_name_lead_creation,\r\n\r\n--Flags\r\n    is_hand_raiser,\r\n    is_mql,\r\n    is_sal,\r\n    is_sql,\r\n    is_sqo,\r\n    is_demo,\r\n    is_voc,\r\n    is_closing,\r\n    is_cl,\r\n    is_cw,\r\n    is_won\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.lead_to_cw_cohort']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_cohort'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_cohort', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_cohort.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_cohort.sql', 'name': 'funnel_report_all_time_cohort', 'alias': 'funnel_report_all_time_cohort', 'checksum': {'name': 'sha256', 'checksum': 'a4813364e902ce287645ff54486c9030b85b0a72dcd2cc357488a4785accdb1b'}, 'tags': [], 'refs': [['lead_to_cw_cohort']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2367904, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_closing': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        opp_closing_source_xf.opportunity_id AS closing_id,\r\n        CONCAT('https://acton.my.salesforce.com/',opp_closing_source_xf.opportunity_id) AS closing_url,\r\n        acv,\r\n        account_name,\r\n        type AS opp_type,\r\n        opp_closing_source_xf.closing_date AS closing_date,\r\n        CASE\r\n        WHEN account_global_region IS null THEN 'blank'\r\n        ELSE account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE opp_offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation\r\n    FROM {{ref('opp_closing_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_closing_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_closing'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_closing', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_closing.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_closing.sql', 'name': 'funnel_report_all_time_closing', 'alias': 'funnel_report_all_time_closing', 'checksum': {'name': 'sha256', 'checksum': '83324f52b4a2f6b22128ac84dc04594350ea48362ecb673ff94af965274de061'}, 'tags': [], 'refs': [['opp_closing_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2389977, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_filters_channelbucket': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n), final AS (\r\n\r\n    SELECT DISTINCT\r\n        base.channel_bucket\r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_leads', 'model.acton_marketing_data.funnel_report_all_time_mqls', 'model.acton_marketing_data.funnel_report_all_time_sals', 'model.acton_marketing_data.funnel_report_all_time_sqls', 'model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.funnel_report_all_time_demo', 'model.acton_marketing_data.funnel_report_all_time_voc', 'model.acton_marketing_data.funnel_report_all_time_closing', 'model.acton_marketing_data.funnel_report_all_time_won', 'model.acton_marketing_data.funnel_report_all_time_lost']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_filters_channelbucket'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_filters_channelbucket', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_filters_channelbucket.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_filters_channelbucket.sql', 'name': 'funnel_report_all_time_filters_channelbucket', 'alias': 'funnel_report_all_time_filters_channelbucket', 'checksum': {'name': 'sha256', 'checksum': 'ca70d41182a7716a9d7460c6e3d5e1f86c0d107b4b47afc2681e174eb00142fb'}, 'tags': [], 'refs': [['funnel_report_all_time_leads'], ['funnel_report_all_time_mqls'], ['funnel_report_all_time_sals'], ['funnel_report_all_time_sqls'], ['funnel_report_all_time_sqos'], ['funnel_report_all_time_demo'], ['funnel_report_all_time_voc'], ['funnel_report_all_time_closing'], ['funnel_report_all_time_won'], ['funnel_report_all_time_lost']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.241413, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_filters_leadsource': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n), final AS (\r\n\r\n    SELECT DISTINCT\r\n        base.lead_source\r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_leads', 'model.acton_marketing_data.funnel_report_all_time_mqls', 'model.acton_marketing_data.funnel_report_all_time_sals', 'model.acton_marketing_data.funnel_report_all_time_sqls', 'model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.funnel_report_all_time_demo', 'model.acton_marketing_data.funnel_report_all_time_voc', 'model.acton_marketing_data.funnel_report_all_time_closing', 'model.acton_marketing_data.funnel_report_all_time_won', 'model.acton_marketing_data.funnel_report_all_time_lost']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_filters_leadsource'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_filters_leadsource', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_filters_leadsource.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_filters_leadsource.sql', 'name': 'funnel_report_all_time_filters_leadsource', 'alias': 'funnel_report_all_time_filters_leadsource', 'checksum': {'name': 'sha256', 'checksum': 'f4159bb8f5e13583482a47000cc6e983d86587356fbfca0e3e6f059c20963f5e'}, 'tags': [], 'refs': [['funnel_report_all_time_leads'], ['funnel_report_all_time_mqls'], ['funnel_report_all_time_sals'], ['funnel_report_all_time_sqls'], ['funnel_report_all_time_sqos'], ['funnel_report_all_time_demo'], ['funnel_report_all_time_voc'], ['funnel_report_all_time_closing'], ['funnel_report_all_time_won'], ['funnel_report_all_time_lost']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.244046, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_sqo2won_velocity': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH sqo_opp AS (\r\n\r\n    SELECT\r\n        sqo_id,\r\n        sqo_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_sqos\')}}\r\n\r\n), won_opp AS (\r\n\r\n    SELECT\r\n        won_id,\r\n        won_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_won\')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        won_id,\r\n        won_date,\r\n        sqo_date,\r\n        won_opp.account_global_region,\r\n        won_opp.company_size_rev,\r\n        won_opp.opp_lead_source,\r\n        won_opp.segment,\r\n        won_opp.industry,\r\n        won_opp.channel_bucket,\r\n        won_opp.industry_bucket,\r\n        {{ dbt_utils.datediff("sqo_date","won_date",\'day\')}} AS sqo2won_velocity\r\n    FROM won_opp\r\n    LEFT JOIN sqo_opp ON \r\n    won_opp.won_id=sqo_opp.sqo_id\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    company_size_rev,\r\n    opp_lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    won_date,\r\n    sqo2won_velocity\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.funnel_report_all_time_won']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_sqo2won_velocity'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_sqo2won_velocity', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_sqo2won_velocity.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_sqo2won_velocity.sql', 'name': 'funnel_report_all_time_sqo2won_velocity', 'alias': 'funnel_report_all_time_sqo2won_velocity', 'checksum': {'name': 'sha256', 'checksum': '23b63f71ee3851840b8ca0b51986987a0680a6b7df52bbe3f679075c676513f7'}, 'tags': [], 'refs': [['funnel_report_all_time_sqos'], ['funnel_report_all_time_won']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.246932, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_filters_companysizerev': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n), final AS (\r\n\r\n    SELECT DISTINCT\r\n        base.company_size_rev   \r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_leads', 'model.acton_marketing_data.funnel_report_all_time_mqls', 'model.acton_marketing_data.funnel_report_all_time_sals', 'model.acton_marketing_data.funnel_report_all_time_sqls', 'model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.funnel_report_all_time_demo', 'model.acton_marketing_data.funnel_report_all_time_voc', 'model.acton_marketing_data.funnel_report_all_time_closing', 'model.acton_marketing_data.funnel_report_all_time_won', 'model.acton_marketing_data.funnel_report_all_time_lost']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_filters_companysizerev'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_filters_companysizerev', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_filters_companysizerev.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_filters_companysizerev.sql', 'name': 'funnel_report_all_time_filters_companysizerev', 'alias': 'funnel_report_all_time_filters_companysizerev', 'checksum': {'name': 'sha256', 'checksum': '6f654b40ff5eda766b8cbd1b1807b99116ebd6fdadcfae654dd4ccefc25797e2'}, 'tags': [], 'refs': [['funnel_report_all_time_leads'], ['funnel_report_all_time_mqls'], ['funnel_report_all_time_sals'], ['funnel_report_all_time_sqls'], ['funnel_report_all_time_sqos'], ['funnel_report_all_time_demo'], ['funnel_report_all_time_voc'], ['funnel_report_all_time_closing'], ['funnel_report_all_time_won'], ['funnel_report_all_time_lost']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2526536, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_close_won_velocity': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH won_opp AS (\r\n\r\n    SELECT\r\n        won_id,\r\n        won_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket\r\n    FROM {{ref(\'funnel_report_all_time_won\')}}\r\n\r\n),  sql_opp AS (\r\n\r\n    SELECT\r\n        sql_id,\r\n        sql_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket\r\n    FROM {{ref(\'funnel_report_all_time_sqls\')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        won_id,\r\n        sql_date,\r\n        won_date,\r\n        won_opp.account_global_region,\r\n        won_opp.company_size_rev,\r\n        won_opp.opp_lead_source,\r\n        won_opp.segment,\r\n        won_opp.industry,\r\n        won_opp.industry_bucket,\r\n        won_opp.channel_bucket,\r\n        {{ dbt_utils.datediff("sql_date","won_date",\'day\')}} AS cw_velocity\r\n    FROM won_opp\r\n    LEFT JOIN sql_opp ON \r\n    won_opp.won_id=sql_opp.sql_id\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    company_size_rev,\r\n    opp_lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    won_date,\r\n    cw_velocity\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_won', 'model.acton_marketing_data.funnel_report_all_time_sqls']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_close_won_velocity'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_close_won_velocity', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_close_won_velocity.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_close_won_velocity.sql', 'name': 'funnel_report_all_time_close_won_velocity', 'alias': 'funnel_report_all_time_close_won_velocity', 'checksum': {'name': 'sha256', 'checksum': '962a7f7f23a3cda555e49de6d706d9d5e516ed9af2be7029982c59f0e862ff19'}, 'tags': [], 'refs': [['funnel_report_all_time_won'], ['funnel_report_all_time_sqls']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2553854, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_l20_velocity_mlc': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opportunity_id,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket,\r\n        opp_created_date,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket\r\n    FROM {{ref(\'opportunities_with_contacts\')}}\r\n    WHERE type=\'New Business\'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opp_created_date,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        opp_industry,\r\n        opp_channel_bucket,\r\n        opp_industry_bucket,\r\n        {{ dbt_utils.datediff("marketing_created_date","opp_created_date",\'day\')}} AS lead_to_opp_velocity\r\n    FROM base\r\n    WHERE opp_created_date >= marketing_created_date\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    opp_company_size_rev,\r\n    opp_lead_source,\r\n    opp_segment,\r\n    opp_industry,\r\n    opp_channel_bucket,\r\n    opp_industry_bucket,\r\n    marketing_created_date,\r\n    lead_to_opp_velocity\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.opportunities_with_contacts']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_l20_velocity_mlc'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_l20_velocity_mlc', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_l20_velocity_mlc.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_l20_velocity_mlc.sql', 'name': 'funnel_report_all_time_l20_velocity_mlc', 'alias': 'funnel_report_all_time_l20_velocity_mlc', 'checksum': {'name': 'sha256', 'checksum': '39f21f8aec619c16ad7a66ef1bfe929279552372f979748660dd044e7b10dc5e'}, 'tags': [], 'refs': [['opportunities_with_contacts']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2612188, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_m2sql_to_target': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH m2sql_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS m2sql_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_m2sql_conv'\r\n\r\n), actual_sqls AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sql_date)::Date AS sqls_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT sql_id) AS sqls\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    WHERE sql_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n\r\n), actual_mqls AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',mql_date)::Date AS mqls_month,\r\n        CASE \r\n            WHEN global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT mql_id) AS mqls\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    WHERE mql_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n\r\n), actual_m2sql AS (\r\n\r\n    SELECT\r\n        sqls_month,\r\n        actual_sqls.region,\r\n        SUM(sqls)/SUM(mqls) AS m2sql_actual\r\n    FROM actual_sqls\r\n    LEFT JOIN actual_mqls ON \r\n    actual_sqls.region=actual_mqls.region\r\n    AND actual_sqls.sqls_month=actual_mqls.mqls_month\r\n    WHERE actual_sqls.region IS NOT null\r\n    GROUP BY 1,2\r\n\r\n)\r\n\r\nSELECT\r\n    sqls_month,\r\n    actual_m2sql.region,\r\n    m2sql_actual,\r\n    m2sql_target,\r\n    m2sql_actual/m2sql_target AS actual_vs_target\r\nFROM actual_m2sql\r\nLEFT JOIN m2sql_target ON\r\nactual_m2sql.sqls_month=m2sql_target.kpi_month\r\nAND actual_m2sql.region=m2sql_target.kpi_region\r\nWHERE region IS NOT null", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.kpi_targets', 'model.acton_marketing_data.funnel_report_all_time_sqls', 'model.acton_marketing_data.funnel_report_all_time_mqls']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_m2sql_to_target'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_m2sql_to_target', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_m2sql_to_target.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_m2sql_to_target.sql', 'name': 'funnel_report_all_time_m2sql_to_target', 'alias': 'funnel_report_all_time_m2sql_to_target', 'checksum': {'name': 'sha256', 'checksum': '415f99ad2ceed193d25f2eadb325bdfbb31a76c4fa08f665f119b5fb6e274377'}, 'tags': [], 'refs': [['kpi_targets'], ['funnel_report_all_time_sqls'], ['funnel_report_all_time_mqls']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2665808, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_voc2closing_velocity': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH voc_opp AS (\r\n\r\n    SELECT\r\n        voc_id,\r\n        voc_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_voc\')}}\r\n\r\n),  closing_opp AS (\r\n\r\n    SELECT\r\n        closing_id,\r\n        closing_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_closing\')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        closing_id,\r\n        voc_date,\r\n        closing_date,\r\n        closing_opp.account_global_region,\r\n        closing_opp.company_size_rev,\r\n        closing_opp.opp_lead_source,\r\n        closing_opp.segment,\r\n        closing_opp.industry,\r\n        closing_opp.industry_bucket,\r\n        closing_opp.channel_bucket,\r\n        {{ dbt_utils.datediff("voc_date","closing_date",\'day\')}} AS voc2closing_velocity\r\n    FROM closing_opp\r\n    LEFT JOIN voc_opp ON \r\n    closing_opp.closing_id=voc_opp.voc_id\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    company_size_rev,\r\n    opp_lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    closing_date,\r\n    voc2closing_velocity\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_voc', 'model.acton_marketing_data.funnel_report_all_time_closing']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_voc2closing_velocity'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_voc2closing_velocity', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_voc2closing_velocity.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_voc2closing_velocity.sql', 'name': 'funnel_report_all_time_voc2closing_velocity', 'alias': 'funnel_report_all_time_voc2closing_velocity', 'checksum': {'name': 'sha256', 'checksum': '63fd0da0f8689cd59d51fac8a4cd859a89e2169aa4765ac545f1e475fa1b3dfe'}, 'tags': [], 'refs': [['funnel_report_all_time_voc'], ['funnel_report_all_time_closing']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2688732, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_m2sal_velocity': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH sals AS (\r\n\r\n    SELECT\r\n        sal_id,\r\n        sal_date,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_sals\')}}\r\n\r\n),  mqls AS (\r\n\r\n    SELECT\r\n        mql_id,\r\n        mql_date,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_mqls\')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        sal_id,\r\n        sal_date,\r\n        mql_date,\r\n        sals.global_region,\r\n        sals.company_size_rev,\r\n        sals.lead_source,\r\n        sals.segment,\r\n        sals.industry,\r\n        sals.channel_bucket,\r\n        sals.industry_bucket,\r\n        {{ dbt_utils.datediff("mql_date","sal_date",\'day\')}} AS m2sal_velocity\r\n    FROM sals\r\n    LEFT JOIN mqls ON \r\n    sals.sal_id=mqls.mql_id\r\n)\r\n\r\nSELECT\r\n    global_region,\r\n    company_size_rev,\r\n    lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    sal_date,\r\n    m2sal_velocity\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_sals', 'model.acton_marketing_data.funnel_report_all_time_mqls']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_m2sal_velocity'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_m2sal_velocity', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_m2sal_velocity.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_m2sal_velocity.sql', 'name': 'funnel_report_all_time_m2sal_velocity', 'alias': 'funnel_report_all_time_m2sal_velocity', 'checksum': {'name': 'sha256', 'checksum': '7ef189dd937371b5e9e2a5d1170ca27a4d9b1b638b1208552153edc99e5fffee'}, 'tags': [], 'refs': [['funnel_report_all_time_sals'], ['funnel_report_all_time_mqls']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2752564, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_filters_globalregion': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n), final AS (\r\n\r\n    SELECT DISTINCT\r\n        base.global_region \r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_leads', 'model.acton_marketing_data.funnel_report_all_time_mqls', 'model.acton_marketing_data.funnel_report_all_time_sals', 'model.acton_marketing_data.funnel_report_all_time_sqls', 'model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.funnel_report_all_time_demo', 'model.acton_marketing_data.funnel_report_all_time_voc', 'model.acton_marketing_data.funnel_report_all_time_closing', 'model.acton_marketing_data.funnel_report_all_time_won', 'model.acton_marketing_data.funnel_report_all_time_lost']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_filters_globalregion'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_filters_globalregion', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_filters_globalregion.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_filters_globalregion.sql', 'name': 'funnel_report_all_time_filters_globalregion', 'alias': 'funnel_report_all_time_filters_globalregion', 'checksum': {'name': 'sha256', 'checksum': '96dd9d891fab0f388149a7c74133c7a962278fcd50c6b64eb041c1f8acbc09cc'}, 'tags': [], 'refs': [['funnel_report_all_time_leads'], ['funnel_report_all_time_mqls'], ['funnel_report_all_time_sals'], ['funnel_report_all_time_sqls'], ['funnel_report_all_time_sqos'], ['funnel_report_all_time_demo'], ['funnel_report_all_time_voc'], ['funnel_report_all_time_closing'], ['funnel_report_all_time_won'], ['funnel_report_all_time_lost']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2810016, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_mqls': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        lead_mql_source_xf.person_id AS mql_id,\r\n        CONCAT('https://acton.my.salesforce.com/',lead_mql_source_xf.person_id) AS mql_url,\r\n        lead_mql_source_xf.mql_most_recent_date AS mql_date,\r\n        lead_mql_source_xf.working_date,\r\n        company,\r\n        first_name,\r\n        last_name,\r\n        title,\r\n        person_status,\r\n        country,\r\n        is_hand_raiser,\r\n        CASE \r\n            WHEN working_date IS null then 'No'\r\n            ELSE 'Yes'\r\n        END AS is_working,\r\n        CASE\r\n            WHEN global_region IS null THEN 'blank'\r\n            ELSE global_region\r\n        END AS global_region,\r\n        CASE\r\n            WHEN company_size_rev IS null THEN 'blank'\r\n            ELSE company_size_rev\r\n        END AS company_size_rev,\r\n        CASE\r\n            WHEN lead_source IS null THEN 'blank'\r\n            ELSE lead_source\r\n        END AS lead_source,\r\n        CASE\r\n            WHEN segment IS null THEN 'blank'\r\n            ELSE segment\r\n        END AS segment,\r\n        CASE\r\n            WHEN industry IS null THEN 'blank'\r\n            ELSE industry\r\n        END AS industry,\r\n        CASE\r\n            WHEN industry_bucket IS null THEN 'blank'\r\n            ELSE industry_bucket\r\n        END AS industry_bucket,\r\n        CASE\r\n            WHEN channel_bucket IS null THEN 'blank'\r\n            ELSE channel_bucket\r\n        END AS channel_bucket,\r\n        CASE\r\n            WHEN offer_asset_name_lead_creation IS null THEN 'blank'\r\n            ELSE offer_asset_name_lead_creation\r\n        END AS offer_asset_name_lead_creation,\r\n        CASE\r\n            WHEN campaign_lead_creation IS null THEN 'blank'\r\n            ELSE campaign_lead_creation\r\n        END AS campaign_lead_creation\r\n    FROM {{ref('lead_mql_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.lead_mql_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_mqls'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_mqls', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_mqls.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_mqls.sql', 'name': 'funnel_report_all_time_mqls', 'alias': 'funnel_report_all_time_mqls', 'checksum': {'name': 'sha256', 'checksum': '3212cd504116c279287f3ac0a1cdf23349270cac1f134a5eccfd52ae16579b68'}, 'tags': [], 'refs': [['lead_mql_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2836769, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_sql2sqo_to_target': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH sql2sqo_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS sql2sqo_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_sql2sqo_conv'\r\n\r\n), actual_sqls AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sql_date)::Date AS sqls_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT sql_id) AS sqls\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    WHERE sql_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n\r\n), actual_sqos AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sqo_date)::Date AS sqos_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT sqo_id) AS sqos\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    WHERE sqo_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n\r\n), actual_sql2sqo AS (\r\n\r\n    SELECT\r\n        sqos_month,\r\n        actual_sqos.region,\r\n        SUM(sqos)/SUM(sqls) AS sql2sqo_actual\r\n    FROM actual_sqos\r\n    LEFT JOIN actual_sqls ON \r\n    actual_sqos.region=actual_sqls.region\r\n    AND actual_sqos.sqos_month=actual_sqls.sqls_month\r\n    WHERE actual_sqos.region IS NOT null\r\n    GROUP BY 1,2\r\n\r\n)\r\n\r\nSELECT\r\n    sqos_month,\r\n    actual_sql2sqo.region,\r\n    sql2sqo_actual,\r\n    sql2sqo_target,\r\n    sql2sqo_actual/sql2sqo_target AS actual_vs_target\r\nFROM actual_sql2sqo\r\nLEFT JOIN sql2sqo_target ON\r\nactual_sql2sqo.sqos_month=sql2sqo_target.kpi_month\r\nAND actual_sql2sqo.region=sql2sqo_target.kpi_region\r\nWHERE region IS NOT null", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.kpi_targets', 'model.acton_marketing_data.funnel_report_all_time_sqls', 'model.acton_marketing_data.funnel_report_all_time_sqos']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_sql2sqo_to_target'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_sql2sqo_to_target', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_sql2sqo_to_target.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_sql2sqo_to_target.sql', 'name': 'funnel_report_all_time_sql2sqo_to_target', 'alias': 'funnel_report_all_time_sql2sqo_to_target', 'checksum': {'name': 'sha256', 'checksum': '7b083121392bd66424fd4d8c606f8e47d9c338d64ae8e34e3daf63262cd8bef5'}, 'tags': [], 'refs': [['kpi_targets'], ['funnel_report_all_time_sqls'], ['funnel_report_all_time_sqos']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2857337, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_demo2voc_velocity': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH demo_opp AS (\r\n\r\n    SELECT\r\n        demo_id,\r\n        demo_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_demo\')}}\r\n\r\n),  voc_opp AS (\r\n\r\n    SELECT\r\n        voc_id,\r\n        voc_date,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_voc\')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        voc_id,\r\n        demo_date,\r\n        voc_date,\r\n        voc_opp.account_global_region,\r\n        voc_opp.company_size_rev,\r\n        voc_opp.opp_lead_source,\r\n        voc_opp.segment,\r\n        voc_opp.industry,\r\n        voc_opp.channel_bucket,\r\n        voc_opp.industry_bucket,\r\n        {{ dbt_utils.datediff("demo_date","voc_date",\'day\')}} AS demo2voc_velocity\r\n    FROM voc_opp\r\n    LEFT JOIN demo_opp ON \r\n    voc_opp.voc_id=demo_opp.demo_id\r\n)\r\n\r\nSELECT\r\n    account_global_region,\r\n    company_size_rev,\r\n    opp_lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    voc_date,\r\n    demo2voc_velocity\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_demo', 'model.acton_marketing_data.funnel_report_all_time_voc']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_demo2voc_velocity'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_demo2voc_velocity', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_demo2voc_velocity.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_demo2voc_velocity.sql', 'name': 'funnel_report_all_time_demo2voc_velocity', 'alias': 'funnel_report_all_time_demo2voc_velocity', 'checksum': {'name': 'sha256', 'checksum': '21039b2f0baf764f82394655d7b0c0d66158325e9eac4cc9eac816d306332d11'}, 'tags': [], 'refs': [['funnel_report_all_time_demo'], ['funnel_report_all_time_voc']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2879918, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_mqls_to_target': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH mql_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS mqls_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_mqls'\r\n\r\n), actual_mqls AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',mql_date)::Date AS mqls_month,\r\n        CASE \r\n            WHEN global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT mql_id) AS mqls\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    WHERE mql_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    mqls_month,\r\n    actual_mqls.region,\r\n    mqls,\r\n    mqls_target,\r\n    mqls/mqls_target AS actual_vs_target\r\nFROM actual_mqls\r\nLEFT JOIN mql_target ON\r\nactual_mqls.mqls_month=mql_target.kpi_month\r\nAND actual_mqls.region=mql_target.kpi_region\r\nWHERE region IS NOT null", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.kpi_targets', 'model.acton_marketing_data.funnel_report_all_time_mqls']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_mqls_to_target'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_mqls_to_target', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_mqls_to_target.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_mqls_to_target.sql', 'name': 'funnel_report_all_time_mqls_to_target', 'alias': 'funnel_report_all_time_mqls_to_target', 'checksum': {'name': 'sha256', 'checksum': '43d2e84799394da2e18cf5dc0df337045ef301e190417692f31972776a202488'}, 'tags': [], 'refs': [['kpi_targets'], ['funnel_report_all_time_mqls']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.293582, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_l20_velocity_mlc_annual': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opportunity_id,\r\n        opp_created_date,\r\n        type AS opp_type,\r\n        opp_segment\r\n    FROM {{ref(\'opportunities_with_contacts\')}}\r\n    WHERE type=\'New Business\'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        marketing_created_date,\r\n        opp_created_date,\r\n        opp_segment,\r\n        {{ dbt_utils.datediff("marketing_created_date","opp_created_date",\'day\')}} AS lead_to_opp_velocity\r\n    FROM base\r\n    WHERE opp_created_date >= marketing_created_date\r\n    \r\n)\r\n\r\nSELECT\r\nopp_segment,\r\nDATE_TRUNC(\'year\',marketing_created_date) AS marketing_created_year,\r\nAVG(lead_to_opp_velocity) AS avg_lead_to_opp_velocity\r\nFROM final\r\nGROUP BY 1,2', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.opportunities_with_contacts']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_l20_velocity_mlc_annual'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_l20_velocity_mlc_annual', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_l20_velocity_mlc_annual.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_l20_velocity_mlc_annual.sql', 'name': 'funnel_report_all_time_l20_velocity_mlc_annual', 'alias': 'funnel_report_all_time_l20_velocity_mlc_annual', 'checksum': {'name': 'sha256', 'checksum': 'dd3d1da7f9be8249212fdb179bca5c0a2d638a1d64dbe353057a027b2b6aea20'}, 'tags': [], 'refs': [['opportunities_with_contacts']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.2958603, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_demo': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        opp_demo_source_xf.opportunity_id AS demo_id,\r\n        CONCAT('https://acton.my.salesforce.com/',opp_demo_source_xf.opportunity_id) AS demo_url,\r\n        acv,\r\n        account_name,\r\n        type AS opp_type,\r\n        opp_demo_source_xf.demo_date AS demo_date,\r\n        CASE\r\n        WHEN account_global_region IS null THEN 'blank'\r\n        ELSE account_global_region\r\n    END AS account_global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN opp_lead_source IS null THEN 'blank'\r\n        ELSE opp_lead_source\r\n    END AS opp_lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN opp_offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE opp_offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation\r\n    FROM {{ref('opp_demo_source_xf')}}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_demo_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_demo'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_demo', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_demo.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_demo.sql', 'name': 'funnel_report_all_time_demo', 'alias': 'funnel_report_all_time_demo', 'checksum': {'name': 'sha256', 'checksum': 'd9007f732c5a0b27e227d76a1f57897fbf70dc87a8029812a3984f20b755c7c4'}, 'tags': [], 'refs': [['opp_demo_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3011339, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_close_won_velocity_annual': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH closed_won AS (\r\n\r\n    SELECT\r\n        opp_sales_source_xf.opportunity_id AS won_id,\r\n        opp_sales_source_xf.close_date AS won_date,\r\n        segment AS won_segment,\r\n        type AS won_type\r\n    FROM {{ref(\'opp_sales_source_xf\')}}\r\n\r\n),  created_opp AS (\r\n\r\n    SELECT\r\n        sql_source_xf.sql_id,\r\n        sql_source_xf.created_date AS sql_date,\r\n        segment AS opp_segment,\r\n        type AS opp_type\r\n    FROM {{ref(\'sql_source_xf\')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        won_id,\r\n        sql_date,\r\n        won_date,\r\n        won_segment,\r\n        won_type,\r\n        {{ dbt_utils.datediff("sql_date","won_date",\'day\')}} AS cw_velocity\r\n    FROM closed_won\r\n    LEFT JOIN created_opp ON \r\n    closed_won.won_id=created_opp.sql_id\r\n)\r\n\r\nSELECT\r\nwon_segment,\r\nwon_type,\r\nDATE_TRUNC(\'year\',won_date) AS cw_year,\r\nAVG(cw_velocity) AS avg_cw_velocity\r\nFROM final\r\nGROUP BY 1,2,3', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.opp_sales_source_xf', 'model.acton_marketing_data.sql_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_close_won_velocity_annual'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_close_won_velocity_annual', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_close_won_velocity_annual.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_close_won_velocity_annual.sql', 'name': 'funnel_report_all_time_close_won_velocity_annual', 'alias': 'funnel_report_all_time_close_won_velocity_annual', 'checksum': {'name': 'sha256', 'checksum': '96061284d2c993d0e128ba59fb5969ba20a3d2f35f3a2e9d966ca2376d849414'}, 'tags': [], 'refs': [['opp_sales_source_xf'], ['sql_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.303243, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_leads_to_target': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH lead_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS leads_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_leads'\r\n\r\n), actual_leads AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',created_date)::Date AS leads_month,\r\n        CASE \r\n            WHEN global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        COUNT(DISTINCT lead_id) AS leads\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    WHERE created_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    leads_month,\r\n    actual_leads.region,\r\n    leads,\r\n    leads_target,\r\n    leads/leads_target AS actual_vs_target\r\nFROM actual_leads\r\nLEFT JOIN lead_target ON\r\nactual_leads.leads_month=lead_target.kpi_month\r\nAND actual_leads.region=lead_target.kpi_region\r\nWHERE region IS NOT null", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.kpi_targets', 'model.acton_marketing_data.funnel_report_all_time_leads']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_leads_to_target'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_leads_to_target', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_leads_to_target.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_leads_to_target.sql', 'name': 'funnel_report_all_time_leads_to_target', 'alias': 'funnel_report_all_time_leads_to_target', 'checksum': {'name': 'sha256', 'checksum': 'b4560b23bff353eed00dcad451d5eab15b405d646cc43ced5de3562598ead0b9'}, 'tags': [], 'refs': [['kpi_targets'], ['funnel_report_all_time_leads']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3087196, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_filters': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        created_date AS date,\r\n        null AS opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        mql_date,\r\n        null AS opp_type,\r\n        is_working\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        sal_date,\r\n        null AS opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        'No' AS is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        sql_date,\r\n        opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        'No' AS is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        sqo_date,\r\n        opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        'No' AS is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        demo_date,\r\n        opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        'No' AS is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        voc_date,\r\n        opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        'No' AS is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        closing_date,\r\n        opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        'No' AS is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        won_date,\r\n        opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        'No' AS is_hand_raiser,\r\n        offer_asset_name_lead_creation,\r\n        lost_date,\r\n        opp_type,\r\n        null AS is_working\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n\r\n)\r\n\r\nSELECT DISTINCT\r\n    CASE\r\n        WHEN global_region IS null THEN 'blank'\r\n        ELSE global_region\r\n    END AS global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN lead_source IS null THEN 'blank'\r\n        ELSE lead_source\r\n    END AS lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation,\r\n    CASE\r\n        WHEN opp_type IS null THEN 'blank'\r\n        ELSE opp_type\r\n    END AS opp_type,\r\n    CASE\r\n        WHEN is_working IS null THEN 'No'\r\n        ELSE is_working\r\n    END AS is_working,\r\n    is_hand_raiser,\r\n    date\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_leads', 'model.acton_marketing_data.funnel_report_all_time_mqls', 'model.acton_marketing_data.funnel_report_all_time_sals', 'model.acton_marketing_data.funnel_report_all_time_sqls', 'model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.funnel_report_all_time_demo', 'model.acton_marketing_data.funnel_report_all_time_voc', 'model.acton_marketing_data.funnel_report_all_time_closing', 'model.acton_marketing_data.funnel_report_all_time_won', 'model.acton_marketing_data.funnel_report_all_time_lost']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_filters'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_filters', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_filters.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_filters.sql', 'name': 'funnel_report_all_time_filters', 'alias': 'funnel_report_all_time_filters', 'checksum': {'name': 'sha256', 'checksum': 'bb396f85f9761b1b9227b3a40640a310d0e088612fbbd2e3b8ebac847f34a0f2'}, 'tags': [], 'refs': [['funnel_report_all_time_leads'], ['funnel_report_all_time_mqls'], ['funnel_report_all_time_sals'], ['funnel_report_all_time_sqls'], ['funnel_report_all_time_sqos'], ['funnel_report_all_time_demo'], ['funnel_report_all_time_voc'], ['funnel_report_all_time_closing'], ['funnel_report_all_time_won'], ['funnel_report_all_time_lost']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3119962, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_sqopipe_to_target': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH sqopipe_target AS (\r\n\r\n    SELECT \r\n        kpi_month,\r\n        kpi_region,\r\n        kpi_target AS sqopipe_target\r\n    FROM {{ref('kpi_targets')}}\r\n    WHERE kpi = 'target_new_cw_pipe'\r\n    --WHERE kpi = 'target_sqo_pipe'\r\n    \r\n), actual_sqopipe AS (\r\n\r\n    SELECT\r\n        DATE_TRUNC('month',sqo_date)::Date AS sqopipe_month,\r\n        CASE \r\n            WHEN account_global_region LIKE 'NA-%' THEN 'NA'\r\n            WHEN account_global_region IN ('EUROPE') THEN 'EMEA'\r\n            ELSE null\r\n        END AS region,\r\n        SUM(acv) AS sqopipe\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    WHERE sqo_date >= '2022-04-01'\r\n    GROUP BY 1,2\r\n)\r\n\r\nSELECT\r\n    sqopipe_month,\r\n    actual_sqopipe.region,\r\n    sqopipe,\r\n    sqopipe_target,\r\n    sqopipe/sqopipe_target AS actual_vs_target\r\nFROM actual_sqopipe\r\nLEFT JOIN sqopipe_target ON\r\nactual_sqopipe.sqopipe_month=sqopipe_target.kpi_month\r\nAND actual_sqopipe.region=sqopipe_target.kpi_region\r\nWHERE region IS NOT null", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.kpi_targets', 'model.acton_marketing_data.funnel_report_all_time_sqos']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_sqopipe_to_target'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_sqopipe_to_target', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_sqopipe_to_target.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_sqopipe_to_target.sql', 'name': 'funnel_report_all_time_sqopipe_to_target', 'alias': 'funnel_report_all_time_sqopipe_to_target', 'checksum': {'name': 'sha256', 'checksum': '13bfbf46662b5b6c2f95d666986995cfe4d08345deefce877a86858a43b5cf6a'}, 'tags': [], 'refs': [['kpi_targets'], ['funnel_report_all_time_sqos']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3147123, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_l2m_velocity': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH leads AS (\r\n\r\n    SELECT\r\n        lead_id,\r\n        created_date,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_leads\')}}\r\n\r\n),  mqls AS (\r\n\r\n    SELECT\r\n        mql_id,\r\n        mql_date,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        channel_bucket,\r\n        industry_bucket\r\n    FROM {{ref(\'funnel_report_all_time_mqls\')}}\r\n    \r\n), final AS (\r\n\r\n    SELECT\r\n        mql_id,\r\n        mql_date,\r\n        created_date,\r\n        mqls.global_region,\r\n        mqls.company_size_rev,\r\n        mqls.lead_source,\r\n        mqls.segment,\r\n        mqls.industry,\r\n        mqls.industry_bucket,\r\n        mqls.channel_bucket,\r\n        {{ dbt_utils.datediff("created_date","mql_date",\'day\')}} AS l2m_velocity\r\n    FROM mqls\r\n    LEFT JOIN leads ON \r\n    mqls.mql_id=leads.lead_id\r\n)\r\n\r\nSELECT\r\n    global_region,\r\n    company_size_rev,\r\n    lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    industry_bucket,\r\n    mql_date,\r\n    l2m_velocity\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_leads', 'model.acton_marketing_data.funnel_report_all_time_mqls']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_l2m_velocity'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_l2m_velocity', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_l2m_velocity.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_l2m_velocity.sql', 'name': 'funnel_report_all_time_l2m_velocity', 'alias': 'funnel_report_all_time_l2m_velocity', 'checksum': {'name': 'sha256', 'checksum': '9627fcacd69fe8fff442291793f8f42e0b0fc94e69b18e4b76f8bbf64ca56c60'}, 'tags': [], 'refs': [['funnel_report_all_time_leads'], ['funnel_report_all_time_mqls']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.316763, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_all': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        created_date AS date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    UNION ALL\r\n    SELECT DISTINCT\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n    \r\n), lead_base AS (\r\n\r\n    SELECT\r\n        COUNT(DISTINCT lead_id) AS leads,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        created_date\r\n    FROM {{ref('funnel_report_all_time_leads')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), mql_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT mql_id) AS mqls,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        mql_date\r\n    FROM {{ref('funnel_report_all_time_mqls')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), sal_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT sal_id) AS sals,\r\n        global_region,\r\n        company_size_rev,\r\n        lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        sal_date\r\n    FROM {{ref('funnel_report_all_time_sals')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), sql_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT sql_id) AS sqls,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        sql_date\r\n    FROM {{ref('funnel_report_all_time_sqls')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), sqo_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT sqo_id) AS sqos,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        sqo_date\r\n    FROM {{ref('funnel_report_all_time_sqos')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), demo_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT demo_id) AS demos,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        demo_date\r\n    FROM {{ref('funnel_report_all_time_demo')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), voc_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT voc_id) AS vocs,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        voc_date\r\n    FROM {{ref('funnel_report_all_time_voc')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), closing_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT closing_id) AS closing,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        closing_date\r\n    FROM {{ref('funnel_report_all_time_closing')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), won_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT won_id) AS won,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        won_date\r\n    FROM {{ref('funnel_report_all_time_won')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), lost_base AS (\r\n\r\n    SELECT \r\n        COUNT(DISTINCT lost_id) AS lost,\r\n        account_global_region,\r\n        company_size_rev,\r\n        opp_lead_source,\r\n        segment,\r\n        industry,\r\n        industry_bucket,\r\n        channel_bucket,\r\n        lost_date\r\n    FROM {{ref('funnel_report_all_time_lost')}}\r\n    GROUP BY 2,3,4,5,6,7,8,9\r\n\r\n), final AS (\r\n\r\n    SELECT \r\n        base.company_size_rev,\r\n        base.global_region,\r\n        base.lead_source,\r\n        base.segment,\r\n        base.industry,\r\n        base.industry_bucket,\r\n        base.channel_bucket,\r\n        base.date,\r\n        CASE \r\n            WHEN SUM(leads) IS null THEN 0\r\n            ELSE SUM(leads) \r\n        END AS leads,\r\n        CASE \r\n            WHEN SUM(mqls) IS null THEN 0\r\n            ELSE SUM(mqls) \r\n        END AS mqls,\r\n        CASE \r\n            WHEN SUM(sals) IS null THEN 0\r\n            ELSE SUM(sals) \r\n        END AS sals,\r\n        CASE \r\n            WHEN SUM(sqls) IS null THEN 0\r\n            ELSE SUM(sqls) \r\n        END AS sqls,\r\n        CASE \r\n            WHEN SUM(sqos) IS null THEN 0\r\n            ELSE SUM(sqos) \r\n        END AS sqos,\r\n        CASE \r\n            WHEN SUM(demos) IS null THEN 0\r\n            ELSE SUM(demos) \r\n        END AS demos,\r\n        CASE \r\n            WHEN SUM(vocs) IS null THEN 0\r\n            ELSE SUM(vocs) \r\n        END AS vocs,\r\n        CASE \r\n            WHEN SUM(closing) IS null THEN 0\r\n            ELSE SUM(closing) \r\n        END AS closing,\r\n        CASE \r\n            WHEN SUM(won) IS null THEN 0\r\n            ELSE SUM(won) \r\n        END AS won,\r\n        CASE \r\n            WHEN SUM(lost) IS null THEN 0\r\n            ELSE SUM(lost) \r\n        END AS lost\r\n    FROM base\r\n    LEFT JOIN lead_base ON \r\n    base.company_size_rev=lead_base.company_size_rev\r\n    AND base.global_region=lead_base.global_region\r\n    AND base.lead_source=lead_base.lead_source\r\n    AND base.segment=lead_base.segment\r\n    AND base.industry=lead_base.industry\r\n    AND base.channel_bucket=lead_base.channel_bucket\r\n    AND base.date=lead_base.created_date\r\n    LEFT JOIN mql_base ON\r\n    base.company_size_rev=mql_base.company_size_rev\r\n    AND base.global_region=mql_base.global_region\r\n    AND base.lead_source=mql_base.lead_source\r\n    AND base.segment=mql_base.segment\r\n    AND base.industry=mql_base.industry\r\n    AND base.channel_bucket=mql_base.channel_bucket\r\n    AND base.date=mql_base.mql_date\r\n    LEFT JOIN sal_base ON\r\n    base.company_size_rev=sal_base.company_size_rev\r\n    AND base.global_region=sal_base.global_region\r\n    AND base.lead_source=sal_base.lead_source\r\n    AND base.segment=sal_base.segment\r\n    AND base.industry=sal_base.industry\r\n    AND base.channel_bucket=sal_base.channel_bucket\r\n    AND base.date=sal_base.sal_date\r\n    LEFT JOIN sql_base ON\r\n    base.company_size_rev=sql_base.company_size_rev\r\n    AND base.global_region=sql_base.account_global_region\r\n    AND base.lead_source=sql_base.opp_lead_source\r\n    AND base.segment=sql_base.segment\r\n    AND base.industry=sql_base.industry\r\n    AND base.channel_bucket=sql_base.channel_bucket\r\n    AND base.date=sql_base.sql_date\r\n    LEFT JOIN sqo_base ON\r\n    base.company_size_rev=sqo_base.company_size_rev\r\n    AND base.global_region=sqo_base.account_global_region\r\n    AND base.lead_source=sqo_base.opp_lead_source\r\n    AND base.segment=sqo_base.segment\r\n    AND base.industry=sqo_base.industry\r\n    AND base.channel_bucket=sqo_base.channel_bucket\r\n    AND base.date=sqo_base.sqo_date\r\n    LEFT JOIN demo_base ON\r\n    base.company_size_rev=demo_base.company_size_rev\r\n    AND base.global_region=demo_base.account_global_region\r\n    AND base.lead_source=demo_base.opp_lead_source\r\n    AND base.segment=demo_base.segment\r\n    AND base.industry=demo_base.industry\r\n    AND base.channel_bucket=demo_base.channel_bucket\r\n    AND base.date=demo_base.demo_date\r\n    LEFT JOIN voc_base ON\r\n    base.company_size_rev=voc_base.company_size_rev\r\n    AND base.global_region=voc_base.account_global_region\r\n    AND base.lead_source=voc_base.opp_lead_source\r\n    AND base.segment=voc_base.segment\r\n    AND base.industry=voc_base.industry\r\n    AND base.channel_bucket=voc_base.channel_bucket\r\n    AND base.date=voc_base.voc_date\r\n    LEFT JOIN closing_base ON\r\n    base.company_size_rev=closing_base.company_size_rev\r\n    AND base.global_region=closing_base.account_global_region\r\n    AND base.lead_source=closing_base.opp_lead_source\r\n    AND base.segment=closing_base.segment\r\n    AND base.industry=closing_base.industry\r\n    AND base.channel_bucket=closing_base.channel_bucket\r\n    AND base.date=closing_base.closing_date\r\n    LEFT JOIN won_base ON\r\n    base.company_size_rev=won_base.company_size_rev\r\n    AND base.global_region=won_base.account_global_region\r\n    AND base.lead_source=won_base.opp_lead_source\r\n    AND base.segment=won_base.segment\r\n    AND base.industry=won_base.industry\r\n    AND base.channel_bucket=won_base.channel_bucket\r\n    AND base.date=won_base.won_date\r\n    LEFT JOIN lost_base ON\r\n    base.company_size_rev=lost_base.company_size_rev\r\n    AND base.global_region=lost_base.account_global_region\r\n    AND base.lead_source=lost_base.opp_lead_source\r\n    AND base.segment=lost_base.segment\r\n    AND base.industry=lost_base.industry\r\n    AND base.channel_bucket=lost_base.channel_bucket\r\n    AND base.date=lost_base.lost_date\r\n    GROUP BY 1,2,3,4,5,6,7,8\r\n\r\n)\r\n\r\nSELECT\r\n    company_size_rev,\r\n    global_region,\r\n    lead_source,\r\n    segment,\r\n    industry,\r\n    channel_bucket,\r\n    date,\r\n    leads,\r\n    mqls,\r\n    sals,\r\n    sqls,\r\n    sqos,\r\n    demos,\r\n    vocs,\r\n    closing,\r\n    won,\r\n    lost,\r\n    CASE\r\n        WHEN mqls=0 THEN 0\r\n        ELSE SUM(leads/NULLIF(mqls,0))\r\n    END AS lead_to_mql_conv,\r\n    CASE\r\n        WHEN sals=0 THEN 0\r\n        ELSE SUM(mqls/NULLIF(sals,0))\r\n    END AS mql_to_sal_conv,\r\n    CASE\r\n        WHEN sqls=0 THEN 0\r\n        ELSE SUM(sals/NULLIF(sqls,0))\r\n    END AS sal_to_sql_conv,\r\n    CASE\r\n        WHEN sqos=0 THEN 0\r\n        ELSE SUM(sqls/NULLIF(sqos,0))\r\n    END AS sql_to_sqo_conv,\r\n    CASE\r\n        WHEN demos=0 THEN 0\r\n        ELSE SUM(sqos/NULLIF(demos,0))\r\n    END AS sqo_to_demo_conv,\r\n    CASE\r\n        WHEN vocs=0 THEN 0\r\n        ELSE SUM(demos/NULLIF(vocs,0))\r\n    END AS demo_to_voc_conv,\r\n    CASE\r\n        WHEN closing=0 THEN 0\r\n        ELSE SUM(vocs/NULLIF(closing,0))\r\n    END AS voc_to_closing_conv,\r\n    CASE\r\n        WHEN won=0 THEN 0\r\n        ELSE SUM(closing/NULLIF(won,0))\r\n    END AS closing_to_won_conv,\r\n    CASE\r\n        WHEN lost=0 THEN 0\r\n        ELSE SUM(closing/NULLIF(lost,0))\r\n    END AS closing_to_lost_conv\r\nFROM final\r\nGROUP BY 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_leads', 'model.acton_marketing_data.funnel_report_all_time_mqls', 'model.acton_marketing_data.funnel_report_all_time_sals', 'model.acton_marketing_data.funnel_report_all_time_sqls', 'model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.funnel_report_all_time_demo', 'model.acton_marketing_data.funnel_report_all_time_voc', 'model.acton_marketing_data.funnel_report_all_time_closing', 'model.acton_marketing_data.funnel_report_all_time_won', 'model.acton_marketing_data.funnel_report_all_time_lost', 'model.acton_marketing_data.funnel_report_all_time_leads', 'model.acton_marketing_data.funnel_report_all_time_mqls', 'model.acton_marketing_data.funnel_report_all_time_sals', 'model.acton_marketing_data.funnel_report_all_time_sqls', 'model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.funnel_report_all_time_demo', 'model.acton_marketing_data.funnel_report_all_time_voc', 'model.acton_marketing_data.funnel_report_all_time_closing', 'model.acton_marketing_data.funnel_report_all_time_won', 'model.acton_marketing_data.funnel_report_all_time_lost']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_all'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_all', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_all.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_all.sql', 'name': 'funnel_report_all_time_all', 'alias': 'funnel_report_all_time_all', 'checksum': {'name': 'sha256', 'checksum': '246ffac55b2c91c02790e18f2ab61846157cddb3b84862c485cff20e78001194'}, 'tags': [], 'refs': [['funnel_report_all_time_leads'], ['funnel_report_all_time_mqls'], ['funnel_report_all_time_sals'], ['funnel_report_all_time_sqls'], ['funnel_report_all_time_sqos'], ['funnel_report_all_time_demo'], ['funnel_report_all_time_voc'], ['funnel_report_all_time_closing'], ['funnel_report_all_time_won'], ['funnel_report_all_time_lost'], ['funnel_report_all_time_leads'], ['funnel_report_all_time_mqls'], ['funnel_report_all_time_sals'], ['funnel_report_all_time_sqls'], ['funnel_report_all_time_sqos'], ['funnel_report_all_time_demo'], ['funnel_report_all_time_voc'], ['funnel_report_all_time_closing'], ['funnel_report_all_time_won'], ['funnel_report_all_time_lost']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3223627, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_conversions': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        global_region,\r\n        company_size_rev,\r\n        date,\r\n        ROUND(SUM(mqls/NULLIF(leads,0)),2) AS all_time_lead_to_mql,\r\n        ROUND(SUM(sals/NULLIF(mqls,0)),2) AS all_time_mql_to_sal,\r\n        ROUND(SUM(sqls/NULLIF(sals,0)),2) AS all_time_sal_to_sql,\r\n        ROUND(SUM(sqos/NULLIF(sqls,0)),2) AS all_time_sql_to_sqo,\r\n        ROUND(SUM(demos/NULLIF(sqos,0)),2) AS all_time_sqo_to_demo,\r\n        ROUND(SUM(vocs/NULLIF(demos,0)),2) AS all_time_demo_to_voc,\r\n        ROUND(SUM(closing/NULLIF(vocs,0)),2) AS all_time_voc_to_closing,\r\n        ROUND(SUM(won/NULLIF(closing,0)),2) AS all_time_closing_to_won,\r\n        ROUND(SUM(lost/NULLIF(closing,0)),2) AS all_time_closing_to_lost\r\n    FROM {{ref('funnel_report_all_time_all')}}\r\n    GROUP BY 1,2,3\r\n    \r\n)\r\n\r\nSELECT DISTINCT\r\n    global_region,\r\n    company_size_rev,\r\n    date,\r\n    CASE \r\n        WHEN all_time_lead_to_mql IS null THEN 0\r\n        ELSE all_time_lead_to_mql\r\n    END AS all_time_lead_to_mql,\r\n    CASE \r\n        WHEN all_time_mql_to_sal IS null THEN 0\r\n        ELSE all_time_mql_to_sal\r\n    END AS all_time_mql_to_sal,\r\n    CASE \r\n        WHEN all_time_sal_to_sql IS null THEN 0\r\n        ELSE all_time_sal_to_sql\r\n    END AS all_time_sal_to_sql,\r\n    CASE \r\n        WHEN all_time_sql_to_sqo IS null THEN 0\r\n        ELSE all_time_sql_to_sqo\r\n    END AS all_time_sql_to_sqo,\r\n    CASE \r\n        WHEN all_time_sqo_to_demo IS null THEN 0\r\n        ELSE all_time_sqo_to_demo\r\n    END AS all_time_sqo_to_demo,\r\n    CASE \r\n        WHEN all_time_demo_to_voc IS null THEN 0\r\n        ELSE all_time_demo_to_voc\r\n    END AS all_time_demo_to_voc,\r\n    CASE \r\n        WHEN all_time_voc_to_closing IS null THEN 0\r\n        ELSE all_time_voc_to_closing\r\n    END AS all_time_voc_to_closing,\r\n    CASE \r\n        WHEN all_time_closing_to_won IS null THEN 0\r\n        ELSE all_time_closing_to_won\r\n    END AS all_time_closing_to_won,\r\n    CASE \r\n        WHEN all_time_closing_to_lost IS null THEN 0\r\n        ELSE all_time_closing_to_lost\r\n    END AS all_time_closing_to_lost\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_all']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_conversions'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_conversions', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_conversions.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_conversions.sql', 'name': 'funnel_report_all_time_conversions', 'alias': 'funnel_report_all_time_conversions', 'checksum': {'name': 'sha256', 'checksum': '683b907d784fd1ee0c96a80f8f6ecdebbd92afe80f7e1812f0000a5a67876442'}, 'tags': [], 'refs': [['funnel_report_all_time_all']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3252518, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.funnel_report_all_time_leads': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        person_source_xf.person_id AS lead_id,\r\n        CONCAT('https://acton.my.salesforce.com/',person_source_xf.person_id) AS lead_url,\r\n        person_source_xf.marketing_created_date AS created_date,\r\n        company,\r\n        first_name,\r\n        last_name,\r\n        title,\r\n        person_status,\r\n        country,\r\n        is_hand_raiser,\r\n    CASE\r\n        WHEN global_region IS null THEN 'blank'\r\n        ELSE global_region\r\n    END AS global_region,\r\n    CASE\r\n        WHEN company_size_rev IS null THEN 'blank'\r\n        ELSE company_size_rev\r\n    END AS company_size_rev,\r\n    CASE\r\n        WHEN lead_source IS null THEN 'blank'\r\n        ELSE lead_source\r\n    END AS lead_source,\r\n    CASE\r\n        WHEN segment IS null THEN 'blank'\r\n        ELSE segment\r\n    END AS segment,\r\n    CASE\r\n        WHEN industry IS null THEN 'blank'\r\n        ELSE industry\r\n    END AS industry,\r\n    CASE\r\n        WHEN industry_bucket IS null THEN 'blank'\r\n        ELSE industry_bucket\r\n    END AS industry_bucket,\r\n    CASE\r\n        WHEN channel_bucket IS null THEN 'blank'\r\n        ELSE channel_bucket\r\n    END AS channel_bucket,\r\n    CASE\r\n        WHEN offer_asset_name_lead_creation IS null THEN 'blank'\r\n        ELSE offer_asset_name_lead_creation\r\n    END AS offer_asset_name_lead_creation,\r\n    CASE\r\n        WHEN campaign_lead_creation IS null THEN 'blank'\r\n        ELSE campaign_lead_creation\r\n    END AS campaign_lead_creation\r\n    FROM {{ref('person_source_xf')}}\r\n    WHERE marketing_created_date IS NOT null\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.person_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel', 'funnel_report_all_time_leads'], 'unique_id': 'model.acton_marketing_data.funnel_report_all_time_leads', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel/funnel_report_all_time_leads.sql', 'original_file_path': 'models/funnel/funnel_report_all_time_leads.sql', 'name': 'funnel_report_all_time_leads', 'alias': 'funnel_report_all_time_leads', 'checksum': {'name': 'sha256', 'checksum': '97377dd0b25adcdc1cb0258057a31aeba966903ca26c2b073b4a7abcf7cff0c0'}, 'tags': [], 'refs': [['person_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3275743, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.date_base_xf': {'raw_sql': '{{ config(materialized=\'table\') }}\r\nSELECT\r\nday::date AS day,\r\nweek,\r\nmonth,\r\nmonth_name,\r\nquarter,\r\nfy\r\nFROM "acton".public.date_base', 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': []}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'date_base_xf'], 'unique_id': 'model.acton_marketing_data.date_base_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/date_base_xf.sql', 'original_file_path': 'models/sources/date_base_xf.sql', 'name': 'date_base_xf', 'alias': 'date_base_xf', 'checksum': {'name': 'sha256', 'checksum': '11c8c14904f5631b0da8beaa4c4deea3af27d387cfa857de2938c6668e1ccac5'}, 'tags': [], 'refs': [], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3296058, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.account_source_xf': {'raw_sql': '{{ config(materialized=\'table\') }}\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source(\'salesforce\', \'account\') }}\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        base.id AS account_id,\r\n        base.is_deleted,\r\n        base.name AS account_name,\r\n        base.type AS account_type,\r\n        base.parent_id AS account_parent_id,\r\n        base.billing_state,\r\n        base.billing_postal_code,\r\n        base.billing_country,\r\n        base.industry,\r\n        CASE\r\n            WHEN base.industry IN (\'Business Services\') THEN \'Business Services\'\r\n            WHEN base.industry IN (\'Finance\',\'Insurance\') THEN \'Finance\'\r\n            WHEN base.industry IN (\'Manufacturing\') THEN \'Manufacturing\'\r\n            WHEN base.industry IN (\'Software\',\'Telecommunications\') THEN \'SoftCom\'\r\n            ELSE \'Other\'\r\n        END AS default_industry_bucket,\r\n        base.annual_revenue,\r\n        base.number_of_employees,\r\n        base.owner_id AS account_owner_id,\r\n        base.created_date AS account_created_date,\r\n        base.last_modified_date,\r\n        base.system_modstamp AS systemmodstamp,\r\n        base.is_partner,\r\n        base.current_customer_c AS is_current_customer,\r\n        base.csm_c AS account_csm_c,\r\n        base.current_crm_c AS current_crm,\r\n        base.current_marketing_automation_c AS current_ma,\r\n        base.de_country_c AS de_country,\r\n        base.de_current_crm_c AS de_current_crm,\r\n        base.de_current_marketing_automation_c AS de_current_ma,\r\n        base.de_industry_c AS de_industry,\r\n        CASE\r\n            WHEN base.de_industry_c IN (\'Business Services\') THEN \'Business Services\'\r\n            WHEN base.de_industry_c IN (\'Finance\',\'Insurance\') THEN \'Finance\'\r\n            WHEN base.de_industry_c IN (\'Manufacturing\') THEN \'Manufacturing\'\r\n            WHEN base.de_industry_c IN (\'Software\',\'Telecommunications\') THEN \'SoftCom\'\r\n            ELSE \'Other\'\r\n        END AS industry_bucket,\r\n        base.de_parent_company_c AS de_account_parent_name,\r\n        base.de_ultimate_parent_company_c AS de_ultimate_parent_account_name,\r\n        base.ao_instance_number_c AS ao_instance_number,\r\n        base.do_not_market_c AS do_not_market,\r\n        base.target_account_c AS target_account,\r\n        base.market_segment_static_c AS market_segment_static,\r\n        base.sdr_c AS sdr,\r\n        base.current_contract_c AS current_contract,\r\n        base.onboarding_completion_date_c AS onboarding_completion_date,\r\n        base.customer_since_c AS customer_since,\r\n        base.onboarding_specialist_c AS onboarding_specialist,\r\n        base.executive_sponsor_c AS executive_sponsor,\r\n        base.assigned_account_tier_c AS assigned_account_tier,\r\n        base.business_model_c AS business_model,\r\n        base.contract_type_c AS contract_type,\r\n        base.delivered_support_tier_c AS delivered_support_tier,\r\n        parent.name AS account_parent_name,\r\n        base.deliverability_consultant_c AS deliverability_consultant_id,\r\n        sdr.user_email AS sdr_email,\r\n        sdr.user_first_name AS sdr_first_name,\r\n        sdr.user_full_name AS sdr_full_name,\r\n        sdr.user_photo AS sdr_photo,\r\n        sdr.calendly_link AS sdr_calendly,\r\n        sdr.user_title AS sdr_title,\r\n        sdr.user_phone AS sdr_phone,\r\n        csm.user_email AS account_csm_email,\r\n        csm.user_photo AS account_csm_photo,\r\n        csm.user_id AS csm_id,\r\n        csm.user_full_name AS account_csm_name,\r\n        account_owner.user_full_name AS account_owner_name,\r\n        account_owner.user_email AS account_owner_email,\r\n        account_owner.calendly_link AS account_owner_calendly,\r\n        account_owner.user_photo AS account_owner_photo,\r\n        onboarding.user_photo AS onboarding_specialist_photo,\r\n        onboarding.user_email AS onboarding_specialist_email,\r\n        onboarding.user_full_name AS onboarding_specialist_name,\r\n        deliverability.user_email AS account_deliverability_consultant_email,\r\n        deliverability.user_full_name AS account_deliverability_consultant,\r\n        opp_source_xf.is_closed,\r\n        contract_source_xf.end_date,\r\n        CASE \r\n            WHEN base.annual_revenue <= 49999999 THEN \'SMB\'\r\n            WHEN base.annual_revenue > 49999999 AND base.annual_revenue <= 499999999 THEN \'Mid-Market\'\r\n            WHEN base.annual_revenue > 499999999 THEN \'Enterprise\'\r\n        END AS company_size_rev,\r\n        COUNT(DISTINCT opp_source_xf.opportunity_id) AS number_of_open_opportunities,\r\n        CASE \r\n            WHEN opp_source_xf.is_closed = false THEN COUNT(DISTINCT opp_source_xf.opportunity_id)\r\n            ELSE 0\r\n        END AS number_of_open_opps,\r\n        CASE\r\n            WHEN base.billing_country IS NOT null AND base.billing_country IN (\'GB\',\'UK\',\'IE\',\'DE\',\'DK\',\'FI\',\'IS\',\'NO\',\'SE\',\'FR\',\'AL\',\'AD\',\'AM\',\'AT\',\'BY\',\'BE\',\'BA\',\'BG\',\'HR\',\'CS\',\'CY\',\'CZ\',\'EE\',\'FX\',\'GE\',\'GR\',\'HU\',\'IT\',\'LV\',\'LI\',\'LT\',\'LU\',\'MK\',\'MT\',\'MD\',\'MC\',\'ME\',\'NL\',\'PL\',\'PT\',\'RO\',\'SM\',\'RS\',\'SJ\',\'SK\',\'SI\',\'ES\',\'CH\',\'UA\',\'VA\',\'FO\',\'GI\',\'GG\',\'IM\',\'JE\',\'XK\',\'RU\') THEN \'EUROPE\'\r\n            WHEN base.billing_country IS NOT null AND base.billing_country IN (\'JP\',\'KR\',\'CN\',\'MN\',\'TW\',\'VN\',\'HK\',\'LA\',\'TH\',\'KH\',\'PH\',\'MY\',\'SG\',\'ID\',\'LK\',\'IN\',\'NP\',\'BT\',\'MM\',\'PK\',\'AF\',\'KG\',\'UZ\',\'TM\',\'KZ\') THEN \'APJ\'\r\n            WHEN base.billing_country IS NOT null AND base.billing_country IN (\'AU\',\'CX\',\'NZ\',\'NF\',\'Australia\',\'New Zealand\') THEN \'AUNZ\'\r\n            WHEN base.billing_country IS NOT null AND base.billing_country IN (\'AR\',\'BO\',\'BR\',\'BZ\',\'CL\',\'CO\',\'CU\',\'CR\',\'DO\',\'EC\',\'FK\',\'GF\',\'GS\',\'GY\',\'GT\',\'HN\',\'MX\',\'NI\',\'PA\',\'PE\',\'PR\',\'PY\',\'SR\',\'SV\',\'UY\',\'VE\')THEN \'LATAM\'\r\n            WHEN base.billing_state IS NOT null AND base.billing_state IN (\'CA\',\'NV\',\'UT\',\'AK\',\'MO\',\'CO\',\'HI\',\'OK\',\'IL\',\'AR\',\'NE\',\'MI\',\'KS\',\'OR\',\'WA\',\'ID\',\'WI\',\'MN\',\'ND\',\'SD\',\'MT\',\'WY\',\'IA\',\'NB\',\'ON\',\'PE\',\'QC\',\'AB\',\'BC\',\'MB\',\'SK\',\'NL\',\'NS\',\'YT\',\'NU\',\'NT\') THEN \'NA-WEST\'\r\n            WHEN base.billing_state IS NOT null AND base.billing_state IN (\'NY\',\'CT\',\'MA\',\'VT\',\'NH\',\'ME\',\'NJ\',\'RI\',\'TX\',\'AZ\',\'NM\',\'MS\',\'LA\',\'AL\',\'TN\',\'KY\',\'OH\',\'IN\',\'GA\',\'FL\',\'NC\',\'SC\',\'PA\',\'DC\',\'DE\',\'MD\',\'VA\',\'WV\') THEN \'NA-EAST\'\r\n            WHEN base.billing_country IS NOT null AND base.billing_country IN (\'AG\',\'AI\',\'AN\',\'AW\',\'BB\',\'BM\',\'BS\',\'DM\',\'GD\',\'GP\',\'HT\',\'JM\',\'KN\',\'LC\',\'MQ\',\'MS\',\'TC\',\'TT\',\'VC\',\'VG\',\'VI\') THEN \'NA-EAST\'\r\n            WHEN base.billing_country IS NOT null AND base.billing_country IN (\'US\',\'CA\') AND base.billing_state IS null  THEN \'NA-NO-STATEPROV\'\r\n            WHEN base.billing_country IS NOT null AND base.billing_state IS NOT null THEN \'ROW\'\r\n            ELSE \'Unknown\'\r\n        END AS global_region,\r\n        contract_source_xf.end_date+1 AS renewal_date\r\n        -- "Renewal_Notice_Date__c" AS renewal_notice_date,\r\n    FROM base\r\n    LEFT JOIN "acton".salesforce."account" AS parent ON\r\n    base.id=parent.parent_id\r\n    LEFT JOIN {{ref(\'user_source_xf\')}} AS sdr ON\r\n    base.sdr_c=sdr.user_id\r\n    LEFT JOIN {{ref(\'user_source_xf\')}} AS csm ON\r\n    base.csm_c=csm.user_id\r\n    LEFT JOIN {{ref(\'user_source_xf\')}} AS account_owner ON\r\n    base.owner_id=account_owner.user_id\r\n    LEFT JOIN {{ref(\'user_source_xf\')}} AS onboarding ON\r\n    base.onboarding_specialist_c=onboarding.user_id\r\n    LEFT JOIN {{ref(\'user_source_xf\')}} AS deliverability ON\r\n    base.deliverability_consultant_c=deliverability.user_id\r\n    LEFT JOIN {{ref(\'opp_source_xf\')}} ON\r\n    base.id=opp_source_xf.account_id\r\n    LEFT JOIN {{ref(\'contract_source_xf\')}} ON\r\n    base.current_contract_c=contract_source_xf.contract_id\r\n    {{dbt_utils.group_by(n=66) }}\r\n\r\n)\r\n\r\nSELECT \r\nfinal.*,\r\nCASE\r\n    WHEN global_region IN (\'EUROPE\',\'ROW\',\'AUNZ\') THEN \'EMEA\'\r\n    WHEN company_size_rev IN (\'SMB\') OR company_size_rev IS null THEN \'Velocity\'\r\n    WHEN company_size_rev IN (\'Mid-Market\',\'Enterprise\') THEN \'Upmarket\'\r\n    ELSE null\r\nEND AS segment \r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.group_by'], 'nodes': ['source.acton_marketing_data.salesforce.account', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.contract_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'account_source_xf'], 'unique_id': 'model.acton_marketing_data.account_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/account_source_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/account_source_xf.sql', 'name': 'account_source_xf', 'alias': 'account_source_xf', 'checksum': {'name': 'sha256', 'checksum': 'a33df3a4d8c1f40de1ff82fd5e05654c2be23975b25b62b14bab4ae5c4ed127d'}, 'tags': [], 'refs': [['user_source_xf'], ['user_source_xf'], ['user_source_xf'], ['user_source_xf'], ['user_source_xf'], ['opp_source_xf'], ['contract_source_xf']], 'sources': [['salesforce', 'account']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3314526, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.contact_history_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'contact_history') }}\r\n\r\n)\r\n\r\nSELECT\r\nid AS contact_history_id, \r\ncontact_id,\r\ncreated_date AS field_modified_at,\r\nfield,\r\nold_value,\r\nnew_value\r\nFROM base\r\nWHERE is_deleted = false", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.contact_history']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'contact_history_xf'], 'unique_id': 'model.acton_marketing_data.contact_history_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/contact_history_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/contact_history_xf.sql', 'name': 'contact_history_xf', 'alias': 'contact_history_xf', 'checksum': {'name': 'sha256', 'checksum': '804169484507926511e61e9c545e9690135aa431759f296404cdc3998944e8a6'}, 'tags': [], 'refs': [], 'sources': [['salesforce', 'contact_history']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3419397, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.product_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ source('salesforce', 'product_2') }}\r\n\r\n), final AS (\r\n\r\n    SELECT \r\n        id AS product_id,\r\n        product_code,\r\n        DATE_TRUNC('day',created_date)::Date AS product_created_date,\r\n        DATE_TRUNC('day',last_modified_date)::Date AS product_last_modified_date,\r\n        system_modstamp AS systemmodstamp,\r\n        is_deleted,\r\n        rev_rec_c AS rev_rec,\r\n        multiplier_override_c AS multiplier_override,\r\n        sbqq_subscription_type_c AS sbqq_subscription_type,\r\n        product_category_c AS product_category\r\n    FROM base\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.product_2']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'product_xf'], 'unique_id': 'model.acton_marketing_data.product_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/product_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/product_xf.sql', 'name': 'product_xf', 'alias': 'product_xf', 'checksum': {'name': 'sha256', 'checksum': 'b892bc25c1dd6f721a34f9be111df89d9a88cb15c1c8b5738dd6c140f9a1d288'}, 'tags': [], 'refs': [], 'sources': [['salesforce', 'product_2']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.344255, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.lead_history_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'lead_history') }}\r\n\r\n)\r\n\r\nSELECT\r\nid AS lead_history_id, \r\nbase.lead_id,\r\nbase.created_date AS field_modified_at,\r\nfield,\r\nold_value,\r\nnew_value\r\nFROM base\r\nLEFT JOIN {{ref('lead_source_xf')}} ON\r\nbase.lead_id=lead_source_xf.lead_id\r\nWHERE base.is_deleted = false\r\nAND is_converted=false", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.lead_history', 'model.acton_marketing_data.lead_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'lead_history_xf'], 'unique_id': 'model.acton_marketing_data.lead_history_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/lead_history_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/lead_history_xf.sql', 'name': 'lead_history_xf', 'alias': 'lead_history_xf', 'checksum': {'name': 'sha256', 'checksum': '3370f17bb81ef633080a4c36c89902f12e709bc2c8a8c6b238733d01c6dfb325'}, 'tags': [], 'refs': [['lead_source_xf']], 'sources': [['salesforce', 'lead_history']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.346246, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.campaign_member_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'campaign_member') }}\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        id AS campaign_member_id,\r\n        campaign_id,\r\n        lead_id,\r\n        contact_id,\r\n        lead_or_contact_id,\r\n        account_id,\r\n        company_or_account AS account_name,\r\n        account_lookup_c AS account_lookup,\r\n        email,\r\n        status AS campaign_member_status,\r\n        type AS campaign_member_type,\r\n        has_responded AS campaign_member_has_responded,\r\n        DATE_TRUNC('day',base.created_date)::Date AS campaign_member_created_date,\r\n        DATE_TRUNC('day',base.first_responded_date)::Date AS campaign_member_first_responded_date,\r\n        is_deleted AS is_deleted_campaign_member\r\n    FROM base\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.campaign_member']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'campaign_member_source_xf'], 'unique_id': 'model.acton_marketing_data.campaign_member_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/campaign_member_source_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/campaign_member_source_xf.sql', 'name': 'campaign_member_source_xf', 'alias': 'campaign_member_source_xf', 'checksum': {'name': 'sha256', 'checksum': 'fbd220c144831925ad8d570aa98f6ce86dc57f408743743af007dadcb730ba59'}, 'tags': [], 'refs': [], 'sources': [['salesforce', 'campaign_member']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3484228, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.user_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'user') }}\r\n\r\n)\r\n\r\n    SELECT\r\n        id AS user_id,\r\n        username AS user_name,\r\n        last_name AS user_last_name,\r\n        first_name AS user_first_name,\r\n        name AS user_full_name,\r\n        department AS user_department,\r\n        title AS user_title,\r\n        email AS user_email,\r\n        phone AS user_phone,\r\n        is_active AS is_active_user,\r\n        manager_id,\r\n        created_date AS user_created_date,\r\n        last_modified_date AS user_last_modified_date,\r\n        system_modstamp AS systemmodstamp,\r\n        contact_id AS user_contact_id,\r\n        account_id AS user_account_id,\r\n        full_photo_url AS user_photo_url,\r\n        sales_loft_calendar_link_c AS sales_loft_calendar_link,\r\n        calendly_link_c AS calendly_link,\r\n        headshot_url_c AS user_headshot_url,\r\n        office_location_c AS user_office_location,\r\n        sales_home_office_c AS user_sales_home_office,\r\n        csm_type_c AS csm_type,\r\n        my_territory_c AS user_territory,\r\n        photo_c AS user_photo\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.user']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'user_source_xf'], 'unique_id': 'model.acton_marketing_data.user_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/user_source_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/user_source_xf.sql', 'name': 'user_source_xf', 'alias': 'user_source_xf', 'checksum': {'name': 'sha256', 'checksum': '6fcb107d95e2affae58c790a92e44ace193a146983467f674930ae0a45c6499f'}, 'tags': [], 'refs': [], 'sources': [['salesforce', 'user']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3504653, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opp_source_xf': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH base AS (\r\nSELECT *\r\nFROM {{ source(\'salesforce\', \'opportunity\') }}\r\n\r\n), intermediate AS (\r\n\r\n    SELECT DISTINCT\r\n        base.id AS opportunity_id,\r\n        base.is_deleted,\r\n        base.account_id,\r\n        account.name AS account_name,\r\n        --account.account_csm_name,\r\n        --account.account_owner_name,\r\n        account.current_customer_c AS is_current_customer,\r\n        account.sdr_c AS sdr_id,\r\n        sdr.user_name AS sdr_name,\r\n        CASE\r\n            WHEN account.billing_country IS NOT null AND account.billing_country IN (\'GB\',\'UK\',\'IE\',\'DE\',\'DK\',\'FI\',\'IS\',\'NO\',\'SE\',\'FR\',\'AL\',\'AD\',\'AM\',\'AT\',\'BY\',\'BE\',\'BA\',\'BG\',\'HR\',\'CS\',\'CY\',\'CZ\',\'EE\',\'FX\',\'GE\',\'GR\',\'HU\',\'IT\',\'LV\',\'LI\',\'LT\',\'LU\',\'MK\',\'MT\',\'MD\',\'MC\',\'ME\',\'NL\',\'PL\',\'PT\',\'RO\',\'SM\',\'RS\',\'SJ\',\'SK\',\'SI\',\'ES\',\'CH\',\'UA\',\'VA\',\'FO\',\'GI\',\'GG\',\'IM\',\'JE\',\'XK\',\'RU\') THEN \'EUROPE\'\r\n            WHEN account.billing_country IS NOT null AND account.billing_country IN (\'JP\',\'KR\',\'CN\',\'MN\',\'TW\',\'VN\',\'HK\',\'LA\',\'TH\',\'KH\',\'PH\',\'MY\',\'SG\',\'ID\',\'LK\',\'IN\',\'NP\',\'BT\',\'MM\',\'PK\',\'AF\',\'KG\',\'UZ\',\'TM\',\'KZ\') THEN \'APJ\'\r\n            WHEN account.billing_country IS NOT null AND account.billing_country IN (\'AU\',\'CX\',\'NZ\',\'NF\',\'Australia\',\'New Zealand\') THEN \'AUNZ\'\r\n            WHEN account.billing_country IS NOT null AND account.billing_country IN (\'AR\',\'BO\',\'BR\',\'BZ\',\'CL\',\'CO\',\'CU\',\'CR\',\'DO\',\'EC\',\'FK\',\'GF\',\'GS\',\'GY\',\'GT\',\'HN\',\'MX\',\'NI\',\'PA\',\'PE\',\'PR\',\'PY\',\'SR\',\'SV\',\'UY\',\'VE\')THEN \'LATAM\'\r\n            WHEN account.billing_state IS NOT null AND account.billing_state IN (\'CA\',\'NV\',\'UT\',\'AK\',\'MO\',\'CO\',\'HI\',\'OK\',\'IL\',\'AR\',\'NE\',\'MI\',\'KS\',\'OR\',\'WA\',\'ID\',\'WI\',\'MN\',\'ND\',\'SD\',\'MT\',\'WY\',\'IA\',\'NB\',\'ON\',\'PE\',\'QC\',\'AB\',\'BC\',\'MB\',\'SK\',\'NL\',\'NS\',\'YT\',\'NU\',\'NT\') THEN \'NA-WEST\'\r\n            WHEN account.billing_state IS NOT null AND account.billing_state IN (\'NY\',\'CT\',\'MA\',\'VT\',\'NH\',\'ME\',\'NJ\',\'RI\',\'TX\',\'AZ\',\'NM\',\'MS\',\'LA\',\'AL\',\'TN\',\'KY\',\'OH\',\'IN\',\'GA\',\'FL\',\'NC\',\'SC\',\'PA\',\'DC\',\'DE\',\'MD\',\'VA\',\'WV\') THEN \'NA-EAST\'\r\n            WHEN account.billing_country IS NOT null AND account.billing_country IN (\'AG\',\'AI\',\'AN\',\'AW\',\'BB\',\'BM\',\'BS\',\'DM\',\'GD\',\'GP\',\'HT\',\'JM\',\'KN\',\'LC\',\'MQ\',\'MS\',\'TC\',\'TT\',\'VC\',\'VG\',\'VI\') THEN \'NA-EAST\'\r\n            WHEN account.billing_country IS NOT null AND account.billing_country IN (\'US\',\'CA\') AND account.billing_state IS null  THEN \'NA-NO-STATEPROV\'\r\n            WHEN account.billing_country IS NOT null AND account.billing_state IS NOT null THEN \'ROW\'\r\n            ELSE \'Unknown\'\r\n        END AS account_global_region,\r\n        CASE \r\n            WHEN account.annual_revenue <= 49999999 THEN \'SMB\'\r\n            WHEN account.annual_revenue > 49999999 AND account.annual_revenue <= 499999999 THEN \'Mid-Market\'\r\n            WHEN account.annual_revenue > 499999999 THEN \'Enterprise\'\r\n        END AS company_size_rev,\r\n        base.name AS opportunity_name,\r\n        stage_name,\r\n        amount,\r\n        base.type,\r\n        lead_source AS opp_lead_source,\r\n        is_closed,\r\n        is_won,\r\n        base.owner_id,\r\n        owner.user_name AS owner_name, \r\n        base.created_date AS created_day,\r\n        DATE_TRUNC(\'day\',base.created_date)::Date AS created_date,\r\n        DATE_TRUNC(\'day\',base.last_modified_date)::Date AS last_modified_date,\r\n        base.system_modstamp AS systemmodstamp,\r\n        contact_id,\r\n        base.contract_id,\r\n        crm_c AS opp_crm,\r\n        renewal_type_c AS renewal_type,\r\n        renewal_acv_value_c AS renewal_acv,\r\n        channel_lead_creation_c AS opp_channel_lead_creation,\r\n        medium_lead_creation_c AS opp_medium_lead_creation,\r\n        DATE_TRUNC(\'day\',discovery_date_c)::Date AS discovery_date,\r\n        DATE_TRUNC(\'day\',date_reached_confirmed_value_c)::Date AS confirmed_value_date,\r\n        DATE_TRUNC(\'day\',date_reached_contract_c)::Date AS negotiation_date,\r\n        DATE_TRUNC(\'day\',date_reached_demo_c)::Date AS demo_date,\r\n        DATE_TRUNC(\'day\',date_reached_solution_c)::Date AS solution_date,\r\n        DATE_TRUNC(\'day\',date_reached_closing_c)::Date AS closing_date,\r\n        DATE_TRUNC(\'day\',date_time_reached_implement_c)::Date AS implement_date,\r\n        DATE_TRUNC(\'day\',sql_date_c)::Date AS sql_date,\r\n        DATE_TRUNC(\'day\',date_time_reached_voc_negotiate_c)::Date AS voc_date,\r\n        DATE_TRUNC(\'day\',date_time_reached_discovery_c)::Date AS discovery_day_time,\r\n        DATE_TRUNC(\'day\',date_time_reached_demo_c)::Date AS demo_day_time,\r\n        DATE_TRUNC(\'day\',date_time_reached_implement_c)::Date AS implement_day_time,\r\n        DATE_TRUNC(\'day\',date_time_reached_sql_c)::Date AS sql_day_time,\r\n        DATE_TRUNC(\'day\',date_time_reached_voc_negotiate_c)::Date AS voc_day_time,\r\n        oc_utm_channel_c AS opp_channel_opportunity_creation,\r\n        oc_utm_medium_c AS opp_medium_opportunity_creation,\r\n        oc_utm_content_c AS opp_content_opportunity_creation, \r\n        oc_utm_source_c AS opp_source_opportunity_creation, \r\n        base.csm_c AS csm,\r\n        base.marketing_channel_c AS marketing_channel,\r\n        base.ft_utm_channel_c AS opp_channel_first_touch,\r\n        base.ft_utm_content_c AS opp_content_first_touch,\r\n        base.ft_utm_medium_c AS opp_medium_first_touch,\r\n        base.ft_utm_source_c AS opp_source_first_touch,\r\n        base.oc_offer_asset_type_c AS opp_offer_asset_type_opportunity_creation,\r\n        base.oc_offer_asset_subtype_c AS opp_offer_asset_subtype_opportunity_creation,\r\n        base.oc_offer_asset_topic_c AS opp_offer_asset_topic_opportunity_creation,\r\n        base.oc_offer_asset_name_c AS opp_offer_asset_name_opportunity_creation,\r\n        base.ft_offer_asset_name_c AS opp_offer_asset_name_first_touch,\r\n        base.lc_offer_asset_name_c  AS opp_offer_asset_name_lead_creation, \r\n        base.ft_offer_asset_subtype_c AS opp_offer_asset_subtype_first_touch, \r\n        base.lc_offer_asset_subtype_c AS opp_offer_asset_subtype_lead_creation,\r\n        base.ft_offer_asset_topic_c AS opp_offer_asset_topic_first_touch, \r\n        base.lc_offer_asset_topic_c AS opp_offer_asset_topic_lead_creation,\r\n        base.ft_offer_asset_type_c AS opp_offer_asset_type_first_touch, \r\n        base.lc_offer_asset_type_c AS opp_offer_asset_type_lead_creation,\r\n        base.ft_subchannel_c AS opp_subchannel_first_touch,\r\n        base.lc_subchannel_c AS opp_subchannel_lead_creation, \r\n        base.oc_subchannel_c AS opp_subchannel_opportunity_creation,\r\n        DATE_TRUNC(\'day\',base.discovery_call_scheduled_date_c)::Date AS discovery_call_date,\r\n        base.opportunity_status_c AS opportunity_status,\r\n        base.sql_status_reason_c AS sql_status_reason,\r\n        DATE_TRUNC(\'day\',base.sql_date_c)::Date AS sql_day,\r\n        DATE_TRUNC(\'day\',base.discovery_call_scheduled_date_time_c)::Date AS discovery_call_scheduled_datetime,\r\n        DATE_TRUNC(\'day\',base.discovery_call_completed_date_time_c)::Date AS discovery_call_completed_datetime,\r\n        base.ao_account_id_c AS ao_account_id,\r\n        base.lead_id_converted_from_c AS lead_id_converted_from,\r\n        base.close_date,\r\n        base.opportunity_type_detail_c AS opp_type_details,\r\n        DATE_TRUNC(\'day\',base.close_date)::Date AS close_day,\r\n        base.source_lead_creation_c AS opp_source_lead_creation,\r\n        base.oc_utm_campaign_c AS opp_campaign_opportunity_creation,\r\n        base.forecast_category,\r\n        base.ft_utm_campaign_c AS opp_campaign_first_touch,  \r\n        base.acv_deal_size_override_c AS acv_deal_size_override,\r\n        base.lead_grade_at_conversion_c AS lead_grade_at_conversion,\r\n        base.renewal_stage_c AS renewal_stage,\r\n        base.created_by_id,\r\n        quota_credit_renewal_c AS quota_credit_renewal,\r\n        base.sbqq_renewed_contract_c AS renewed_contract_id,\r\n        quota_credit_c AS quota_credit,\r\n        sbqq_primary_quote_c AS primary_quote_id,\r\n        quota_credit_new_business_c AS quota_credit_new_business,\r\n        quota_credit_one_time_c AS quota_credit_one_time,\r\n        submitted_for_approval_c AS submitted_for_approval,\r\n        acv_add_back_c AS acv_add_back,\r\n        trigger_renewal_value_c AS trigger_renewal_value,\r\n        opportunity_line_item_xf.sbqq_subscription_type,\r\n        quote_line.sbqq_product_subscription_term,\r\n        opportunity_line_item_xf.product_code,\r\n        opportunity_line_item_xf.product_family,\r\n        opportunity_line_item_xf.total_price,\r\n        opportunity_line_item_xf.annual_price,\r\n        quote_line.sbqq_primary_quote,\r\n        contract_source_xf.contract_acv,\r\n        account.industry,\r\n        CASE\r\n            WHEN account.industry IN (\'Business Services\') THEN \'Business Services\'\r\n            WHEN account.industry IN (\'Finance\',\'Insurance\') THEN \'Finance\'\r\n            WHEN account.industry IN (\'Manufacturing\') THEN \'Manufacturing\'\r\n            WHEN account.industry IN (\'Software\',\'Telecommunications\') THEN \'SoftCom\'\r\n            ELSE \'Other\'\r\n        END AS industry_bucket,\r\n        --account.segment,\r\n        CASE\r\n            WHEN base.type IN (\'New Business\',\'Upsell\',\'Trigger Renewal\',\'Trigger Up\',\'Non-Monetary Mod\',\'Admin Opp\',\'Partner New\',\'Partner UpSell\',\'Admin Conversion\') THEN true\r\n            ELSE false\r\n        END AS include_in_acv_deal_size,\r\n        CASE\r\n            WHEN is_closed = true THEN {{ dbt_utils.datediff("base.created_date","base.close_date",\'day\') }}\r\n            ELSE {{ dbt_utils.datediff("base.created_date","CURRENT_DATE",\'day\') }}\r\n        END AS age,\r\n        CASE\r\n            WHEN opportunity_line_item_xf.sbqq_subscription_type = \'Renewable\' AND opportunity_line_item_xf.product_code != \'SOW-MNTH-CUST\' THEN SUM(total_price)\r\n            ELSE 0\r\n        END AS tcv,\r\n        CASE \r\n            WHEN opportunity_line_item_xf.sbqq_subscription_type = \'Renewable\' AND opportunity_line_item_xf.product_family != \'Bundle\' AND opportunity_line_item_xf.product_code NOT IN (\'SOW-MNTH-CUST\',\'MAAS-FND-TRAIN\',\'MAAS-FND-FAST\',\'MAAS-ACC-DELIV\',\'MAAS-ACC-STRAT\')\r\n                THEN SUM(annual_price)\r\n            ELSE 0\r\n        END AS acv,\r\n        CASE \r\n            WHEN opportunity_line_item_xf.sbqq_subscription_type = \'One-time\' AND opportunity_line_item_xf.product_code NOT IN (\'STD-CPCTY-ONE\',\'SOW-MKTR-DMD\',\'SOW-MNTH-CUST\',\'MAAS-FND-TRAIN\',\'MAAS-FND-FASTTRK\',\'MAAS-ACC-IMPL\',\'MAAS-ACC-DELIV\',\'MAAS-ACC-STRAT\',\'AO-CPM-OVER\')\r\n                THEN SUM(total_price)\r\n            ELSE 0\r\n        END AS one_time_ps_value,\r\n        CASE \r\n            WHEN opportunity_line_item_xf.sbqq_subscription_type = \'One-time\' AND opportunity_line_item_xf.product_code IN (\'STD-CPCTY-ONE\',\'AO-CPM-OVER\') THEN SUM(total_price)\r\n            ELSE 0\r\n        END AS one_time_license_value,\r\n        CASE \r\n            WHEN opportunity_line_item_xf.product_code IN (\'SOW-MKTR-DMD\',\'SOW-MNTH-CUST\',\'MAAS-FND-TRAIN\',\'MAAS-FND-FASTTRK\',\'MAAS-ACC-IMPL\',\'MAAS-ACC-DELIV\',\'MAAS-ACC-STRAT\') THEN SUM(total_price)\r\n            ELSE 0\r\n        END AS pso_recurring_fees\r\n    FROM base\r\n    LEFT JOIN {{ref(\'contract_source_xf\')}} ON\r\n    base.id=contract_source_xf.contract_opportunity_id\r\n    LEFT JOIN {{ref(\'opportunity_line_item_xf\')}} ON\r\n    base.id=opportunity_line_item_xf.opportunity_id\r\n    LEFT JOIN {{ref(\'quote_line\')}} ON\r\n    base.id=quote_line.opportunity_id\r\n    LEFT JOIN "acton".salesforce."account" account ON\r\n    base.account_id=account.id\r\n    LEFT JOIN {{ref(\'user_source_xf\')}} owner ON\r\n    base.owner_id=owner.user_id\r\n    LEFT JOIN {{ref(\'user_source_xf\')}} sdr ON\r\n    account.sdr_c=sdr.user_id\r\n    {{dbt_utils.group_by(n=108) }}\r\n\r\n), intermediate_acv_formula AS (\r\n\r\n    SELECT \r\n      intermediate.opportunity_id,\r\n      intermediate.is_deleted,\r\n      intermediate.account_id,\r\n      intermediate.account_name,\r\n      intermediate.is_current_customer,\r\n      intermediate.sdr_id,\r\n      intermediate.sdr_name,\r\n      intermediate.company_size_rev,\r\n      intermediate.account_global_region,\r\n      intermediate.opportunity_name,\r\n      intermediate.stage_name,\r\n      intermediate.amount,\r\n      intermediate.type,\r\n      intermediate.opp_lead_source,\r\n      intermediate.is_closed,\r\n      intermediate.is_won,\r\n      intermediate.owner_id,\r\n      intermediate.owner_name,\r\n      intermediate.created_day,\r\n      intermediate.created_date,\r\n      intermediate.last_modified_date,\r\n      intermediate.systemmodstamp,\r\n      intermediate.contact_id,\r\n      intermediate.contract_id,\r\n      intermediate.opp_crm,\r\n      intermediate.renewal_type,\r\n      intermediate.renewal_acv,\r\n      intermediate.opp_channel_lead_creation,\r\n      intermediate.opp_medium_lead_creation,\r\n      intermediate.discovery_date,\r\n      intermediate.demo_date,\r\n      intermediate.solution_date,\r\n      intermediate.negotiation_date,\r\n      intermediate.confirmed_value_date,\r\n      intermediate.closing_date,\r\n      intermediate.implement_date,\r\n      intermediate.sql_date,\r\n      intermediate.voc_date,\r\n      intermediate.discovery_day_time,\r\n      intermediate.demo_day_time,\r\n      intermediate.implement_day_time,\r\n      intermediate.sql_day_time,\r\n      intermediate.voc_day_time,\r\n      intermediate.opp_channel_opportunity_creation,\r\n      intermediate.opp_medium_opportunity_creation,\r\n      intermediate.opp_content_opportunity_creation,\r\n      intermediate.opp_source_opportunity_creation,\r\n      intermediate.csm,\r\n      intermediate.marketing_channel,\r\n      intermediate.opp_channel_first_touch,\r\n      intermediate.opp_content_first_touch,\r\n      intermediate.opp_medium_first_touch,\r\n      intermediate.opp_source_first_touch,\r\n      intermediate.opp_offer_asset_type_opportunity_creation,\r\n      intermediate.opp_offer_asset_subtype_opportunity_creation,\r\n      intermediate.opp_offer_asset_topic_opportunity_creation,\r\n      intermediate.opp_offer_asset_name_opportunity_creation,\r\n      intermediate.opp_offer_asset_name_first_touch,\r\n      intermediate.opp_offer_asset_name_lead_creation,\r\n      intermediate.opp_offer_asset_subtype_first_touch,\r\n      intermediate.opp_offer_asset_subtype_lead_creation,\r\n      intermediate.opp_offer_asset_topic_first_touch,\r\n      intermediate.opp_offer_asset_topic_lead_creation,\r\n      intermediate.opp_offer_asset_type_first_touch,\r\n      intermediate.opp_offer_asset_type_lead_creation,\r\n      intermediate.opp_subchannel_first_touch,\r\n      intermediate.opp_subchannel_lead_creation,\r\n      intermediate.opp_subchannel_opportunity_creation,\r\n      intermediate.discovery_call_date,\r\n      intermediate.opportunity_status,\r\n      intermediate.sql_status_reason,\r\n      intermediate.sql_day,\r\n      intermediate.discovery_call_scheduled_datetime,\r\n      intermediate.discovery_call_completed_datetime,\r\n      intermediate.ao_account_id,\r\n      intermediate.lead_id_converted_from,\r\n      intermediate.close_date,\r\n      intermediate.opp_type_details,\r\n      intermediate.close_day,\r\n      intermediate.opp_source_lead_creation,\r\n      intermediate.opp_campaign_opportunity_creation,\r\n      intermediate.forecast_category,\r\n      intermediate.opp_campaign_first_touch,\r\n      intermediate.acv_deal_size_override,\r\n      intermediate.lead_grade_at_conversion,\r\n      intermediate.renewal_stage,\r\n      intermediate.created_by_id,\r\n      intermediate.quota_credit_renewal,\r\n      intermediate.renewed_contract_id,\r\n      intermediate.quota_credit,\r\n      intermediate.primary_quote_id,\r\n      intermediate.quota_credit_new_business,\r\n      intermediate.quota_credit_one_time,\r\n      intermediate.submitted_for_approval,\r\n      intermediate.acv_add_back,\r\n      intermediate.trigger_renewal_value,\r\n      intermediate.sbqq_primary_quote,\r\n      intermediate.sbqq_product_subscription_term,\r\n      intermediate.contract_acv,\r\n      intermediate.industry,\r\n      intermediate.industry_bucket,\r\n      --intermediate.segment,\r\n      intermediate.include_in_acv_deal_size,\r\n      intermediate.age,\r\n      intermediate.tcv,\r\n      intermediate.acv,\r\n      intermediate.one_time_ps_value,\r\n      intermediate.one_time_license_value,\r\n      intermediate.pso_recurring_fees,\r\n      intermediate.total_price,\r\n      intermediate.annual_price,\r\n      CASE\r\n        WHEN sbqq_product_subscription_term = 0 AND sbqq_primary_quote IS null THEN SUM(contract_acv)\r\n        WHEN sbqq_product_subscription_term > 0 AND sbqq_product_subscription_term < 12 THEN SUM(tcv) \r\n        ELSE SUM(acv)\r\n      END AS acv_formula\r\n      --intermediate.sbqq_subscription_type,\r\n      --intermediate.product_code,\r\n      --intermediate.product_family,\r\n    FROM intermediate\r\n    {{dbt_utils.group_by(n=110) }}\r\n\r\n), intermediate_acv_sum AS (\r\n    \r\n    SELECT\r\n      intermediate_acv_formula.opportunity_id,\r\n      intermediate_acv_formula.is_deleted,\r\n      intermediate_acv_formula.account_id,\r\n      intermediate_acv_formula.account_name,\r\n      intermediate_acv_formula.is_current_customer,\r\n      intermediate_acv_formula.sdr_id,\r\n      intermediate_acv_formula.sdr_name,\r\n      intermediate_acv_formula.account_global_region,\r\n      intermediate_acv_formula.company_size_rev,\r\n      intermediate_acv_formula.opportunity_name,\r\n      intermediate_acv_formula.stage_name,\r\n      intermediate_acv_formula.amount,\r\n      intermediate_acv_formula.type,\r\n      intermediate_acv_formula.opp_lead_source,\r\n      intermediate_acv_formula.is_closed,\r\n      intermediate_acv_formula.is_won,\r\n      intermediate_acv_formula.owner_id,\r\n      intermediate_acv_formula.owner_name,\r\n      intermediate_acv_formula.created_day,\r\n      intermediate_acv_formula.created_date,\r\n      intermediate_acv_formula.last_modified_date,\r\n      intermediate_acv_formula.systemmodstamp,\r\n      intermediate_acv_formula.contact_id,\r\n      intermediate_acv_formula.contract_id,\r\n      intermediate_acv_formula.opp_crm,\r\n      intermediate_acv_formula.renewal_type,\r\n      intermediate_acv_formula.renewal_acv,\r\n      intermediate_acv_formula.opp_channel_lead_creation,\r\n      intermediate_acv_formula.opp_medium_lead_creation,\r\n      intermediate_acv_formula.discovery_date,\r\n      intermediate_acv_formula.negotiation_date,\r\n      intermediate_acv_formula.demo_date,\r\n      intermediate_acv_formula.solution_date,\r\n      intermediate_acv_formula.confirmed_value_date,\r\n      intermediate_acv_formula.closing_date,\r\n      intermediate_acv_formula.implement_date,\r\n      intermediate_acv_formula.discovery_day_time,\r\n      intermediate_acv_formula.demo_day_time,\r\n      intermediate_acv_formula.implement_day_time,\r\n      intermediate_acv_formula.sql_day_time,\r\n      intermediate_acv_formula.voc_day_time,\r\n      intermediate_acv_formula.sql_date,\r\n      intermediate_acv_formula.voc_date,\r\n      intermediate_acv_formula.opp_channel_opportunity_creation,\r\n      intermediate_acv_formula.opp_medium_opportunity_creation,\r\n      intermediate_acv_formula.opp_content_opportunity_creation,\r\n      intermediate_acv_formula.opp_source_opportunity_creation,\r\n      intermediate_acv_formula.csm,\r\n      intermediate_acv_formula.marketing_channel,\r\n      intermediate_acv_formula.opp_channel_first_touch,\r\n      intermediate_acv_formula.opp_content_first_touch,\r\n      intermediate_acv_formula.opp_medium_first_touch,\r\n      intermediate_acv_formula.opp_source_first_touch,\r\n      intermediate_acv_formula.opp_offer_asset_type_opportunity_creation,\r\n      intermediate_acv_formula.opp_offer_asset_subtype_opportunity_creation,\r\n      intermediate_acv_formula.opp_offer_asset_topic_opportunity_creation,\r\n      intermediate_acv_formula.opp_offer_asset_name_opportunity_creation,\r\n      intermediate_acv_formula.opp_offer_asset_name_first_touch,\r\n      intermediate_acv_formula.opp_offer_asset_name_lead_creation,\r\n      intermediate_acv_formula.opp_offer_asset_subtype_first_touch,\r\n      intermediate_acv_formula.opp_offer_asset_subtype_lead_creation,\r\n      intermediate_acv_formula.opp_offer_asset_topic_first_touch,\r\n      intermediate_acv_formula.opp_offer_asset_topic_lead_creation,\r\n      intermediate_acv_formula.opp_offer_asset_type_first_touch,\r\n      intermediate_acv_formula.opp_offer_asset_type_lead_creation,\r\n      intermediate_acv_formula.opp_subchannel_first_touch,\r\n      intermediate_acv_formula.opp_subchannel_lead_creation,\r\n      intermediate_acv_formula.opp_subchannel_opportunity_creation,\r\n      intermediate_acv_formula.discovery_call_date,\r\n      intermediate_acv_formula.opportunity_status,\r\n      intermediate_acv_formula.sql_status_reason,\r\n      intermediate_acv_formula.sql_day,\r\n      intermediate_acv_formula.discovery_call_scheduled_datetime,\r\n      intermediate_acv_formula.discovery_call_completed_datetime,\r\n      intermediate_acv_formula.ao_account_id,\r\n      intermediate_acv_formula.lead_id_converted_from,\r\n      intermediate_acv_formula.close_date,\r\n      intermediate_acv_formula.opp_type_details,\r\n      intermediate_acv_formula.close_day,\r\n      intermediate_acv_formula.opp_source_lead_creation,\r\n      intermediate_acv_formula.opp_campaign_opportunity_creation,\r\n      intermediate_acv_formula.forecast_category,\r\n      intermediate_acv_formula.opp_campaign_first_touch,\r\n      intermediate_acv_formula.acv_deal_size_override,\r\n      intermediate_acv_formula.lead_grade_at_conversion,\r\n      intermediate_acv_formula.renewal_stage,\r\n      intermediate_acv_formula.created_by_id,\r\n      intermediate_acv_formula.quota_credit_renewal,\r\n      intermediate_acv_formula.renewed_contract_id,\r\n      intermediate_acv_formula.quota_credit,\r\n      intermediate_acv_formula.primary_quote_id,\r\n      intermediate_acv_formula.quota_credit_new_business,\r\n      intermediate_acv_formula.quota_credit_one_time,\r\n      intermediate_acv_formula.submitted_for_approval,\r\n      intermediate_acv_formula.acv_add_back,\r\n      intermediate_acv_formula.trigger_renewal_value,\r\n      intermediate_acv_formula.sbqq_primary_quote,\r\n      intermediate_acv_formula.sbqq_product_subscription_term,\r\n      intermediate_acv_formula.contract_acv,\r\n      intermediate_acv_formula.industry,\r\n      intermediate_acv_formula.industry_bucket,\r\n     -- intermediate_acv_formula.segment,\r\n      intermediate_acv_formula.include_in_acv_deal_size,\r\n      intermediate_acv_formula.age,\r\n      SUM(intermediate_acv_formula.one_time_ps_value) AS one_time_ps_value,\r\n      SUM(intermediate_acv_formula.one_time_license_value) AS one_time_license_value,\r\n      SUM(intermediate_acv_formula.pso_recurring_fees) AS pso_recurring_fees,\r\n      SUM(intermediate_acv_formula.tcv) AS tcv,\r\n      SUM(intermediate_acv_formula.acv) AS acv,\r\n      SUM(intermediate_acv_formula.total_price) AS total_price,\r\n      SUM(intermediate_acv_formula.annual_price) AS annual_price,\r\n      SUM(intermediate_acv_formula.acv_formula) AS acv_formula\r\n    FROM intermediate_acv_formula\r\n    {{dbt_utils.group_by(n=103) }}\r\n\r\n), intermediate_acv_deal_size AS (\r\n    \r\n    SELECT\r\n      intermediate_acv_sum.*,\r\n      CASE\r\n        WHEN account_global_region IN (\'EUROPE\',\'ROW\',\'AUNZ\') THEN \'EMEA\'\r\n        WHEN company_size_rev IN (\'SMB\') OR company_size_rev IS null THEN \'Velocity\'\r\n        WHEN company_size_rev IN (\'Mid-Market\',\'Enterprise\') THEN \'Upmarket\'\r\n        ELSE null\r\n      END AS segment, \r\n      CASE\r\n        WHEN acv_deal_size_override > 0 AND is_closed = false AND submitted_for_approval = false THEN acv_deal_size_override\r\n        WHEN type = \'Renewal\' THEN SUM(acv_add_back + trigger_renewal_value)\r\n        WHEN include_in_acv_deal_size=false THEN 0\r\n        WHEN include_in_acv_deal_size=true AND acv_formula=0 AND one_time_ps_value=0 AND one_time_license_value=0 AND pso_recurring_fees=0 THEN amount\r\n        ELSE acv_formula\r\n      END AS acv_deal_size_usd\r\n    FROM intermediate_acv_sum\r\n    {{dbt_utils.group_by(n=111) }}\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        intermediate_acv_deal_size.*,\r\n        CASE \r\n            WHEN acv_deal_size_usd <= \'9999\' THEN \'< 10K\'\r\n            WHEN acv_deal_size_usd > \'9999\' AND acv_deal_size_usd <= \'14999\' THEN \'10-15K\'\r\n            WHEN acv_deal_size_usd > \'14999\' AND acv_deal_size_usd <= \'19999\' THEN \'15-20K\'\r\n            WHEN acv_deal_size_usd > \'19999\' AND acv_deal_size_usd <= \'24999\' THEN \'20-25K\'\r\n            WHEN acv_deal_size_usd > \'24999\' AND acv_deal_size_usd <= \'29999\' THEN \'25-30K\'\r\n            ELSE \'30K+\'\r\n        END AS deal_size_range,\r\n        CASE \r\n            WHEN LOWER(opp_channel_lead_creation) = \'organic\' THEN \'Organic\'\r\n            WHEN LOWER(opp_channel_lead_creation) IS null THEN \'Unknown\'\r\n            WHEN LOWER(opp_channel_lead_creation) = \'social\' AND LOWER(opp_medium_lead_creation) = \'social-organic\' THEN \'Social - Organic\'\r\n            WHEN LOWER(opp_channel_lead_creation) = \'social\' AND LOWER(opp_medium_lead_creation) = \'social-paid\' THEN \'Paid Social\'\r\n            WHEN LOWER(opp_channel_lead_creation) = \'ppc\' THEN \'PPC/Paid Search\'\r\n            WHEN LOWER(opp_channel_lead_creation) = \'email\' AND LOWER(opp_source_lead_creation) like \'%act-on%\' THEN \'Paid Email\' \r\n            WHEN LOWER(opp_channel_lead_creation) = \'ppl\' AND LOWER(opp_medium_lead_creation) = \'syndication partner\' THEN \'PPL\'\r\n            WHEN LOWER(opp_channel_lead_creation) IN (\'prospecting\',\'ppl\') AND LOWER(opp_medium_lead_creation) = \'intent partner\' THEN \'Intent Partners\'\r\n            WHEN LOWER(opp_channel_lead_creation) = \'event\' THEN \'Events and Trade Shows\'\r\n            WHEN LOWER(opp_channel_lead_creation) = \'partner\' THEN \'Partners\'\r\n            ELSE \'Other\'\r\n        END AS channel_bucket\r\n    FROM intermediate_acv_deal_size\r\n)\r\n\r\nSELECT DISTINCT\r\n*\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff', 'macro.dbt_utils.group_by'], 'nodes': ['source.acton_marketing_data.salesforce.opportunity', 'model.acton_marketing_data.contract_source_xf', 'model.acton_marketing_data.opportunity_line_item_xf', 'model.acton_marketing_data.quote_line', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.user_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'opp_source_xf'], 'unique_id': 'model.acton_marketing_data.opp_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/opp_source_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/opp_source_xf.sql', 'name': 'opp_source_xf', 'alias': 'opp_source_xf', 'checksum': {'name': 'sha256', 'checksum': '1e1d45c58d4cb293440ddd53078aab0d07ec7b7bd6970150e1d427f3cf50075d'}, 'tags': [], 'refs': [['contract_source_xf'], ['opportunity_line_item_xf'], ['quote_line'], ['user_source_xf'], ['user_source_xf']], 'sources': [['salesforce', 'opportunity']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3524368, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.lead_source_ss_xf': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM "acton".salesforce."lead"\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        id AS lead_id,\r\n        is_deleted,\r\n        first_name,\r\n        last_name, \r\n        title,\r\n        company,\r\n        state,\r\n        country,\r\n        email,\r\n        lead_source,\r\n        status AS lead_status,\r\n        industry,\r\n        annual_revenue,\r\n        number_of_employees,\r\n        owner_id AS lead_owner,\r\n        is_converted,\r\n        DATE_TRUNC(\'day\',converted_date)::Date AS converted_date,\r\n        converted_account_id,\r\n        converted_contact_id,\r\n        converted_opportunity_id,\r\n        last_modified_date,\r\n        DATE_TRUNC(\'day\',created_date)::Date AS created_date,\r\n        system_modstamp AS systemmodstamp,\r\n        DATE_TRUNC(\'day\',mql_created_date_c)::Date AS mql_created_date,\r\n        DATE_TRUNC(\'day\',mql_most_recent_date_c)::Date AS mql_most_recent_date,\r\n        DATE_TRUNC(\'day\',date_time_to_working_c)::Date AS working_date,\r\n        account_c AS account_id,\r\n        no_longer_with_company_c AS no_longer_with_company,\r\n        ft_utm_channel_c AS channel_first_touch,\r\n        lt_utm_channel_c AS channel_last_touch,\r\n        lt_utm_medium_c AS medium_last_touch,\r\n        lt_utm_content_c AS content_last_touch,\r\n        lt_utm_source_c AS source_last_touch,\r\n        lt_utm_campaign_c AS campaign_last_touch,\r\n        channel_lead_creation_c AS channel_lead_creation,\r\n        medium_lead_creation_c AS medium_lead_creation,\r\n        hand_raiser_c AS is_hand_raiser,\r\n        ft_subchannel_c AS subchannel_first_touch,\r\n        lt_subchannel_c AS subchannel_last_touch,\r\n        lc_subchannel_c AS subchannel_lead_creation,\r\n        ft_offer_asset_type_c AS offer_asset_type_first_touch,\r\n        ft_offer_asset_subtype_c AS offer_asset_subtype_first_touch,\r\n        ft_offer_asset_topic_c AS offer_asset_topic_first_touch,\r\n        ft_offer_asset_name_c AS offer_asset_name_first_touch,\r\n        lc_offer_asset_type_c AS offer_asset_type_lead_creation,\r\n        lc_offer_asset_subtype_c AS offer_asset_subtype_lead_creation,\r\n        lc_offer_asset_topic_c AS offer_asset_topic_lead_creation,\r\n        lc_offer_asset_name_c AS offer_asset_name_lead_creation,\r\n        lt_offer_asset_type_c AS offer_asset_type_last_touch,\r\n        lt_offer_asset_subtype_c AS offer_asset_subtype_last_touch,\r\n        lt_offer_asset_topic_c AS offer_asset_topic_last_touch,\r\n        lt_offer_asset_name_c AS offer_asset_name_last_touch,\r\n        lean_data_a_2_b_account_c AS lean_data_account_id,\r\n        de_current_marketing_automation_c AS current_ma,\r\n        de_current_crm_c AS current_crm,\r\n        DATE_TRUNC(\'day\',marketing_lead_creation_date_c)::Date AS marketing_created_date,\r\n        mql_created_time_c AS mql_created_datetime,\r\n        mql_most_recent_time_c AS mql_most_recent_datetime,\r\n        article_14_notice_date_c AS article_14_notice_date,\r\n        x_9883_lead_score_c AS lead_score,\r\n        ft_utm_medium_c AS medium_first_touch,\r\n        ft_utm_source_c AS source_first_touch,\r\n        ft_utm_campaign_c AS campaign_first_touch,\r\n        channel_lead_creation_c AS lead_channel_forecast,\r\n        email_bounced_reason,\r\n        legitimate_basis_c AS legitimate_basis,\r\n        email_bounced_date,\r\n        source_lead_creation_c AS source_lead_creation,\r\n        campaign_lead_creation_c AS campaign_lead_creation,\r\n        firmographic_demographic_lead_score_c AS firmographic_demographic_lead_score,\r\n        do_not_contact_c AS do_not_contact,\r\n        form_consent_opt_in_c AS form_consent_opt_in,\r\n        CASE \r\n            WHEN annual_revenue <= 49999999 THEN \'SMB\'\r\n            WHEN annual_revenue > 49999999 AND annual_revenue <= 499999999 THEN \'Mid-Market\'\r\n            WHEN annual_revenue > 499999999 THEN \'Enterprise\'\r\n        END AS company_size_rev,\r\n        CASE \r\n            WHEN LOWER(channel_lead_creation_c) = \'organic\' THEN \'Organic\'\r\n            WHEN LOWER(channel_lead_creation_c) IS null THEN \'Unknown\'\r\n            WHEN LOWER(channel_lead_creation_c) = \'social\' AND LOWER(medium_lead_creation_c) = \'social-organic\' THEN \'Social - Organic\'\r\n            WHEN LOWER(channel_lead_creation_c) = \'social\' AND LOWER(medium_lead_creation_c) = \'social-paid\' THEN \'Paid Social\'\r\n            WHEN LOWER(channel_lead_creation_c) = \'ppc\' THEN \'PPC/Paid Search\'\r\n            WHEN LOWER(channel_lead_creation_c) = \'email\' AND LOWER(source_lead_creation_c) like \'%act-on%\' THEN \'Paid Email\' \r\n            WHEN LOWER(channel_lead_creation_c) = \'ppl\' AND LOWER(medium_lead_creation_c) = \'syndication partner\' THEN \'PPL\'\r\n            WHEN LOWER(channel_lead_creation_c) IN (\'prospecting\',\'ppl\') AND LOWER(medium_lead_creation_c) = \'intent partner\' THEN \'Intent Partners\'\r\n            WHEN LOWER(channel_lead_creation_c) = \'event\' THEN \'Events and Trade Shows\'\r\n            WHEN LOWER(channel_lead_creation_c) = \'partner\' THEN \'Partners\'\r\n            ELSE \'Other\'\r\n        END AS channel_bucket,\r\n        CASE\r\n            WHEN country IS NOT null AND country IN (\'GB\',\'UK\',\'IE\',\'DE\',\'DK\',\'FI\',\'IS\',\'NO\',\'SE\',\'FR\',\'AL\',\'AD\',\'AM\',\'AT\',\'BY\',\'BE\',\'BA\',\'BG\',\'HR\',\'CS\',\'CY\',\'CZ\',\'EE\',\'FX\',\'GE\',\'GR\',\'HU\',\'IT\',\'LV\',\'LI\',\'LT\',\'LU\',\'MK\',\'MT\',\'MD\',\'MC\',\'ME\',\'NL\',\'PL\',\'PT\',\'RO\',\'SM\',\'RS\',\'SJ\',\'SK\',\'SI\',\'ES\',\'CH\',\'UA\',\'VA\',\'FO\',\'GI\',\'GG\',\'IM\',\'JE\',\'XK\',\'RU\',\'United Kingdom\',\'England\') THEN \'EUROPE\'\r\n            WHEN country IS NOT null AND country IN (\'JP\',\'KR\',\'CN\',\'MN\',\'TW\',\'VN\',\'HK\',\'LA\',\'TH\',\'KH\',\'PH\',\'MY\',\'SG\',\'ID\',\'LK\',\'IN\',\'NP\',\'BT\',\'MM\',\'PK\',\'AF\',\'KG\',\'UZ\',\'TM\',\'KZ\') THEN \'APJ\'\r\n            WHEN country IS NOT null AND country IN (\'AU\',\'CX\',\'NZ\',\'NF\',\'Australia\',\'New Zealand\') THEN \'AUNZ\'\r\n            WHEN country IS NOT null AND country IN (\'AR\',\'BO\',\'BR\',\'BZ\',\'CL\',\'CO\',\'CU\',\'CR\',\'DO\',\'EC\',\'FK\',\'GF\',\'GS\',\'GY\',\'GT\',\'HN\',\'MX\',\'NI\',\'PA\',\'PE\',\'PR\',\'PY\',\'SR\',\'SV\',\'UY\',\'VE\')THEN \'LATAM\'\r\n            WHEN state IS NOT null AND state IN (\'CA\',\'NV\',\'UT\',\'AK\',\'MO\',\'CO\',\'HI\',\'OK\',\'IL\',\'AR\',\'NE\',\'MI\',\'KS\',\'OR\',\'WA\',\'ID\',\'WI\',\'MN\',\'ND\',\'SD\',\'MT\',\'WY\',\'IA\',\'NB\',\'ON\',\'PE\',\'QC\',\'AB\',\'BC\',\'MB\',\'SK\',\'NL\',\'NS\',\'YT\',\'NU\',\'NT\') THEN \'NA-WEST\'\r\n            WHEN state IS NOT null AND state IN (\'NY\',\'CT\',\'MA\',\'VT\',\'NH\',\'ME\',\'NJ\',\'RI\',\'TX\',\'AZ\',\'NM\',\'MS\',\'LA\',\'AL\',\'TN\',\'KY\',\'OH\',\'IN\',\'GA\',\'FL\',\'NC\',\'SC\',\'PA\',\'DC\',\'DE\',\'MD\',\'VA\',\'WV\') THEN \'NA-EAST\'\r\n            WHEN country IS NOT null AND country IN (\'AG\',\'AI\',\'AN\',\'AW\',\'BB\',\'BM\',\'BS\',\'DM\',\'GD\',\'GP\',\'HT\',\'JM\',\'KN\',\'LC\',\'MQ\',\'MS\',\'TC\',\'TT\',\'VC\',\'VG\',\'VI\') THEN \'NA-EAST\'\r\n            WHEN country IS NOT null AND country IN (\'US\',\'CA\') AND state IS null  THEN \'NA-NO-STATEPROV\'\r\n            WHEN country IS NOT null AND state IS NOT null THEN \'ROW\'\r\n            ELSE \'Unknown\'\r\n        END AS global_region,\r\n        COALESCE(account_c,lean_data_a_2_b_account_c) AS person_account_id\r\n    FROM base\r\n    WHERE base.owner_id != \'00Ga0000003Nugr\' -- AO-Fake Leads\r\n\r\n)\r\n\r\nSELECT \r\nfinal.*,\r\nCASE\r\n    WHEN global_region IN (\'EUROPE\',\'ROW\',\'AUNZ\') THEN \'EMEA\'\r\n    WHEN company_size_rev IN (\'SMB\') OR company_size_rev IS null THEN \'Velocity\'\r\n    WHEN company_size_rev IN (\'Mid-Market\',\'Enterprise\') THEN \'Upmarket\'\r\n    ELSE null\r\nEND AS segment\r\nFROM final\r\nWHERE lead_status IN (\'Suspect\',\'Responded\',\'RTM\')', 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': []}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'lead_source_ss_xf'], 'unique_id': 'model.acton_marketing_data.lead_source_ss_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/lead_source_ss_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/lead_source_ss_xf.sql', 'name': 'lead_source_ss_xf', 'alias': 'lead_source_ss_xf', 'checksum': {'name': 'sha256', 'checksum': '8e0aca73165037ef743eaafa698aa42953476ccd8f519056c15840e456f0dfa6'}, 'tags': [], 'refs': [], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3651605, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.task_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'task') }}\r\n\r\n), renamed AS (\r\n\r\n    SELECT\r\n        id AS task_id,\r\n        what_id,\r\n        subject AS task_subject,\r\n        activity_date,\r\n        status AS task_status,\r\n        owner_id,\r\n        is_deleted,\r\n        account_id,\r\n        is_closed,\r\n        created_date AS task_created_date,\r\n        last_modified_date,\r\n        system_modstamp,\r\n        is_archived,\r\n        record_type_id,\r\n        who_id AS person_id,\r\n        type AS task_type,\r\n        closed_date_c AS close_date\r\n    FROM base\r\n    WHERE who_id IS NOT null\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n    --IDs\r\n        task_id,\r\n        renamed.person_id,\r\n        owner_id,\r\n        renamed.account_id,\r\n        email,\r\n\r\n    --Task Data\r\n        task_subject,\r\n        task_status,\r\n        task_type,\r\n        is_closed,\r\n        activity_date,\r\n        task_created_date,\r\n        close_date\r\n    FROM renamed\r\n    LEFT JOIN {{ref('person_source_xf')}} ON\r\n    renamed.person_id=person_source_xf.person_id\r\n)\r\n\r\nSELECT*\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.task', 'model.acton_marketing_data.person_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'task_source_xf'], 'unique_id': 'model.acton_marketing_data.task_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/task_source_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/task_source_xf.sql', 'name': 'task_source_xf', 'alias': 'task_source_xf', 'checksum': {'name': 'sha256', 'checksum': '56ea1acdf2e9255853fca578209d561001f7ed014a43811ec0cc6da2f0c83de9'}, 'tags': [], 'refs': [['person_source_xf']], 'sources': [['salesforce', 'task']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3670955, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.lead_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'lead') }}\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        id AS lead_id,\r\n        is_deleted,\r\n        base.created_by_id,\r\n        creator.user_name AS created_by_name,\r\n        first_name,\r\n        last_name, \r\n        title,\r\n        company,\r\n        state,\r\n        country,\r\n        email,\r\n        lead_source,\r\n        status AS lead_status,\r\n        de_industry_c AS industry,\r\n        CASE\r\n            WHEN de_industry_c IN ('Business Services') THEN 'Business Services'\r\n            WHEN de_industry_c IN ('Finance','Insurance') THEN 'Finance'\r\n            WHEN de_industry_c IN ('Manufacturing') THEN 'Manufacturing'\r\n            WHEN de_industry_c IN ('Software','Telecommunications') THEN 'SoftCom'\r\n            ELSE 'Other'\r\n        END AS industry_bucket,\r\n        annual_revenue,\r\n        number_of_employees,\r\n        owner_id AS lead_owner_id,\r\n        is_converted,\r\n        DATE_TRUNC('day',converted_date)::Date AS converted_date,\r\n        converted_account_id,\r\n        converted_contact_id,\r\n        converted_opportunity_id,\r\n        last_modified_date,\r\n        DATE_TRUNC('day',created_date)::Date AS created_date,\r\n        system_modstamp AS systemmodstamp,\r\n        DATE_TRUNC('day',mql_created_date_c)::Date AS mql_created_date,\r\n        DATE_TRUNC('day',mql_most_recent_date_c)::Date AS mql_most_recent_date,\r\n        DATE_TRUNC('day',date_time_to_working_c)::Date AS working_date,\r\n        account_c AS account_id,\r\n        no_longer_with_company_c AS no_longer_with_company,\r\n        ft_utm_channel_c AS channel_first_touch,\r\n        lt_utm_channel_c AS channel_last_touch,\r\n        lt_utm_medium_c AS medium_last_touch,\r\n        lt_utm_content_c AS content_last_touch,\r\n        lt_utm_source_c AS source_last_touch,\r\n        lt_utm_campaign_c AS campaign_last_touch,\r\n        channel_lead_creation_c AS channel_lead_creation,\r\n        medium_lead_creation_c AS medium_lead_creation,\r\n        hand_raiser_c AS is_hand_raiser,\r\n        ft_subchannel_c AS subchannel_first_touch,\r\n        lt_subchannel_c AS subchannel_last_touch,\r\n        lc_subchannel_c AS subchannel_lead_creation,\r\n        ft_offer_asset_type_c AS offer_asset_type_first_touch,\r\n        ft_offer_asset_subtype_c AS offer_asset_subtype_first_touch,\r\n        ft_offer_asset_topic_c AS offer_asset_topic_first_touch,\r\n        ft_offer_asset_name_c AS offer_asset_name_first_touch,\r\n        lc_offer_asset_type_c AS offer_asset_type_lead_creation,\r\n        lc_offer_asset_subtype_c AS offer_asset_subtype_lead_creation,\r\n        lc_offer_asset_topic_c AS offer_asset_topic_lead_creation,\r\n        lc_offer_asset_name_c AS offer_asset_name_lead_creation,\r\n        lt_offer_asset_type_c AS offer_asset_type_last_touch,\r\n        lt_offer_asset_subtype_c AS offer_asset_subtype_last_touch,\r\n        lt_offer_asset_topic_c AS offer_asset_topic_last_touch,\r\n        lt_offer_asset_name_c AS offer_asset_name_last_touch,\r\n        lean_data_a_2_b_account_c AS lean_data_account_id,\r\n        de_current_marketing_automation_c AS current_ma,\r\n        de_current_crm_c AS current_crm,\r\n        DATE_TRUNC('day',marketing_lead_creation_date_c)::Date AS marketing_created_date,\r\n        mql_created_time_c AS mql_created_datetime,\r\n        mql_most_recent_time_c AS mql_most_recent_datetime,\r\n        article_14_notice_date_c AS article_14_notice_date,\r\n        x_9883_lead_score_c AS lead_score,\r\n        ft_utm_medium_c AS medium_first_touch,\r\n        ft_utm_source_c AS source_first_touch,\r\n        ft_utm_campaign_c AS campaign_first_touch,\r\n        channel_lead_creation_c AS lead_channel_forecast,\r\n        email_bounced_reason,\r\n        legitimate_basis_c AS legitimate_basis,\r\n        email_bounced_date,\r\n        source_lead_creation_c AS source_lead_creation,\r\n        campaign_lead_creation_c AS campaign_lead_creation,\r\n        firmographic_demographic_lead_score_c AS firmographic_demographic_lead_score,\r\n        do_not_contact_c AS do_not_contact,\r\n        form_consent_opt_in_c AS form_consent_opt_in,\r\n        CASE \r\n            WHEN annual_revenue <= 49999999 THEN 'SMB'\r\n            WHEN annual_revenue > 49999999 AND annual_revenue <= 499999999 THEN 'Mid-Market'\r\n            WHEN annual_revenue > 499999999 THEN 'Enterprise'\r\n        END AS company_size_rev,\r\n        CASE \r\n            WHEN LOWER(channel_lead_creation_c) = 'organic' THEN 'Organic'\r\n            WHEN LOWER(channel_lead_creation_c) IS null THEN 'Unknown'\r\n            WHEN LOWER(channel_lead_creation_c) = 'social' AND LOWER(medium_lead_creation_c) = 'social-organic' THEN 'Social - Organic'\r\n            WHEN LOWER(channel_lead_creation_c) = 'social' AND LOWER(medium_lead_creation_c) = 'social-paid' THEN 'Paid Social'\r\n            WHEN LOWER(channel_lead_creation_c) = 'ppc' THEN 'PPC/Paid Search'\r\n            WHEN LOWER(channel_lead_creation_c) = 'email' AND LOWER(source_lead_creation_c) like '%act-on%' THEN 'Paid Email' \r\n            WHEN LOWER(channel_lead_creation_c) = 'ppl' AND LOWER(medium_lead_creation_c) = 'syndication partner' THEN 'PPL'\r\n            WHEN LOWER(channel_lead_creation_c) IN ('prospecting','ppl') AND LOWER(medium_lead_creation_c) = 'intent partner' THEN 'Intent Partners'\r\n            WHEN LOWER(channel_lead_creation_c) = 'event' THEN 'Events and Trade Shows'\r\n            WHEN LOWER(channel_lead_creation_c) = 'partner' THEN 'Partners'\r\n            ELSE 'Other'\r\n        END AS channel_bucket,\r\n        CASE\r\n            WHEN country IS NOT null AND country IN ('GB','UK','IE','DE','DK','FI','IS','NO','SE','FR','AL','AD','AM','AT','BY','BE','BA','BG','HR','CS','CY','CZ','EE','FX','GE','GR','HU','IT','LV','LI','LT','LU','MK','MT','MD','MC','ME','NL','PL','PT','RO','SM','RS','SJ','SK','SI','ES','CH','UA','VA','FO','GI','GG','IM','JE','XK','RU','United Kingdom','England') THEN 'EUROPE'\r\n            WHEN country IS NOT null AND country IN ('JP','KR','CN','MN','TW','VN','HK','LA','TH','KH','PH','MY','SG','ID','LK','IN','NP','BT','MM','PK','AF','KG','UZ','TM','KZ') THEN 'APJ'\r\n            WHEN country IS NOT null AND country IN ('AU','CX','NZ','NF','Australia','New Zealand') THEN 'AUNZ'\r\n            WHEN country IS NOT null AND country IN ('AR','BO','BR','BZ','CL','CO','CU','CR','DO','EC','FK','GF','GS','GY','GT','HN','MX','NI','PA','PE','PR','PY','SR','SV','UY','VE')THEN 'LATAM'\r\n            WHEN state IS NOT null AND state IN ('CA','NV','UT','AK','MO','CO','HI','OK','IL','AR','NE','MI','KS','OR','WA','ID','WI','MN','ND','SD','MT','WY','IA','NB','ON','PE','QC','AB','BC','MB','SK','NL','NS','YT','NU','NT') THEN 'NA-WEST'\r\n            WHEN state IS NOT null AND state IN ('NY','CT','MA','VT','NH','ME','NJ','RI','TX','AZ','NM','MS','LA','AL','TN','KY','OH','IN','GA','FL','NC','SC','PA','DC','DE','MD','VA','WV') THEN 'NA-EAST'\r\n            WHEN country IS NOT null AND country IN ('AG','AI','AN','AW','BB','BM','BS','DM','GD','GP','HT','JM','KN','LC','MQ','MS','TC','TT','VC','VG','VI') THEN 'NA-EAST'\r\n            WHEN country IS NOT null AND country IN ('US','CA') AND state IS null  THEN 'NA-NO-STATEPROV'\r\n            WHEN country IS NOT null AND state IS NOT null THEN 'ROW'\r\n            ELSE 'Unknown'\r\n        END AS global_region,\r\n        COALESCE(account_c,lean_data_a_2_b_account_c) AS person_account_id\r\n    FROM base\r\n    LEFT JOIN {{ref('user_source_xf')}} creator ON\r\n    base.created_by_id=creator.user_id\r\n    WHERE base.owner_id != '00Ga0000003Nugr' -- AO-Fake Leads\r\n\r\n)\r\n\r\nSELECT \r\nfinal.*,\r\nCASE\r\n    WHEN global_region IN ('EUROPE','ROW','AUNZ') THEN 'EMEA'\r\n    WHEN company_size_rev IN ('SMB') OR company_size_rev IS null THEN 'Velocity'\r\n    WHEN company_size_rev IN ('Mid-Market','Enterprise') THEN 'Upmarket'\r\n    ELSE null\r\nEND AS segment\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.lead', 'model.acton_marketing_data.user_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'lead_source_xf'], 'unique_id': 'model.acton_marketing_data.lead_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/lead_source_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/lead_source_xf.sql', 'name': 'lead_source_xf', 'alias': 'lead_source_xf', 'checksum': {'name': 'sha256', 'checksum': 'c06441326756d0487ebd73e861a20186bdcf7377a635a9994248e0a110a1d4a2'}, 'tags': [], 'refs': [['user_source_xf']], 'sources': [['salesforce', 'lead']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.369334, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.contract_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\nSELECT *\r\nFROM {{ source('salesforce', 'contract') }}\r\n\r\n), final AS (\r\nSELECT\r\nid AS contract_id,\r\naccount_id,\r\nowner_id,\r\nstatus,\r\nis_deleted,\r\nDATE_TRUNC('day',created_date)::Date AS created_date,\r\nDATE_TRUNC('day',created_date)::Date AS end_date,\r\ncreated_by_id,\r\nDATE_TRUNC('day',last_modified_date)::Date AS last_modified_date,\r\nsystem_modstamp AS systemmodstamp,\r\ncontract_status_c AS contract_status,\r\nrelated_opportunity_c AS contract_opportunity_id,\r\nDATE_TRUNC('day',churn_date_c)::Date AS churn_date,\r\ncs_churn_c AS cs_churn,\r\narr_c AS arr,\r\ncontract_acv_c AS contract_acv,\r\nsubscription_term_c AS subscription_term,\r\ncs_churn_recognized_mrr_c AS cs_churn_recognized_mrr,\r\nsales_churn_c AS sales_churn,\r\ncurrent_quarter_debook_value_c AS current_quarter_debook_value,\r\nCASE\r\n    WHEN contract_status_c = 'Cancelled' AND cs_churn_c != false THEN cs_churn_recognized_mrr_c*-12\r\n    WHEN contract_status_c = 'Cancelled' AND sales_churn_c != false THEN current_quarter_debook_value_c\r\n    ELSE 0\r\nEND AS arr_loss_amount\r\nFROM base\r\n\r\n)\r\n\r\nSELECT\r\n*\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.contract']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'contract_source_xf'], 'unique_id': 'model.acton_marketing_data.contract_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/contract_source_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/contract_source_xf.sql', 'name': 'contract_source_xf', 'alias': 'contract_source_xf', 'checksum': {'name': 'sha256', 'checksum': 'cc568a75faf4d10c06b609bcd1e8c6903699379ab3107fc3e9517ea0846a8626'}, 'tags': [], 'refs': [], 'sources': [['salesforce', 'contract']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3717809, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opportunity_history_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'opportunity_field_history') }}\r\n\r\n)\r\n\r\nSELECT\r\nid AS opportunity_history_id, \r\nopportunity_id,\r\ncreated_date AS field_modified_at,\r\nfield,\r\nold_value,\r\nnew_value\r\nFROM base\r\nWHERE is_deleted = false", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.opportunity_field_history']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'opportunity_history_xf'], 'unique_id': 'model.acton_marketing_data.opportunity_history_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/opportunity_history_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/opportunity_history_xf.sql', 'name': 'opportunity_history_xf', 'alias': 'opportunity_history_xf', 'checksum': {'name': 'sha256', 'checksum': '3249ecca9fa543779e5683c79d3357c7a3ab3d2852d313202ed6fd1c404bfdfa'}, 'tags': [], 'refs': [], 'sources': [['salesforce', 'opportunity_field_history']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3738945, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_instance_user_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'act_on_instance_user_c') }}\r\n\r\n), final AS (\r\n    SELECT\r\n        base.id AS ao_user_id,\r\n        base.is_deleted,\r\n        base.name AS ao_user_name,\r\n        base.created_date AS ao_user_created_date,\r\n        base.last_modified_date,\r\n        base.system_modstamp AS systemmodstamp,\r\n        base.act_on_instance_c AS ao_user_instance,\r\n        base.email_c AS ao_user_email, \r\n        base.first_name_c AS ao_user_first_name, \r\n        base.last_name_c AS ao_user_last_name, \r\n        base.is_admin_user_c AS is_admin_user,\r\n        base.is_marketing_user_c AS is_marketing_user,\r\n        base.is_sales_user_c AS is_sales_user,\r\n        base.date_user_created_c AS ao_user_date_created,\r\n        base.ao_user_account_id_c AS ao_user_account_id, \r\n        base.contact_c AS ao_user_contact_id,\r\n        base.deleted_c AS deleted,\r\n        base.deleted_date_c AS deleted_date,\r\n        ao_instance_source_xf.ao_instance_name AS ao_user_account_name\r\n    FROM base\r\n    LEFT JOIN {{ref('ao_instance_source_xf')}} ON\r\n    base.act_on_instance_c=ao_instance_source_xf.ao_instance_id\r\n    \r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.act_on_instance_user_c', 'model.acton_marketing_data.ao_instance_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'ao_instance_user_source_xf'], 'unique_id': 'model.acton_marketing_data.ao_instance_user_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/ao_instance_user_source_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/ao_instance_user_source_xf.sql', 'name': 'ao_instance_user_source_xf', 'alias': 'ao_instance_user_source_xf', 'checksum': {'name': 'sha256', 'checksum': '7bdffb2b18153cc157e05cc438e044b02c2e69ec3ccf8f4e1471860abb4096aa'}, 'tags': [], 'refs': [['ao_instance_source_xf']], 'sources': [['salesforce', 'act_on_instance_user_c']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.375877, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opportunity_line_item_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\nSELECT *\r\nFROM {{ source('salesforce', 'opportunity_line_item') }}\r\n\r\n), final AS (\r\n    SELECT \r\n        id AS line_item_id,\r\n        opportunity_id,\r\n        product_2_id AS product_id,\r\n        name AS line_item_name,\r\n        currency_iso_code,\r\n        discount,\r\n        total_price,\r\n        list_price,\r\n        DATE_TRUNC('day',created_date)::Date AS line_item_created_date,\r\n        DATE_TRUNC('day',last_modified_date)::Date AS last_modified_date,\r\n        system_modstamp AS systemmodstamp,\r\n        is_deleted,\r\n        sbqq_subscription_type_c AS sbqq_subscription_type,\r\n        line_item_mrr_c AS line_item_mrr,\r\n        product_code_c AS product_code,\r\n        annual_price_c AS annual_price,\r\n        discounted_annual_price_c AS discounted_annual_price,\r\n        monthly_gross_c AS monthly_gross,\r\n        monthly_net_c AS monthly_net,\r\n        subscription_type_c AS subscription_type,\r\n        total_discount_c AS total_discount,\r\n        prorate_multiplier_mirror_c AS prorate_multiplier_mirror,\r\n        sbqq_parent_id_c AS sbqq_parent_id,\r\n        opp_product_family_text_c AS product_family\r\n    FROM base\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.opportunity_line_item']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'opportunity_line_item_xf'], 'unique_id': 'model.acton_marketing_data.opportunity_line_item_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/opportunity_line_item_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/opportunity_line_item_xf.sql', 'name': 'opportunity_line_item_xf', 'alias': 'opportunity_line_item_xf', 'checksum': {'name': 'sha256', 'checksum': 'a158abf96a1a58e05246ee69f7dfbb96636e68fc45673f98460809b6310dd56d'}, 'tags': [], 'refs': [], 'sources': [['salesforce', 'opportunity_line_item']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3780239, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.quote_line': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM "acton".salesforce."sbqq_quote_line_c"\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        base.id AS quote_id,\r\n        base.is_deleted,\r\n        base.name AS quote_name,\r\n        base.currency_iso_code,\r\n        DATE_TRUNC(\'day\',base.created_date)::Date AS quote_created_date,\r\n        DATE_TRUNC(\'day\',base.last_modified_date)::Date AS quote_last_modified_date,\r\n        base.system_modstamp AS systemmodstamp,\r\n        base.sbqq_quote_c AS sbqq_quote,\r\n        base.sbqq_product_option_c AS sbqq_product_option,\r\n        base.sbqq_product_c AS sbqq_product,\r\n        base.sbqq_prorate_multiplier_c AS sbqq_prorate_multiplier,\r\n        base.sbqq_prorated_list_price_c AS sbqq_prorated_list_price,\r\n        base.sbqq_prorated_price_c AS sbqq_prorated_price,\r\n        base.customer_discount_c AS customer_discount,\r\n        base.sbqq_product_subscription_type_c AS sbqq_product_subscription_type,\r\n        base.sbqq_subscription_term_c AS sbqq_product_subscription_term,\r\n        sbqq_quote_c.sbqq_opportunity_2_c AS opportunity_id,\r\n        product_xf.sbqq_subscription_type,\r\n        product_xf.product_code,\r\n        sbqq_quote_c.sbqq_primary_c AS sbqq_primary_quote\r\n    FROM base\r\n    LEFT JOIN "acton".salesforce."sbqq_quote_c" ON\r\n    base.id=sbqq_quote_c.id\r\n    LEFT JOIN {{ref(\'product_xf\')}} ON\r\n    base.sbqq_product_c=product_xf.product_id\r\n\r\n)   \r\n\r\nSELECT *\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.product_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'quote_line'], 'unique_id': 'model.acton_marketing_data.quote_line', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/quote_line.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/quote_line.sql', 'name': 'quote_line', 'alias': 'quote_line', 'checksum': {'name': 'sha256', 'checksum': '1bee9c9dcd2e180cf28813e4575f0ded11ddcaba9c416f16c9a45f5ae7bb7682'}, 'tags': [], 'refs': [['product_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3800938, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.campaign_influence_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'campaign_influence') }}\r\n\r\n), final AS (\r\n\r\n    SELECT  \r\n        id AS influence_id,\r\n        created_date AS influence_created_date,\r\n        opportunity_id AS influence_opportunity_id,\r\n        campaign_id AS influence_campaign_id,\r\n        contact_id AS influence_contact_id,\r\n        influence AS influence_amount,\r\n        revenue_share\r\n    FROM base\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.campaign_influence']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'campaign_influence_xf'], 'unique_id': 'model.acton_marketing_data.campaign_influence_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/campaign_influence_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/campaign_influence_xf.sql', 'name': 'campaign_influence_xf', 'alias': 'campaign_influence_xf', 'checksum': {'name': 'sha256', 'checksum': '3f0fecb0ebea3ca82c360c3d233a40a0f6b45c6bd9ffd69df0ca328562f421c5'}, 'tags': [], 'refs': [], 'sources': [['salesforce', 'campaign_influence']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.382369, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.campaign_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'campaign') }}\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n    --Campaign Info\r\n        base.id AS campaign_id,\r\n        base.name AS campaign_name, \r\n        base.type AS campaign_type,\r\n        base.status AS campaign_status,\r\n        DATE_TRUNC('day',base.start_date)::Date AS campaign_start_date,\r\n        DATE_TRUNC('day',base.end_date)::Date AS campaign_end_date,\r\n        base.expected_revenue,\r\n        base.budgeted_cost,\r\n        base.actual_cost,\r\n        base.expected_response,\r\n        base.owner_id AS campaign_owner_id,\r\n        base.is_active AS is_active_campaign,\r\n        base.is_deleted AS is_deleted_campaign,\r\n\r\n    --Parent Campaign Info\r\n        base.parent_id AS parent_campaign_id,\r\n        parent.name AS parent_campaign_name,\r\n        parent.type AS parent_campaign_type,\r\n        parent.status AS parent_campaign_status,\r\n        DATE_TRUNC('day',parent.start_date)::Date AS parent_campaign_start_date,\r\n        DATE_TRUNC('day',parent.end_date)::Date AS parent_campaign_end_date,\r\n        parent.expected_revenue AS parent_expected_revenue,\r\n        parent.budgeted_cost AS parent_budgeted_cost,\r\n        parent.actual_cost AS parent_actual_cost,\r\n        parent.expected_response AS parent_expected_reponse,\r\n        parent.owner_id AS parent_campaign_owner_id,\r\n        parent.is_active AS is_active_parent_campaign\r\n    FROM base\r\n    LEFT JOIN base parent ON \r\n    base.parent_id=parent.id\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.campaign']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'campaign_source_xf'], 'unique_id': 'model.acton_marketing_data.campaign_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/campaign_source_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/campaign_source_xf.sql', 'name': 'campaign_source_xf', 'alias': 'campaign_source_xf', 'checksum': {'name': 'sha256', 'checksum': 'a66f35e75badfaa92ed2f9c50fbce4b2f848a325d60e4d2a15158124c7a513e3'}, 'tags': [], 'refs': [], 'sources': [['salesforce', 'campaign']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3844397, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.contact_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM {{ source('salesforce', 'contact') }}\r\n\r\n), final AS (\r\n\r\n    SELECT \r\n        base.id AS contact_id,\r\n        base.is_deleted,\r\n        base.created_by_id,\r\n        creator.user_name AS created_by_name,\r\n        base.account_id,\r\n        account_source_xf.account_name,\r\n        base.first_name,\r\n        base.mailing_postal_code,\r\n        base.mailing_country,\r\n        base.email,\r\n        base.title,\r\n        base.lead_source,\r\n        DATE_TRUNC('day',base.created_date)::Date AS created_date,\r\n        base.last_modified_date,\r\n        base.system_modstamp AS systemmodstamp,\r\n        base.current_customer_reference_c AS is_current_customer,\r\n        base.no_longer_with_company_c AS is_no_longer_with_company,\r\n        base.hand_raiser_c AS is_hand_raiser,\r\n        base.mql_created_date_c AS mql_created_date,\r\n        base.mql_most_recent_date_c AS mql_most_recent_date,\r\n        base.contact_role_c AS contact_role,\r\n        base.primary_contact_c AS is_primary_contact,\r\n        base.ft_offer_asset_type_c AS offer_asset_type_first_touch,\r\n        base.ft_offer_asset_subtype_c AS offer_asset_subtype_first_touch,\r\n        base.contact_status_c AS contact_status,\r\n        base.ft_utm_channel_c AS channel_first_touch,\r\n        base.lt_utm_channel_c AS channel_last_touch,\r\n        base.lt_utm_medium_c AS medium_last_touch,\r\n        base.lt_utm_source_c AS source_last_touch,\r\n        base.lt_utm_campaign_c AS campaign_last_touch,\r\n        base.channel_lead_creation_c AS channel_lead_creation,\r\n        base.content_lead_creation_c AS content_lead_creation,\r\n        base.campaign_lead_creation_c AS campaign_lead_creation,\r\n        base.ft_offer_asset_topic_c AS offer_asset_topic_first_touch,\r\n        base.ft_offer_asset_name_c AS offer_asset_name_first_touch,\r\n        base.lc_offer_asset_type_c AS offer_asset_type_lead_creation,\r\n        base.lc_offer_asset_subtype_c AS offer_asset_subtype_lead_creation,\r\n        base.lc_offer_asset_topic_c AS offer_asset_topic_lead_creation,\r\n        base.lc_offer_asset_name_c AS offer_asset_name_lead_creation,\r\n        base.lt_offer_asset_type_c AS offer_asset_type_last_touch,\r\n        base.lt_offer_asset_subtype_c AS offer_asset_subtype_last_touch,\r\n        base.lt_offer_asset_name_c AS offer_asset_name_last_touch,\r\n        base.lt_offer_asset_topic_c AS offer_asset_topic_last_touch,\r\n        base.renewal_contact_c AS is_renewal_contact, --verify data type\r\n        base.account_owner_email_c AS account_owner_email,\r\n        base.account_csm_email_c AS account_csm_email,\r\n        base.ft_subchannel_c AS subchannel_first_touch,\r\n        base.lt_subchannel_c AS subchannel_last_touch,\r\n        base.lc_subchannel_c AS subchannel_lead_creation,\r\n        base.x_9883_lead_score_c AS lead_score,\r\n        base.status_reason_c AS status_reason,\r\n        DATE_TRUNC('day',marketing_lead_creation_date_c)::Date AS marketing_created_date,\r\n        base.current_map_c AS current_ma,\r\n        base.account_lookup_c AS account_lookup,\r\n        base.ft_utm_campaign_c AS campaign_first_touch,\r\n        base.ft_utm_medium_c AS medium_first_touch,\r\n        base.ft_utm_source_c AS source_first_touch,\r\n        base.lead_id_converted_from_c AS lead_id_converted_from,\r\n        base.was_a_handraiser_lead_c AS was_a_handraiser_lead,\r\n        base.medium_lead_creation_c AS medium_lead_creation,\r\n        base.source_lead_creation_c AS source_lead_creation,\r\n        base.owner_id AS contact_owner_id,\r\n        base.firmographic_demographic_lead_score_c AS firmographic_demographic_lead_score,\r\n        base.last_name, \r\n        base.data_enrich_company_name_c AS de_account_name,\r\n        DATE_TRUNC('day',date_time_to_working_c)::Date AS working_date,\r\n        account_source_xf.account_owner_id,\r\n        account_source_xf.account_owner_name,\r\n        account_source_xf.annual_revenue,\r\n        account_source_xf.de_current_crm,\r\n        account_source_xf.de_current_ma,\r\n        account_source_xf.account_csm_name AS account_csm_name,\r\n        account_source_xf.csm_id AS account_csm_id,\r\n        account_source_xf.sdr_phone AS account_sdr_phone,\r\n        account_source_xf.sdr_photo AS account_sdr_photo,\r\n        account_source_xf.sdr_calendly AS account_sdr_calendly,\r\n        account_source_xf.sdr_title AS account_sdr_title,\r\n        account_source_xf.sdr_full_name AS account_sdr_full_name,\r\n        account_source_xf.sdr_email AS account_sdr_email,\r\n        account_source_xf.account_deliverability_consultant_email,\r\n        account_source_xf.account_deliverability_consultant,\r\n        user_source_xf.user_email AS owner_email,\r\n        CASE\r\n            WHEN account_source_xf.annual_revenue <= 49999999 THEN 'SMB'\r\n            WHEN account_source_xf.annual_revenue > 49999999 AND account_source_xf.annual_revenue <= 499999999 THEN 'Mid-Market'\r\n            WHEN account_source_xf.annual_revenue > 499999999 THEN 'Enterprise'\r\n        END AS company_size_rev,\r\n        account_source_xf.global_region,\r\n        account_source_xf.segment,\r\n        account_source_xf.de_industry AS industry,\r\n        CASE\r\n            WHEN account_source_xf.de_industry IN ('Business Services') THEN 'Business Services'\r\n            WHEN account_source_xf.de_industry IN ('Finance','Insurance') THEN 'Finance'\r\n            WHEN account_source_xf.de_industry IN ('Manufacturing') THEN 'Manufacturing'\r\n            WHEN account_source_xf.de_industry IN ('Software','Telecommunications') THEN 'SoftCom'\r\n            ELSE 'Other'\r\n        END AS industry_bucket,\r\n        CASE \r\n            WHEN LOWER(channel_lead_creation_c) = 'organic' THEN 'Organic'\r\n            WHEN LOWER(channel_lead_creation_c) IS null THEN 'Unknown'\r\n            WHEN LOWER(channel_lead_creation_c) = 'social' AND LOWER(medium_lead_creation_c) = 'social-organic' THEN 'Social - Organic'\r\n            WHEN LOWER(channel_lead_creation_c) = 'social' AND LOWER(medium_lead_creation_c) = 'social-paid' THEN 'Paid Social'\r\n            WHEN LOWER(channel_lead_creation_c) = 'ppc' THEN 'PPC/Paid Search'\r\n            WHEN LOWER(channel_lead_creation_c) = 'email' AND LOWER(source_lead_creation_c) like '%act-on%' THEN 'Paid Email' \r\n            WHEN LOWER(channel_lead_creation_c) = 'ppl' AND LOWER(medium_lead_creation_c) = 'syndication partner' THEN 'PPL'\r\n            WHEN LOWER(channel_lead_creation_c) IN ('prospecting','ppl') AND LOWER(medium_lead_creation_c) = 'intent partner' THEN 'Intent Partners'\r\n            WHEN LOWER(channel_lead_creation_c) = 'event' THEN 'Events and Trade Shows'\r\n            WHEN LOWER(channel_lead_creation_c) = 'partner' THEN 'Partners'\r\n            ELSE 'Other'\r\n        END AS channel_bucket\r\n    FROM base\r\n    LEFT JOIN {{ref('account_source_xf')}} ON\r\n    base.account_id=account_source_xf.account_id\r\n    LEFT JOIN {{ref('user_source_xf')}} ON\r\n    base.owner_id=user_source_xf.user_id\r\n    LEFT JOIN {{ref('user_source_xf')}} creator ON\r\n    base.created_by_id=creator.user_id\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.contact', 'model.acton_marketing_data.account_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.user_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'contact_source_xf'], 'unique_id': 'model.acton_marketing_data.contact_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/contact_source_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/contact_source_xf.sql', 'name': 'contact_source_xf', 'alias': 'contact_source_xf', 'checksum': {'name': 'sha256', 'checksum': '8699c28a3575ac1ec1d35de937c03b868ccd60760ee63782874bd6423998ffdf'}, 'tags': [], 'refs': [['account_source_xf'], ['user_source_xf'], ['user_source_xf']], 'sources': [['salesforce', 'contact']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3864958, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_instance_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\nWITH base AS (\r\nSELECT *\r\nFROM {{ source('salesforce', 'act_on_instance_c') }}\r\n\r\n), final AS (\r\n    \r\n    SELECT\r\n        id AS ao_instance_id,\r\n        is_deleted,\r\n        name AS ao_instance_name,\r\n        created_date AS ao_instance_created_date,\r\n        last_modified_date,\r\n        system_modstamp AS systemmodstamp,\r\n        ao_account_name_c AS ao_account_name,\r\n        cdb_ao_instance_id_c AS cdb_ao_instance_id,\r\n        account_c AS ao_instance_account,\r\n        parent_account_c AS ao_instance_parent_account,\r\n        ao_parent_id_c AS ao_instance_parent_account_id \r\n    FROM base\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.salesforce.act_on_instance_c']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'sfdc', 'sfdc_xf', 'ao_instance_source_xf'], 'unique_id': 'model.acton_marketing_data.ao_instance_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/sfdc/sfdc_xf/ao_instance_source_xf.sql', 'original_file_path': 'models/sources/sfdc/sfdc_xf/ao_instance_source_xf.sql', 'name': 'ao_instance_source_xf', 'alias': 'ao_instance_source_xf', 'checksum': {'name': 'sha256', 'checksum': 'bf79ac86baa6a48631e185e7996e8ecbf72fecbff13e48639990dd7a73e58151'}, 'tags': [], 'refs': [], 'sources': [['salesforce', 'act_on_instance_c']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3888881, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_emails': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ source('data_studio_s3', 'data_studio_emails') }}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.data_studio_s3.data_studio_emails']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'ao_data', 'ao_data_raw', 'ao_emails'], 'unique_id': 'model.acton_marketing_data.ao_emails', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/ao_data/ao_data_raw/ao_emails.sql', 'original_file_path': 'models/sources/ao_data/ao_data_raw/ao_emails.sql', 'name': 'ao_emails', 'alias': 'ao_emails', 'checksum': {'name': 'sha256', 'checksum': '1aa64fbcd42b3d5be5ded05a65ac68d480e41eae7cb16b9ff37d829909d23f4f'}, 'tags': [], 'refs': [], 'sources': [['data_studio_s3', 'data_studio_emails']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.392087, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_webinars': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ source('data_studio_s3', 'data_studio_webinars') }}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.data_studio_s3.data_studio_webinars']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'ao_data', 'ao_data_raw', 'ao_webinars'], 'unique_id': 'model.acton_marketing_data.ao_webinars', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/ao_data/ao_data_raw/ao_webinars.sql', 'original_file_path': 'models/sources/ao_data/ao_data_raw/ao_webinars.sql', 'name': 'ao_webinars', 'alias': 'ao_webinars', 'checksum': {'name': 'sha256', 'checksum': '67a22115d76f5e03d9bd836970c62ba6e325bc57a8e1f3a2e5113e56f56d8119'}, 'tags': [], 'refs': [], 'sources': [['data_studio_s3', 'data_studio_webinars']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3942802, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_email_to_uid': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        recipient_e_mail AS email,\r\n        unique_visitor_id\r\n    FROM {{ref('ao_emails')}}\r\n    WHERE recipient_e_mail NOT LIKE 'unknown%'\r\n    AND recipient_e_mail IS NOT null\r\n    UNION ALL\r\n    SELECT\r\n        email,\r\n        unique_visitor_id\r\n    FROM {{ref('ao_forms')}}\r\n    WHERE email NOT LIKE 'unknown%'\r\n    AND email IS NOT null\r\n    UNION ALL\r\n    SELECT\r\n        e_mail_address AS email,\r\n        unique_visitor_id\r\n    FROM {{ref('ao_landingpages')}}\r\n    WHERE e_mail_address NOT LIKE 'unknown%'\r\n    AND e_mail_address IS NOT null\r\n    UNION ALL\r\n    SELECT\r\n        e_mail_address AS email,\r\n        unique_visitor_id\r\n    FROM {{ref('ao_media')}}\r\n    WHERE e_mail_address NOT LIKE 'unknown%'\r\n    AND e_mail_address IS NOT null\r\n    UNION ALL\r\n    SELECT\r\n        contact_e_mail AS email,\r\n        unique_visitor_id\r\n    FROM {{ref('ao_webinars')}}\r\n    WHERE contact_e_mail NOT LIKE 'unknown%'\r\n    AND contact_e_mail IS NOT null\r\n    UNION ALL\r\n    SELECT\r\n        contact_e_mail AS email,\r\n        unique_visitor_id\r\n    FROM {{ref('ao_webpages')}}\r\n    WHERE contact_e_mail NOT LIKE 'unknown%'\r\n    AND contact_e_mail IS NOT null\r\n\r\n)\r\n\r\n    SELECT DISTINCT\r\n        email,\r\n        unique_visitor_id\r\n    FROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.ao_emails', 'model.acton_marketing_data.ao_forms', 'model.acton_marketing_data.ao_landingpages', 'model.acton_marketing_data.ao_media', 'model.acton_marketing_data.ao_webinars', 'model.acton_marketing_data.ao_webpages']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'ao_data', 'ao_data_raw', 'ao_email_to_uid'], 'unique_id': 'model.acton_marketing_data.ao_email_to_uid', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/ao_data/ao_data_raw/ao_email_to_uid.sql', 'original_file_path': 'models/sources/ao_data/ao_data_raw/ao_email_to_uid.sql', 'name': 'ao_email_to_uid', 'alias': 'ao_email_to_uid', 'checksum': {'name': 'sha256', 'checksum': '6d17fc6ae4267f6c2af958883e39bc11a5b4a8074cd2a164e61264563b7e5ad4'}, 'tags': [], 'refs': [['ao_emails'], ['ao_forms'], ['ao_landingpages'], ['ao_media'], ['ao_webinars'], ['ao_webpages']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3962533, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_forms': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ source('data_studio_s3', 'data_studio_forms') }}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.data_studio_s3.data_studio_forms']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'ao_data', 'ao_data_raw', 'ao_forms'], 'unique_id': 'model.acton_marketing_data.ao_forms', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/ao_data/ao_data_raw/ao_forms.sql', 'original_file_path': 'models/sources/ao_data/ao_data_raw/ao_forms.sql', 'name': 'ao_forms', 'alias': 'ao_forms', 'checksum': {'name': 'sha256', 'checksum': '60d39903aab08487434041e29b34d4b0d15c04c74d7ce53c418fa351888c0d81'}, 'tags': [], 'refs': [], 'sources': [['data_studio_s3', 'data_studio_forms']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.3988008, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_landingpages': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ source('data_studio_s3', 'data_studio_landingpages') }}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.data_studio_s3.data_studio_landingpages']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'ao_data', 'ao_data_raw', 'ao_landingpages'], 'unique_id': 'model.acton_marketing_data.ao_landingpages', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/ao_data/ao_data_raw/ao_landingpages.sql', 'original_file_path': 'models/sources/ao_data/ao_data_raw/ao_landingpages.sql', 'name': 'ao_landingpages', 'alias': 'ao_landingpages', 'checksum': {'name': 'sha256', 'checksum': '66ab65a32f8a23861c3eff27050240c9ec2a19c8c57333904cbd24e8bc2a0589'}, 'tags': [], 'refs': [], 'sources': [['data_studio_s3', 'data_studio_landingpages']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.400887, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_media': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ source('data_studio_s3', 'data_studio_media') }}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.data_studio_s3.data_studio_media']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'ao_data', 'ao_data_raw', 'ao_media'], 'unique_id': 'model.acton_marketing_data.ao_media', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/ao_data/ao_data_raw/ao_media.sql', 'original_file_path': 'models/sources/ao_data/ao_data_raw/ao_media.sql', 'name': 'ao_media', 'alias': 'ao_media', 'checksum': {'name': 'sha256', 'checksum': '948ef3f89231c22bc9455707bcc254f89f9e50ec8d86a3947213799d6d5c58d3'}, 'tags': [], 'refs': [], 'sources': [['data_studio_s3', 'data_studio_media']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4031603, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_webpages': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ source('data_studio_s3', 'data_studio_webpages') }}\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.acton_marketing_data.data_studio_s3.data_studio_webpages']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'ao_data', 'ao_data_raw', 'ao_webpages'], 'unique_id': 'model.acton_marketing_data.ao_webpages', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/ao_data/ao_data_raw/ao_webpages.sql', 'original_file_path': 'models/sources/ao_data/ao_data_raw/ao_webpages.sql', 'name': 'ao_webpages', 'alias': 'ao_webpages', 'checksum': {'name': 'sha256', 'checksum': '09cce3689c824baf7cdffb5c122f4c679f6dc58ee5cc5974e5925d30d64012f7'}, 'tags': [], 'refs': [], 'sources': [['data_studio_s3', 'data_studio_webpages']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4053516, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_webpages_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT \r\n-- IDs\r\n    contact_e_mail AS email,\r\n    unique_visitor_id,\r\n\r\n-- Webpage Attributes\r\n    page_url,\r\n    referral_url,\r\n    visitor_type,\r\n    url_path_info AS url_path,\r\n    SPLIT_PART(SPLIT_PART(page_url,'utm_campaign=',2),'&',1) AS campaign,\r\n    SPLIT_PART(SPLIT_PART(page_url,'utm_channel=',2),'&',1) AS channel,\r\n    SPLIT_PART(SPLIT_PART(page_url,'utm_source=',2),'&',1) AS source,\r\n    SPLIT_PART(SPLIT_PART(page_url,'utm_medium=',2),'&',1) AS medium,\r\n    SPLIT_PART(SPLIT_PART(page_url,'utm_content=',2),'&',1) AS content,\r\n    \r\n-- Action Data\r\n    action,\r\n    action_time,\r\n    action_day,\r\n\r\n-- Other Data\r\n    attribution_id,\r\n    cookie_id,\r\n    ip_address,\r\n    e_mail_domain AS email_domain\r\nFROM {{ref('ao_webpages')}}\r\nWHERE contact_e_mail IS NOT null", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.ao_webpages']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'ao_data', 'ao_data_xf', 'ao_webpages_xf'], 'unique_id': 'model.acton_marketing_data.ao_webpages_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/ao_data/ao_data_xf/ao_webpages_xf.sql', 'original_file_path': 'models/sources/ao_data/ao_data_xf/ao_webpages_xf.sql', 'name': 'ao_webpages_xf', 'alias': 'ao_webpages_xf', 'checksum': {'name': 'sha256', 'checksum': '4c1debfaedc3ecf8a43df5a0d3da118fef5ddfadbcb39fc7d4b09458813387b4'}, 'tags': [], 'refs': [['ao_webpages']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4073472, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_media_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT \r\n-- IDs\r\n    document_id AS media_id,\r\n    e_mail_address AS email,\r\n    record_id,\r\n    unique_visitor_id,\r\n\r\n-- Media Attributes\r\n    document_name AS media_name,\r\n    \r\n-- Action Data\r\n    action,\r\n    action_time,\r\n    action_day,\r\n\r\n-- Other Data\r\n    cookie_id,\r\n    ip_address,\r\n    e_mail_domain AS email_domain\r\nFROM {{ref('ao_media')}}\r\nWHERE e_mail_address IS NOT null\r\nAND e_mail_address NOT LIKE 'unknown%'", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.ao_media']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'ao_data', 'ao_data_xf', 'ao_media_xf'], 'unique_id': 'model.acton_marketing_data.ao_media_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/ao_data/ao_data_xf/ao_media_xf.sql', 'original_file_path': 'models/sources/ao_data/ao_data_xf/ao_media_xf.sql', 'name': 'ao_media_xf', 'alias': 'ao_media_xf', 'checksum': {'name': 'sha256', 'checksum': '459b638fb970156977433d5a1812c0bf5b40b47ef6fabe4fceba898289ccebfe'}, 'tags': [], 'refs': [['ao_media']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4093463, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_combined': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH emails AS (\r\n\r\n    SELECT\r\n    -- IDs\r\n        {{ dbt_utils.surrogate_key(['action_time', 'message_id','email'])}} AS touchpoint_id,\r\n        message_id,\r\n        email,\r\n        record_id,\r\n        unique_visitor_id,\r\n\r\n    --Message Attributes\r\n        message_title,\r\n        subject_line,\r\n        from_address,\r\n\r\n    --Action Attributes\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n    \r\n    --Attribution Attributes\r\n        campaign,\r\n        channel,\r\n        content,\r\n        medium,\r\n        source\r\n    FROM {{ref('ao_emails_xf')}}\r\n\r\n), forms AS (\r\n\r\n    SELECT\r\n    -- IDs\r\n        {{ dbt_utils.surrogate_key(['action_time', 'form_id','email'])}} AS touchpoint_id,\r\n        form_id,\r\n        email,\r\n        unique_visitor_id,\r\n        record_id,\r\n\r\n    --Form Attributes\r\n        form_title,\r\n\r\n    --Action Attributes\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        referral_url,\r\n\r\n    --Attribution Attributes\r\n        -- campaign,\r\n        -- channel,\r\n        -- content,\r\n        -- medium,\r\n        -- source\r\n\r\n    --Other Data\r\n        ip_address,\r\n        cookie_id\r\n    FROM {{ref('ao_forms_xf')}}\r\n\r\n), lps AS (\r\n\r\n    SELECT \r\n    -- IDs\r\n        {{ dbt_utils.surrogate_key(['action_time', 'landing_page_id','email'])}} AS touchpoint_id,\r\n        landing_page_id,\r\n        email,\r\n        record_id,\r\n        unique_visitor_id,\r\n\r\n    -- LP Attributes\r\n        landing_page_title,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n\r\n        --Attribution Attributes\r\n        campaign,\r\n        channel,\r\n        content,\r\n        medium,\r\n        source,\r\n\r\n    -- Action Data\r\n        action,\r\n        action_time,\r\n        action_day,\r\n\r\n    -- Other Data\r\n        cookie_id,\r\n        ip_address,\r\n        email_domain\r\n    FROM {{ref('ao_landingpages_xf')}}\r\n\r\n), media AS (\r\n\r\n    SELECT \r\n    -- IDs\r\n        {{ dbt_utils.surrogate_key(['action_time', 'media_id','email'])}} AS touchpoint_id,\r\n        media_id,\r\n        email,\r\n        record_id,\r\n        unique_visitor_id,\r\n\r\n    -- Media Attributes\r\n        media_name,\r\n        \r\n    -- Action Data\r\n        action,\r\n        action_time,\r\n        action_day,\r\n\r\n    -- Other Data\r\n        cookie_id,\r\n        ip_address,\r\n        email_domain\r\n    FROM {{ref('ao_media_xf')}}\r\n\r\n), tasks AS (\r\n\r\n    SELECT\r\n    --IDs\r\n        {{ dbt_utils.surrogate_key(['activity_date', 'task_id','email'])}} AS touchpoint_id,\r\n        task_id,\r\n        person_id,\r\n        owner_id,\r\n        account_id,\r\n        email,\r\n\r\n    --Task Data\r\n        task_subject,\r\n        activity_date,\r\n        task_status,\r\n        task_type,\r\n        is_closed,\r\n        task_created_date,\r\n        close_date\r\n    FROM {{ref('task_source_xf')}}\r\n\r\n), webinars AS (\r\n\r\n    SELECT \r\n    -- IDs\r\n        {{ dbt_utils.surrogate_key(['action_time', 'webinar_id','email'])}} AS touchpoint_id,\r\n        webinar_id,\r\n        email,\r\n        record_id,\r\n        unique_visitor_id,\r\n\r\n    -- Webinar Attributes\r\n        webinar_title,\r\n        event_id,\r\n\r\n    -- Action Data\r\n        action,\r\n        action_time,\r\n        action_day,\r\n\r\n    -- Other Data\r\n        email_domain\r\n    FROM {{ref('ao_webinars_xf')}}\r\n\r\n), webpages AS (\r\n\r\n    SELECT \r\n    -- IDs\r\n        {{ dbt_utils.surrogate_key(['action_time', 'page_url','email'])}} AS touchpoint_id,\r\n        email,\r\n        unique_visitor_id,\r\n\r\n    -- Webpage Attributes\r\n        page_url,\r\n        referral_url,\r\n        visitor_type,\r\n        url_path,\r\n\r\n    --Attribution Attributes\r\n        campaign,\r\n        channel,\r\n        content,\r\n        medium,\r\n        source,\r\n        \r\n    -- Action Data\r\n        action,\r\n        action_time,\r\n        action_day,\r\n\r\n    -- Other Data\r\n        attribution_id,\r\n        cookie_id,\r\n        ip_address,\r\n        email_domain\r\n    FROM {{ref('ao_webpages_xf')}}\r\n\r\n), combined_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        message_id AS asset_id,\r\n        email,\r\n        message_title AS asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        campaign,\r\n        channel,\r\n        content,\r\n        medium,\r\n        source,\r\n        clickthrough_link_name,\r\n        null AS referral_url,\r\n        null AS event_id,\r\n        'email' AS asset_type\r\n    FROM emails\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        form_id AS asset_id,\r\n        email,\r\n        form_title AS asset_title,\r\n        null AS subject_line,\r\n        null AS from_address,\r\n        null AS clicked_url,\r\n        null AS campaign,\r\n        null AS channel,\r\n        null AS content,\r\n        null AS medium,\r\n        null AS source,\r\n        null AS clickthrough_link_name,\r\n        referral_url,\r\n        null AS event_id,\r\n        'form' AS asset_type\r\n    FROM forms\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        landing_page_id AS asset_id,\r\n        email,\r\n        landing_page_title AS asset_title,\r\n        null AS subject_line,\r\n        null AS from_address,\r\n        clicked_url,\r\n        campaign,\r\n        channel,\r\n        content,\r\n        medium,\r\n        source,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        null AS event_id,\r\n        'landing page' AS asset_type\r\n    FROM lps\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        media_id AS asset_id,\r\n        email,\r\n        media_name AS asset_title,\r\n        null AS subject_line,\r\n        null AS from_address,\r\n        null AS clicked_url,\r\n        null AS campaign,\r\n        null AS channel,\r\n        null AS content,\r\n        null AS medium,\r\n        null AS source,\r\n        null AS clickthrough_link_name,\r\n        null AS referral_url,\r\n        null AS event_id,\r\n        'media' AS asset_type\r\n    FROM media\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        task_type AS action,\r\n        activity_date::timestamp AS action_time,\r\n        activity_date AS action_day,\r\n        task_id AS asset_id,\r\n        email,\r\n        task_subject AS asset_title,\r\n        null AS subject_line,\r\n        null AS from_address,\r\n        null AS clicked_url,\r\n        null AS campaign,\r\n        null AS channel,\r\n        null AS content,\r\n        null AS medium,\r\n        null AS source,\r\n        null AS clickthrough_link_name,\r\n        null AS referral_url,\r\n        null AS event_id,\r\n        'task' AS asset_type   \r\n    FROM tasks\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        webinar_id AS asset_id,\r\n        email,\r\n        webinar_title AS asset_title,\r\n        null AS subject_line,\r\n        null AS from_address,\r\n        null AS clicked_url,\r\n        null AS campaign,\r\n        null AS channel,\r\n        null AS content,\r\n        null AS medium,\r\n        null AS source,\r\n        null AS clickthrough_link_name,\r\n        null AS referral_url,\r\n        event_id,\r\n        'webinar' AS asset_type\r\n    FROM webinars\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        null AS asset_id,\r\n        email,\r\n        page_url AS asset_title,\r\n        null AS subject_line,\r\n        null AS from_address,\r\n        null AS clicked_url,\r\n        campaign,\r\n        channel,\r\n        content,\r\n        medium,\r\n        source,\r\n        null AS clickthrough_link_name,\r\n        referral_url,\r\n        null AS event_id,\r\n        'webpage' AS asset_type\r\n    FROM webpages\r\n)\r\n\r\nSELECT *\r\nFROM combined_base", 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.surrogate_key'], 'nodes': ['model.acton_marketing_data.ao_emails_xf', 'model.acton_marketing_data.ao_forms_xf', 'model.acton_marketing_data.ao_landingpages_xf', 'model.acton_marketing_data.ao_media_xf', 'model.acton_marketing_data.task_source_xf', 'model.acton_marketing_data.ao_webinars_xf', 'model.acton_marketing_data.ao_webpages_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'ao_data', 'ao_data_xf', 'ao_combined'], 'unique_id': 'model.acton_marketing_data.ao_combined', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/ao_data/ao_data_xf/ao_combined.sql', 'original_file_path': 'models/sources/ao_data/ao_data_xf/ao_combined.sql', 'name': 'ao_combined', 'alias': 'ao_combined', 'checksum': {'name': 'sha256', 'checksum': 'e801bd44e3a243c9c6896f4a00b1564592353c31d4ab4da3fb8288a531df0522'}, 'tags': [], 'refs': [['ao_emails_xf'], ['ao_forms_xf'], ['ao_landingpages_xf'], ['ao_media_xf'], ['task_source_xf'], ['ao_webinars_xf'], ['ao_webpages_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4114118, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_forms_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n-- IDs\r\n    form_id,\r\n    email,\r\n    unique_visitor_id,\r\n    record_id,\r\n\r\n--Form Attributes\r\n    form_title,\r\n\r\n--Action Attributes\r\n    CASE\r\n        WHEN action IN ('INSERT','UPDATE') THEN 'SUBMIT'\r\n    END AS action,\r\n    action_time,\r\n    action_day,\r\n    referral_url,\r\n\r\n--Other Data\r\n    ip_address,\r\n    cookie_id\r\nFROM {{ref('ao_forms')}}\r\nWHERE email IS NOT null\r\nAND email NOT LIKE 'unknown%'", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.ao_forms']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'ao_data', 'ao_data_xf', 'ao_forms_xf'], 'unique_id': 'model.acton_marketing_data.ao_forms_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/ao_data/ao_data_xf/ao_forms_xf.sql', 'original_file_path': 'models/sources/ao_data/ao_data_xf/ao_forms_xf.sql', 'name': 'ao_forms_xf', 'alias': 'ao_forms_xf', 'checksum': {'name': 'sha256', 'checksum': 'df4b89186ea6b4c58be92e2e83a7ac8b1045e3b55d37ff9e671021a1e8ebe48d'}, 'tags': [], 'refs': [['ao_forms']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.439237, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_emails_xf': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nSELECT\r\n-- IDs\r\n    message_id,\r\n    recipient_e_mail AS email,\r\n    record_id,\r\n    unique_visitor_id,\r\n\r\n--Message Attributes\r\n    message_title,\r\n    subject AS subject_line,\r\n    "from" AS from_address,\r\n\r\n--Action Attributes\r\n    action,\r\n    action_time,\r\n    action_day,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,\'utm_campaign=\',2),\'&\',1) AS campaign,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,\'utm_channel=\',2),\'&\',1) AS channel,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,\'utm_source=\',2),\'&\',1) AS source,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,\'utm_medium=\',2),\'&\',1) AS medium,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,\'utm_content=\',2),\'&\',1) AS content,\r\n    clicked_url,\r\n    clickthrough_link_name\r\nFROM {{ref(\'ao_emails\')}}\r\nWHERE action = \'CLICKED\'\r\nAND recipient_e_mail IS NOT null\r\nAND recipient_e_mail NOT LIKE \'unknown%\'', 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.ao_emails']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'ao_data', 'ao_data_xf', 'ao_emails_xf'], 'unique_id': 'model.acton_marketing_data.ao_emails_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/ao_data/ao_data_xf/ao_emails_xf.sql', 'original_file_path': 'models/sources/ao_data/ao_data_xf/ao_emails_xf.sql', 'name': 'ao_emails_xf', 'alias': 'ao_emails_xf', 'checksum': {'name': 'sha256', 'checksum': 'dc3a33cbc53e8d4977d277b3f5a915e0fc1bdedae4fec533b173b9998badda18'}, 'tags': [], 'refs': [['ao_emails']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4412925, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_webinars_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT \r\n-- IDs\r\n    webinar_id,\r\n    contact_e_mail AS email,\r\n    record_id,\r\n    unique_visitor_id,\r\n\r\n-- Webinar Attributes\r\n    webinar_title,\r\n    event_program_id AS event_id,\r\n\r\n-- Action Data\r\n    action,\r\n    action_time,\r\n    action_day,\r\n\r\n-- Other Data\r\n    e_mail_domain AS email_domain\r\nFROM {{ref('ao_webinars')}}\r\nWHERE contact_e_mail IS NOT null\r\nAND contact_e_mail NOT LIKE 'unknown%'", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.ao_webinars']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'ao_data', 'ao_data_xf', 'ao_webinars_xf'], 'unique_id': 'model.acton_marketing_data.ao_webinars_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/ao_data/ao_data_xf/ao_webinars_xf.sql', 'original_file_path': 'models/sources/ao_data/ao_data_xf/ao_webinars_xf.sql', 'name': 'ao_webinars_xf', 'alias': 'ao_webinars_xf', 'checksum': {'name': 'sha256', 'checksum': '681c00cfd355f9dbba832ec5abda453a2f1427e83c333c548f2405ad87879dd3'}, 'tags': [], 'refs': [['ao_webinars']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4433365, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.ao_landingpages_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT \r\n-- IDs\r\n    landing_page_id,\r\n    e_mail_address AS email,\r\n    record_id,\r\n    unique_visitor_id,\r\n\r\n-- LP Attributes\r\n    landing_page_title,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_campaign=',2),'&',1) AS campaign,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_channel=',2),'&',1) AS channel,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_source=',2),'&',1) AS source,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_medium=',2),'&',1) AS medium,\r\n    SPLIT_PART(SPLIT_PART(clicked_url,'utm_content=',2),'&',1) AS content,\r\n    clicked_url,\r\n    clickthrough_link_name,\r\n    referral_url,\r\n\r\n-- Action Data\r\n    action,\r\n    action_time,\r\n    action_day,\r\n\r\n-- Other Data\r\n    cookie_id,\r\n    ip_address,\r\n    e_mail_domain AS email_domain\r\nFROM {{ref('ao_landingpages')}}\r\nWHERE e_mail_address IS NOT null\r\nAND e_mail_address NOT LIKE 'unknown%'", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.ao_landingpages']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'sources', 'ao_data', 'ao_data_xf', 'ao_landingpages_xf'], 'unique_id': 'model.acton_marketing_data.ao_landingpages_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sources/ao_data/ao_data_xf/ao_landingpages_xf.sql', 'original_file_path': 'models/sources/ao_data/ao_data_xf/ao_landingpages_xf.sql', 'name': 'ao_landingpages_xf', 'alias': 'ao_landingpages_xf', 'checksum': {'name': 'sha256', 'checksum': '5ce78a13a0bd950ff37283cd1d614425828670eb8c1857fa4770074f808f50be'}, 'tags': [], 'refs': [['ao_landingpages']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4457579, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.topo_leads': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    lead_source,\r\n    global_region,\r\n    'Inquiries' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_leads')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_leads.created_date=date_base_xf.day\r\nWHERE created_date >= '2021-01-01'\r\nAND lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_leads', 'model.acton_marketing_data.date_base_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'topo_model', 'topo_leads'], 'unique_id': 'model.acton_marketing_data.topo_leads', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'topo_model/topo_leads.sql', 'original_file_path': 'models/topo_model/topo_leads.sql', 'name': 'topo_leads', 'alias': 'topo_leads', 'checksum': {'name': 'sha256', 'checksum': '678832d4afd88a6f27418155fcd36235b18de97c554a603642fd7fef38a99d04'}, 'tags': [], 'refs': [['funnel_report_all_time_leads'], ['date_base_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4477983, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.topo_all': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT *\r\nFROM {{ref('topo_closing')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_demos')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_leads')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_lost')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_mqls')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_pipe')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_sals')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_sqls')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_sqos')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_voc')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_won_acv')}}\r\nUNION ALL\r\nSELECT *\r\nFROM {{ref('topo_won')}}", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.topo_closing', 'model.acton_marketing_data.topo_demos', 'model.acton_marketing_data.topo_leads', 'model.acton_marketing_data.topo_lost', 'model.acton_marketing_data.topo_mqls', 'model.acton_marketing_data.topo_pipe', 'model.acton_marketing_data.topo_sals', 'model.acton_marketing_data.topo_sqls', 'model.acton_marketing_data.topo_sqos', 'model.acton_marketing_data.topo_voc', 'model.acton_marketing_data.topo_won_acv', 'model.acton_marketing_data.topo_won']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'topo_model', 'topo_all'], 'unique_id': 'model.acton_marketing_data.topo_all', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'topo_model/topo_all.sql', 'original_file_path': 'models/topo_model/topo_all.sql', 'name': 'topo_all', 'alias': 'topo_all', 'checksum': {'name': 'sha256', 'checksum': '6616619ec3a8370a431eebc1b213cc43b12595d0b986060198048478ae2612bb'}, 'tags': [], 'refs': [['topo_closing'], ['topo_demos'], ['topo_leads'], ['topo_lost'], ['topo_mqls'], ['topo_pipe'], ['topo_sals'], ['topo_sqls'], ['topo_sqos'], ['topo_voc'], ['topo_won_acv'], ['topo_won']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4498873, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.topo_won_acv': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'Won ACV' AS type,\r\n    month,\r\n    quarter,\r\n    SUM(acv) AS records\r\nFROM {{ref('funnel_report_all_time_won')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_won.won_date=date_base_xf.day\r\nWHERE won_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_won', 'model.acton_marketing_data.date_base_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'topo_model', 'topo_won_acv'], 'unique_id': 'model.acton_marketing_data.topo_won_acv', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'topo_model/topo_won_acv.sql', 'original_file_path': 'models/topo_model/topo_won_acv.sql', 'name': 'topo_won_acv', 'alias': 'topo_won_acv', 'checksum': {'name': 'sha256', 'checksum': 'e089342b627813cb2c81e3c3b49d1ef40c69c4af7edea875dd71862ff111389a'}, 'tags': [], 'refs': [['funnel_report_all_time_won'], ['date_base_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.452736, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.topo_mqls': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    lead_source,\r\n    global_region,\r\n    'MQL' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_mqls')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_mqls.mql_date=date_base_xf.day\r\nWHERE mql_date >= '2021-01-01'\r\nAND lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_mqls', 'model.acton_marketing_data.date_base_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'topo_model', 'topo_mqls'], 'unique_id': 'model.acton_marketing_data.topo_mqls', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'topo_model/topo_mqls.sql', 'original_file_path': 'models/topo_model/topo_mqls.sql', 'name': 'topo_mqls', 'alias': 'topo_mqls', 'checksum': {'name': 'sha256', 'checksum': '7535c0da8bfcaef6fff769aa1492989d2fb925f901946b96f504589bea8d98f8'}, 'tags': [], 'refs': [['funnel_report_all_time_mqls'], ['date_base_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.455264, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.topo_sqls': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'SQL' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_sqls')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_sqls.sql_date=date_base_xf.day\r\nWHERE sql_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_sqls', 'model.acton_marketing_data.date_base_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'topo_model', 'topo_sqls'], 'unique_id': 'model.acton_marketing_data.topo_sqls', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'topo_model/topo_sqls.sql', 'original_file_path': 'models/topo_model/topo_sqls.sql', 'name': 'topo_sqls', 'alias': 'topo_sqls', 'checksum': {'name': 'sha256', 'checksum': 'e9763db998efcc4ad93582a748febae200247e289bc1310a40bfc1c061487ce4'}, 'tags': [], 'refs': [['funnel_report_all_time_sqls'], ['date_base_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4576197, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.topo_sals': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    lead_source,\r\n    global_region,\r\n    'SAL' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_sals')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_sals.sal_date=date_base_xf.day\r\nWHERE sal_date >= '2021-01-01'\r\nAND lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_sals', 'model.acton_marketing_data.date_base_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'topo_model', 'topo_sals'], 'unique_id': 'model.acton_marketing_data.topo_sals', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'topo_model/topo_sals.sql', 'original_file_path': 'models/topo_model/topo_sals.sql', 'name': 'topo_sals', 'alias': 'topo_sals', 'checksum': {'name': 'sha256', 'checksum': 'dc06fbb64db8e8d04cda35c339b2c61c4c3ae6b38cfbe13d72f89653cc2f16f2'}, 'tags': [], 'refs': [['funnel_report_all_time_sals'], ['date_base_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.45972, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.topo_closing': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'CLOSING' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_closing')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_closing.closing_date=date_base_xf.day\r\nWHERE closing_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_closing', 'model.acton_marketing_data.date_base_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'topo_model', 'topo_closing'], 'unique_id': 'model.acton_marketing_data.topo_closing', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'topo_model/topo_closing.sql', 'original_file_path': 'models/topo_model/topo_closing.sql', 'name': 'topo_closing', 'alias': 'topo_closing', 'checksum': {'name': 'sha256', 'checksum': 'c9d3256dffd1f37f85d858d59dc50098f566b036c106800694079c5ecac305c0'}, 'tags': [], 'refs': [['funnel_report_all_time_closing'], ['date_base_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4619193, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.topo_lost': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'Lost' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_lost')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_lost.lost_date=date_base_xf.day\r\nWHERE lost_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_lost', 'model.acton_marketing_data.date_base_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'topo_model', 'topo_lost'], 'unique_id': 'model.acton_marketing_data.topo_lost', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'topo_model/topo_lost.sql', 'original_file_path': 'models/topo_model/topo_lost.sql', 'name': 'topo_lost', 'alias': 'topo_lost', 'checksum': {'name': 'sha256', 'checksum': '71ede907cbd1522ca1ccd75841449f308a2c2cb863eb89786b2a62fe8c223297'}, 'tags': [], 'refs': [['funnel_report_all_time_lost'], ['date_base_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4639833, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.topo_sqos': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'SQO' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_sqos')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_sqos.sqo_date=date_base_xf.day\r\nWHERE sqo_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.date_base_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'topo_model', 'topo_sqos'], 'unique_id': 'model.acton_marketing_data.topo_sqos', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'topo_model/topo_sqos.sql', 'original_file_path': 'models/topo_model/topo_sqos.sql', 'name': 'topo_sqos', 'alias': 'topo_sqos', 'checksum': {'name': 'sha256', 'checksum': '6a7c778f5d067b4213e3d7be057884078c0a6a94915f886838d546e7a2d0e579'}, 'tags': [], 'refs': [['funnel_report_all_time_sqos'], ['date_base_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.466445, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.topo_pipe': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'PIPE' AS type,\r\n    month,\r\n    quarter,\r\n    SUM(acv) AS records\r\nFROM {{ref('funnel_report_all_time_sqos')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_sqos.sqo_date=date_base_xf.day\r\nWHERE sqo_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_sqos', 'model.acton_marketing_data.date_base_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'topo_model', 'topo_pipe'], 'unique_id': 'model.acton_marketing_data.topo_pipe', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'topo_model/topo_pipe.sql', 'original_file_path': 'models/topo_model/topo_pipe.sql', 'name': 'topo_pipe', 'alias': 'topo_pipe', 'checksum': {'name': 'sha256', 'checksum': '50339211ba4dc33971099f1d79e8f1076269b97b8468515e5a9cb2cd73b979d0'}, 'tags': [], 'refs': [['funnel_report_all_time_sqos'], ['date_base_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.468515, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.topo_won': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'Won' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_won')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_won.won_date=date_base_xf.day\r\nWHERE won_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_won', 'model.acton_marketing_data.date_base_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'topo_model', 'topo_won'], 'unique_id': 'model.acton_marketing_data.topo_won', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'topo_model/topo_won.sql', 'original_file_path': 'models/topo_model/topo_won.sql', 'name': 'topo_won', 'alias': 'topo_won', 'checksum': {'name': 'sha256', 'checksum': '6f0cd517205924b5e11bc3b0181c32bb7ad41a0cdfe08ec004e7c343d5927c97'}, 'tags': [], 'refs': [['funnel_report_all_time_won'], ['date_base_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4705865, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.topo_demos': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'DEMO' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_demo')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_demo.demo_date=date_base_xf.day\r\nWHERE demo_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_demo', 'model.acton_marketing_data.date_base_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'topo_model', 'topo_demos'], 'unique_id': 'model.acton_marketing_data.topo_demos', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'topo_model/topo_demos.sql', 'original_file_path': 'models/topo_model/topo_demos.sql', 'name': 'topo_demos', 'alias': 'topo_demos', 'checksum': {'name': 'sha256', 'checksum': 'dae03ced86e4801d22bf5f143fa833be183990de550b2b9b9b5cb1e7d8504bbb'}, 'tags': [], 'refs': [['funnel_report_all_time_demo'], ['date_base_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4727821, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.topo_voc': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    segment,\r\n    opp_lead_source AS lead_source,\r\n    account_global_region AS global_region,\r\n    'VOC' AS type,\r\n    month,\r\n    quarter,\r\n    COUNT(*) AS records\r\nFROM {{ref('funnel_report_all_time_voc')}}\r\nLEFT JOIN {{ref('date_base_xf')}} ON\r\nfunnel_report_all_time_voc.voc_date=date_base_xf.day\r\nWHERE voc_date >= '2021-01-01'\r\nAND opp_lead_source IN ('Marketing','Sales','SDR','Channel')\r\nGROUP BY 1,2,3,4,5,6\r\nORDER BY 1,2,3,4,5,6", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.funnel_report_all_time_voc', 'model.acton_marketing_data.date_base_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'topo_model', 'topo_voc'], 'unique_id': 'model.acton_marketing_data.topo_voc', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'topo_model/topo_voc.sql', 'original_file_path': 'models/topo_model/topo_voc.sql', 'name': 'topo_voc', 'alias': 'topo_voc', 'checksum': {'name': 'sha256', 'checksum': '69cca010738c01509d0de60f7ee98cb16a35bd36cfb1b05249eb4446e9d55abf'}, 'tags': [], 'refs': [['funnel_report_all_time_voc'], ['date_base_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4749055, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.marketing_lead_creation_date_history_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        lead_history_xf.lead_id,\r\n        lead_history_xf.field_modified_at,\r\n        lead_history_xf.field,\r\n        lead_history_xf.old_value,\r\n        lead_history_xf.new_value,\r\n        'lead' AS type\r\n    FROM {{ref('lead_history_xf')}}\r\n    LEFT JOIN {{ref('lead_source_xf')}} ON \r\n    lead_history_xf.lead_id=lead_source_xf.lead_id\r\n    WHERE marketing_created_date IS null\r\n    UNION ALL\r\n    SELECT \r\n        contact_history_xf.contact_id,\r\n        contact_history_xf.field_modified_at,\r\n        contact_history_xf.field,\r\n        contact_history_xf.old_value,\r\n        contact_history_xf.new_value,\r\n        'contact' AS type\r\n    FROM {{ref('contact_history_xf')}}\r\n    LEFT JOIN {{ref('contact_source_xf')}} ON \r\n    contact_history_xf.contact_id=contact_source_xf.contact_id\r\n    WHERE marketing_created_date IS null\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        lead_id,\r\n        old_value,\r\n        new_value,\r\n        field_modified_at,\r\n        type,\r\n        ROW_NUMBER() OVER(PARTITION BY lead_id ORDER BY field_modified_at) AS event_number\r\n    FROM base \r\n    WHERE field ='X9883_Lead_Score__c'\r\n    AND new_value > '0.0'\r\n    ORDER BY lead_id,field_modified_at\r\n\r\n)\r\n\r\nSELECT \r\n    lead_id,\r\n    old_value,\r\n    new_value,\r\n    field_modified_at,\r\n    type\r\nFROM final\r\nWHERE event_number = 1", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.lead_history_xf', 'model.acton_marketing_data.lead_source_xf', 'model.acton_marketing_data.contact_history_xf', 'model.acton_marketing_data.contact_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel_date_updates', 'marketing_lead_creation_date_history_xf'], 'unique_id': 'model.acton_marketing_data.marketing_lead_creation_date_history_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel_date_updates/marketing_lead_creation_date_history_xf.sql', 'original_file_path': 'models/funnel_date_updates/marketing_lead_creation_date_history_xf.sql', 'name': 'marketing_lead_creation_date_history_xf', 'alias': 'marketing_lead_creation_date_history_xf', 'checksum': {'name': 'sha256', 'checksum': '6dc7ce24f9e0818e54ec6359e2e6574f1e081afde3efbdeee4385430a03080bc'}, 'tags': [], 'refs': [['lead_history_xf'], ['lead_source_xf'], ['contact_history_xf'], ['contact_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4773479, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opp_demo_date_history_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        opportunity_history_xf.opportunity_id,\r\n        opp_source_xf.type AS opp_type,\r\n        opportunity_history_xf.field_modified_at,\r\n        opportunity_history_xf.field,\r\n        opportunity_history_xf.old_value,\r\n        opportunity_history_xf.new_value\r\n    FROM {{ref('opportunity_history_xf')}}\r\n    LEFT JOIN {{ref('opp_source_xf')}} ON \r\n    opportunity_history_xf.opportunity_id=opp_source_xf.opportunity_id\r\n    WHERE demo_date IS null\r\n    AND type IN ('New Business','UpSell','Renewal')\r\n    AND field_modified_at >= '2021-01-01'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        opportunity_id,\r\n        opp_type,\r\n        old_value,\r\n        new_value,\r\n        field_modified_at,\r\n        ROW_NUMBER() OVER(PARTITION BY opportunity_id ORDER BY field_modified_at) AS event_number\r\n    FROM base \r\n    WHERE field = 'StageName'\r\n    AND new_value = 'Demo'\r\n    ORDER BY opportunity_id,field_modified_at\r\n\r\n)\r\n\r\nSELECT \r\n    opportunity_id,\r\n    opp_type,\r\n    old_value,\r\n    new_value,\r\n    field_modified_at\r\nFROM final\r\nWHERE event_number = 1", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opportunity_history_xf', 'model.acton_marketing_data.opp_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel_date_updates', 'opp_demo_date_history_xf'], 'unique_id': 'model.acton_marketing_data.opp_demo_date_history_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel_date_updates/opp_demo_date_history_xf.sql', 'original_file_path': 'models/funnel_date_updates/opp_demo_date_history_xf.sql', 'name': 'opp_demo_date_history_xf', 'alias': 'opp_demo_date_history_xf', 'checksum': {'name': 'sha256', 'checksum': '99b51873270f0ad547a1b13870587c6dbdcdec6a524352a78210cc616403b9fb'}, 'tags': [], 'refs': [['opportunity_history_xf'], ['opp_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4796627, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.working_date_history_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        lead_history_xf.lead_id,\r\n        lead_history_xf.field_modified_at,\r\n        lead_history_xf.field,\r\n        lead_history_xf.old_value,\r\n        lead_history_xf.new_value,\r\n        'lead' AS type\r\n    FROM {{ref('lead_history_xf')}}\r\n    LEFT JOIN {{ref('lead_source_xf')}} ON \r\n    lead_history_xf.lead_id=lead_source_xf.lead_id\r\n    WHERE working_date IS null\r\n    UNION ALL\r\n    SELECT \r\n        contact_history_xf.contact_id,\r\n        contact_history_xf.field_modified_at,\r\n        contact_history_xf.field,\r\n        contact_history_xf.old_value,\r\n        contact_history_xf.new_value,\r\n        'contact' AS type\r\n    FROM {{ref('contact_history_xf')}}\r\n    LEFT JOIN {{ref('contact_source_xf')}} ON \r\n    contact_history_xf.contact_id=contact_source_xf.contact_id\r\n    WHERE working_date IS null\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        lead_id,\r\n        old_value,\r\n        new_value,\r\n        field_modified_at,\r\n        type,\r\n        ROW_NUMBER() OVER(PARTITION BY lead_id ORDER BY field_modified_at) AS event_number\r\n    FROM base \r\n    WHERE field = 'Status'\r\n    AND new_value = 'Working'\r\n    ORDER BY lead_id,field_modified_at\r\n\r\n)\r\n\r\nSELECT \r\n    lead_id,\r\n    old_value,\r\n    new_value,\r\n    field_modified_at,\r\n    type\r\nFROM final\r\nWHERE event_number = 1", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.lead_history_xf', 'model.acton_marketing_data.lead_source_xf', 'model.acton_marketing_data.contact_history_xf', 'model.acton_marketing_data.contact_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel_date_updates', 'working_date_history_xf'], 'unique_id': 'model.acton_marketing_data.working_date_history_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel_date_updates/working_date_history_xf.sql', 'original_file_path': 'models/funnel_date_updates/working_date_history_xf.sql', 'name': 'working_date_history_xf', 'alias': 'working_date_history_xf', 'checksum': {'name': 'sha256', 'checksum': '08ad9ce415fed26438371a6ff6db08d17877c2658fac9674c21d9c79f2bea39b'}, 'tags': [], 'refs': [['lead_history_xf'], ['lead_source_xf'], ['contact_history_xf'], ['contact_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.481853, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opp_closing_date_history_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        opportunity_history_xf.opportunity_id,\r\n        opp_source_xf.type AS opp_type,\r\n        opportunity_history_xf.field_modified_at,\r\n        opportunity_history_xf.field,\r\n        opportunity_history_xf.old_value,\r\n        opportunity_history_xf.new_value\r\n    FROM {{ref('opportunity_history_xf')}}\r\n    LEFT JOIN {{ref('opp_source_xf')}} ON \r\n    opportunity_history_xf.opportunity_id=opp_source_xf.opportunity_id\r\n    WHERE closing_date IS null\r\n    AND type IN ('New Business','UpSell','Renewal')\r\n    AND field_modified_at >= '2021-01-01'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        opportunity_id,\r\n        opp_type,\r\n        old_value,\r\n        new_value,\r\n        field_modified_at,\r\n        ROW_NUMBER() OVER(PARTITION BY opportunity_id ORDER BY field_modified_at) AS event_number\r\n    FROM base \r\n    WHERE field = 'StageName'\r\n    AND new_value = 'Closing'\r\n    ORDER BY opportunity_id,field_modified_at\r\n\r\n)\r\n\r\nSELECT \r\n    opportunity_id,\r\n    opp_type,\r\n    old_value,\r\n    new_value,\r\n    field_modified_at\r\nFROM final\r\nWHERE event_number = 1", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opportunity_history_xf', 'model.acton_marketing_data.opp_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel_date_updates', 'opp_closing_date_history_xf'], 'unique_id': 'model.acton_marketing_data.opp_closing_date_history_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel_date_updates/opp_closing_date_history_xf.sql', 'original_file_path': 'models/funnel_date_updates/opp_closing_date_history_xf.sql', 'name': 'opp_closing_date_history_xf', 'alias': 'opp_closing_date_history_xf', 'checksum': {'name': 'sha256', 'checksum': '23f9f9731ab14c02ed89e3d2d7bd414d171fabb9991bb00bd34e30b9c8b50992'}, 'tags': [], 'refs': [['opportunity_history_xf'], ['opp_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.484157, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.mql_date_history_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        lead_history_xf.lead_id,\r\n        lead_history_xf.field_modified_at,\r\n        lead_history_xf.field,\r\n        lead_history_xf.old_value,\r\n        lead_history_xf.new_value,\r\n        'lead' AS type\r\n    FROM {{ref('lead_history_xf')}}\r\n    LEFT JOIN {{ref('lead_source_xf')}} ON \r\n    lead_history_xf.lead_id=lead_source_xf.lead_id\r\n    WHERE mql_most_recent_date IS null\r\n    AND field ='X9883_Lead_Score__c'\r\n    AND new_value::Decimal >= '50.0'\r\n    AND old_value::Decimal < '50.0'\r\n    UNION ALL\r\n    SELECT \r\n        contact_history_xf.contact_id,\r\n        contact_history_xf.field_modified_at,\r\n        contact_history_xf.field,\r\n        contact_history_xf.old_value,\r\n        contact_history_xf.new_value,\r\n        'contact' AS type\r\n    FROM {{ref('contact_history_xf')}}\r\n    LEFT JOIN {{ref('contact_source_xf')}} ON \r\n    contact_history_xf.contact_id=contact_source_xf.contact_id\r\n    WHERE mql_most_recent_date IS null\r\n    AND field ='X9883_Lead_Score__c'\r\n    AND new_value::Decimal >= '50.0'\r\n    AND old_value::Decimal < '50.0'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        lead_id,\r\n        old_value,\r\n        new_value,\r\n        field_modified_at,\r\n        type,\r\n        ROW_NUMBER() OVER(PARTITION BY lead_id ORDER BY field_modified_at) AS event_number\r\n    FROM base \r\n    ORDER BY lead_id,field_modified_at\r\n\r\n)\r\n\r\nSELECT \r\n    lead_id,\r\n    old_value,\r\n    new_value,\r\n    field_modified_at,\r\n    type\r\nFROM final\r\nWHERE event_number = 1", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.lead_history_xf', 'model.acton_marketing_data.lead_source_xf', 'model.acton_marketing_data.contact_history_xf', 'model.acton_marketing_data.contact_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel_date_updates', 'mql_date_history_xf'], 'unique_id': 'model.acton_marketing_data.mql_date_history_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel_date_updates/mql_date_history_xf.sql', 'original_file_path': 'models/funnel_date_updates/mql_date_history_xf.sql', 'name': 'mql_date_history_xf', 'alias': 'mql_date_history_xf', 'checksum': {'name': 'sha256', 'checksum': '1fa54ddfad8a80b7b3f7fb1a43b21da6962577f6eb862d0053ed6c6b9cdf2da7'}, 'tags': [], 'refs': [['lead_history_xf'], ['lead_source_xf'], ['contact_history_xf'], ['contact_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4865692, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opp_discovery_date_history_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        opportunity_history_xf.opportunity_id,\r\n        opp_source_xf.type AS opp_type,\r\n        opportunity_history_xf.field_modified_at,\r\n        opportunity_history_xf.field,\r\n        opportunity_history_xf.old_value,\r\n        opportunity_history_xf.new_value\r\n    FROM {{ref('opportunity_history_xf')}}\r\n    LEFT JOIN {{ref('opp_source_xf')}} ON \r\n    opportunity_history_xf.opportunity_id=opp_source_xf.opportunity_id\r\n    WHERE discovery_date IS null\r\n    AND type IN ('New Business','UpSell','Renewal')\r\n    AND field_modified_at >= '2021-01-01'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        opportunity_id,\r\n        opp_type,\r\n        old_value,\r\n        new_value,\r\n        field_modified_at,\r\n        ROW_NUMBER() OVER(PARTITION BY opportunity_id ORDER BY field_modified_at) AS event_number\r\n    FROM base \r\n    WHERE field = 'StageName'\r\n    AND new_value = 'Discovery'\r\n    ORDER BY opportunity_id,field_modified_at\r\n\r\n)\r\n\r\nSELECT \r\n    opportunity_id,\r\n    opp_type,\r\n    old_value,\r\n    new_value,\r\n    field_modified_at\r\nFROM final\r\nWHERE event_number = 1", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opportunity_history_xf', 'model.acton_marketing_data.opp_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel_date_updates', 'opp_discovery_date_history_xf'], 'unique_id': 'model.acton_marketing_data.opp_discovery_date_history_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel_date_updates/opp_discovery_date_history_xf.sql', 'original_file_path': 'models/funnel_date_updates/opp_discovery_date_history_xf.sql', 'name': 'opp_discovery_date_history_xf', 'alias': 'opp_discovery_date_history_xf', 'checksum': {'name': 'sha256', 'checksum': 'ca75cbfea918629a628d0408b6cd880e5b28ad86ecb9cb31f6c52248c00546a0'}, 'tags': [], 'refs': [['opportunity_history_xf'], ['opp_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4890573, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opp_voc_date_history_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        opportunity_history_xf.opportunity_id,\r\n        opp_source_xf.type AS opp_type,\r\n        opportunity_history_xf.field_modified_at,\r\n        opportunity_history_xf.field,\r\n        opportunity_history_xf.old_value,\r\n        opportunity_history_xf.new_value\r\n    FROM {{ref('opportunity_history_xf')}}\r\n    LEFT JOIN {{ref('opp_source_xf')}} ON \r\n    opportunity_history_xf.opportunity_id=opp_source_xf.opportunity_id\r\n    WHERE voc_date IS null\r\n    AND type IN ('New Business','UpSell','Renewal')\r\n    AND field_modified_at >= '2021-01-01'\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n        opportunity_id,\r\n        opp_type,\r\n        old_value,\r\n        new_value,\r\n        field_modified_at,\r\n        ROW_NUMBER() OVER(PARTITION BY opportunity_id ORDER BY field_modified_at) AS event_number\r\n    FROM base \r\n    WHERE field = 'StageName'\r\n    AND new_value = 'VOC/Negotiate'\r\n    ORDER BY opportunity_id,field_modified_at\r\n\r\n)\r\n\r\nSELECT \r\n    opportunity_id,\r\n    opp_type,\r\n    old_value,\r\n    new_value,\r\n    field_modified_at\r\nFROM final\r\nWHERE event_number = 1", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opportunity_history_xf', 'model.acton_marketing_data.opp_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'funnel_date_updates', 'opp_voc_date_history_xf'], 'unique_id': 'model.acton_marketing_data.opp_voc_date_history_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'funnel_date_updates/opp_voc_date_history_xf.sql', 'original_file_path': 'models/funnel_date_updates/opp_voc_date_history_xf.sql', 'name': 'opp_voc_date_history_xf', 'alias': 'opp_voc_date_history_xf', 'checksum': {'name': 'sha256', 'checksum': 'e701d2c0e23a2a3a8b16eae103e6cc492abfd149e6db81c8ad4c173b2d2108cb'}, 'tags': [], 'refs': [['opportunity_history_xf'], ['opp_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4912038, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.marketo_persons_influenced': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        email,\r\n        global_region,\r\n        marketing_created_date,\r\n        mql_most_recent_date,\r\n        campaign_first_touch,\r\n        campaign_last_touch,\r\n        campaign_lead_creation,\r\n        offer_asset_name_first_touch,\r\n        offer_asset_name_last_touch,\r\n        offer_asset_name_lead_creation,\r\n        offer_asset_subtype_first_touch,\r\n        offer_asset_subtype_last_touch,\r\n        offer_asset_subtype_lead_creation,\r\n        offer_asset_topic_first_touch,\r\n        offer_asset_topic_last_touch,\r\n        offer_asset_topic_lead_creation,\r\n        offer_asset_type_first_touch,\r\n        offer_asset_type_last_touch,\r\n        offer_asset_type_lead_creation\r\n    FROM {{ref('person_source_xf')}}\r\n    WHERE (campaign_first_touch LIKE 'marketo ap'\r\n        OR campaign_last_touch LIKE 'marketo ap'\r\n        OR campaign_lead_creation LIKE 'marketo ap')\r\n    \r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.person_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'campaign_reporting', 'marketo_persons_influenced'], 'unique_id': 'model.acton_marketing_data.marketo_persons_influenced', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'campaign_reporting/marketo_persons_influenced.sql', 'original_file_path': 'models/campaign_reporting/marketo_persons_influenced.sql', 'name': 'marketo_persons_influenced', 'alias': 'marketo_persons_influenced', 'checksum': {'name': 'sha256', 'checksum': '1bdfd636dc7fac522d708cca7ca851146290de4bc0b3547a73720157673496a5'}, 'tags': [], 'refs': [['person_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4935694, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.campaign_primary_source': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n    --Campaign Info\r\n        campaign_member.campaign_id,\r\n        campaign.campaign_name,\r\n        campaign.campaign_start_date,\r\n        campaign.campaign_end_date,\r\n        campaign.budgeted_cost,\r\n        campaign.actual_cost,\r\n        campaign.campaign_type,\r\n        campaign.campaign_status,\r\n        campaign.is_active_campaign,\r\n\r\n    --Parent Campaign Info\r\n        campaign.parent_campaign_id,\r\n        campaign.parent_campaign_name,\r\n        campaign.parent_campaign_start_date,\r\n        campaign.parent_campaign_end_date,\r\n        campaign.parent_budgeted_cost,\r\n        campaign.parent_actual_cost,\r\n        campaign.parent_campaign_type,\r\n        campaign.parent_campaign_status,\r\n        campaign.is_active_parent_campaign,\r\n\r\n    --Campaign Member Info\r\n        campaign_member.lead_or_contact_id,\r\n        campaign_member.campaign_member_id,\r\n        campaign_member.campaign_member_status,\r\n        campaign_member.campaign_member_type,\r\n        campaign_member.campaign_member_has_responded,\r\n        campaign_member.campaign_member_created_date,\r\n        campaign_member.campaign_member_first_responded_date,\r\n\r\n    --Person Info\r\n        person.email,\r\n        person.person_status,\r\n        person.lead_score,\r\n        person.mql_most_recent_date,\r\n        person.working_date,\r\n\r\n    --Account Info\r\n        person.lean_data_account_id AS account_id,\r\n        COALESCE(account.account_name,person.company) AS account_name,\r\n        account.account_owner_name,\r\n        account.account_csm_name,\r\n        COALESCE(account.global_region,person.global_region) AS global_region,\r\n        account.executive_sponsor,\r\n        account.assigned_account_tier,\r\n        account.customer_since,\r\n        account.renewal_date,\r\n        account.business_model,\r\n        account.contract_type,\r\n        account.delivered_support_tier,\r\n        COALESCE(account.industry,person.industry) AS industry,\r\n        COALESCE(account.industry_bucket,person.industry_bucket) AS industry_bucket,\r\n        COALESCE(account.company_size_rev,person.company_size_rev) AS company_size_rev,\r\n        COALESCE(account.segment,person.segment) AS segment,\r\n        account.account_type,\r\n        account.is_current_customer,\r\n\r\n    --Opportunity Info\r\n        campaign_influence.influence_opportunity_id AS opportunity_id,\r\n        opp.opportunity_name,\r\n        opp.acv AS acv_deal_size_usd,\r\n        opp.created_date,\r\n        opp.discovery_date,\r\n        opp.close_date,\r\n        opp.type AS opp_type,\r\n        opp.is_closed,\r\n        opp.is_won,\r\n        CASE \r\n            WHEN is_won = true THEN influence_opportunity_id\r\n            END AS won_opportunity_id,\r\n        CASE \r\n            WHEN is_won = true THEN acv\r\n            END AS won_opportunity_acv\r\nFROM {{ref('campaign_member_source_xf')}} campaign_member\r\nLEFT JOIN {{ref('campaign_source_xf')}} campaign\r\nON campaign_member.campaign_id=campaign.campaign_id\r\nLEFT JOIN {{ref('person_source_xf')}} person\r\nON campaign_member.lead_or_contact_id=person.person_id\r\nLEFT JOIN {{ref('account_source_xf')}} account\r\nON person.lean_data_account_id=account.account_id\r\nLEFT JOIN {{ref('campaign_influence_xf')}} campaign_influence\r\nON campaign_member.campaign_id=campaign_influence.influence_campaign_id\r\nAND campaign_influence.influence_contact_id=person.person_id\r\nLEFT JOIN {{ref('opp_source_xf')}} opp\r\nON campaign_influence.influence_opportunity_id=opp.opportunity_id\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.campaign_member_source_xf', 'model.acton_marketing_data.campaign_source_xf', 'model.acton_marketing_data.person_source_xf', 'model.acton_marketing_data.account_source_xf', 'model.acton_marketing_data.campaign_influence_xf', 'model.acton_marketing_data.opp_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'campaign_reporting', 'campaign_primary_source'], 'unique_id': 'model.acton_marketing_data.campaign_primary_source', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'campaign_reporting/campaign_primary_source.sql', 'original_file_path': 'models/campaign_reporting/campaign_primary_source.sql', 'name': 'campaign_primary_source', 'alias': 'campaign_primary_source', 'checksum': {'name': 'sha256', 'checksum': '250663c5818675d42873170deb2226d4c8fb6ba6c636de26dd7bfb23b9dbd93a'}, 'tags': [], 'refs': [['campaign_member_source_xf'], ['campaign_source_xf'], ['person_source_xf'], ['account_source_xf'], ['campaign_influence_xf'], ['opp_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.4955664, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.first_touch': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type\r\n    FROM {{ref('ao_combined')}}\r\n\r\n), first_touch_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        ROW_NUMBER() OVER (PARTITION BY email ORDER BY action_time ASC ) AS touchpoint_number\r\n    FROM base\r\n\r\n)\r\n\r\nSELECT\r\n    email,\r\n    touchpoint_id,\r\n    action,\r\n    action_time,\r\n    action_day,\r\n    asset_id,\r\n    asset_title,\r\n    subject_line,\r\n    from_address,\r\n    clicked_url,\r\n    clickthrough_link_name,\r\n    referral_url,\r\n    event_id,\r\n    asset_type,\r\n    'FT' AS ft_position,\r\n    1 AS first_touch_weight,\r\n    .5 AS u_shaped_weight,\r\n    .3 AS w_shaped_weight,\r\n    .225 AS full_path_weight\r\nFROM first_touch_base\r\nWHERE touchpoint_number = 1", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.ao_combined']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'attribution', 'attribution_models', 'first_touch'], 'unique_id': 'model.acton_marketing_data.first_touch', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'attribution/attribution_models/first_touch.sql', 'original_file_path': 'models/attribution/attribution_models/first_touch.sql', 'name': 'first_touch', 'alias': 'first_touch', 'checksum': {'name': 'sha256', 'checksum': '32dac25dcc79d4e4c31302ee2eec67a6c9248be76ce38e115e788731af54fab5'}, 'tags': [], 'refs': [['ao_combined']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.499135, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.lead_creation': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type\r\n    FROM {{ref(\'ao_combined\')}}\r\n    WHERE asset_type = \'form\'\r\n\r\n), person_source_prep AS (\r\n\r\n    SELECT\r\n        email,\r\n        {{ dbt_date.convert_timezone("created_date::Timestamp", "America/Los_Angeles") }} AS created_date\r\n    FROM {{ref(\'person_source_xf\')}}\r\n\r\n), person_source AS (\r\n\r\n    SELECT\r\n        email,\r\n        created_date::Date AS created_date\r\n    FROM person_source_prep\r\n\r\n), lead_creation_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        base.email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        ROW_NUMBER() OVER (PARTITION BY base.email ORDER BY action_time ASC ) AS touchpoint_number\r\n    FROM base\r\n    LEFT JOIN person_source person ON\r\n    base.email=person.email\r\n    WHERE action_day=person.created_date\r\n\r\n)\r\n\r\nSELECT\r\n    touchpoint_id,\r\n    action,\r\n    action_time,\r\n    action_day,\r\n    asset_id,\r\n    email,\r\n    asset_title,\r\n    subject_line,\r\n    from_address,\r\n    clicked_url,\r\n    clickthrough_link_name,\r\n    referral_url,\r\n    event_id,\r\n    asset_type,\r\n    \'LC\' AS lc_position,\r\n    1 AS lead_creation_weight,\r\n    .5 AS u_shaped_weight,\r\n    .3 AS w_shaped_weight,\r\n    .225 AS full_path_weight\r\nFROM lead_creation_base\r\nWHERE touchpoint_number = 1', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_date.convert_timezone'], 'nodes': ['model.acton_marketing_data.ao_combined', 'model.acton_marketing_data.person_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'attribution', 'attribution_models', 'lead_creation'], 'unique_id': 'model.acton_marketing_data.lead_creation', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'attribution/attribution_models/lead_creation.sql', 'original_file_path': 'models/attribution/attribution_models/lead_creation.sql', 'name': 'lead_creation', 'alias': 'lead_creation', 'checksum': {'name': 'sha256', 'checksum': 'c1fbb2f0810a24e648562839dd735fea0cfacc387b686e9a92ac0b72639205ad'}, 'tags': [], 'refs': [['ao_combined'], ['person_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5011396, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.last_touch': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type\r\n    FROM {{ref('ao_combined')}}\r\n\r\n), last_touch_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        ROW_NUMBER() OVER (PARTITION BY email ORDER BY action_time DESC ) AS touchpoint_number\r\n    FROM base\r\n\r\n)\r\n\r\nSELECT\r\n    touchpoint_id,\r\n    action,\r\n    action_time,\r\n    action_day,\r\n    asset_id,\r\n    email,\r\n    asset_title,\r\n    subject_line,\r\n    from_address,\r\n    clicked_url,\r\n    clickthrough_link_name,\r\n    referral_url,\r\n    event_id,\r\n    asset_type,\r\n    'LT' AS lt_position,\r\n    1 AS last_touch_weight\r\nFROM last_touch_base\r\nWHERE touchpoint_number = 1", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.ao_combined']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'attribution', 'attribution_models', 'last_touch'], 'unique_id': 'model.acton_marketing_data.last_touch', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'attribution/attribution_models/last_touch.sql', 'original_file_path': 'models/attribution/attribution_models/last_touch.sql', 'name': 'last_touch', 'alias': 'last_touch', 'checksum': {'name': 'sha256', 'checksum': '639e80b63522e80bd1d8c2b39e406e104d679ec998c03ef147d70aa509ae0813'}, 'tags': [], 'refs': [['ao_combined']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5071313, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.lead_creation2': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type\r\n    FROM {{ref(\'ao_combined\')}}\r\n\r\n), person_source_prep AS (\r\n\r\n    SELECT\r\n        email,\r\n        {{ dbt_date.convert_timezone("created_date::Timestamp", "America/Los_Angeles") }} AS created_date\r\n    FROM {{ref(\'person_source_xf\')}}\r\n\r\n), person_source AS (\r\n\r\n    SELECT\r\n        email,\r\n        created_date::Date AS created_date\r\n    FROM person_source_prep\r\n\r\n), lead_creation_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        base.email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        ROW_NUMBER() OVER (PARTITION BY base.email ORDER BY action_time ASC ) AS touchpoint_number\r\n    FROM base\r\n    LEFT JOIN person_source person ON\r\n    base.email=person.email\r\n    WHERE action_day=person.created_date\r\n    AND asset_type = \'form\'\r\n\r\n), linear_base AS (\r\n\r\n    SELECT\r\n        email,\r\n        COUNT(DISTINCT touchpoint_id) AS linear_touches\r\n    FROM base\r\n    GROUP BY 1\r\n)\r\n\r\nSELECT\r\n    base.touchpoint_id,\r\n    base.action,\r\n    base.action_time,\r\n    base.action_day,\r\n    base.asset_id,\r\n    base.email,\r\n    base.asset_title,\r\n    base.subject_line,\r\n    base.from_address,\r\n    base.clicked_url,\r\n    base.clickthrough_link_name,\r\n    base.referral_url,\r\n    base.event_id,\r\n    base.asset_type,\r\n    touchpoint_number,\r\n    linear_touches,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN \'LC\' \r\n        ELSE null\r\n    END AS lc_position,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN 1\r\n        ELSE 0\r\n    END AS lead_creation_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .5\r\n        ELSE 0\r\n    END AS u_shaped_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .3 \r\n        WHEN linear_touches = 1 THEN .1\r\n        ELSE (.1/SUM(linear_touches-1))\r\n    END AS w_shaped_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .225 \r\n        WHEN linear_touches = 1 THEN .1\r\n        ELSE (.1/SUM(linear_touches-1))\r\n    END AS full_path_weight\r\nFROM base\r\nLEFT JOIN lead_creation_base ON\r\nbase.touchpoint_id=lead_creation_base.touchpoint_id\r\nLEFT JOIN linear_base ON\r\nbase.email=linear_base.email\r\n{{ dbt_utils.group_by(n=19) }}', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_date.convert_timezone', 'macro.dbt_utils.group_by'], 'nodes': ['model.acton_marketing_data.ao_combined', 'model.acton_marketing_data.person_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'attribution', 'attribution_models', 'lead_creation2'], 'unique_id': 'model.acton_marketing_data.lead_creation2', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'attribution/attribution_models/lead_creation2.sql', 'original_file_path': 'models/attribution/attribution_models/lead_creation2.sql', 'name': 'lead_creation2', 'alias': 'lead_creation2', 'checksum': {'name': 'sha256', 'checksum': 'bb535fc75a48ffeeea1d304ab4ce740454e27075d72fea917a1a674ac48943d9'}, 'tags': [], 'refs': [['ao_combined'], ['person_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5093734, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.first_touch2': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type\r\n    FROM {{ref('ao_combined')}}\r\n\r\n), first_touch_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        ROW_NUMBER() OVER (PARTITION BY email ORDER BY action_time ASC ) AS touchpoint_number\r\n    FROM base\r\n\r\n), linear_base AS (\r\n\r\n    SELECT\r\n        email,\r\n        COUNT(DISTINCT touchpoint_id) AS linear_touches\r\n    FROM base\r\n    GROUP BY 1\r\n)\r\n\r\nSELECT\r\n    first_touch_base.email,\r\n    touchpoint_id,\r\n    action,\r\n    action_time,\r\n    action_day,\r\n    asset_id,\r\n    asset_title,\r\n    subject_line,\r\n    from_address,\r\n    clicked_url,\r\n    clickthrough_link_name,\r\n    referral_url,\r\n    event_id,\r\n    asset_type,\r\n    touchpoint_number,\r\n    linear_touches,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN 'FT' \r\n        ELSE null\r\n    END AS ft_position,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN 1\r\n        ELSE 0\r\n    END AS first_touch_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .5\r\n        ELSE 0\r\n    END AS u_shaped_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .3 \r\n        WHEN linear_touches = 1 THEN .1\r\n        ELSE (.1/SUM(linear_touches-1))\r\n    END AS w_shaped_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .225 \r\n        WHEN linear_touches = 1 THEN .1\r\n        ELSE (.1/SUM(linear_touches-1))\r\n    END AS full_path_weight\r\nFROM first_touch_base\r\nLEFT JOIN linear_base ON\r\nfirst_touch_base.email=linear_base.email\r\n{{ dbt_utils.group_by(n=19) }}", 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.group_by'], 'nodes': ['model.acton_marketing_data.ao_combined']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'attribution', 'attribution_models', 'first_touch2'], 'unique_id': 'model.acton_marketing_data.first_touch2', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'attribution/attribution_models/first_touch2.sql', 'original_file_path': 'models/attribution/attribution_models/first_touch2.sql', 'name': 'first_touch2', 'alias': 'first_touch2', 'checksum': {'name': 'sha256', 'checksum': '84762c0fe4770c3ab5fd6c1fab199489ba466ba7139b81fd09c499614dc9054b'}, 'tags': [], 'refs': [['ao_combined']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5160983, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opportunity_creation2': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type\r\n    FROM {{ref('ao_combined')}}\r\n\r\n), opp_creation_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        base.email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        ROW_NUMBER() OVER (PARTITION BY cohort.opportunity_id ORDER BY action_time ASC ) AS touchpoint_number\r\n    FROM base\r\n    LEFT JOIN {{ref('lead_to_cw_cohort')}} cohort ON\r\n    base.email=cohort.email\r\n    WHERE action_day <= cohort.opp_created_date\r\n\r\n), linear_base AS (\r\n\r\n    SELECT\r\n        email,\r\n        COUNT(DISTINCT touchpoint_id) AS linear_touches\r\n    FROM base\r\n    GROUP BY 1\r\n)\r\n\r\nSELECT\r\n    base.touchpoint_id,\r\n    base.action,\r\n    base.action_time,\r\n    base.action_day,\r\n    base.asset_id,\r\n    base.email,\r\n    base.asset_title,\r\n    base.subject_line,\r\n    base.from_address,\r\n    base.clicked_url,\r\n    base.clickthrough_link_name,\r\n    base.referral_url,\r\n    base.event_id,\r\n    base.asset_type,\r\n    touchpoint_number,\r\n    linear_touches,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN 'OC' \r\n        ELSE null\r\n    END AS oc_position,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN 1\r\n        ELSE 0\r\n    END AS opp_creation_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .3 \r\n        WHEN linear_touches = 1 THEN .1\r\n        ELSE (.1/SUM(linear_touches-1))\r\n    END AS w_shaped_weight,\r\n    CASE\r\n        WHEN touchpoint_number = 1 THEN .225 \r\n        WHEN linear_touches = 1 THEN .1\r\n        ELSE (.1/SUM(linear_touches-1))\r\n    END AS full_path_weight\r\nFROM base\r\nLEFT JOIN opp_creation_base ON\r\nbase.touchpoint_id=opp_creation_base.touchpoint_id\r\nLEFT JOIN linear_base ON \r\nbase.email=linear_base.email\r\n{{ dbt_utils.group_by(n=18) }}", 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.group_by'], 'nodes': ['model.acton_marketing_data.ao_combined', 'model.acton_marketing_data.lead_to_cw_cohort']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'attribution', 'attribution_models', 'opportunity_creation2'], 'unique_id': 'model.acton_marketing_data.opportunity_creation2', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'attribution/attribution_models/opportunity_creation2.sql', 'original_file_path': 'models/attribution/attribution_models/opportunity_creation2.sql', 'name': 'opportunity_creation2', 'alias': 'opportunity_creation2', 'checksum': {'name': 'sha256', 'checksum': '429574952a68eb826a2f0f53eb6e4009e7a73e78c24c62762e4db001ebacf361'}, 'tags': [], 'refs': [['ao_combined'], ['lead_to_cw_cohort']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5216873, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.custom_model': {'raw_sql': '', 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': []}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'attribution', 'attribution_models', 'custom_model'], 'unique_id': 'model.acton_marketing_data.custom_model', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'attribution/attribution_models/custom_model.sql', 'original_file_path': 'models/attribution/attribution_models/custom_model.sql', 'name': 'custom_model', 'alias': 'custom_model', 'checksum': {'name': 'sha256', 'checksum': 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855'}, 'tags': [], 'refs': [], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5273457, 'config_call_dict': {}}, 'model.acton_marketing_data.combined_attribution2': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH ao_combined AS (\r\n\r\n   SELECT *\r\n   FROM {{ref('ao_combined')}} \r\n\r\n), lead_creation AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('lead_creation2')}}\r\n\r\n), first_touch AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('first_touch2')}}\r\n\r\n), last_touch AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('last_touch')}}\r\n\r\n), opportunity_creation AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('opportunity_creation2')}}\r\n\r\n), linear_base AS (\r\n\r\n    SELECT\r\n        email,\r\n        COUNT(DISTINCT touchpoint_id)::Decimal AS linear_touches\r\n    FROM ao_combined\r\n    GROUP BY 1\r\n        \r\n), linear_final AS (\r\n\r\n    SELECT\r\n        ao_combined.email,\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        1/linear_touches AS linear_weight\r\n    FROM ao_combined\r\n    LEFT JOIN linear_base ON \r\n    ao_combined.email=linear_base.email\r\n\r\n), unioned AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        0 AS first_touch_weight,\r\n        0 AS lead_creation_weight,\r\n        opp_creation_weight,\r\n        0 AS u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight\r\n    FROM opportunity_creation\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        0 AS first_touch_weight,\r\n        lead_creation_weight,\r\n        0 AS opp_creation_weight,\r\n        u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight\r\n    FROM lead_creation\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        first_touch_weight,\r\n        0 AS lead_creation_weight,\r\n        0 AS opp_creation_weight,\r\n        u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight\r\n    FROM first_touch\r\n\r\n), unioned_final AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        SUM(first_touch_weight) AS first_touch_weight,\r\n        SUM(lead_creation_weight) AS lead_creation_weight,\r\n        SUM(opp_creation_weight) AS opp_creation_weight,\r\n        SUM(u_shaped_weight) AS u_shaped_weight,\r\n        SUM(w_shaped_weight) AS w_shaped_weight,\r\n        SUM(full_path_weight) AS full_path_weight\r\n    FROM unioned\r\n    GROUP BY 1\r\n\r\n), final_prep AS (\r\n\r\n    SELECT\r\n        linear_final.touchpoint_id,\r\n        first_touch_weight,\r\n        lead_creation_weight,\r\n        opp_creation_weight,\r\n        u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight,\r\n        linear_weight\r\n    FROM linear_final\r\n    LEFT JOIN unioned_final ON\r\n    unioned_final.touchpoint_id=linear_final.touchpoint_id\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n    -- Key IDs\r\n        lead_to_cw_cohort.email,\r\n        ao_combined.touchpoint_id,\r\n        opportunity_id,\r\n        person_id,\r\n\r\n    -- Dates\r\n        person_created_date,\r\n        marketing_created_date,\r\n        mql_created_date,\r\n        sal_created_date,\r\n        opp_created_date,\r\n        discovery_date,\r\n        demo_date,\r\n        voc_date,\r\n        closing_date,\r\n        ao_combined.action_time,\r\n        ao_combined.action_day,\r\n\r\n    --Opportunity Information\r\n        lead_to_cw_cohort.acv,\r\n\r\n    --Touchpoint Information\r\n        ao_combined.action,\r\n        ao_combined.asset_id,\r\n        ao_combined.asset_title,\r\n        ao_combined.subject_line,\r\n        ao_combined.from_address,\r\n        ao_combined.clicked_url,\r\n        ao_combined.clickthrough_link_name,\r\n        ao_combined.referral_url,\r\n        ao_combined.event_id,\r\n        ao_combined.asset_type,\r\n        CONCAT_WS(',',first_touch.ft_position,lead_creation.lc_position,opportunity_creation.oc_position,last_touch.lt_position) AS touchpoint_position,\r\n\r\n    --Touchpoint Weights\r\n        final_prep.first_touch_weight,\r\n        final_prep.lead_creation_weight,\r\n        final_prep.opp_creation_weight,\r\n        final_prep.u_shaped_weight,\r\n        final_prep.w_shaped_weight,\r\n        final_prep.full_path_weight,\r\n        final_prep.linear_weight,\r\n\r\n    --Touchpoint ACV Weights\r\n        lead_to_cw_cohort.acv*final_prep.first_touch_weight AS first_touch_acv,\r\n        lead_to_cw_cohort.acv*final_prep.lead_creation_weight AS lead_creation_acv,\r\n        lead_to_cw_cohort.acv*final_prep.opp_creation_weight AS opp_creation_acv,\r\n        lead_to_cw_cohort.acv*final_prep.u_shaped_weight AS u_shaped_acv,\r\n        lead_to_cw_cohort.acv*final_prep.w_shaped_weight AS w_shaped_acv,\r\n        lead_to_cw_cohort.acv*final_prep.full_path_weight AS full_path_acv,\r\n        lead_to_cw_cohort.acv*final_prep.linear_weight AS linear_acv\r\n    FROM ao_combined\r\n    LEFT JOIN final_prep ON\r\n    ao_combined.touchpoint_id=final_prep.touchpoint_id\r\n    LEFT JOIN {{ref('lead_to_cw_cohort')}} ON\r\n    ao_combined.email=lead_to_cw_cohort.email\r\n    LEFT JOIN lead_creation ON \r\n    ao_combined.touchpoint_id=lead_creation.touchpoint_id\r\n    LEFT JOIN opportunity_creation ON \r\n    ao_combined.touchpoint_id=opportunity_creation.touchpoint_id\r\n    LEFT JOIN first_touch ON \r\n    ao_combined.touchpoint_id=first_touch.touchpoint_id\r\n    LEFT JOIN last_touch ON \r\n    ao_combined.touchpoint_id=last_touch.touchpoint_id\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.ao_combined', 'model.acton_marketing_data.lead_creation2', 'model.acton_marketing_data.first_touch2', 'model.acton_marketing_data.last_touch', 'model.acton_marketing_data.opportunity_creation2', 'model.acton_marketing_data.lead_to_cw_cohort']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'attribution', 'attribution_models', 'combined_attribution2'], 'unique_id': 'model.acton_marketing_data.combined_attribution2', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'attribution/attribution_models/combined_attribution2.sql', 'original_file_path': 'models/attribution/attribution_models/combined_attribution2.sql', 'name': 'combined_attribution2', 'alias': 'combined_attribution2', 'checksum': {'name': 'sha256', 'checksum': 'e74be2568db1ad1151b27c2993c3e5e2686e2be9ec0bf417697f2771f200c845'}, 'tags': [], 'refs': [['ao_combined'], ['lead_creation2'], ['first_touch2'], ['last_touch'], ['opportunity_creation2'], ['lead_to_cw_cohort']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5294085, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.combined_attribution': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH ao_combined AS (\r\n\r\n   SELECT *\r\n   FROM {{ref('ao_combined')}} \r\n\r\n), lead_creation AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('lead_creation')}}\r\n\r\n), first_touch AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('first_touch')}}\r\n\r\n), last_touch AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('last_touch')}}\r\n\r\n), opportunity_creation AS (\r\n\r\n    SELECT *\r\n    FROM {{ref('opportunity_creation')}}\r\n\r\n), linear_base AS (\r\n\r\n    SELECT\r\n        email,\r\n        COUNT(DISTINCT touchpoint_id)::Decimal AS linear_touches\r\n    FROM ao_combined\r\n    GROUP BY 1\r\n        \r\n), linear_final AS (\r\n\r\n    SELECT\r\n        ao_combined.email,\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        1/linear_touches AS linear_weight\r\n    FROM ao_combined\r\n    LEFT JOIN linear_base ON \r\n    ao_combined.email=linear_base.email\r\n\r\n), unioned AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        0 AS first_touch_weight,\r\n        0 AS lead_creation_weight,\r\n        opp_creation_weight,\r\n        0 AS u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight\r\n    FROM opportunity_creation\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        0 AS first_touch_weight,\r\n        lead_creation_weight,\r\n        0 AS opp_creation_weight,\r\n        u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight\r\n    FROM lead_creation\r\n    UNION ALL\r\n    SELECT\r\n        touchpoint_id,\r\n        first_touch_weight,\r\n        0 AS lead_creation_weight,\r\n        0 AS opp_creation_weight,\r\n        u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight\r\n    FROM first_touch\r\n\r\n), unioned_final AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        SUM(first_touch_weight) AS first_touch_weight,\r\n        SUM(lead_creation_weight) AS lead_creation_weight,\r\n        SUM(opp_creation_weight) AS opp_creation_weight,\r\n        SUM(u_shaped_weight) AS u_shaped_weight,\r\n        SUM(w_shaped_weight) AS w_shaped_weight,\r\n        SUM(full_path_weight) AS full_path_weight\r\n    FROM unioned\r\n    GROUP BY 1\r\n\r\n), final_prep AS (\r\n\r\n    SELECT\r\n        linear_final.touchpoint_id,\r\n        first_touch_weight,\r\n        lead_creation_weight,\r\n        opp_creation_weight,\r\n        u_shaped_weight,\r\n        w_shaped_weight,\r\n        full_path_weight,\r\n        linear_weight\r\n    FROM linear_final\r\n    LEFT JOIN unioned_final ON\r\n    unioned_final.touchpoint_id=linear_final.touchpoint_id\r\n\r\n), final AS (\r\n\r\n    SELECT\r\n    -- Key IDs\r\n        lead_to_cw_cohort.email,\r\n        ao_combined.touchpoint_id,\r\n        opportunity_id,\r\n        person_id,\r\n\r\n    -- Dates\r\n        person_created_date,\r\n        marketing_created_date,\r\n        mql_created_date,\r\n        sal_created_date,\r\n        opp_created_date,\r\n        discovery_date,\r\n        demo_date,\r\n        voc_date,\r\n        closing_date,\r\n        ao_combined.action_time,\r\n        ao_combined.action_day,\r\n\r\n    --Opportunity Information\r\n        lead_to_cw_cohort.acv,\r\n\r\n    --Touchpoint Information\r\n        ao_combined.action,\r\n        ao_combined.asset_id,\r\n        ao_combined.asset_title,\r\n        ao_combined.subject_line,\r\n        ao_combined.from_address,\r\n        ao_combined.clicked_url,\r\n        ao_combined.clickthrough_link_name,\r\n        ao_combined.referral_url,\r\n        ao_combined.event_id,\r\n        ao_combined.asset_type,\r\n        CONCAT_WS(',',first_touch.ft_position,lead_creation.lc_position,opportunity_creation.oc_position,last_touch.lt_position) AS touchpoint_position,\r\n\r\n    --Touchpoint Weights\r\n        final_prep.first_touch_weight,\r\n        final_prep.lead_creation_weight,\r\n        final_prep.opp_creation_weight,\r\n        final_prep.u_shaped_weight,\r\n        final_prep.w_shaped_weight,\r\n        final_prep.full_path_weight,\r\n        final_prep.linear_weight,\r\n\r\n    --Touchpoint ACV Weights\r\n        lead_to_cw_cohort.acv*final_prep.first_touch_weight AS first_touch_acv,\r\n        lead_to_cw_cohort.acv*final_prep.lead_creation_weight AS lead_creation_acv,\r\n        lead_to_cw_cohort.acv*final_prep.opp_creation_weight AS opp_creation_acv,\r\n        lead_to_cw_cohort.acv*final_prep.u_shaped_weight AS u_shaped_acv,\r\n        lead_to_cw_cohort.acv*final_prep.w_shaped_weight AS w_shaped_acv,\r\n        lead_to_cw_cohort.acv*final_prep.full_path_weight AS full_path_acv,\r\n        lead_to_cw_cohort.acv*final_prep.linear_weight AS linear_acv\r\n    FROM ao_combined\r\n    LEFT JOIN final_prep ON\r\n    ao_combined.touchpoint_id=final_prep.touchpoint_id\r\n    LEFT JOIN {{ref('lead_to_cw_cohort')}} ON\r\n    ao_combined.email=lead_to_cw_cohort.email\r\n    LEFT JOIN lead_creation ON \r\n    ao_combined.touchpoint_id=lead_creation.touchpoint_id\r\n    LEFT JOIN opportunity_creation ON \r\n    ao_combined.touchpoint_id=opportunity_creation.touchpoint_id\r\n    LEFT JOIN first_touch ON \r\n    ao_combined.touchpoint_id=first_touch.touchpoint_id\r\n    LEFT JOIN last_touch ON \r\n    ao_combined.touchpoint_id=last_touch.touchpoint_id\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.ao_combined', 'model.acton_marketing_data.lead_creation', 'model.acton_marketing_data.first_touch', 'model.acton_marketing_data.last_touch', 'model.acton_marketing_data.opportunity_creation', 'model.acton_marketing_data.lead_to_cw_cohort']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'attribution', 'attribution_models', 'combined_attribution'], 'unique_id': 'model.acton_marketing_data.combined_attribution', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'attribution/attribution_models/combined_attribution.sql', 'original_file_path': 'models/attribution/attribution_models/combined_attribution.sql', 'name': 'combined_attribution', 'alias': 'combined_attribution', 'checksum': {'name': 'sha256', 'checksum': '4b62aa2512ef4e7d5cdeae6d05db1868a1a563418bea919ccd69a056a59fa112'}, 'tags': [], 'refs': [['ao_combined'], ['lead_creation'], ['first_touch'], ['last_touch'], ['opportunity_creation'], ['lead_to_cw_cohort']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5324051, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opportunity_creation': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT \r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type\r\n    FROM {{ref('ao_combined')}}\r\n\r\n), opp_creation_base AS (\r\n\r\n    SELECT\r\n        touchpoint_id,\r\n        action,\r\n        action_time,\r\n        action_day,\r\n        asset_id,\r\n        base.email,\r\n        asset_title,\r\n        subject_line,\r\n        from_address,\r\n        clicked_url,\r\n        clickthrough_link_name,\r\n        referral_url,\r\n        event_id,\r\n        asset_type,\r\n        ROW_NUMBER() OVER (PARTITION BY cohort.opportunity_id ORDER BY action_time ASC ) AS touchpoint_number\r\n    FROM base\r\n    LEFT JOIN {{ref('lead_to_cw_cohort')}} cohort ON\r\n    base.email=cohort.email\r\n    WHERE action_day=cohort.opp_created_date\r\n\r\n)\r\n\r\nSELECT\r\n    touchpoint_id,\r\n    action,\r\n    action_time,\r\n    action_day,\r\n    asset_id,\r\n    email,\r\n    asset_title,\r\n    subject_line,\r\n    from_address,\r\n    clicked_url,\r\n    clickthrough_link_name,\r\n    referral_url,\r\n    event_id,\r\n    asset_type,\r\n    'OC' AS oc_position,\r\n    1 AS opp_creation_weight,\r\n    .3 AS w_shaped_weight,\r\n    .225 AS full_path_weight\r\nFROM opp_creation_base\r\nWHERE touchpoint_number = 1", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.ao_combined', 'model.acton_marketing_data.lead_to_cw_cohort']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'attribution', 'attribution_models', 'opportunity_creation'], 'unique_id': 'model.acton_marketing_data.opportunity_creation', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'attribution/attribution_models/opportunity_creation.sql', 'original_file_path': 'models/attribution/attribution_models/opportunity_creation.sql', 'name': 'opportunity_creation', 'alias': 'opportunity_creation', 'checksum': {'name': 'sha256', 'checksum': '678b9419db9434b3503cdf0314e23d8ca938fe0782fa1d8bf4e2c3d572acd55f'}, 'tags': [], 'refs': [['ao_combined'], ['lead_to_cw_cohort']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5351326, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.customer_power_ups': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT DISTINCT\r\n        campaign_member.campaign_id,\r\n        campaign.campaign_name,\r\n        campaign_member.lead_or_contact_id,\r\n        campaign_member.campaign_member_id,\r\n        campaign_member.campaign_member_status,\r\n        campaign_member.campaign_member_created_date,\r\n        person.lean_data_account_id AS account_id,\r\n        person.created_date,\r\n        COALESCE(account.account_name,person.company) AS account_name,\r\n        account.account_owner_name,\r\n        account.account_csm_name,\r\n        COALESCE(account.global_region,person.global_region) AS global_region,\r\n        account.executive_sponsor,\r\n        account.assigned_account_tier,\r\n        account.customer_since,\r\n        account.renewal_date,\r\n        account.business_model,\r\n        account.contract_type,\r\n        account.delivered_support_tier,\r\n        COALESCE(account.industry,person.industry) AS industry,\r\n        COALESCE(account.company_size_rev,person.company_size_rev) AS company_size_rev,\r\n        COALESCE(account.segment,person.segment) AS segment,\r\n        account.account_type,\r\n        account.is_current_customer,\r\n        campaign_influence.influence_opportunity_id AS opportunity_id,\r\n        opp.acv AS acv_deal_size_usd,\r\n        opp.opportunity_name,\r\n        opp.is_won,\r\n        CASE \r\n            WHEN is_won = true THEN influence_opportunity_id\r\n            END AS won_opportunity_id,\r\n        CASE \r\n            WHEN is_won = true THEN acv\r\n            END AS won_opportunity_acv\r\nFROM {{ref('campaign_member_source_xf')}} campaign_member\r\nLEFT JOIN {{ref('campaign_source_xf')}} campaign\r\nON campaign_member.campaign_id=campaign.campaign_id\r\nLEFT JOIN {{ref('person_source_xf')}} person\r\nON campaign_member.lead_or_contact_id=person.person_id\r\nLEFT JOIN {{ref('account_source_xf')}} account\r\nON person.lean_data_account_id=account.account_id\r\nLEFT JOIN {{ref('campaign_influence_xf')}} campaign_influence\r\nON campaign_member.campaign_id=campaign_influence.influence_campaign_id\r\nAND campaign_influence.influence_contact_id=person.person_id\r\nLEFT JOIN {{ref('opp_source_xf')}} opp\r\nON campaign_influence.influence_opportunity_id=opp.opportunity_id\r\nWHERE campaign.parent_campaign_id LIKE '7015Y000002UBBi%'\r\nAND campaign_member_status NOT IN ('Initial','Sent')\r\n)\r\n\r\nSELECT *\r\nFROM base", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.campaign_member_source_xf', 'model.acton_marketing_data.campaign_source_xf', 'model.acton_marketing_data.person_source_xf', 'model.acton_marketing_data.account_source_xf', 'model.acton_marketing_data.campaign_influence_xf', 'model.acton_marketing_data.opp_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'customer_marketing', 'customer_power_ups'], 'unique_id': 'model.acton_marketing_data.customer_power_ups', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'customer_marketing/customer_power_ups.sql', 'original_file_path': 'models/customer_marketing/customer_power_ups.sql', 'name': 'customer_power_ups', 'alias': 'customer_power_ups', 'checksum': {'name': 'sha256', 'checksum': '94bbf8ae330f800d9c00daf25058312f6fc47bbd84e5890d9d0125f272b22c4f'}, 'tags': [], 'refs': [['campaign_member_source_xf'], ['campaign_source_xf'], ['person_source_xf'], ['account_source_xf'], ['campaign_influence_xf'], ['opp_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5375674, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.new_account_welcome_series_list': {'raw_sql': 'WITH opp_and_acct_base AS (\r\n\r\n    SELECT\r\n        opportunity_id,\r\n        opp_source_xf.account_id,\r\n        opportunity_name,\r\n        customer_since,\r\n        account_csm_name,\r\n        account_csm_email,\r\n        account_csm_photo,\r\n        onboarding.user_name AS onboarding_specialist,\r\n        onboarding_specialist_email,\r\n        onboarding_specialist_photo,\r\n        owner.user_name AS account_owner,\r\n        account_owner_email,\r\n        account_owner_photo,\r\n        onboarding_completion_date,\r\n        opp_source_xf.close_date\r\n    FROM {{ref(\'opp_source_xf\')}}\r\n    LEFT JOIN {{ref(\'account_source_xf\')}} ON\r\n    opp_source_xf.account_id=account_source_xf.account_id\r\n    LEFT JOIN {{ref(\'user_source_xf\')}} owner ON\r\n    account_source_xf.account_owner_id=owner.user_id\r\n    LEFT JOIN {{ref(\'user_source_xf\')}} onboarding ON\r\n    account_source_xf.onboarding_specialist=onboarding.user_id\r\n    WHERE stage_name = \'Implement\'\r\n   -- AND is_current_customer = \'true\'\r\n    AND opp_source_xf.account_id != \'0011O00002LeGkEQAV\'\r\n    AND account_type != \'Partner Owned\'\r\n\r\n)\r\n\r\nSELECT DISTINCT\r\n    opp_and_acct_base.opportunity_id,\r\n    opp_and_acct_base.account_id,\r\n    opp_and_acct_base.opportunity_name,\r\n    opp_and_acct_base.customer_since,\r\n    CASE \r\n        WHEN opp_and_acct_base.account_csm_name IS null THEN \'Support\'\r\n        ELSE opp_and_acct_base.account_csm_name \r\n    END AS account_csm_name,\r\n    CASE \r\n        WHEN opp_and_acct_base.account_csm_email IS null THEN \'support@act-on.com\'\r\n        ELSE opp_and_acct_base.account_csm_email \r\n    END AS account_csm_email,\r\n    CASE \r\n        WHEN opp_and_acct_base.account_csm_photo IS null THEN \'https://success.act-on.com/cdnr/forpcid1/acton/attachment/9883/f-fa8432de-9cea-4bf7-b6d4-eca1c9656b82/1/-/-/-/-/NewUserWelcomeSeries-EM3-Support.png\'\r\n        ELSE opp_and_acct_base.account_csm_photo \r\n    END AS account_csm_photo,\r\n    CASE\r\n        WHEN opp_and_acct_base.onboarding_specialist IS null THEN \'marjorie.waniata@act-on.com\'\r\n        ELSE opp_and_acct_base.onboarding_specialist\r\n    END AS onboarding_specialist,\r\n    CASE\r\n        WHEN opp_and_acct_base.onboarding_specialist_email IS null THEN \'marjorie.waniata@act-on.com\'\r\n        ELSE opp_and_acct_base.onboarding_specialist_email\r\n    END AS onboarding_specialist_email,\r\n    CASE \r\n        WHEN opp_and_acct_base.onboarding_specialist_photo IS null THEN \'https://success.act-on.com/cdnr/forpcid1/acton/attachment/9883/f-776f2a0d-032b-406f-9b3b-f4990bc2e601/1/-/-/-/-/Marj_Waniata.png\'\r\n        ELSE opp_and_acct_base.onboarding_specialist_photo\r\n    END AS onboarding_specialist_photo,\r\n    opp_and_acct_base.account_owner,\r\n    opp_and_acct_base.account_owner_email,\r\n    opp_and_acct_base.account_owner_photo,\r\n    contact_source_xf.first_name AS "First Name",\r\n    contact_source_xf.last_name AS "Last Name",\r\n    contact_source_xf.email AS "Email",\r\n    ao_instance_user_source_xf.ao_user_name,\r\n    ao_instance_user_source_xf.ao_user_id,\r\n    ao_instance_user_source_xf.is_marketing_user,\r\n    opp_and_acct_base.onboarding_completion_date,\r\n    ao_instance_user_source_xf.ao_user_created_date\r\nFROM {{ref(\'ao_instance_user_source_xf\')}}\r\nLEFT JOIN {{ref(\'contact_source_xf\')}} ON\r\ncontact_source_xf.contact_id=ao_instance_user_source_xf.ao_user_contact_id\r\nLEFT JOIN opp_and_acct_base ON\r\nopp_and_acct_base.account_id=contact_source_xf.account_id\r\nWHERE 1=1\r\nAND is_marketing_user = \'true\'\r\nAND customer_since > CURRENT_DATE-60\r\nAND ao_user_created_date >= \'2022-06-01\'', 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.account_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.ao_instance_user_source_xf', 'model.acton_marketing_data.contact_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'customer_marketing', 'new_user', 'new_account_welcome_series_list'], 'unique_id': 'model.acton_marketing_data.new_account_welcome_series_list', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'customer_marketing/new_user/new_account_welcome_series_list.sql', 'original_file_path': 'models/customer_marketing/new_user/new_account_welcome_series_list.sql', 'name': 'new_account_welcome_series_list', 'alias': 'new_account_welcome_series_list', 'checksum': {'name': 'sha256', 'checksum': '20a69e57fafad5f87ac365a1d0dfda030a288bc31cf6514fb5b9e5adc5c885c4'}, 'tags': [], 'refs': [['opp_source_xf'], ['account_source_xf'], ['user_source_xf'], ['user_source_xf'], ['ao_instance_user_source_xf'], ['contact_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5401556, 'config_call_dict': {}}, 'model.acton_marketing_data.new_user_welcome_series_list': {'raw_sql': 'WITH opp_and_acct_base AS (\r\n\r\n    SELECT\r\n        opportunity_id,\r\n        opp_source_xf.account_id,\r\n        opportunity_name,\r\n        customer_since,\r\n        account_csm_name,\r\n        account_csm_email,\r\n        account_csm_photo,\r\n        onboarding.user_name AS onboarding_specialist,\r\n        onboarding_specialist_email,\r\n        onboarding_specialist_photo,\r\n        owner.user_name AS account_owner,\r\n        account_owner_email,\r\n        account_owner_photo,\r\n        onboarding_completion_date,\r\n        opp_source_xf.close_date\r\n    FROM {{ref(\'opp_source_xf\')}}\r\n    LEFT JOIN {{ref(\'account_source_xf\')}} ON\r\n    opp_source_xf.account_id=account_source_xf.account_id\r\n    LEFT JOIN {{ref(\'user_source_xf\')}} owner ON\r\n    account_source_xf.account_owner_id=owner.user_id\r\n    LEFT JOIN {{ref(\'user_source_xf\')}} onboarding ON\r\n    account_source_xf.onboarding_specialist=onboarding.user_id\r\n    WHERE stage_name = \'Implement\'\r\n   -- AND is_current_customer = \'true\'\r\n    AND opp_source_xf.account_id != \'0011O00002LeGkEQAV\'\r\n    AND account_type != \'Partner Owned\'\r\n\r\n)\r\n\r\nSELECT DISTINCT\r\n    opp_and_acct_base.opportunity_id,\r\n    opp_and_acct_base.account_id,\r\n    opp_and_acct_base.opportunity_name,\r\n    opp_and_acct_base.customer_since,\r\n    CASE \r\n        WHEN opp_and_acct_base.account_csm_name IS null THEN \'Support\'\r\n        ELSE opp_and_acct_base.account_csm_name \r\n    END AS account_csm_name,\r\n    CASE \r\n        WHEN opp_and_acct_base.account_csm_email IS null THEN \'support@act-on.com\'\r\n        ELSE opp_and_acct_base.account_csm_email \r\n    END AS account_csm_email,\r\n    CASE \r\n        WHEN opp_and_acct_base.account_csm_photo IS null THEN \'https://success.act-on.com/cdnr/forpcid1/acton/attachment/9883/f-fa8432de-9cea-4bf7-b6d4-eca1c9656b82/1/-/-/-/-/NewUserWelcomeSeries-EM3-Support.png\'\r\n        ELSE opp_and_acct_base.account_csm_photo \r\n    END AS account_csm_photo,\r\n    opp_and_acct_base.onboarding_specialist,\r\n    opp_and_acct_base.onboarding_specialist_email,\r\n    opp_and_acct_base.onboarding_specialist_photo,\r\n    opp_and_acct_base.account_owner,\r\n    opp_and_acct_base.account_owner_email,\r\n    opp_and_acct_base.account_owner_photo,\r\n    contact_source_xf.first_name AS "First Name",\r\n    contact_source_xf.last_name AS "Last Name",\r\n    contact_source_xf.email AS "Email",\r\n    ao_instance_user_source_xf.ao_user_name,\r\n    ao_instance_user_source_xf.ao_user_id,\r\n    ao_instance_user_source_xf.is_marketing_user,\r\n    opp_and_acct_base.onboarding_completion_date,\r\n    ao_instance_user_source_xf.ao_user_created_date\r\nFROM {{ref(\'ao_instance_user_source_xf\')}}\r\nLEFT JOIN {{ref(\'contact_source_xf\')}} ON\r\ncontact_source_xf.contact_id=ao_instance_user_source_xf.ao_user_contact_id\r\nLEFT JOIN opp_and_acct_base ON\r\nopp_and_acct_base.account_id=contact_source_xf.account_id\r\nWHERE 1=1\r\nAND is_marketing_user = \'true\'\r\nAND customer_since >= \'2022-01-01\'\r\nAND customer_since < CURRENT_DATE-60\r\nAND ao_user_created_date >= \'2022-06-01\'', 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.account_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.ao_instance_user_source_xf', 'model.acton_marketing_data.contact_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'customer_marketing', 'new_user', 'new_user_welcome_series_list'], 'unique_id': 'model.acton_marketing_data.new_user_welcome_series_list', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'customer_marketing/new_user/new_user_welcome_series_list.sql', 'original_file_path': 'models/customer_marketing/new_user/new_user_welcome_series_list.sql', 'name': 'new_user_welcome_series_list', 'alias': 'new_user_welcome_series_list', 'checksum': {'name': 'sha256', 'checksum': '1c2071f6e59a1ce49ef85cac088c55404456fe6b517040bba456442f1d0e85c2'}, 'tags': [], 'refs': [['opp_source_xf'], ['account_source_xf'], ['user_source_xf'], ['user_source_xf'], ['ao_instance_user_source_xf'], ['contact_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5437944, 'config_call_dict': {}}, 'model.acton_marketing_data.sal_source_ss_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    lead_id,\r\n    email,\r\n    lead_source,\r\n    is_converted,\r\n    is_hand_raiser,\r\n    working_date,\r\n    mql_most_recent_date,\r\n    lead_status,\r\n    country,\r\n    global_region\r\nFROM {{ref('lead_source_ss_xf')}}\r\nWHERE lead_owner != '00Ga0000003Nugr'\r\nAND working_date IS NOT null\r\nAND email NOT LIKE '%act-on.com'\r\nAND lead_source = 'Marketing'\r\nAND lead_status = 'Working'\r\n--AND lead_status  NOT IN ('Current Customer','Partner','Bad Data','No Fit')", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.lead_source_ss_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'sal_source_ss_xf'], 'unique_id': 'model.acton_marketing_data.sal_source_ss_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/sal_source_ss_xf.sql', 'original_file_path': 'models/kpi_definitions/sal_source_ss_xf.sql', 'name': 'sal_source_ss_xf', 'alias': 'sal_source_ss_xf', 'checksum': {'name': 'sha256', 'checksum': 'd9055d1ee100899f0e669b39a300eecfbed8f5650a00df5c5da14a028216005f'}, 'tags': [], 'refs': [['lead_source_ss_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5472667, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.sql_source_ss_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    opportunity_id AS sql_id,\r\n    opportunity_name,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    created_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    opp_channel_opportunity_creation, \r\n    opp_medium_opportunity_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_lead_creation,\r\n    type,\r\n    billing_country AS country,\r\n    opp_source_xf.company_size_rev,\r\n    account_global_region\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE created_date IS NOT null\r\n--AND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed')\r\nAND stage_name = 'SQL'", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.account_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'sql_source_ss_xf'], 'unique_id': 'model.acton_marketing_data.sql_source_ss_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/sql_source_ss_xf.sql', 'original_file_path': 'models/kpi_definitions/sql_source_ss_xf.sql', 'name': 'sql_source_ss_xf', 'alias': 'sql_source_ss_xf', 'checksum': {'name': 'sha256', 'checksum': '99da8244b85479598375dd19a62aa94ae619381b412cf18939de13339a4dbda0'}, 'tags': [], 'refs': [['opp_source_xf'], ['account_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.55065, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opp_closing_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    opportunity_id,\r\n    opportunity_name,\r\n    user_name AS owner_name,\r\n    opp_source_xf.account_name,\r\n    owner_id,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    closing_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    CASE \r\n        WHEN type in ('New Business') THEN 'New Business'\r\n        WHEN type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') THEN 'Upsell'\r\n        ELSE null\r\n    END AS grouped_type,\r\n    opp_channel_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_opportunity_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_source_lead_creation,\r\n    type,\r\n    acv_deal_size_usd AS acv,\r\n    billing_country AS country,\r\n    account_global_region,\r\n    opp_source_xf.company_size_rev,\r\n    opp_source_xf.segment,\r\n    opp_source_xf.industry,\r\n    opp_source_xf.industry_bucket,\r\n    opp_source_xf.channel_bucket,\r\n    opp_source_xf.opp_offer_asset_name_lead_creation\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE closing_date IS NOT null\r\nAND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery','Demo','VOC/Negotiate','Implement')", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.account_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'opp_closing_source_xf'], 'unique_id': 'model.acton_marketing_data.opp_closing_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/opp_closing_source_xf.sql', 'original_file_path': 'models/kpi_definitions/opp_closing_source_xf.sql', 'name': 'opp_closing_source_xf', 'alias': 'opp_closing_source_xf', 'checksum': {'name': 'sha256', 'checksum': '0354ae58abdb43172e24994d49ea5ea3d6925d6436ddc374b17d4030a1330e0a'}, 'tags': [], 'refs': [['opp_source_xf'], ['user_source_xf'], ['account_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5527449, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.person_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    -- Key ID\r\n    lead_id AS person_id,\r\n\r\n    -- Firmographic Information\r\n    email,\r\n    first_name,\r\n    last_name,\r\n    title,\r\n    country,\r\n    lead_status AS person_status,\r\n    global_region,\r\n\r\n    -- Account Information\r\n    company,\r\n    annual_revenue,\r\n    lean_data_account_id,\r\n    current_crm,\r\n    current_ma,\r\n    company_size_rev,\r\n    industry,\r\n    industry_bucket,\r\n    segment,\r\n\r\n    -- DateTime Fields\r\n    last_modified_date,\r\n    created_date,\r\n    mql_created_date,\r\n    mql_most_recent_date,\r\n    working_date,\r\n    marketing_created_date,\r\n\r\n    -- Other Key Information    \r\n    lead_source,    \r\n    lead_owner_id AS person_owner_id,\r\n    lead_score,\r\n    firmographic_demographic_lead_score,\r\n    no_longer_with_company,\r\n    CASE\r\n        WHEN is_hand_raiser = true THEN 'Yes'\r\n        ELSE 'No'\r\n    END AS is_hand_raiser,\r\n    created_by_name,\r\n\r\n    --Attribution Data\r\n    campaign_first_touch,\r\n    campaign_last_touch,\r\n    campaign_lead_creation,\r\n    channel_first_touch,\r\n    channel_last_touch,\r\n    channel_lead_creation,\r\n    medium_first_touch,\r\n    medium_last_touch,\r\n    medium_lead_creation,\r\n    source_first_touch,\r\n    source_last_touch, \r\n    source_lead_creation,    \r\n    subchannel_first_touch,\r\n    subchannel_last_touch,\r\n    subchannel_lead_creation,\r\n    offer_asset_name_first_touch,\r\n    offer_asset_name_last_touch,\r\n    offer_asset_name_lead_creation,\r\n    offer_asset_subtype_first_touch,\r\n    offer_asset_subtype_last_touch,\r\n    offer_asset_subtype_lead_creation,\r\n    offer_asset_topic_first_touch,\r\n    offer_asset_topic_last_touch,\r\n    offer_asset_topic_lead_creation,\r\n    offer_asset_type_first_touch,\r\n    offer_asset_type_last_touch,\r\n    offer_asset_type_lead_creation,\r\n    channel_bucket\r\nFROM {{ref('lead_source_xf')}}\r\nWHERE is_converted = FALSE\r\nAND is_deleted = FALSE\r\nUNION ALL\r\nSELECT\r\n    -- Key ID\r\n    contact_id AS person_id,\r\n\r\n    -- Firmographic Information\r\n    email,\r\n    first_name,\r\n    last_name,\r\n    title,\r\n    mailing_country,\r\n    contact_status AS person_status,\r\n    global_region,\r\n\r\n    -- Account Information\r\n    account_name,\r\n    annual_revenue,\r\n    account_id,\r\n    de_current_crm,\r\n    de_current_ma,\r\n    company_size_rev,\r\n    industry,\r\n    industry_bucket,\r\n    segment,\r\n    \r\n    -- DateTime Fields\r\n    last_modified_date,\r\n    created_date,\r\n    mql_created_date,\r\n    mql_most_recent_date,\r\n    working_date,\r\n    marketing_created_date,\r\n\r\n    -- Other Key Information    \r\n    lead_source,    \r\n    contact_owner_id AS person_owner_id,\r\n    lead_score,\r\n    firmographic_demographic_lead_score,\r\n    is_no_longer_with_company,\r\n    CASE\r\n        WHEN is_hand_raiser = true THEN 'Yes'\r\n        ELSE 'No'\r\n    END AS is_hand_raiser,\r\n    created_by_name,\r\n\r\n    --Attribution Data\r\n    campaign_first_touch,\r\n    campaign_last_touch,\r\n    campaign_lead_creation,\r\n    channel_first_touch,\r\n    channel_last_touch,\r\n    channel_lead_creation,\r\n    medium_first_touch,\r\n    medium_last_touch,\r\n    medium_lead_creation,\r\n    source_first_touch,\r\n    source_last_touch, \r\n    source_lead_creation,    \r\n    subchannel_first_touch,\r\n    subchannel_last_touch,\r\n    subchannel_lead_creation,\r\n    offer_asset_name_first_touch,\r\n    offer_asset_name_last_touch,\r\n    offer_asset_name_lead_creation,\r\n    offer_asset_subtype_first_touch,\r\n    offer_asset_subtype_last_touch,\r\n    offer_asset_subtype_lead_creation,\r\n    offer_asset_topic_first_touch,\r\n    offer_asset_topic_last_touch,\r\n    offer_asset_topic_lead_creation,\r\n    offer_asset_type_first_touch,\r\n    offer_asset_type_last_touch,\r\n    offer_asset_type_lead_creation,\r\n    channel_bucket\r\nFROM {{ref('contact_source_xf')}}\r\nWHERE is_deleted = FALSE", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.lead_source_xf', 'model.acton_marketing_data.contact_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'person_source_xf'], 'unique_id': 'model.acton_marketing_data.person_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/person_source_xf.sql', 'original_file_path': 'models/kpi_definitions/person_source_xf.sql', 'name': 'person_source_xf', 'alias': 'person_source_xf', 'checksum': {'name': 'sha256', 'checksum': 'badfb838bb95595a1ee7c694d6d48820f868415a1d82c01f9aca08ce0fdf5f87'}, 'tags': [], 'refs': [['lead_source_xf'], ['contact_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5551474, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.lead_mql_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    person_id,\r\n    email,\r\n    is_hand_raiser,\r\n    mql_created_date,\r\n    mql_most_recent_date,\r\n    working_date,\r\n    person_status,\r\n    country,\r\n    company,\r\n    first_name,\r\n    last_name,\r\n    title,\r\n    person_owner_id,\r\n    global_region,\r\n    company_size_rev,\r\n    lead_source,\r\n    segment,\r\n    industry,\r\n    industry_bucket,\r\n    channel_bucket,\r\n    offer_asset_name_lead_creation,\r\n    campaign_lead_creation\r\nFROM {{ref('person_source_xf')}}\r\nWHERE mql_most_recent_date IS NOT null\r\nAND person_owner_id != '00Ga0000003Nugr' -- AO-Fake Leads\r\nAND email NOT LIKE '%act-on.com'\r\n--AND lead_source = 'Marketing'", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.person_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'lead_mql_source_xf'], 'unique_id': 'model.acton_marketing_data.lead_mql_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/lead_mql_source_xf.sql', 'original_file_path': 'models/kpi_definitions/lead_mql_source_xf.sql', 'name': 'lead_mql_source_xf', 'alias': 'lead_mql_source_xf', 'checksum': {'name': 'sha256', 'checksum': '7ba5a0f14e1c0cde1b519c6e6754e801357cc3b9e13e3771f745fc7e1f8e6fdb'}, 'tags': [], 'refs': [['person_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5573127, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opp_voc_source_ss_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    opportunity_id,\r\n    opportunity_name,\r\n    user_name AS owner_name,\r\n    owner_id,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    negotiation_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    CASE \r\n        WHEN type in ('New Business') THEN 'New Business'\r\n        WHEN type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') THEN 'Upsell'\r\n        ELSE null\r\n    END AS grouped_type,\r\n    opp_channel_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_opportunity_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_source_lead_creation,\r\n    type,\r\n    acv_deal_size_usd AS acv,\r\n    billing_country AS country,\r\n    account_global_region\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE negotiation_date IS NOT null\r\nAND stage_name = 'VOC/Negotiate'\r\n--AND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery','Demo')", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.account_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'opp_voc_source_ss_xf'], 'unique_id': 'model.acton_marketing_data.opp_voc_source_ss_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/opp_voc_source_ss_xf.sql', 'original_file_path': 'models/kpi_definitions/opp_voc_source_ss_xf.sql', 'name': 'opp_voc_source_ss_xf', 'alias': 'opp_voc_source_ss_xf', 'checksum': {'name': 'sha256', 'checksum': '323de433b2306f8d22828b356dd7bbc868066934ab83826eb9f13524c558e4b3'}, 'tags': [], 'refs': [['opp_source_xf'], ['user_source_xf'], ['account_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5593357, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.sqo_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\nopportunity_id,\r\nopportunity_name,\r\nuser_name AS owner_name,\r\nopp_source_xf.account_name,\r\nsdr_name,\r\nowner_id,\r\nopp_source_xf.is_closed,\r\nopp_source_xf.is_won,\r\ndiscovery_date,\r\ncreated_date,\r\nclose_day AS close_date,\r\nstage_name,\r\nopp_lead_source,\r\ncase \r\nwhen type in ('New Business') then 'New Business'\r\nwhen type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') then 'Upsell'\r\nelse null\r\nend as grouped_type,\r\nopp_channel_opportunity_creation, \r\nopp_channel_lead_creation,\r\nopp_medium_opportunity_creation,\r\nopp_medium_lead_creation,\r\nopp_source_opportunity_creation, \r\nopp_source_lead_creation,\r\ntype,\r\nacv_deal_size_usd AS acv,\r\nbilling_country AS country,\r\naccount_global_region,\r\nopp_source_xf.segment,\r\nopp_source_xf.industry,\r\nopp_source_xf.industry_bucket,\r\nchannel_bucket,\r\nopp_source_xf.company_size_rev,\r\nopp_source_xf.opp_offer_asset_name_lead_creation\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE discovery_date IS NOT null\r\nAND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','SQL - No Opportunity')\r\n--AND type = 'New Business'", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.account_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'sqo_source_xf'], 'unique_id': 'model.acton_marketing_data.sqo_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/sqo_source_xf.sql', 'original_file_path': 'models/kpi_definitions/sqo_source_xf.sql', 'name': 'sqo_source_xf', 'alias': 'sqo_source_xf', 'checksum': {'name': 'sha256', 'checksum': '5443b5f02767cfba03565630c13fd34b6e790f7dbc26287c780971e48d6b88a3'}, 'tags': [], 'refs': [['opp_source_xf'], ['user_source_xf'], ['account_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5631275, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opp_demo_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    opportunity_id,\r\n    opportunity_name,\r\n    user_name AS owner_name,\r\n    opp_source_xf.account_name,\r\n    owner_id,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    demo_date,\r\n    solution_date,\r\n    confirmed_value_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    CASE \r\n        WHEN type in ('New Business') THEN 'New Business'\r\n        WHEN type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') THEN 'Upsell'\r\n        ELSE null\r\n    END AS grouped_type,\r\n    opp_channel_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_opportunity_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_source_lead_creation,\r\n    type,\r\n    acv_deal_size_usd AS acv,\r\n    billing_country AS country,\r\n    account_global_region,\r\n    opp_source_xf.company_size_rev,\r\n    opp_source_xf.segment,\r\n    opp_source_xf.industry,\r\n    opp_source_xf.industry_bucket,\r\n    opp_source_xf.channel_bucket,\r\n    opp_source_xf.opp_offer_asset_name_lead_creation\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE demo_date IS NOT null\r\n--AND stage_name = 'Demo'\r\nAND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery','Implement')", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.account_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'opp_demo_source_xf'], 'unique_id': 'model.acton_marketing_data.opp_demo_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/opp_demo_source_xf.sql', 'original_file_path': 'models/kpi_definitions/opp_demo_source_xf.sql', 'name': 'opp_demo_source_xf', 'alias': 'opp_demo_source_xf', 'checksum': {'name': 'sha256', 'checksum': 'b0bfdfa1be3382b3935a7486159b5bd03270bf647f938aa380e99aca7b2075c1'}, 'tags': [], 'refs': [['opp_source_xf'], ['user_source_xf'], ['account_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.565635, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opp_sales_source_xf': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nSELECT\r\nopportunity_id,\r\nopportunity_name,\r\nopp_source_xf.account_name,\r\nuser_name AS owner_name,\r\nclose_day AS close_date,\r\nopp_lead_source,\r\nopp_channel_opportunity_creation, \r\nopp_medium_opportunity_creation,\r\nopp_source_opportunity_creation, \r\nopp_channel_lead_creation,\r\nopp_medium_lead_creation,\r\nopp_source_lead_creation,\r\nopp_offer_asset_name_lead_creation,\r\nopp_offer_asset_subtype_lead_creation,\r\nopp_offer_asset_topic_lead_creation,\r\nopp_offer_asset_type_lead_creation,\r\ntype,\r\ncase \r\nwhen type in (\'New Business\') then \'New Business\'\r\nwhen type in (\'UpSell\',\'Non-Monetary Mod\',\'Admin Opp\',\'Trigger Up\',\'Trigger Down\',\'Trigger Renewal\',\'Renewal\',\'Multiyear Renewal\',\'Admin Conversion\',\'One Time\',\'Downsell\') then \'Upsell\'\r\nelse null\r\nend as grouped_type,\r\nacv,\r\nbilling_country AS country,\r\naccount_global_region,\r\n    opp_source_xf.company_size_rev,\r\n    opp_source_xf.segment,\r\n    opp_source_xf.industry,\r\n    opp_source_xf.industry_bucket,\r\n    opp_source_xf.channel_bucket\r\nFROM {{ref(\'opp_source_xf\')}}\r\n--FROM "acton".dbt_actonmarketing.opp_source_xf\r\nLEFT JOIN {{ref(\'user_source_xf\')}} ON\r\n--LEFT JOIN "acton".dbt_actonmarketing.user_source_xf ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref(\'account_source_xf\')}} ON\r\n--LEFT JOIN "acton".dbt_actonmarketing.account_source_xf ON \r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE close_day IS NOT null\r\nAND stage_name NOT IN (\'Closed - Duplicate\',\'Closed - Admin Removed\')\r\nAND is_won = \'1\'', 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.account_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'opp_sales_source_xf'], 'unique_id': 'model.acton_marketing_data.opp_sales_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/opp_sales_source_xf.sql', 'original_file_path': 'models/kpi_definitions/opp_sales_source_xf.sql', 'name': 'opp_sales_source_xf', 'alias': 'opp_sales_source_xf', 'checksum': {'name': 'sha256', 'checksum': '143a577aaf21e20aaba0b560b998330407908e338393747862f75455896ff9b7'}, 'tags': [], 'refs': [['opp_source_xf'], ['user_source_xf'], ['account_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5678205, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opp_voc_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    opportunity_id,\r\n    opportunity_name,\r\n    user_name AS owner_name,\r\n    opp_source_xf.account_name,\r\n    owner_id,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    voc_date AS negotiation_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    CASE \r\n        WHEN type in ('New Business') THEN 'New Business'\r\n        WHEN type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') THEN 'Upsell'\r\n        ELSE null\r\n    END AS grouped_type,\r\n    opp_channel_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_opportunity_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_source_lead_creation,\r\n    type,\r\n    acv_deal_size_usd AS acv,\r\n    billing_country AS country,\r\n    account_global_region,\r\n    opp_source_xf.company_size_rev,\r\n    opp_source_xf.segment,\r\n    opp_source_xf.industry,\r\n    opp_source_xf.industry_bucket,\r\n    opp_source_xf.channel_bucket,\r\n    opp_source_xf.opp_offer_asset_name_lead_creation\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE voc_date IS NOT null\r\nAND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery','Demo','Implement')\r\nORDER BY 7 DESC", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.account_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'opp_voc_source_xf'], 'unique_id': 'model.acton_marketing_data.opp_voc_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/opp_voc_source_xf.sql', 'original_file_path': 'models/kpi_definitions/opp_voc_source_xf.sql', 'name': 'opp_voc_source_xf', 'alias': 'opp_voc_source_xf', 'checksum': {'name': 'sha256', 'checksum': '5a095f49b477be0fe0c8b2ab6cb9dc02744d9f8b7b6b31f7acbb25453e2eb075'}, 'tags': [], 'refs': [['opp_source_xf'], ['user_source_xf'], ['account_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5699766, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opp_closing_source_ss_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    opportunity_id,\r\n    opportunity_name,\r\n    user_name AS owner_name,\r\n    opp_source_xf.account_name,\r\n    owner_id,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    discovery_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    CASE \r\n        WHEN type in ('New Business') THEN 'New Business'\r\n        WHEN type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') THEN 'Upsell'\r\n        ELSE null\r\n    END AS grouped_type,\r\n    opp_channel_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_opportunity_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_source_lead_creation,\r\n    type,\r\n    acv_deal_size_usd AS acv,\r\n    billing_country AS country,\r\n    account_global_region\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE discovery_date IS NOT null\r\nAND stage_name = 'Closing'\r\n--AND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery','Demo','VOC/Negotiate')", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.account_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'opp_closing_source_ss_xf'], 'unique_id': 'model.acton_marketing_data.opp_closing_source_ss_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/opp_closing_source_ss_xf.sql', 'original_file_path': 'models/kpi_definitions/opp_closing_source_ss_xf.sql', 'name': 'opp_closing_source_ss_xf', 'alias': 'opp_closing_source_ss_xf', 'checksum': {'name': 'sha256', 'checksum': '4e7b8397f52fc08cd9d5d7123553153250e40808e5107f1e91c76b9323356e9c'}, 'tags': [], 'refs': [['opp_source_xf'], ['user_source_xf'], ['account_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5722592, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.sqo_source_ss_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\nopportunity_id,\r\nopportunity_name,\r\nuser_name AS owner_name,\r\nowner_id,\r\nopp_source_xf.is_closed,\r\nopp_source_xf.is_won,\r\ndiscovery_date,\r\nstage_name,\r\nopp_lead_source,\r\ncase \r\nwhen type in ('New Business') then 'New Business'\r\nwhen type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') then 'Upsell'\r\nelse null\r\nend as grouped_type,\r\nopp_channel_opportunity_creation, \r\nopp_channel_lead_creation,\r\nopp_medium_opportunity_creation,\r\nopp_medium_lead_creation,\r\nopp_source_opportunity_creation, \r\nopp_source_lead_creation,\r\ntype,\r\nacv_deal_size_usd AS acv,\r\nbilling_country AS country,\r\naccount_global_region\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE discovery_date IS NOT null\r\nAND stage_name = ('Discovery')", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.account_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'sqo_source_ss_xf'], 'unique_id': 'model.acton_marketing_data.sqo_source_ss_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/sqo_source_ss_xf.sql', 'original_file_path': 'models/kpi_definitions/sqo_source_ss_xf.sql', 'name': 'sqo_source_ss_xf', 'alias': 'sqo_source_ss_xf', 'checksum': {'name': 'sha256', 'checksum': '6e826f2c8ec71b2227f8f5055a537226be1edee309342024428424c93bab2d87'}, 'tags': [], 'refs': [['opp_source_xf'], ['user_source_xf'], ['account_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5747876, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opp_demo_source_ss_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    opportunity_id,\r\n    opportunity_name,\r\n    user_name AS owner_name,\r\n    owner_id,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    discovery_date,\r\n    demo_date,\r\n    solution_date,\r\n    confirmed_value_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    CASE \r\n        WHEN type in ('New Business') THEN 'New Business'\r\n        WHEN type in ('UpSell','Non-Monetary Mod','Admin Opp','Trigger Up','Trigger Down','Trigger Renewal','Renewal','Multiyear Renewal','Admin Conversion','One Time','Downsell') THEN 'Upsell'\r\n        ELSE null\r\n    END AS grouped_type,\r\n    opp_channel_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_opportunity_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_source_lead_creation,\r\n    type,\r\n    acv_deal_size_usd AS acv,\r\n    billing_country AS country,\r\n    account_global_region\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('user_source_xf')}} ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE demo_date IS NOT null\r\nAND stage_name = 'Demo'\r\n--AND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery')", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.user_source_xf', 'model.acton_marketing_data.account_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'opp_demo_source_ss_xf'], 'unique_id': 'model.acton_marketing_data.opp_demo_source_ss_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/opp_demo_source_ss_xf.sql', 'original_file_path': 'models/kpi_definitions/opp_demo_source_ss_xf.sql', 'name': 'opp_demo_source_ss_xf', 'alias': 'opp_demo_source_ss_xf', 'checksum': {'name': 'sha256', 'checksum': '206c491d55bf9e146d3c03fe992ad347938cf471447763b2f18de64d878d1e97'}, 'tags': [], 'refs': [['opp_source_xf'], ['user_source_xf'], ['account_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5772305, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.sql_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT DISTINCT\r\n    opportunity_id AS sql_id,\r\n    opportunity_name,\r\n    opp_source_xf.account_name,\r\n    owner_name,\r\n    sdr_name,\r\n    opp_source_xf.is_closed,\r\n    opp_source_xf.is_won,\r\n    created_date,\r\n    stage_name,\r\n    opp_lead_source,\r\n    opp_channel_opportunity_creation, \r\n    opp_medium_opportunity_creation,\r\n    opp_source_opportunity_creation, \r\n    opp_channel_lead_creation,\r\n    opp_medium_lead_creation,\r\n    opp_source_lead_creation,\r\n    type,\r\n    billing_country AS country,\r\n    opp_source_xf.company_size_rev,\r\n    account_global_region,\r\n    opp_source_xf.segment,\r\n    opp_source_xf.industry,\r\n    opp_source_xf.industry_bucket,\r\n    channel_bucket,\r\n    opp_source_xf.opp_offer_asset_name_lead_creation,\r\n    acv_deal_size_usd AS acv\r\nFROM {{ref('opp_source_xf')}}\r\nLEFT JOIN {{ref('account_source_xf')}} ON\r\nopp_source_xf.account_id=account_source_xf.account_id\r\nWHERE created_date IS NOT null\r\nAND stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed')\r\n--AND stage_name = 'SQL'", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.account_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'sql_source_xf'], 'unique_id': 'model.acton_marketing_data.sql_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/sql_source_xf.sql', 'original_file_path': 'models/kpi_definitions/sql_source_xf.sql', 'name': 'sql_source_xf', 'alias': 'sql_source_xf', 'checksum': {'name': 'sha256', 'checksum': '1473a282bd1aef98853ee02fdd9b585dd56b47c2473220eea9ddbf9b331bc489'}, 'tags': [], 'refs': [['opp_source_xf'], ['account_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.579431, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.kpi_targets': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT *\r\nFROM "acton".public."kpi_targets"\r\n\r\n)\r\n\r\nSELECT *\r\nFROM base', 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': []}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'kpi_targets'], 'unique_id': 'model.acton_marketing_data.kpi_targets', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/kpi_targets.sql', 'original_file_path': 'models/kpi_definitions/kpi_targets.sql', 'name': 'kpi_targets', 'alias': 'kpi_targets', 'checksum': {'name': 'sha256', 'checksum': '9197afc2db20108c676891ee47573b531ca47c281d8e8f210905cadad47a2e55'}, 'tags': [], 'refs': [], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5816648, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.sal_source_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    person_id,\r\n    email,\r\n    is_hand_raiser,\r\n    working_date,\r\n    mql_most_recent_date,\r\n    person_status,\r\n    country,\r\n    global_region,\r\n    company,\r\n    company_size_rev,\r\n    lead_source,\r\n    segment,\r\n    industry,\r\n    industry_bucket,\r\n    channel_bucket,\r\n    offer_asset_name_lead_creation,\r\n    campaign_lead_creation\r\nFROM {{ref('person_source_xf')}}\r\nWHERE person_owner_id != '00Ga0000003Nugr'\r\nAND working_date IS NOT null\r\nAND email NOT LIKE '%act-on.com'\r\n--AND lead_source = 'Marketing'\r\nAND person_status  NOT IN ('Current Customer','Partner','Bad Data','No Fit')", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.person_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'sal_source_xf'], 'unique_id': 'model.acton_marketing_data.sal_source_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/sal_source_xf.sql', 'original_file_path': 'models/kpi_definitions/sal_source_xf.sql', 'name': 'sal_source_xf', 'alias': 'sal_source_xf', 'checksum': {'name': 'sha256', 'checksum': '42378430793e70b8093439b77c5bc144940ef598cc807bc24bbd51e61641e45d'}, 'tags': [], 'refs': [['person_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5837843, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.lead_mql_source_ss_xf': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nSELECT\r\n    lead_id,\r\n    email,\r\n    lead_source,\r\n    is_converted,\r\n    is_hand_raiser,\r\n    mql_created_date,\r\n    mql_most_recent_date,\r\n    lead_status,\r\n    country,\r\n    lead_owner,\r\n    global_region\r\nFROM {{ref('lead_source_ss_xf')}}\r\nWHERE mql_most_recent_date IS NOT null\r\nAND lead_owner != '00Ga0000003Nugr' -- AO-Fake Leads\r\nAND email NOT LIKE '%act-on.com'\r\nAND lead_source = 'Marketing'", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.lead_source_ss_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'lead_mql_source_ss_xf'], 'unique_id': 'model.acton_marketing_data.lead_mql_source_ss_xf', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/lead_mql_source_ss_xf.sql', 'original_file_path': 'models/kpi_definitions/lead_mql_source_ss_xf.sql', 'name': 'lead_mql_source_ss_xf', 'alias': 'lead_mql_source_ss_xf', 'checksum': {'name': 'sha256', 'checksum': '9b632fc8605aa1df4af5d7d8e2076ed838b3d826b0454a969604ce4268a5654d'}, 'tags': [], 'refs': [['lead_source_ss_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5859659, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.wow_disco_scheduled': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH  base AS (\r\n\r\nSELECT\r\nopportunity_id,\r\nopportunity_name,\r\nowner_id,\r\ndiscovery_call_scheduled_datetime\r\nFROM {{ref(\'opp_source_xf\')}}\r\n--FROM "acton".dbt_actonmarketing.opp_source_xf\r\nWHERE 1=1\r\nAND type = \'New Business\'\r\nAND discovery_call_scheduled_datetime IS NOT null\r\nAND discovery_date IS null\r\nAND opportunity_status != \'Rescheduling Meeting\'\r\nAND is_closed != \'true\'\r\nAND is_won != \'true\'\r\nAND is_deleted != \'true\'\r\n)\r\n\r\nSELECT\r\ndiscovery_call_scheduled_datetime,\r\nCOUNT(DISTINCT opportunity_id) AS opps\r\nFROM base\r\nGROUP BY 1', 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'disco calls', 'wow_disco_scheduled'], 'unique_id': 'model.acton_marketing_data.wow_disco_scheduled', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/disco calls/wow_disco_scheduled.sql', 'original_file_path': 'models/kpi_definitions/disco calls/wow_disco_scheduled.sql', 'name': 'wow_disco_scheduled', 'alias': 'wow_disco_scheduled', 'checksum': {'name': 'sha256', 'checksum': 'e4900cf20a9ed9b9bf61d965c5f9240c00746a6dd7fdc23e6aa959b60b4865b1'}, 'tags': [], 'refs': [['opp_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5879943, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.wow_disco_pastdue': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH  base AS (\r\n\r\nSELECT\r\nopportunity_id,\r\nopportunity_name,\r\nuser_name AS owner_name,\r\ndiscovery_call_scheduled_datetime\r\nFROM {{ref(\'opp_source_xf\')}}\r\n--FROM "acton".dbt_actonmarketing.opp_source_xf\r\nLEFT JOIN {{ref(\'user_source_xf\')}} ON\r\n--LEFT JOIN "acton".dbt_actonmarketing.user_source_xf ON\r\nopp_source_xf.owner_id=user_source_xf.user_id\r\nWHERE 1=1\r\nAND type = \'New Business\'\r\nAND discovery_call_scheduled_datetime IS NOT null\r\nAND discovery_date IS null\r\nAND opportunity_status != \'Rescheduling Meeting\'\r\nAND is_closed != \'true\'\r\nAND is_won != \'true\'\r\nAND is_deleted != \'true\'\r\nAND discovery_call_scheduled_datetime < CURRENT_DATE\r\n)\r\n\r\nSELECT\r\nowner_name,\r\nCOUNT(DISTINCT opportunity_id) AS opps\r\nFROM base\r\nGROUP BY 1', 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.user_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'disco calls', 'wow_disco_pastdue'], 'unique_id': 'model.acton_marketing_data.wow_disco_pastdue', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/disco calls/wow_disco_pastdue.sql', 'original_file_path': 'models/kpi_definitions/disco calls/wow_disco_pastdue.sql', 'name': 'wow_disco_pastdue', 'alias': 'wow_disco_pastdue', 'checksum': {'name': 'sha256', 'checksum': '849dc086ee7c5aa34a2cb4979acb765fa06fd02b4be7eed45836cd5de57d01c8'}, 'tags': [], 'refs': [['opp_source_xf'], ['user_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.590203, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.wow_disco_missing': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH base AS (\r\n\r\nSELECT\r\nopportunity_id,\r\nuser_name AS owner_name\r\nFROM {{ref(\'opp_source_xf\')}}\r\n--FROM "acton".dbt_actonmarketing.opp_source_xf\r\nLEFT JOIN {{ref(\'user_source_xf\')}} ON\r\n--LEFT JOIN "acton".dbt_actonmarketing.user_source_xf ON\r\nopp_source_xf.created_by_id=user_source_xf.user_id\r\nWHERE 1=1\r\nAND type = \'New Business\'\r\nAND discovery_call_scheduled_datetime IS null\r\nAND discovery_date IS null\r\nAND is_closed != \'true\'\r\nAND is_won != \'true\'\r\nAND is_deleted != \'true\'\r\n\r\n)\r\n\r\nSELECT\r\nowner_name,\r\nCOUNT(DISTINCT opportunity_id) AS opps\r\nFROM base\r\nGROUP BY 1', 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf', 'model.acton_marketing_data.user_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'kpi_definitions', 'disco calls', 'wow_disco_missing'], 'unique_id': 'model.acton_marketing_data.wow_disco_missing', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'kpi_definitions/disco calls/wow_disco_missing.sql', 'original_file_path': 'models/kpi_definitions/disco calls/wow_disco_missing.sql', 'name': 'wow_disco_missing', 'alias': 'wow_disco_missing', 'checksum': {'name': 'sha256', 'checksum': '5f146439b74e3d481ef239be67bacd43c37c58937ec0ae3cbff121d408890309'}, 'tags': [], 'refs': [['opp_source_xf'], ['user_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5924373, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.opportunities_with_contacts': {'raw_sql': "{{ config(materialized='table') }}\r\n\r\nWITH person_base AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        email,\r\n        is_hand_raiser,\r\n        person_owner_id AS owner_id,\r\n        channel_lead_creation,\r\n        medium_lead_creation,\r\n        source_lead_creation,\r\n        lead_source,\r\n        created_date,\r\n        marketing_created_date,\r\n        mql_most_recent_date AS mql_created_date,\r\n        working_date,\r\n        person_status,\r\n        company_size_rev,\r\n        global_region,\r\n        segment,\r\n        lean_data_account_id AS account_id,\r\n        channel_bucket,\r\n        industry_bucket,\r\n        industry,\r\n        offer_asset_name_lead_creation\r\n    FROM {{ref('person_source_xf')}}\r\n    --WHERE marketing_created_date >= '2021-01-01'\r\n)\r\n\r\nSELECT DISTINCT\r\n    person_base.person_id,\r\n    person_base.email,\r\n    person_base.is_hand_raiser,\r\n    person_base.channel_bucket,\r\n    person_base.owner_id,\r\n    person_base.channel_lead_creation,\r\n    person_base.medium_lead_creation,\r\n    person_base.source_lead_creation,\r\n    person_base.lead_source,\r\n    person_base.created_date AS person_created_date,\r\n    person_base.marketing_created_date,\r\n    person_base.mql_created_date,\r\n    person_base.working_date,\r\n    person_base.company_size_rev,\r\n    person_base.global_region,\r\n    person_base.segment,\r\n    person_base.account_id,\r\n    person_base.person_status,\r\n    person_base.industry,\r\n    person_base.offer_asset_name_lead_creation AS person_offer_asset_name_lead_creation,\r\n    person_base.industry_bucket,\r\n    -- account_base.is_current_customer, \r\n    -- account_base.account_name,\r\n    -- account_base.account_owner_name,\r\n    -- account_base.account_csm_name,\r\n   -- account_base.\r\n    opp_base.is_current_customer,\r\n    opp_base.opportunity_id,\r\n    opp_base.opportunity_name,\r\n    opp_base.is_won,\r\n    opp_base.created_date AS opp_created_date,\r\n    opp_base.discovery_date,\r\n    opp_base.demo_date,\r\n    opp_base.voc_date,\r\n    opp_base.closing_date,\r\n    opp_base.implement_date,\r\n    opp_base.close_date,\r\n    opp_base.stage_name,\r\n    opp_base.acv_deal_size_usd AS acv,\r\n    opp_base.opp_lead_source,\r\n    opp_base.type,\r\n    opp_base.is_closed,\r\n    opp_base.segment AS opp_segment,\r\n    opp_base.account_global_region,\r\n    opp_base.company_size_rev AS opp_company_size_rev,\r\n    opp_base.industry AS opp_industry,\r\n    opp_base.industry_bucket AS opp_industry_bucket,\r\n    opp_base.channel_bucket AS opp_channel_bucket,\r\n    opp_base.opp_offer_asset_name_lead_creation,\r\n    CASE \r\n        WHEN mql_created_date IS NOT null AND email NOT LIKE '%act-on%' THEN 1\r\n        ELSE 0\r\n    END AS is_mql,\r\n    CASE \r\n        WHEN working_date IS NOT null AND email NOT LIKE '%act-on%' AND person_status NOT IN ('Current Customer','Partner','Bad Data','No Fit') THEN 1\r\n        ELSE 0\r\n    END AS is_sal,\r\n    CASE\r\n        WHEN opp_base.created_date IS NOT null AND opp_base.stage_name NOT IN ('Closed - Duplicate','Closed - Admin Remove') THEN 1\r\n        ELSE 0\r\n    END AS is_sql,\r\n    CASE\r\n        WHEN opp_base.discovery_date IS NOT null AND opp_base.stage_name NOT IN ('Closed - Duplicate','Closed - Admin Remove') THEN 1\r\n        ELSE 0\r\n    END AS is_sqo,\r\n    CASE\r\n        WHEN opp_base.demo_date IS NOT null AND opp_base.stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery') THEN 1\r\n        ELSE 0\r\n    END AS is_demo,\r\n    CASE\r\n        WHEN opp_base.voc_date IS NOT null AND opp_base.stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery','Demo') THEN 1\r\n        ELSE 0\r\n    END AS is_voc,\r\n    CASE\r\n        WHEN opp_base.closing_date IS NOT null AND opp_base.stage_name NOT IN ('Closed - Duplicate','Closed - Admin Removed','SQL','Discovery','Demo','VOC/Negotiate') THEN 1\r\n        ELSE 0\r\n    END AS is_closing,\r\n    CASE\r\n        WHEN opp_base.is_closed = true AND opp_base.is_won = false THEN 1\r\n        ELSE 0\r\n    END AS is_cl,\r\n    CASE\r\n        WHEN opp_base.is_closed = true AND opp_base.is_won = true THEN 1\r\n        ELSE 0\r\n    END AS is_cw\r\nFROM person_base\r\nFULL JOIN {{ref('opp_source_xf')}} AS opp_base ON\r\nperson_base.account_id=opp_base.account_id", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.person_source_xf', 'model.acton_marketing_data.opp_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'cohort_model', 'opportunities_with_contacts'], 'unique_id': 'model.acton_marketing_data.opportunities_with_contacts', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'cohort_model/opportunities_with_contacts.sql', 'original_file_path': 'models/cohort_model/opportunities_with_contacts.sql', 'name': 'opportunities_with_contacts', 'alias': 'opportunities_with_contacts', 'checksum': {'name': 'sha256', 'checksum': 'bf72a7456e11680853fd7a957fd25be1bb1692b1898eb91d80732bd81e8750e2'}, 'tags': [], 'refs': [['person_source_xf'], ['opp_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5948286, 'config_call_dict': {'materialized': 'table'}}, 'model.acton_marketing_data.avg_lead_to_cw_cohort_count': {'raw_sql': "WITH base AS(\r\n\r\n    SELECT *\r\n    FROM {{ ref('lead_to_cw_cohort')}}\r\n)\r\n\r\nSELECT DISTINCT\r\n    channel_bucket,\r\n    segment,\r\n    SUM(is_mql) AS mqls,\r\n    SUM(is_sal) AS sals,\r\n    SUM(is_sql) AS sqls,\r\n    SUM(is_sqo) AS sqos,\r\n    SUM(is_cl) AS closed_lost,\r\n    SUM(is_cw) AS closed_won\r\nFROM base\r\nGROUP BY 1,2", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.lead_to_cw_cohort']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'cohort_model', 'avg_lead_to_cw_cohort_count'], 'unique_id': 'model.acton_marketing_data.avg_lead_to_cw_cohort_count', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'cohort_model/avg_lead_to_cw_cohort_count.sql', 'original_file_path': 'models/cohort_model/avg_lead_to_cw_cohort_count.sql', 'name': 'avg_lead_to_cw_cohort_count', 'alias': 'avg_lead_to_cw_cohort_count', 'checksum': {'name': 'sha256', 'checksum': '5a68a7817dfe2cd9031b17328b15522b315a82db6f2a9154022138b5af4ceb84'}, 'tags': [], 'refs': [['lead_to_cw_cohort']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.597121, 'config_call_dict': {}}, 'model.acton_marketing_data.avg_lead_to_cw_cohort': {'raw_sql': "WITH base AS(\r\n\r\n    SELECT *\r\n    FROM {{ ref('lead_to_cw_cohort')}}\r\n)\r\n\r\nSELECT\r\n    channel_bucket,\r\n    segment,\r\n    AVG(days_to_mql) AS avg_days_to_mql,\r\n    AVG(days_to_sal) AS avg_days_to_sal,\r\n    AVG(days_to_sql) AS avg_days_to_sql,\r\n    AVG(days_to_sqo) AS avg_days_to_sqo,\r\n    AVG(days_to_won) AS avg_days_to_won,\r\n    AVG(days_to_closed_lost) AS avg_days_to_closed_lost\r\nFROM base\r\nGROUP BY 1,2", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.lead_to_cw_cohort']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'cohort_model', 'avg_lead_to_cw_cohort'], 'unique_id': 'model.acton_marketing_data.avg_lead_to_cw_cohort', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'cohort_model/avg_lead_to_cw_cohort.sql', 'original_file_path': 'models/cohort_model/avg_lead_to_cw_cohort.sql', 'name': 'avg_lead_to_cw_cohort', 'alias': 'avg_lead_to_cw_cohort', 'checksum': {'name': 'sha256', 'checksum': '96ebbd538b46f34d110283fa62c73c2ca30fa79fb41c194b2ae13fe20f405a0d'}, 'tags': [], 'refs': [['lead_to_cw_cohort']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.5989835, 'config_call_dict': {}}, 'model.acton_marketing_data.lead_to_cw_cohort': {'raw_sql': '{{ config(materialized=\'table\') }}\r\n\r\nWITH base AS (\r\n\r\n    SELECT *\r\n    FROM {{ref(\'opportunities_with_contacts\')}}\r\n\r\n), intermediate AS (\r\n\r\n    SELECT\r\n        person_id,\r\n        email,\r\n        opportunity_id,\r\n        owner_id AS person_owner_id,\r\n        company_size_rev,\r\n        global_region,\r\n        segment,\r\n        channel_bucket,\r\n        industry,\r\n        industry_bucket,\r\n        lead_source,\r\n        person_created_date,\r\n        marketing_created_date::Date,\r\n        mql_created_date::Date,\r\n        working_date AS sal_created_date,\r\n        person_status,\r\n        opp_created_date::Date,\r\n        discovery_date::Date,\r\n        demo_date::Date,\r\n        voc_date::Date,\r\n        closing_date::Date,\r\n        close_date::Date,\r\n        CASE\r\n            WHEN is_won = true THEN close_date::Date\r\n            ELSE null\r\n        END AS cw_date,\r\n        CASE \r\n            WHEN is_won = false AND is_closed = true THEN close_date::Date\r\n            ELSE null\r\n        END AS cl_date,\r\n        is_won,\r\n        acv,\r\n        channel_lead_creation,\r\n        medium_lead_creation,\r\n        source_lead_creation,\r\n        person_offer_asset_name_lead_creation,\r\n        stage_name,\r\n        opp_lead_source,\r\n        opp_segment,\r\n        account_global_region,\r\n        opp_company_size_rev,\r\n        opp_industry,\r\n        opp_industry_bucket,\r\n        opp_channel_bucket,\r\n        opp_offer_asset_name_lead_creation,\r\n        type AS opp_type,\r\n        is_hand_raiser,\r\n        is_current_customer,\r\n        is_mql,\r\n        is_sal,\r\n        is_sql,\r\n        is_sqo,\r\n        is_demo,\r\n        is_voc,\r\n        is_closing,\r\n        is_cl,\r\n        is_cw\r\n    FROM base\r\n\r\n), final AS (\r\n\r\n    SELECT \r\n        intermediate.*,\r\n        CASE \r\n            WHEN mql_created_date>=marketing_created_date THEN {{ dbt_utils.datediff("marketing_created_date","mql_created_date",\'day\') }} \r\n            ELSE 0 \r\n        END AS days_to_mql,\r\n        CASE \r\n            WHEN sal_created_date>=mql_created_date THEN {{ dbt_utils.datediff("mql_created_date","sal_created_date",\'day\') }} \r\n            ELSE 0 \r\n        END AS  days_to_sal,\r\n        CASE \r\n            WHEN opp_created_date>=sal_created_date THEN {{ dbt_utils.datediff("sal_created_date","opp_created_date",\'day\') }} \r\n            ELSE 0 \r\n        END AS  days_to_sql,\r\n        CASE \r\n            WHEN discovery_date>=opp_created_date THEN {{ dbt_utils.datediff("opp_created_date","discovery_date",\'day\') }} \r\n            ELSE 0 \r\n        END AS  days_to_sqo,\r\n        CASE \r\n            WHEN cw_date>=discovery_date THEN {{ dbt_utils.datediff("discovery_date","cw_date",\'day\') }} \r\n            ELSE 0 \r\n        END AS  days_to_won,\r\n        CASE \r\n            WHEN cl_date>=discovery_date THEN {{ dbt_utils.datediff("discovery_date","cl_date",\'day\') }} \r\n            ELSE 0 \r\n        END AS  days_to_closed_lost\r\n    FROM intermediate\r\n\r\n)\r\n\r\nSELECT *\r\nFROM final', 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt_utils.datediff'], 'nodes': ['model.acton_marketing_data.opportunities_with_contacts']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'dbt_actonmarketing', 'fqn': ['acton_marketing_data', 'cohort_model', 'lead_to_cw_cohort'], 'unique_id': 'model.acton_marketing_data.lead_to_cw_cohort', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'cohort_model/lead_to_cw_cohort.sql', 'original_file_path': 'models/cohort_model/lead_to_cw_cohort.sql', 'name': 'lead_to_cw_cohort', 'alias': 'lead_to_cw_cohort', 'checksum': {'name': 'sha256', 'checksum': 'd3006a83de3c9794cb7e18c8ce9b7d13b9d3ff4359016721f06fb92df8585901'}, 'tags': [], 'refs': [['opportunities_with_contacts']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1666469550.6008067, 'config_call_dict': {'materialized': 'table'}}, 'snapshot.acton_marketing_data.sfdc_ao_instance_snapshot2': {'raw_sql': "\r\n\r\n{{\r\n    config (\r\n        target_schema='snapshots',\r\n        unique_key = 'ao_instance_id',\r\n        strategy='timestamp',\r\n        updated_at='systemmodstamp'\r\n    )\r\n}}\r\n\r\nSELECT *\r\nFROM {{ref('ao_instance_source_xf')}}\r\n\r\n", 'resource_type': 'snapshot', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.ao_instance_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'snapshot', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': 'ao_instance_id', 'on_schema_change': 'ignore', 'grants': {}, 'strategy': 'timestamp', 'target_schema': 'snapshots', 'target_database': None, 'updated_at': 'systemmodstamp', 'check_cols': None, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'snapshots', 'fqn': ['acton_marketing_data', 'sfdc', 'sfdc_ao_instance_snapshot', 'sfdc_ao_instance_snapshot2'], 'unique_id': 'snapshot.acton_marketing_data.sfdc_ao_instance_snapshot2', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sfdc/sfdc_ao_instance_snapshot.sql', 'original_file_path': 'snapshots/sfdc/sfdc_ao_instance_snapshot.sql', 'name': 'sfdc_ao_instance_snapshot2', 'alias': 'sfdc_ao_instance_snapshot2', 'checksum': {'name': 'sha256', 'checksum': 'a460b3d1add6700b47970262622605cfb9269a593970c22e454ed745d917ae68'}, 'tags': [], 'refs': [['ao_instance_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'target_schema': 'snapshots', 'unique_key': 'ao_instance_id', 'strategy': 'timestamp', 'updated_at': 'systemmodstamp'}, 'created_at': 1666469550.6228323, 'config_call_dict': {'target_schema': 'snapshots', 'unique_key': 'ao_instance_id', 'strategy': 'timestamp', 'updated_at': 'systemmodstamp'}}, 'snapshot.acton_marketing_data.sfdc_contact_snapshot3': {'raw_sql': "\r\n\r\n{{\r\n    config (\r\n        target_schema='snapshots',\r\n        unique_key = 'contact_id',\r\n        strategy='timestamp',\r\n        updated_at='systemmodstamp'\r\n    )\r\n}}\r\n\r\nSELECT *\r\nFROM {{ref('contact_source_xf')}}\r\n\r\n", 'resource_type': 'snapshot', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.contact_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'snapshot', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': 'contact_id', 'on_schema_change': 'ignore', 'grants': {}, 'strategy': 'timestamp', 'target_schema': 'snapshots', 'target_database': None, 'updated_at': 'systemmodstamp', 'check_cols': None, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'snapshots', 'fqn': ['acton_marketing_data', 'sfdc', 'sfdc_contact_snapshot', 'sfdc_contact_snapshot3'], 'unique_id': 'snapshot.acton_marketing_data.sfdc_contact_snapshot3', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sfdc/sfdc_contact_snapshot.sql', 'original_file_path': 'snapshots/sfdc/sfdc_contact_snapshot.sql', 'name': 'sfdc_contact_snapshot3', 'alias': 'sfdc_contact_snapshot3', 'checksum': {'name': 'sha256', 'checksum': 'ebe336e78ae4cf1d1302645a60d243070f30b246039e3c5f7a21ad34858d8034'}, 'tags': [], 'refs': [['contact_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'target_schema': 'snapshots', 'unique_key': 'contact_id', 'strategy': 'timestamp', 'updated_at': 'systemmodstamp'}, 'created_at': 1666469550.6301696, 'config_call_dict': {'target_schema': 'snapshots', 'unique_key': 'contact_id', 'strategy': 'timestamp', 'updated_at': 'systemmodstamp'}}, 'snapshot.acton_marketing_data.sfdc_lead_snapshot2': {'raw_sql': "\r\n\r\n{{\r\n    config (\r\n        target_schema='snapshots',\r\n        unique_key = 'lead_id',\r\n        strategy='timestamp',\r\n        updated_at='systemmodstamp'\r\n    )\r\n}}\r\n\r\nSELECT *\r\nFROM {{ref('lead_source_xf')}}\r\n\r\n", 'resource_type': 'snapshot', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.lead_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'snapshot', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': 'lead_id', 'on_schema_change': 'ignore', 'grants': {}, 'strategy': 'timestamp', 'target_schema': 'snapshots', 'target_database': None, 'updated_at': 'systemmodstamp', 'check_cols': None, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'snapshots', 'fqn': ['acton_marketing_data', 'sfdc', 'sfdc_lead_snapshot', 'sfdc_lead_snapshot2'], 'unique_id': 'snapshot.acton_marketing_data.sfdc_lead_snapshot2', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sfdc/sfdc_lead_snapshot.sql', 'original_file_path': 'snapshots/sfdc/sfdc_lead_snapshot.sql', 'name': 'sfdc_lead_snapshot2', 'alias': 'sfdc_lead_snapshot2', 'checksum': {'name': 'sha256', 'checksum': '1a754d6245739970a6da29d20fcbbe9f33b9663f456c6206b0fca3c6218128ee'}, 'tags': [], 'refs': [['lead_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'target_schema': 'snapshots', 'unique_key': 'lead_id', 'strategy': 'timestamp', 'updated_at': 'systemmodstamp'}, 'created_at': 1666469550.6350334, 'config_call_dict': {'target_schema': 'snapshots', 'unique_key': 'lead_id', 'strategy': 'timestamp', 'updated_at': 'systemmodstamp'}}, 'snapshot.acton_marketing_data.sfdc_contract_snapshot2': {'raw_sql': "\r\n\r\n{{\r\n    config (\r\n        target_schema='snapshots',\r\n        unique_key = 'contract_id',\r\n        strategy='timestamp',\r\n        updated_at='systemmodstamp'\r\n    )\r\n}}\r\n\r\nSELECT *\r\nFROM {{ref('contract_source_xf')}}\r\n\r\n", 'resource_type': 'snapshot', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.contract_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'snapshot', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': 'contract_id', 'on_schema_change': 'ignore', 'grants': {}, 'strategy': 'timestamp', 'target_schema': 'snapshots', 'target_database': None, 'updated_at': 'systemmodstamp', 'check_cols': None, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'snapshots', 'fqn': ['acton_marketing_data', 'sfdc', 'sfdc_contract_snapshot', 'sfdc_contract_snapshot2'], 'unique_id': 'snapshot.acton_marketing_data.sfdc_contract_snapshot2', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sfdc/sfdc_contract_snapshot.sql', 'original_file_path': 'snapshots/sfdc/sfdc_contract_snapshot.sql', 'name': 'sfdc_contract_snapshot2', 'alias': 'sfdc_contract_snapshot2', 'checksum': {'name': 'sha256', 'checksum': '35f0e1350b2f58119b5047c2ab9b675ee33c47225cb611378f7ec462fcfbb026'}, 'tags': [], 'refs': [['contract_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'target_schema': 'snapshots', 'unique_key': 'contract_id', 'strategy': 'timestamp', 'updated_at': 'systemmodstamp'}, 'created_at': 1666469550.6397629, 'config_call_dict': {'target_schema': 'snapshots', 'unique_key': 'contract_id', 'strategy': 'timestamp', 'updated_at': 'systemmodstamp'}}, 'snapshot.acton_marketing_data.sfdc_ao_instance_user_snapshot2': {'raw_sql': "\r\n\r\n{{\r\n    config (\r\n        target_schema='snapshots',\r\n        unique_key = 'ao_user_id',\r\n        strategy='timestamp',\r\n        updated_at='systemmodstamp'\r\n    )\r\n}}\r\n\r\nSELECT *\r\nFROM {{ref('ao_instance_user_source_xf')}}\r\n\r\n", 'resource_type': 'snapshot', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.ao_instance_user_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'snapshot', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': 'ao_user_id', 'on_schema_change': 'ignore', 'grants': {}, 'strategy': 'timestamp', 'target_schema': 'snapshots', 'target_database': None, 'updated_at': 'systemmodstamp', 'check_cols': None, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'snapshots', 'fqn': ['acton_marketing_data', 'sfdc', 'sfdc_ao_instance_user_snapshot', 'sfdc_ao_instance_user_snapshot2'], 'unique_id': 'snapshot.acton_marketing_data.sfdc_ao_instance_user_snapshot2', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sfdc/sfdc_ao_instance_user_snapshot.sql', 'original_file_path': 'snapshots/sfdc/sfdc_ao_instance_user_snapshot.sql', 'name': 'sfdc_ao_instance_user_snapshot2', 'alias': 'sfdc_ao_instance_user_snapshot2', 'checksum': {'name': 'sha256', 'checksum': 'dfd908b80531bd2d3a0916d3278548a2d15c620aa5e02950ca839a07f1f1da4f'}, 'tags': [], 'refs': [['ao_instance_user_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'target_schema': 'snapshots', 'unique_key': 'ao_user_id', 'strategy': 'timestamp', 'updated_at': 'systemmodstamp'}, 'created_at': 1666469550.6446018, 'config_call_dict': {'target_schema': 'snapshots', 'unique_key': 'ao_user_id', 'strategy': 'timestamp', 'updated_at': 'systemmodstamp'}}, 'snapshot.acton_marketing_data.sfdc_account_snapshot4': {'raw_sql': "\r\n\r\n{{\r\n    config (\r\n        target_schema='snapshots',\r\n        unique_key = 'account_id',\r\n        strategy='timestamp',\r\n        updated_at='systemmodstamp'\r\n    )\r\n    \r\n}}\r\n\r\nSELECT *\r\nFROM {{ref('account_source_xf')}}\r\n\r\n", 'resource_type': 'snapshot', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.account_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'snapshot', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': 'account_id', 'on_schema_change': 'ignore', 'grants': {}, 'strategy': 'timestamp', 'target_schema': 'snapshots', 'target_database': None, 'updated_at': 'systemmodstamp', 'check_cols': None, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'snapshots', 'fqn': ['acton_marketing_data', 'sfdc', 'sfdc_account_snapshot', 'sfdc_account_snapshot4'], 'unique_id': 'snapshot.acton_marketing_data.sfdc_account_snapshot4', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sfdc/sfdc_account_snapshot.sql', 'original_file_path': 'snapshots/sfdc/sfdc_account_snapshot.sql', 'name': 'sfdc_account_snapshot4', 'alias': 'sfdc_account_snapshot4', 'checksum': {'name': 'sha256', 'checksum': '36e888f60e98924cf2cdadb8382f845e0210d955651783037f0e50181be3e304'}, 'tags': [], 'refs': [['account_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'target_schema': 'snapshots', 'unique_key': 'account_id', 'strategy': 'timestamp', 'updated_at': 'systemmodstamp'}, 'created_at': 1666469550.6497025, 'config_call_dict': {'target_schema': 'snapshots', 'unique_key': 'account_id', 'strategy': 'timestamp', 'updated_at': 'systemmodstamp'}}, 'snapshot.acton_marketing_data.sfdc_opportunity_snapshot2': {'raw_sql': "\r\n\r\n{{\r\n    config (\r\n        target_schema='snapshots',\r\n        unique_key = 'opportunity_id',\r\n        strategy='timestamp',\r\n        updated_at='systemmodstamp'\r\n    )\r\n}}\r\n\r\nSELECT *\r\nFROM {{ref('opp_source_xf')}}\r\n\r\n", 'resource_type': 'snapshot', 'depends_on': {'macros': [], 'nodes': ['model.acton_marketing_data.opp_source_xf']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'snapshot', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': 'opportunity_id', 'on_schema_change': 'ignore', 'grants': {}, 'strategy': 'timestamp', 'target_schema': 'snapshots', 'target_database': None, 'updated_at': 'systemmodstamp', 'check_cols': None, 'post-hook': [], 'pre-hook': []}, 'database': 'acton', 'schema': 'snapshots', 'fqn': ['acton_marketing_data', 'sfdc', 'sfdc_opportunity_snapshot', 'sfdc_opportunity_snapshot2'], 'unique_id': 'snapshot.acton_marketing_data.sfdc_opportunity_snapshot2', 'package_name': 'acton_marketing_data', 'root_path': '/usr/src/develop/user-23113/environment-95395/repository-76981', 'path': 'sfdc/sfdc_opportunity_snapshot.sql', 'original_file_path': 'snapshots/sfdc/sfdc_opportunity_snapshot.sql', 'name': 'sfdc_opportunity_snapshot2', 'alias': 'sfdc_opportunity_snapshot2', 'checksum': {'name': 'sha256', 'checksum': 'b51fb000a612300d8cebed81ee4d28addbb6e2983ebfbdb6cba7fe82d336872d'}, 'tags': [], 'refs': [['opp_source_xf']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'target_schema': 'snapshots', 'unique_key': 'opportunity_id', 'strategy': 'timestamp', 'updated_at': 'systemmodstamp'}, 'created_at': 1666469550.6552517, 'config_call_dict': {'target_schema': 'snapshots', 'unique_key': 'opportunity_id', 'strategy': 'timestamp', 'updated_at': 'systemmodstamp'}}}
[0m16:22:58.438986 [debug] [MainThread]: Parsing macros\common\create_external_table.sql
[0m16:22:58.446097 [debug] [MainThread]: Parsing macros\common\get_external_build_plan.sql
[0m16:22:58.447092 [debug] [MainThread]: Parsing macros\common\refresh_external_table.sql
[0m16:22:58.447092 [debug] [MainThread]: Parsing macros\common\stage_external_sources.sql
[0m16:22:58.455109 [debug] [MainThread]: Parsing macros\adapters.sql
[0m16:22:58.472160 [debug] [MainThread]: Parsing macros\catalog.sql
[0m16:22:58.474155 [debug] [MainThread]: Parsing macros\relations.sql
[0m16:22:58.475152 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m16:22:58.476149 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m16:22:58.477146 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m16:22:58.479141 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m16:22:58.479141 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m16:22:58.480138 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m16:22:58.484196 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m16:22:58.485193 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m16:22:58.486191 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m16:22:58.487188 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m16:22:58.497228 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m16:22:58.504307 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m16:22:58.506302 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m16:22:58.508297 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m16:22:58.513354 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m16:22:58.516346 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m16:22:58.528375 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m16:22:58.530370 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m16:22:58.533542 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m16:22:58.539524 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m16:22:58.544575 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m16:22:58.545573 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m16:22:58.546570 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m16:22:58.547569 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m16:22:58.548566 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m16:22:58.550559 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m16:22:58.551557 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m16:22:58.553625 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m16:22:58.555620 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m16:22:58.558612 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m16:22:58.565677 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m16:22:58.574653 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m16:22:58.575652 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m16:22:58.587621 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m16:22:58.599586 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m16:22:58.605572 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m16:22:58.607566 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m16:22:58.612629 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m16:22:58.614647 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m16:22:58.616644 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m16:22:58.618642 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m16:22:58.622680 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m16:22:58.635774 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m16:22:58.640760 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m16:22:58.651907 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m16:22:58.659978 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m16:22:58.662028 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m16:22:58.675057 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m16:22:58.676054 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m16:22:58.680048 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m16:22:58.681042 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m16:22:58.687115 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m16:22:58.688109 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m16:22:58.689107 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m16:22:58.690104 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m16:22:58.691102 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m16:22:58.692154 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m16:22:58.693152 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m16:22:58.694149 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m16:22:58.699135 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m16:22:58.700133 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m16:22:58.701130 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m16:22:58.702128 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m16:22:58.703175 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m16:22:58.704172 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m16:22:58.705171 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m16:22:58.706167 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m16:22:58.708162 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m16:22:58.709159 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m16:22:58.711154 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m16:22:58.711208 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m16:22:58.712206 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m16:22:58.713203 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m16:22:58.714201 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m16:22:58.715198 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m16:22:58.717193 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m16:22:58.719187 [debug] [MainThread]: Parsing macros\get_base_dates.sql
[0m16:22:58.723225 [debug] [MainThread]: Parsing macros\get_date_dimension.sql
[0m16:22:58.740232 [debug] [MainThread]: Parsing macros\calendar_date\convert_timezone.sql
[0m16:22:58.743301 [debug] [MainThread]: Parsing macros\calendar_date\date_part.sql
[0m16:22:58.745308 [debug] [MainThread]: Parsing macros\calendar_date\day_name.sql
[0m16:22:58.748288 [debug] [MainThread]: Parsing macros\calendar_date\day_of_month.sql
[0m16:22:58.749286 [debug] [MainThread]: Parsing macros\calendar_date\day_of_week.sql
[0m16:22:58.754319 [debug] [MainThread]: Parsing macros\calendar_date\day_of_year.sql
[0m16:22:58.756314 [debug] [MainThread]: Parsing macros\calendar_date\from_unixtimestamp.sql
[0m16:22:58.760302 [debug] [MainThread]: Parsing macros\calendar_date\iso_week_end.sql
[0m16:22:58.762372 [debug] [MainThread]: Parsing macros\calendar_date\iso_week_of_year.sql
[0m16:22:58.764367 [debug] [MainThread]: Parsing macros\calendar_date\iso_week_start.sql
[0m16:22:58.766362 [debug] [MainThread]: Parsing macros\calendar_date\last_month.sql
[0m16:22:58.767359 [debug] [MainThread]: Parsing macros\calendar_date\last_month_name.sql
[0m16:22:58.767359 [debug] [MainThread]: Parsing macros\calendar_date\last_month_number.sql
[0m16:22:58.768356 [debug] [MainThread]: Parsing macros\calendar_date\last_week.sql
[0m16:22:58.769353 [debug] [MainThread]: Parsing macros\calendar_date\month_name.sql
[0m16:22:58.771348 [debug] [MainThread]: Parsing macros\calendar_date\next_month.sql
[0m16:22:58.772346 [debug] [MainThread]: Parsing macros\calendar_date\next_month_name.sql
[0m16:22:58.772346 [debug] [MainThread]: Parsing macros\calendar_date\next_month_number.sql
[0m16:22:58.773392 [debug] [MainThread]: Parsing macros\calendar_date\next_week.sql
[0m16:22:58.773392 [debug] [MainThread]: Parsing macros\calendar_date\now.sql
[0m16:22:58.775387 [debug] [MainThread]: Parsing macros\calendar_date\n_days_ago.sql
[0m16:22:58.776384 [debug] [MainThread]: Parsing macros\calendar_date\n_days_away.sql
[0m16:22:58.777381 [debug] [MainThread]: Parsing macros\calendar_date\n_months_ago.sql
[0m16:22:58.778378 [debug] [MainThread]: Parsing macros\calendar_date\n_months_away.sql
[0m16:22:58.778378 [debug] [MainThread]: Parsing macros\calendar_date\n_weeks_ago.sql
[0m16:22:58.779376 [debug] [MainThread]: Parsing macros\calendar_date\n_weeks_away.sql
[0m16:22:58.780373 [debug] [MainThread]: Parsing macros\calendar_date\periods_since.sql
[0m16:22:58.781428 [debug] [MainThread]: Parsing macros\calendar_date\round_timestamp.sql
[0m16:22:58.782426 [debug] [MainThread]: Parsing macros\calendar_date\today.sql
[0m16:22:58.782426 [debug] [MainThread]: Parsing macros\calendar_date\tomorrow.sql
[0m16:22:58.783423 [debug] [MainThread]: Parsing macros\calendar_date\to_unixtimestamp.sql
[0m16:22:58.784420 [debug] [MainThread]: Parsing macros\calendar_date\week_end.sql
[0m16:22:58.786416 [debug] [MainThread]: Parsing macros\calendar_date\week_of_year.sql
[0m16:22:58.788410 [debug] [MainThread]: Parsing macros\calendar_date\week_start.sql
[0m16:22:58.790404 [debug] [MainThread]: Parsing macros\calendar_date\yesterday.sql
[0m16:22:58.790404 [debug] [MainThread]: Parsing macros\fiscal_date\get_fiscal_periods.sql
[0m16:22:58.792455 [debug] [MainThread]: Parsing macros\fiscal_date\get_fiscal_year_dates.sql
[0m16:22:58.795449 [debug] [MainThread]: Parsing macros\common\create_external_table.sql
[0m16:22:58.796446 [debug] [MainThread]: Parsing macros\common\get_external_build_plan.sql
[0m16:22:58.797442 [debug] [MainThread]: Parsing macros\common\refresh_external_table.sql
[0m16:22:58.797442 [debug] [MainThread]: Parsing macros\common\stage_external_sources.sql
[0m16:22:58.805469 [debug] [MainThread]: Parsing macros\common\helpers\dropif.sql
[0m16:22:58.806466 [debug] [MainThread]: Parsing macros\common\helpers\transaction.sql
[0m16:22:58.807465 [debug] [MainThread]: Parsing macros\plugins\bigquery\create_external_table.sql
[0m16:22:58.811453 [debug] [MainThread]: Parsing macros\plugins\bigquery\get_external_build_plan.sql
[0m16:22:58.812490 [debug] [MainThread]: Parsing macros\plugins\redshift\create_external_table.sql
[0m16:22:58.815482 [debug] [MainThread]: Parsing macros\plugins\redshift\get_external_build_plan.sql
[0m16:22:58.817476 [debug] [MainThread]: Parsing macros\plugins\redshift\refresh_external_table.sql
[0m16:22:58.823506 [debug] [MainThread]: Parsing macros\plugins\redshift\helpers\add_partitions.sql
[0m16:22:58.826499 [debug] [MainThread]: Parsing macros\plugins\redshift\helpers\dropif.sql
[0m16:22:58.827497 [debug] [MainThread]: Parsing macros\plugins\redshift\helpers\is_ext_tbl.sql
[0m16:22:58.829492 [debug] [MainThread]: Parsing macros\plugins\redshift\helpers\paths.sql
[0m16:22:58.830490 [debug] [MainThread]: Parsing macros\plugins\redshift\helpers\render_macro.sql
[0m16:22:58.832484 [debug] [MainThread]: Parsing macros\plugins\redshift\helpers\transaction.sql
[0m16:22:58.832484 [debug] [MainThread]: Parsing macros\plugins\snowflake\create_external_table.sql
[0m16:22:58.836473 [debug] [MainThread]: Parsing macros\plugins\snowflake\get_external_build_plan.sql
[0m16:22:58.839465 [debug] [MainThread]: Parsing macros\plugins\snowflake\refresh_external_table.sql
[0m16:22:58.841460 [debug] [MainThread]: Parsing macros\plugins\snowflake\helpers\is_csv.sql
[0m16:22:58.845449 [debug] [MainThread]: Parsing macros\plugins\snowflake\snowpipe\create_empty_table.sql
[0m16:22:58.846446 [debug] [MainThread]: Parsing macros\plugins\snowflake\snowpipe\create_snowpipe.sql
[0m16:22:58.848441 [debug] [MainThread]: Parsing macros\plugins\snowflake\snowpipe\get_copy_sql.sql
[0m16:22:58.851433 [debug] [MainThread]: Parsing macros\plugins\snowflake\snowpipe\refresh_snowpipe.sql
[0m16:22:58.852430 [debug] [MainThread]: Parsing macros\plugins\spark\create_external_table.sql
[0m16:22:58.855422 [debug] [MainThread]: Parsing macros\plugins\spark\get_external_build_plan.sql
[0m16:22:58.857417 [debug] [MainThread]: Parsing macros\plugins\spark\refresh_external_table.sql
[0m16:22:58.858415 [debug] [MainThread]: Parsing macros\plugins\spark\helpers\dropif.sql
[0m16:22:58.859413 [debug] [MainThread]: Parsing macros\plugins\spark\helpers\recover_partitions.sql
[0m16:22:58.860409 [debug] [MainThread]: Parsing macros\plugins\sqlserver\create_external_table.sql
[0m16:22:58.863402 [debug] [MainThread]: Parsing macros\plugins\sqlserver\get_external_build_plan.sql
[0m16:22:58.864399 [debug] [MainThread]: Parsing macros\plugins\sqlserver\helpers\dropif.sql
[0m16:22:58.865395 [debug] [MainThread]: Parsing macros\cross_db_utils\array_append.sql
[0m16:22:58.867389 [debug] [MainThread]: Parsing macros\cross_db_utils\array_concat.sql
[0m16:22:58.869385 [debug] [MainThread]: Parsing macros\cross_db_utils\array_construct.sql
[0m16:22:58.871380 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_array_to_string.sql
[0m16:22:58.873375 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m16:22:58.877363 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\any_value.sql
[0m16:22:58.878361 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\bool_or.sql
[0m16:22:58.879358 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\cast_bool_to_text.sql
[0m16:22:58.880356 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\concat.sql
[0m16:22:58.881353 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\datatypes.sql
[0m16:22:58.887336 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\dateadd.sql
[0m16:22:58.888334 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\datediff.sql
[0m16:22:58.889332 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\date_trunc.sql
[0m16:22:58.891326 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\escape_single_quotes.sql
[0m16:22:58.892324 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\except.sql
[0m16:22:58.893320 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\hash.sql
[0m16:22:58.894318 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\identifier.sql
[0m16:22:58.896313 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\intersect.sql
[0m16:22:58.897311 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\last_day.sql
[0m16:22:58.898308 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\length.sql
[0m16:22:58.899305 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\listagg.sql
[0m16:22:58.901300 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\literal.sql
[0m16:22:58.902297 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\position.sql
[0m16:22:58.903293 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\replace.sql
[0m16:22:58.905289 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\right.sql
[0m16:22:58.906286 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\safe_cast.sql
[0m16:22:58.907284 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\split_part.sql
[0m16:22:58.908281 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\xdb_deprecation_warning.sql
[0m16:22:58.910276 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m16:22:58.912270 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m16:22:58.913268 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m16:22:58.915262 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m16:22:58.917256 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m16:22:58.919252 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m16:22:58.920249 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m16:22:58.921246 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m16:22:58.928228 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m16:22:58.930223 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m16:22:58.931220 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m16:22:58.932217 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m16:22:58.934211 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m16:22:58.936206 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m16:22:58.938201 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
[0m16:22:58.939198 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
[0m16:22:58.940196 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m16:22:58.943188 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m16:22:58.944185 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m16:22:58.945183 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m16:22:58.946180 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m16:22:58.947177 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_ephemeral.sql
[0m16:22:58.948174 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_relation.sql
[0m16:22:58.949172 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
[0m16:22:58.968121 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m16:22:58.972111 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m16:22:58.977096 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m16:22:58.980089 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m16:22:58.985075 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m16:22:58.987071 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m16:22:58.989065 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m16:22:58.991060 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m16:22:58.994052 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m16:22:58.999038 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m16:22:59.000035 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m16:22:59.001033 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m16:22:59.003028 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m16:22:59.007018 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m16:22:59.008014 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m16:22:59.010009 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m16:22:59.013001 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m16:22:59.013998 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m16:22:59.017988 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m16:22:59.019983 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m16:22:59.028958 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m16:22:59.034943 [debug] [MainThread]: Parsing macros\sql\width_bucket.sql
[0m16:22:59.038932 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m16:22:59.039928 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m16:22:59.041924 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m16:22:59.425925 [debug] [MainThread]: 1699: static parser successfully parsed attribution\attribution_models\combined_attribution.sql
[0m16:22:59.453851 [debug] [MainThread]: 1699: static parser successfully parsed attribution\attribution_models\combined_attribution2.sql
[0m16:22:59.455846 [debug] [MainThread]: 1699: static parser successfully parsed attribution\attribution_models\custom_model.sql
[0m16:22:59.457812 [debug] [MainThread]: 1699: static parser successfully parsed attribution\attribution_models\first_touch.sql
[0m16:22:59.460804 [debug] [MainThread]: 1603: static parser failed on attribution\attribution_models\first_touch2.sql
[0m16:22:59.466788 [debug] [MainThread]: 1602: parser fallback to jinja rendering on attribution\attribution_models\first_touch2.sql
[0m16:22:59.467785 [debug] [MainThread]: 1699: static parser successfully parsed attribution\attribution_models\last_touch.sql
[0m16:22:59.469780 [debug] [MainThread]: 1603: static parser failed on attribution\attribution_models\lead_creation.sql
[0m16:22:59.478756 [debug] [MainThread]: 1602: parser fallback to jinja rendering on attribution\attribution_models\lead_creation.sql
[0m16:22:59.479754 [debug] [MainThread]: 1603: static parser failed on attribution\attribution_models\lead_creation2.sql
[0m16:22:59.483743 [debug] [MainThread]: 1602: parser fallback to jinja rendering on attribution\attribution_models\lead_creation2.sql
[0m16:22:59.484740 [debug] [MainThread]: 1699: static parser successfully parsed attribution\attribution_models\opportunity_creation.sql
[0m16:22:59.487733 [debug] [MainThread]: 1603: static parser failed on attribution\attribution_models\opportunity_creation2.sql
[0m16:22:59.491750 [debug] [MainThread]: 1602: parser fallback to jinja rendering on attribution\attribution_models\opportunity_creation2.sql
[0m16:22:59.493716 [debug] [MainThread]: 1699: static parser successfully parsed campaign_reporting\campaign_primary_source.sql
[0m16:22:59.495739 [debug] [MainThread]: 1699: static parser successfully parsed campaign_reporting\marketo_persons_influenced.sql
[0m16:22:59.497734 [debug] [MainThread]: 1699: static parser successfully parsed cohort_model\avg_lead_to_cw_cohort.sql
[0m16:22:59.499700 [debug] [MainThread]: 1699: static parser successfully parsed cohort_model\avg_lead_to_cw_cohort_count.sql
[0m16:22:59.501724 [debug] [MainThread]: 1603: static parser failed on cohort_model\lead_to_cw_cohort.sql
[0m16:22:59.509674 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.lead_to_cw_cohort model triggered this warning.
[0m16:22:59.516683 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.lead_to_cw_cohort model triggered this warning.
[0m16:22:59.517653 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.lead_to_cw_cohort model triggered this warning.
[0m16:22:59.517653 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.lead_to_cw_cohort model triggered this warning.
[0m16:22:59.519647 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.lead_to_cw_cohort model triggered this warning.
[0m16:22:59.520649 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.lead_to_cw_cohort model triggered this warning.
[0m16:22:59.521642 [debug] [MainThread]: 1602: parser fallback to jinja rendering on cohort_model\lead_to_cw_cohort.sql
[0m16:22:59.523637 [debug] [MainThread]: 1699: static parser successfully parsed cohort_model\opportunities_with_contacts.sql
[0m16:22:59.525631 [debug] [MainThread]: 1699: static parser successfully parsed customer_marketing\customer_power_ups.sql
[0m16:22:59.527626 [debug] [MainThread]: 1699: static parser successfully parsed customer_marketing\new_user\new_account_welcome_series_list.sql
[0m16:22:59.530618 [debug] [MainThread]: 1699: static parser successfully parsed customer_marketing\new_user\new_user_welcome_series_list.sql
[0m16:22:59.532612 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_all.sql
[0m16:22:59.535604 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_asp_to_target.sql
[0m16:22:59.537599 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_clos2cw_velocity.sql
[0m16:22:59.540591 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_clos2cw_velocity model triggered this warning.
[0m16:22:59.541589 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_clos2cw_velocity.sql
[0m16:22:59.543583 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_close_won_velocity.sql
[0m16:22:59.546575 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_close_won_velocity model triggered this warning.
[0m16:22:59.547573 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_close_won_velocity.sql
[0m16:22:59.548570 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_close_won_velocity_annual.sql
[0m16:22:59.552559 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_close_won_velocity_annual model triggered this warning.
[0m16:22:59.554554 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_close_won_velocity_annual.sql
[0m16:22:59.555552 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_closing.sql
[0m16:22:59.557546 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_cohort.sql
[0m16:22:59.560548 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_conversions.sql
[0m16:22:59.562532 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_cwpipe_to_target.sql
[0m16:22:59.564527 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_demo.sql
[0m16:22:59.566522 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_demo2voc_velocity.sql
[0m16:22:59.570511 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_demo2voc_velocity model triggered this warning.
[0m16:22:59.571509 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_demo2voc_velocity.sql
[0m16:22:59.572506 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_filters.sql
[0m16:22:59.575498 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_filters_channelbucket.sql
[0m16:22:59.577492 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_filters_companysizerev.sql
[0m16:22:59.580484 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_filters_date.sql
[0m16:22:59.582479 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_filters_globalregion.sql
[0m16:22:59.585488 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_filters_industry.sql
[0m16:22:59.587466 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_filters_leadsource.sql
[0m16:22:59.589460 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_filters_segment.sql
[0m16:22:59.592454 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_intrapipe_to_target.sql
[0m16:22:59.594447 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_l20_velocity_mlc.sql
[0m16:22:59.597439 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_l20_velocity_mlc model triggered this warning.
[0m16:22:59.598436 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_l20_velocity_mlc.sql
[0m16:22:59.599434 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_l20_velocity_mlc_annual.sql
[0m16:22:59.603423 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_l20_velocity_mlc_annual model triggered this warning.
[0m16:22:59.604421 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_l20_velocity_mlc_annual.sql
[0m16:22:59.605418 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_l20_velocity_opp.sql
[0m16:22:59.608410 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_l20_velocity_opp model triggered this warning.
[0m16:22:59.610404 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_l20_velocity_opp.sql
[0m16:22:59.611402 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_l20_velocity_opp_annual.sql
[0m16:22:59.614394 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_l20_velocity_opp_annual model triggered this warning.
[0m16:22:59.616389 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_l20_velocity_opp_annual.sql
[0m16:22:59.617386 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_l2m_to_target.sql
[0m16:22:59.619380 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_l2m_velocity.sql
[0m16:22:59.623370 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_l2m_velocity model triggered this warning.
[0m16:22:59.624368 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_l2m_velocity.sql
[0m16:22:59.625365 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_leads.sql
[0m16:22:59.628356 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_leads_to_target.sql
[0m16:22:59.630351 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_lost.sql
[0m16:22:59.632346 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_m2sal_velocity.sql
[0m16:22:59.635338 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_m2sal_velocity model triggered this warning.
[0m16:22:59.637333 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_m2sal_velocity.sql
[0m16:22:59.638330 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_m2sql_to_target.sql
[0m16:22:59.641322 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_mql2sql_velocity.sql
[0m16:22:59.644314 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_mql2sql_velocity model triggered this warning.
[0m16:22:59.646308 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_mql2sql_velocity.sql
[0m16:22:59.647307 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_mqls.sql
[0m16:22:59.649301 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_mqls_to_target.sql
[0m16:22:59.651295 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_pipeline.sql
[0m16:22:59.654287 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_sal2sql_velocity.sql
[0m16:22:59.657279 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_sal2sql_velocity model triggered this warning.
[0m16:22:59.658277 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_sal2sql_velocity.sql
[0m16:22:59.660272 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_sals.sql
[0m16:22:59.662269 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_sql2sqo_to_target.sql
[0m16:22:59.664261 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_sql2sqo_velocity.sql
[0m16:22:59.667253 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_sql2sqo_velocity model triggered this warning.
[0m16:22:59.669248 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_sql2sqo_velocity.sql
[0m16:22:59.670245 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_sqls.sql
[0m16:22:59.672240 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_sqls_to_target.sql
[0m16:22:59.675231 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_sqo2demo_velocity.sql
[0m16:22:59.678223 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_sqo2demo_velocity model triggered this warning.
[0m16:22:59.679221 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_sqo2demo_velocity.sql
[0m16:22:59.681215 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_sqo2won_velocity.sql
[0m16:22:59.685204 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_sqo2won_velocity model triggered this warning.
[0m16:22:59.686202 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_sqo2won_velocity.sql
[0m16:22:59.688196 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_sqopipe_to_target.sql
[0m16:22:59.690191 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_sqos.sql
[0m16:22:59.692186 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_sqos_to_target.sql
[0m16:22:59.694180 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_voc.sql
[0m16:22:59.698170 [debug] [MainThread]: 1603: static parser failed on funnel\funnel_report_all_time_voc2closing_velocity.sql
[0m16:22:59.702159 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.funnel_report_all_time_voc2closing_velocity model triggered this warning.
[0m16:22:59.703157 [debug] [MainThread]: 1602: parser fallback to jinja rendering on funnel\funnel_report_all_time_voc2closing_velocity.sql
[0m16:22:59.704154 [debug] [MainThread]: 1699: static parser successfully parsed funnel\funnel_report_all_time_won.sql
[0m16:22:59.707147 [debug] [MainThread]: 1699: static parser successfully parsed funnel_date_updates\marketing_lead_creation_date_history_xf.sql
[0m16:22:59.709141 [debug] [MainThread]: 1699: static parser successfully parsed funnel_date_updates\mql_date_history_xf.sql
[0m16:22:59.711135 [debug] [MainThread]: 1699: static parser successfully parsed funnel_date_updates\opp_closing_date_history_xf.sql
[0m16:22:59.714127 [debug] [MainThread]: 1699: static parser successfully parsed funnel_date_updates\opp_demo_date_history_xf.sql
[0m16:22:59.716121 [debug] [MainThread]: 1699: static parser successfully parsed funnel_date_updates\opp_discovery_date_history_xf.sql
[0m16:22:59.718116 [debug] [MainThread]: 1699: static parser successfully parsed funnel_date_updates\opp_voc_date_history_xf.sql
[0m16:22:59.720111 [debug] [MainThread]: 1699: static parser successfully parsed funnel_date_updates\working_date_history_xf.sql
[0m16:22:59.722106 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\kpi_targets.sql
[0m16:22:59.724101 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\lead_mql_source_ss_xf.sql
[0m16:22:59.726096 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\lead_mql_source_xf.sql
[0m16:22:59.729087 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\opp_closing_source_ss_xf.sql
[0m16:22:59.731082 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\opp_closing_source_xf.sql
[0m16:22:59.733077 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\opp_demo_source_ss_xf.sql
[0m16:22:59.735071 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\opp_demo_source_xf.sql
[0m16:22:59.737066 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\opp_sales_source_xf.sql
[0m16:22:59.740058 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\opp_voc_source_ss_xf.sql
[0m16:22:59.742053 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\opp_voc_source_xf.sql
[0m16:22:59.744047 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\person_source_xf.sql
[0m16:22:59.746042 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\sal_source_ss_xf.sql
[0m16:22:59.748037 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\sal_source_xf.sql
[0m16:22:59.750031 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\sql_source_ss_xf.sql
[0m16:22:59.752026 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\sql_source_xf.sql
[0m16:22:59.755018 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\sqo_source_ss_xf.sql
[0m16:22:59.759007 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\sqo_source_xf.sql
[0m16:22:59.761002 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\disco calls\wow_disco_missing.sql
[0m16:22:59.762997 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\disco calls\wow_disco_pastdue.sql
[0m16:22:59.764992 [debug] [MainThread]: 1699: static parser successfully parsed kpi_definitions\disco calls\wow_disco_scheduled.sql
[0m16:22:59.766986 [debug] [MainThread]: 1699: static parser successfully parsed sources\date_base_xf.sql
[0m16:22:59.769978 [debug] [MainThread]: 1699: static parser successfully parsed sources\ao_data\ao_data_raw\ao_emails.sql
[0m16:22:59.771973 [debug] [MainThread]: 1699: static parser successfully parsed sources\ao_data\ao_data_raw\ao_email_to_uid.sql
[0m16:22:59.774967 [debug] [MainThread]: 1699: static parser successfully parsed sources\ao_data\ao_data_raw\ao_forms.sql
[0m16:22:59.776959 [debug] [MainThread]: 1699: static parser successfully parsed sources\ao_data\ao_data_raw\ao_landingpages.sql
[0m16:22:59.778954 [debug] [MainThread]: 1699: static parser successfully parsed sources\ao_data\ao_data_raw\ao_media.sql
[0m16:22:59.780949 [debug] [MainThread]: 1699: static parser successfully parsed sources\ao_data\ao_data_raw\ao_webinars.sql
[0m16:22:59.782944 [debug] [MainThread]: 1699: static parser successfully parsed sources\ao_data\ao_data_raw\ao_webpages.sql
[0m16:22:59.786933 [debug] [MainThread]: 1603: static parser failed on sources\ao_data\ao_data_xf\ao_combined.sql
[0m16:22:59.812895 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources\ao_data\ao_data_xf\ao_combined.sql
[0m16:22:59.813889 [debug] [MainThread]: 1699: static parser successfully parsed sources\ao_data\ao_data_xf\ao_emails_xf.sql
[0m16:22:59.815889 [debug] [MainThread]: 1699: static parser successfully parsed sources\ao_data\ao_data_xf\ao_forms_xf.sql
[0m16:22:59.817879 [debug] [MainThread]: 1699: static parser successfully parsed sources\ao_data\ao_data_xf\ao_landingpages_xf.sql
[0m16:22:59.820859 [debug] [MainThread]: 1699: static parser successfully parsed sources\ao_data\ao_data_xf\ao_media_xf.sql
[0m16:22:59.822862 [debug] [MainThread]: 1699: static parser successfully parsed sources\ao_data\ao_data_xf\ao_webinars_xf.sql
[0m16:22:59.824860 [debug] [MainThread]: 1699: static parser successfully parsed sources\ao_data\ao_data_xf\ao_webpages_xf.sql
[0m16:22:59.826854 [debug] [MainThread]: 1603: static parser failed on sources\sfdc\sfdc_xf\account_source_xf.sql
[0m16:22:59.833808 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources\sfdc\sfdc_xf\account_source_xf.sql
[0m16:22:59.834804 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\ao_instance_source_xf.sql
[0m16:22:59.836799 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\ao_instance_user_source_xf.sql
[0m16:22:59.840789 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\campaign_influence_xf.sql
[0m16:22:59.843781 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\campaign_member_source_xf.sql
[0m16:22:59.845776 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\campaign_source_xf.sql
[0m16:22:59.847770 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\contact_history_xf.sql
[0m16:22:59.849765 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\contact_source_xf.sql
[0m16:22:59.851760 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\contract_source_xf.sql
[0m16:22:59.854752 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\lead_history_xf.sql
[0m16:22:59.856747 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\lead_source_ss_xf.sql
[0m16:22:59.858742 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\lead_source_xf.sql
[0m16:22:59.860737 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\opportunity_history_xf.sql
[0m16:22:59.862730 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\opportunity_line_item_xf.sql
[0m16:22:59.865722 [debug] [MainThread]: 1603: static parser failed on sources\sfdc\sfdc_xf\opp_source_xf.sql
[0m16:22:59.871736 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.opp_source_xf model triggered this warning.
[0m16:22:59.872710 [warn ] [MainThread]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.opp_source_xf model triggered this warning.
[0m16:22:59.875724 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources\sfdc\sfdc_xf\opp_source_xf.sql
[0m16:22:59.877690 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\product_xf.sql
[0m16:22:59.879685 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\quote_line.sql
[0m16:22:59.881680 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\task_source_xf.sql
[0m16:22:59.883674 [debug] [MainThread]: 1699: static parser successfully parsed sources\sfdc\sfdc_xf\user_source_xf.sql
[0m16:22:59.885669 [debug] [MainThread]: 1603: static parser failed on test\test.sql
[0m16:22:59.889658 [debug] [MainThread]: 1602: parser fallback to jinja rendering on test\test.sql
[0m16:22:59.890656 [debug] [MainThread]: 1699: static parser successfully parsed topo_model\topo_all.sql
[0m16:22:59.893648 [debug] [MainThread]: 1699: static parser successfully parsed topo_model\topo_closing.sql
[0m16:22:59.895642 [debug] [MainThread]: 1699: static parser successfully parsed topo_model\topo_demos.sql
[0m16:22:59.897637 [debug] [MainThread]: 1699: static parser successfully parsed topo_model\topo_leads.sql
[0m16:22:59.899632 [debug] [MainThread]: 1699: static parser successfully parsed topo_model\topo_lost.sql
[0m16:22:59.902623 [debug] [MainThread]: 1699: static parser successfully parsed topo_model\topo_mqls.sql
[0m16:22:59.904618 [debug] [MainThread]: 1699: static parser successfully parsed topo_model\topo_pipe.sql
[0m16:22:59.907610 [debug] [MainThread]: 1699: static parser successfully parsed topo_model\topo_sals.sql
[0m16:22:59.909605 [debug] [MainThread]: 1699: static parser successfully parsed topo_model\topo_sqls.sql
[0m16:22:59.911600 [debug] [MainThread]: 1699: static parser successfully parsed topo_model\topo_sqos.sql
[0m16:22:59.913595 [debug] [MainThread]: 1699: static parser successfully parsed topo_model\topo_voc.sql
[0m16:22:59.916586 [debug] [MainThread]: 1699: static parser successfully parsed topo_model\topo_won.sql
[0m16:22:59.918581 [debug] [MainThread]: 1699: static parser successfully parsed topo_model\topo_won_acv.sql
[0m16:23:00.111033 [info ] [MainThread]: Found 143 models, 0 tests, 7 snapshots, 0 analyses, 631 macros, 0 operations, 0 seed files, 24 sources, 0 exposures, 0 metrics
[0m16:23:00.115123 [info ] [MainThread]: 
[0m16:23:00.115123 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:23:00.116121 [debug] [ThreadPool]: Acquiring new postgres connection "list_acton"
[0m16:23:00.125146 [debug] [ThreadPool]: Using postgres connection "list_acton"
[0m16:23:00.125146 [debug] [ThreadPool]: On list_acton: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "connection_name": "list_acton"} */

    select distinct nspname from pg_namespace
  
[0m16:23:00.126143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:00.626646 [debug] [ThreadPool]: SQL status: SELECT 166 in 0.5 seconds
[0m16:23:00.627615 [debug] [ThreadPool]: On list_acton: Close
[0m16:23:00.634741 [debug] [ThreadPool]: Acquiring new postgres connection "list_acton_Postgres"
[0m16:23:00.635722 [debug] [ThreadPool]: Acquiring new postgres connection "list_acton_snapshots"
[0m16:23:00.640709 [debug] [ThreadPool]: Using postgres connection "list_acton_Postgres"
[0m16:23:00.643791 [debug] [ThreadPool]: Using postgres connection "list_acton_snapshots"
[0m16:23:00.643791 [debug] [ThreadPool]: On list_acton_Postgres: BEGIN
[0m16:23:00.644796 [debug] [ThreadPool]: On list_acton_snapshots: BEGIN
[0m16:23:00.644796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:00.644796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:01.034324 [debug] [ThreadPool]: SQL status: BEGIN in 0.39 seconds
[0m16:23:01.034324 [debug] [ThreadPool]: Using postgres connection "list_acton_snapshots"
[0m16:23:01.034324 [debug] [ThreadPool]: On list_acton_snapshots: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "connection_name": "list_acton_snapshots"} */
select
      'acton' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'acton' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m16:23:01.045330 [debug] [ThreadPool]: SQL status: BEGIN in 0.4 seconds
[0m16:23:01.046296 [debug] [ThreadPool]: Using postgres connection "list_acton_Postgres"
[0m16:23:01.046296 [debug] [ThreadPool]: On list_acton_Postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "connection_name": "list_acton_Postgres"} */
select
      'acton' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'Postgres'
    union all
    select
      'acton' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'Postgres'
  
[0m16:23:01.086888 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.05 seconds
[0m16:23:01.088415 [debug] [ThreadPool]: On list_acton_snapshots: ROLLBACK
[0m16:23:01.137825 [debug] [ThreadPool]: On list_acton_snapshots: Close
[0m16:23:01.141837 [debug] [ThreadPool]: SQL status: SELECT 292 in 0.1 seconds
[0m16:23:01.146839 [debug] [ThreadPool]: On list_acton_Postgres: ROLLBACK
[0m16:23:01.190264 [debug] [ThreadPool]: On list_acton_Postgres: Close
[0m16:23:01.201415 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:01.202514 [debug] [MainThread]: On master: BEGIN
[0m16:23:01.202514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:01.579727 [debug] [MainThread]: SQL status: BEGIN in 0.38 seconds
[0m16:23:01.579727 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:01.579727 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:23:01.633269 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m16:23:01.634269 [debug] [MainThread]: On master: ROLLBACK
[0m16:23:01.680558 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:01.681111 [debug] [MainThread]: On master: BEGIN
[0m16:23:01.776267 [debug] [MainThread]: SQL status: BEGIN in 0.1 seconds
[0m16:23:01.776267 [debug] [MainThread]: On master: COMMIT
[0m16:23:01.776267 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:01.776267 [debug] [MainThread]: On master: COMMIT
[0m16:23:01.823250 [debug] [MainThread]: SQL status: COMMIT in 0.05 seconds
[0m16:23:01.823250 [debug] [MainThread]: On master: Close
[0m16:23:01.824250 [info ] [MainThread]: Concurrency: 5 threads (target='postgres')
[0m16:23:01.824250 [info ] [MainThread]: 
[0m16:23:01.854511 [debug] [Thread-1 (]: Began running node model.acton_marketing_data.combined_attribution2
[0m16:23:01.854511 [info ] [Thread-1 (]: 1 of 1 START sql table model Postgres.combined_attribution2 .................... [RUN]
[0m16:23:01.855508 [debug] [Thread-1 (]: Acquiring new postgres connection "model.acton_marketing_data.combined_attribution2"
[0m16:23:01.855508 [debug] [Thread-1 (]: Began compiling node model.acton_marketing_data.combined_attribution2
[0m16:23:01.856506 [debug] [Thread-1 (]: Compiling model.acton_marketing_data.combined_attribution2
[0m16:23:01.860495 [debug] [Thread-1 (]: Writing injected SQL for node "model.acton_marketing_data.combined_attribution2"
[0m16:23:01.861492 [debug] [Thread-1 (]: finished collecting timing info
[0m16:23:01.861492 [debug] [Thread-1 (]: Began executing node model.acton_marketing_data.combined_attribution2
[0m16:23:01.898394 [debug] [Thread-1 (]: Writing runtime sql for node "model.acton_marketing_data.combined_attribution2"
[0m16:23:01.899391 [debug] [Thread-1 (]: Using postgres connection "model.acton_marketing_data.combined_attribution2"
[0m16:23:01.899391 [debug] [Thread-1 (]: On model.acton_marketing_data.combined_attribution2: BEGIN
[0m16:23:01.899391 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:23:02.263250 [debug] [Thread-1 (]: SQL status: BEGIN in 0.36 seconds
[0m16:23:02.263250 [debug] [Thread-1 (]: Using postgres connection "model.acton_marketing_data.combined_attribution2"
[0m16:23:02.263250 [debug] [Thread-1 (]: On model.acton_marketing_data.combined_attribution2: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.combined_attribution2"} */

  
    

  create  table "acton"."Postgres"."combined_attribution2__dbt_tmp"
  as (
    

WITH ao_combined AS (

   SELECT *
   FROM "acton"."Postgres"."ao_combined" 

), lead_creation AS (

    SELECT *
    FROM "acton"."Postgres"."lead_creation2"

), first_touch AS (

    SELECT *
    FROM "acton"."Postgres"."first_touch2"

), last_touch AS (

    SELECT *
    FROM "acton"."Postgres"."last_touch"

), opportunity_creation AS (

    SELECT *
    FROM "acton"."Postgres"."opportunity_creation2"

), linear_base AS (

    SELECT
        email,
        COUNT(DISTINCT touchpoint_id)::Decimal AS linear_touches
    FROM ao_combined
    GROUP BY 1
        
), linear_final AS (

    SELECT
        ao_combined.email,
        touchpoint_id,
        action,
        action_time,
        action_day,
        asset_id,
        asset_title,
        subject_line,
        from_address,
        clicked_url,
        clickthrough_link_name,
        referral_url,
        event_id,
        asset_type,
        1/linear_touches AS linear_weight
    FROM ao_combined
    LEFT JOIN linear_base ON 
    ao_combined.email=linear_base.email

), unioned AS (

    SELECT
        touchpoint_id,
        0 AS first_touch_weight,
        0 AS lead_creation_weight,
        opp_creation_weight,
        0 AS u_shaped_weight,
        w_shaped_weight,
        full_path_weight
    FROM opportunity_creation
    UNION ALL
    SELECT
        touchpoint_id,
        0 AS first_touch_weight,
        lead_creation_weight,
        0 AS opp_creation_weight,
        u_shaped_weight,
        w_shaped_weight,
        full_path_weight
    FROM lead_creation
    UNION ALL
    SELECT
        touchpoint_id,
        first_touch_weight,
        0 AS lead_creation_weight,
        0 AS opp_creation_weight,
        u_shaped_weight,
        w_shaped_weight,
        full_path_weight
    FROM first_touch

), unioned_final AS (

    SELECT
        touchpoint_id,
        SUM(first_touch_weight) AS first_touch_weight,
        SUM(lead_creation_weight) AS lead_creation_weight,
        SUM(opp_creation_weight) AS opp_creation_weight,
        SUM(u_shaped_weight) AS u_shaped_weight,
        SUM(w_shaped_weight) AS w_shaped_weight,
        SUM(full_path_weight) AS full_path_weight
    FROM unioned
    GROUP BY 1

), final_prep AS (

    SELECT
        linear_final.touchpoint_id,
        first_touch_weight,
        lead_creation_weight,
        opp_creation_weight,
        u_shaped_weight,
        w_shaped_weight,
        full_path_weight,
        linear_weight
    FROM linear_final
    LEFT JOIN unioned_final ON
    unioned_final.touchpoint_id=linear_final.touchpoint_id

), final AS (

    SELECT
    -- Key IDs
        lead_to_cw_cohort.email,
        ao_combined.touchpoint_id,
        opportunity_id,
        person_id,

    -- Dates
        person_created_date,
        marketing_created_date,
        mql_created_date,
        sal_created_date,
        opp_created_date,
        discovery_date,
        demo_date,
        voc_date,
        closing_date,
        ao_combined.action_time,
        ao_combined.action_day,

    --Opportunity Information
        lead_to_cw_cohort.acv,

    --Touchpoint Information
        ao_combined.action,
        ao_combined.asset_id,
        ao_combined.asset_title,
        ao_combined.subject_line,
        ao_combined.from_address,
        ao_combined.clicked_url,
        ao_combined.clickthrough_link_name,
        ao_combined.referral_url,
        ao_combined.event_id,
        ao_combined.asset_type,
        CONCAT_WS(',',first_touch.ft_position,lead_creation.lc_position,opportunity_creation.oc_position,last_touch.lt_position) AS touchpoint_position,

    --Touchpoint Weights
        final_prep.first_touch_weight,
        final_prep.lead_creation_weight,
        final_prep.opp_creation_weight,
        final_prep.u_shaped_weight,
        final_prep.w_shaped_weight,
        final_prep.full_path_weight,
        final_prep.linear_weight,

    --Touchpoint ACV Weights
        lead_to_cw_cohort.acv*final_prep.first_touch_weight AS first_touch_acv,
        lead_to_cw_cohort.acv*final_prep.lead_creation_weight AS lead_creation_acv,
        lead_to_cw_cohort.acv*final_prep.opp_creation_weight AS opp_creation_acv,
        lead_to_cw_cohort.acv*final_prep.u_shaped_weight AS u_shaped_acv,
        lead_to_cw_cohort.acv*final_prep.w_shaped_weight AS w_shaped_acv,
        lead_to_cw_cohort.acv*final_prep.full_path_weight AS full_path_acv,
        lead_to_cw_cohort.acv*final_prep.linear_weight AS linear_acv
    FROM ao_combined
    LEFT JOIN final_prep ON
    ao_combined.touchpoint_id=final_prep.touchpoint_id
    LEFT JOIN "acton"."Postgres"."lead_to_cw_cohort" ON
    ao_combined.email=lead_to_cw_cohort.email
    LEFT JOIN lead_creation ON 
    ao_combined.touchpoint_id=lead_creation.touchpoint_id
    LEFT JOIN opportunity_creation ON 
    ao_combined.touchpoint_id=opportunity_creation.touchpoint_id
    LEFT JOIN first_touch ON 
    ao_combined.touchpoint_id=first_touch.touchpoint_id
    LEFT JOIN last_touch ON 
    ao_combined.touchpoint_id=last_touch.touchpoint_id

)

SELECT *
FROM final
  );
  
[0m16:23:02.314366 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "Postgres.ao_combined" does not exist
LINE 13:    FROM "acton"."Postgres"."ao_combined" 
                 ^

[0m16:23:02.314366 [debug] [Thread-1 (]: On model.acton_marketing_data.combined_attribution2: ROLLBACK
[0m16:23:02.361666 [debug] [Thread-1 (]: finished collecting timing info
[0m16:23:02.361666 [debug] [Thread-1 (]: On model.acton_marketing_data.combined_attribution2: Close
[0m16:23:02.362666 [debug] [Thread-1 (]: Database Error in model combined_attribution2 (models\attribution\attribution_models\combined_attribution2.sql)
  relation "Postgres.ao_combined" does not exist
  LINE 13:    FROM "acton"."Postgres"."ao_combined" 
                   ^
  compiled Code at target\run\acton_marketing_data\models\attribution\attribution_models\combined_attribution2.sql
[0m16:23:02.362666 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model Postgres.combined_attribution2 ........... [[31mERROR[0m in 0.51s]
[0m16:23:02.363663 [debug] [Thread-1 (]: Finished running node model.acton_marketing_data.combined_attribution2
[0m16:23:02.364689 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:23:02.365685 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:02.365685 [debug] [MainThread]: On master: BEGIN
[0m16:23:02.365685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:23:02.752392 [debug] [MainThread]: SQL status: BEGIN in 0.39 seconds
[0m16:23:02.752392 [debug] [MainThread]: On master: COMMIT
[0m16:23:02.752392 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:02.753395 [debug] [MainThread]: On master: COMMIT
[0m16:23:02.798868 [debug] [MainThread]: SQL status: COMMIT in 0.05 seconds
[0m16:23:02.798868 [debug] [MainThread]: On master: Close
[0m16:23:02.799372 [info ] [MainThread]: 
[0m16:23:02.800384 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m16:23:02.800384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:02.801387 [debug] [MainThread]: Connection 'list_acton' was properly closed.
[0m16:23:02.801387 [debug] [MainThread]: Connection 'list_acton_Postgres' was properly closed.
[0m16:23:02.801387 [debug] [MainThread]: Connection 'list_acton_snapshots' was properly closed.
[0m16:23:02.802367 [debug] [MainThread]: Connection 'model.acton_marketing_data.combined_attribution2' was properly closed.
[0m16:23:02.819321 [info ] [MainThread]: 
[0m16:23:02.819321 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:23:02.820319 [info ] [MainThread]: 
[0m16:23:02.821316 [error] [MainThread]: [33mDatabase Error in model combined_attribution2 (models\attribution\attribution_models\combined_attribution2.sql)[0m
[0m16:23:02.821316 [error] [MainThread]:   relation "Postgres.ao_combined" does not exist
[0m16:23:02.822313 [error] [MainThread]:   LINE 13:    FROM "acton"."Postgres"."ao_combined" 
[0m16:23:02.822313 [error] [MainThread]:                    ^
[0m16:23:02.822313 [error] [MainThread]:   compiled Code at target\run\acton_marketing_data\models\attribution\attribution_models\combined_attribution2.sql
[0m16:23:02.823311 [info ] [MainThread]: 
[0m16:23:02.823311 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:23:02.824308 [debug] [MainThread]: Flushing usage events


============================== 2022-10-23 16:23:20.516638 | 8e48e893-fc02-48b4-bb85-73f4dee4f9d7 ==============================
[0m16:23:20.516638 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:23:20.517646 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\JP\\Dropbox\\PC (3)\\Desktop\\Git\\generalsql-main', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['+combined_attribution2'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:23:20.517646 [debug] [MainThread]: Tracking: do not track
[0m16:23:20.769103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:23:20.769103 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:23:20.808793 [info ] [MainThread]: Found 143 models, 0 tests, 7 snapshots, 0 analyses, 631 macros, 0 operations, 0 seed files, 24 sources, 0 exposures, 0 metrics
[0m16:23:20.813936 [info ] [MainThread]: 
[0m16:23:20.813936 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:23:20.816929 [debug] [ThreadPool]: Acquiring new postgres connection "list_acton"
[0m16:23:20.825073 [debug] [ThreadPool]: Using postgres connection "list_acton"
[0m16:23:20.825073 [debug] [ThreadPool]: On list_acton: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "connection_name": "list_acton"} */

    select distinct nspname from pg_namespace
  
[0m16:23:20.826098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:21.286133 [debug] [ThreadPool]: SQL status: SELECT 166 in 0.46 seconds
[0m16:23:21.287162 [debug] [ThreadPool]: On list_acton: Close
[0m16:23:21.293117 [debug] [ThreadPool]: Acquiring new postgres connection "list_acton_snapshots"
[0m16:23:21.294114 [debug] [ThreadPool]: Acquiring new postgres connection "list_acton_Postgres"
[0m16:23:21.299102 [debug] [ThreadPool]: Using postgres connection "list_acton_snapshots"
[0m16:23:21.301096 [debug] [ThreadPool]: Using postgres connection "list_acton_Postgres"
[0m16:23:21.301096 [debug] [ThreadPool]: On list_acton_snapshots: BEGIN
[0m16:23:21.302092 [debug] [ThreadPool]: On list_acton_Postgres: BEGIN
[0m16:23:21.302092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:21.302092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:21.675854 [debug] [ThreadPool]: SQL status: BEGIN in 0.37 seconds
[0m16:23:21.676851 [debug] [ThreadPool]: Using postgres connection "list_acton_snapshots"
[0m16:23:21.676851 [debug] [ThreadPool]: On list_acton_snapshots: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "connection_name": "list_acton_snapshots"} */
select
      'acton' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'acton' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m16:23:21.684345 [debug] [ThreadPool]: SQL status: BEGIN in 0.38 seconds
[0m16:23:21.685343 [debug] [ThreadPool]: Using postgres connection "list_acton_Postgres"
[0m16:23:21.685343 [debug] [ThreadPool]: On list_acton_Postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "connection_name": "list_acton_Postgres"} */
select
      'acton' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'Postgres'
    union all
    select
      'acton' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'Postgres'
  
[0m16:23:21.725476 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.05 seconds
[0m16:23:21.726475 [debug] [ThreadPool]: On list_acton_snapshots: ROLLBACK
[0m16:23:21.770301 [debug] [ThreadPool]: On list_acton_snapshots: Close
[0m16:23:21.778500 [debug] [ThreadPool]: SQL status: SELECT 292 in 0.09 seconds
[0m16:23:21.783779 [debug] [ThreadPool]: On list_acton_Postgres: ROLLBACK
[0m16:23:21.830118 [debug] [ThreadPool]: On list_acton_Postgres: Close
[0m16:23:21.840883 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:21.840883 [debug] [MainThread]: On master: BEGIN
[0m16:23:21.840883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:22.242618 [debug] [MainThread]: SQL status: BEGIN in 0.4 seconds
[0m16:23:22.242618 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:22.242618 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:23:22.295416 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m16:23:22.296417 [debug] [MainThread]: On master: ROLLBACK
[0m16:23:22.340744 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:22.340744 [debug] [MainThread]: On master: BEGIN
[0m16:23:22.430717 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
[0m16:23:22.430717 [debug] [MainThread]: On master: COMMIT
[0m16:23:22.430717 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:22.431645 [debug] [MainThread]: On master: COMMIT
[0m16:23:22.477801 [debug] [MainThread]: SQL status: COMMIT in 0.05 seconds
[0m16:23:22.477801 [debug] [MainThread]: On master: Close
[0m16:23:22.478802 [info ] [MainThread]: Concurrency: 5 threads (target='postgres')
[0m16:23:22.478802 [info ] [MainThread]: 
[0m16:23:22.483787 [debug] [Thread-1 (]: Began running node model.acton_marketing_data.ao_emails
[0m16:23:22.483787 [debug] [Thread-2 (]: Began running node model.acton_marketing_data.ao_forms
[0m16:23:22.483787 [debug] [Thread-3 (]: Began running node model.acton_marketing_data.ao_landingpages
[0m16:23:22.483787 [debug] [Thread-4 (]: Began running node model.acton_marketing_data.ao_media
[0m16:23:22.484785 [debug] [Thread-5 (]: Began running node model.acton_marketing_data.ao_webinars
[0m16:23:22.484785 [info ] [Thread-1 (]: 1 of 31 START sql table model Postgres.ao_emails ............................... [RUN]
[0m16:23:22.484785 [info ] [Thread-2 (]: 2 of 31 START sql table model Postgres.ao_forms ................................ [RUN]
[0m16:23:22.484785 [info ] [Thread-3 (]: 3 of 31 START sql table model Postgres.ao_landingpages ......................... [RUN]
[0m16:23:22.485782 [info ] [Thread-4 (]: 4 of 31 START sql table model Postgres.ao_media ................................ [RUN]
[0m16:23:22.485782 [info ] [Thread-5 (]: 5 of 31 START sql table model Postgres.ao_webinars ............................. [RUN]
[0m16:23:22.486779 [debug] [Thread-1 (]: Acquiring new postgres connection "model.acton_marketing_data.ao_emails"
[0m16:23:22.487777 [debug] [Thread-2 (]: Acquiring new postgres connection "model.acton_marketing_data.ao_forms"
[0m16:23:22.487777 [debug] [Thread-3 (]: Acquiring new postgres connection "model.acton_marketing_data.ao_landingpages"
[0m16:23:22.488774 [debug] [Thread-4 (]: Acquiring new postgres connection "model.acton_marketing_data.ao_media"
[0m16:23:22.489771 [debug] [Thread-5 (]: Acquiring new postgres connection "model.acton_marketing_data.ao_webinars"
[0m16:23:22.489771 [debug] [Thread-1 (]: Began compiling node model.acton_marketing_data.ao_emails
[0m16:23:22.489771 [debug] [Thread-2 (]: Began compiling node model.acton_marketing_data.ao_forms
[0m16:23:22.489771 [debug] [Thread-3 (]: Began compiling node model.acton_marketing_data.ao_landingpages
[0m16:23:22.490769 [debug] [Thread-4 (]: Began compiling node model.acton_marketing_data.ao_media
[0m16:23:22.490769 [debug] [Thread-5 (]: Began compiling node model.acton_marketing_data.ao_webinars
[0m16:23:22.490769 [debug] [Thread-1 (]: Compiling model.acton_marketing_data.ao_emails
[0m16:23:22.491766 [debug] [Thread-2 (]: Compiling model.acton_marketing_data.ao_forms
[0m16:23:22.491766 [debug] [Thread-3 (]: Compiling model.acton_marketing_data.ao_landingpages
[0m16:23:22.491766 [debug] [Thread-4 (]: Compiling model.acton_marketing_data.ao_media
[0m16:23:22.491766 [debug] [Thread-5 (]: Compiling model.acton_marketing_data.ao_webinars
[0m16:23:22.495755 [debug] [Thread-1 (]: Writing injected SQL for node "model.acton_marketing_data.ao_emails"
[0m16:23:22.498747 [debug] [Thread-2 (]: Writing injected SQL for node "model.acton_marketing_data.ao_forms"
[0m16:23:22.501739 [debug] [Thread-3 (]: Writing injected SQL for node "model.acton_marketing_data.ao_landingpages"
[0m16:23:22.503734 [debug] [Thread-4 (]: Writing injected SQL for node "model.acton_marketing_data.ao_media"
[0m16:23:22.505729 [debug] [Thread-5 (]: Writing injected SQL for node "model.acton_marketing_data.ao_webinars"
[0m16:23:22.506729 [debug] [Thread-1 (]: finished collecting timing info
[0m16:23:22.507724 [debug] [Thread-2 (]: finished collecting timing info
[0m16:23:22.507724 [debug] [Thread-3 (]: finished collecting timing info
[0m16:23:22.507724 [debug] [Thread-1 (]: Began executing node model.acton_marketing_data.ao_emails
[0m16:23:22.508721 [debug] [Thread-4 (]: finished collecting timing info
[0m16:23:22.508721 [debug] [Thread-2 (]: Began executing node model.acton_marketing_data.ao_forms
[0m16:23:22.508721 [debug] [Thread-5 (]: finished collecting timing info
[0m16:23:22.508721 [debug] [Thread-3 (]: Began executing node model.acton_marketing_data.ao_landingpages
[0m16:23:22.570555 [debug] [Thread-1 (]: Writing runtime sql for node "model.acton_marketing_data.ao_emails"
[0m16:23:22.570555 [debug] [Thread-4 (]: Began executing node model.acton_marketing_data.ao_media
[0m16:23:22.578534 [debug] [Thread-2 (]: Writing runtime sql for node "model.acton_marketing_data.ao_forms"
[0m16:23:22.578534 [debug] [Thread-5 (]: Began executing node model.acton_marketing_data.ao_webinars
[0m16:23:22.586513 [debug] [Thread-3 (]: Writing runtime sql for node "model.acton_marketing_data.ao_landingpages"
[0m16:23:22.594491 [debug] [Thread-4 (]: Writing runtime sql for node "model.acton_marketing_data.ao_media"
[0m16:23:22.595489 [debug] [Thread-1 (]: Using postgres connection "model.acton_marketing_data.ao_emails"
[0m16:23:22.602470 [debug] [Thread-5 (]: Writing runtime sql for node "model.acton_marketing_data.ao_webinars"
[0m16:23:22.603467 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_forms"
[0m16:23:22.604475 [debug] [Thread-1 (]: On model.acton_marketing_data.ao_emails: BEGIN
[0m16:23:22.604475 [debug] [Thread-3 (]: Using postgres connection "model.acton_marketing_data.ao_landingpages"
[0m16:23:22.604475 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_media"
[0m16:23:22.604475 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms: BEGIN
[0m16:23:22.605462 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:23:22.605462 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_webinars"
[0m16:23:22.605462 [debug] [Thread-3 (]: On model.acton_marketing_data.ao_landingpages: BEGIN
[0m16:23:22.605462 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media: BEGIN
[0m16:23:22.606461 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:23:22.606461 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webinars: BEGIN
[0m16:23:22.607472 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:23:22.607472 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:23:22.608454 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m16:23:22.975089 [debug] [Thread-4 (]: SQL status: BEGIN in 0.37 seconds
[0m16:23:22.975089 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_media"
[0m16:23:22.975089 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_media"} */

  
    

  create  table "acton"."Postgres"."ao_media__dbt_tmp"
  as (
    

WITH base AS (

    SELECT *
    FROM "acton"."data_studio_s3"."data_studio_media"

)

SELECT *
FROM base
  );
  
[0m16:23:22.979232 [debug] [Thread-2 (]: SQL status: BEGIN in 0.37 seconds
[0m16:23:22.979232 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_forms"
[0m16:23:22.979232 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_forms"} */

  
    

  create  table "acton"."Postgres"."ao_forms__dbt_tmp"
  as (
    

WITH base AS (

    SELECT *
    FROM "acton"."data_studio_s3"."data_studio_forms"

)

SELECT *
FROM base
  );
  
[0m16:23:22.991911 [debug] [Thread-3 (]: SQL status: BEGIN in 0.38 seconds
[0m16:23:22.991911 [debug] [Thread-5 (]: SQL status: BEGIN in 0.38 seconds
[0m16:23:22.992908 [debug] [Thread-3 (]: Using postgres connection "model.acton_marketing_data.ao_landingpages"
[0m16:23:22.992908 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_webinars"
[0m16:23:22.992908 [debug] [Thread-3 (]: On model.acton_marketing_data.ao_landingpages: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_landingpages"} */

  
    

  create  table "acton"."Postgres"."ao_landingpages__dbt_tmp"
  as (
    

WITH base AS (

    SELECT *
    FROM "acton"."data_studio_s3"."data_studio_landingpages"

)

SELECT *
FROM base
  );
  
[0m16:23:22.993906 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webinars: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_webinars"} */

  
    

  create  table "acton"."Postgres"."ao_webinars__dbt_tmp"
  as (
    

WITH base AS (

    SELECT *
    FROM "acton"."data_studio_s3"."data_studio_webinars"

)

SELECT *
FROM base
  );
  
[0m16:23:23.002882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.4 seconds
[0m16:23:23.002882 [debug] [Thread-1 (]: Using postgres connection "model.acton_marketing_data.ao_emails"
[0m16:23:23.002882 [debug] [Thread-1 (]: On model.acton_marketing_data.ao_emails: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_emails"} */

  
    

  create  table "acton"."Postgres"."ao_emails__dbt_tmp"
  as (
    

WITH base AS (

    SELECT *
    FROM "acton"."data_studio_s3"."data_studio_emails"

)

SELECT *
FROM base
  );
  
[0m16:23:23.120804 [debug] [Thread-5 (]: SQL status: SELECT 18487 in 0.13 seconds
[0m16:23:23.126824 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_webinars"
[0m16:23:23.126824 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webinars: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_webinars"} */
alter table "acton"."Postgres"."ao_webinars" rename to "ao_webinars__dbt_backup"
[0m16:23:23.169506 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:23:23.171009 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_webinars"
[0m16:23:23.172006 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webinars: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_webinars"} */
alter table "acton"."Postgres"."ao_webinars__dbt_tmp" rename to "ao_webinars"
[0m16:23:23.214241 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:23:23.230200 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webinars: COMMIT
[0m16:23:23.230200 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_webinars"
[0m16:23:23.230200 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webinars: COMMIT
[0m16:23:23.276255 [debug] [Thread-5 (]: SQL status: COMMIT in 0.05 seconds
[0m16:23:23.280246 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_webinars"
[0m16:23:23.280246 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webinars: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_webinars"} */
drop table if exists "acton"."Postgres"."ao_webinars__dbt_backup" cascade
[0m16:23:23.335518 [debug] [Thread-5 (]: SQL status: DROP TABLE in 0.06 seconds
[0m16:23:23.336552 [debug] [Thread-5 (]: finished collecting timing info
[0m16:23:23.337522 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webinars: Close
[0m16:23:23.337522 [info ] [Thread-5 (]: 5 of 31 OK created sql table model Postgres.ao_webinars ........................ [[32mSELECT 18487[0m in 0.85s]
[0m16:23:23.338518 [debug] [Thread-5 (]: Finished running node model.acton_marketing_data.ao_webinars
[0m16:23:23.339516 [debug] [Thread-5 (]: Began running node model.acton_marketing_data.ao_webpages
[0m16:23:23.339516 [info ] [Thread-5 (]: 6 of 31 START sql table model Postgres.ao_webpages ............................. [RUN]
[0m16:23:23.340513 [debug] [Thread-5 (]: Acquiring new postgres connection "model.acton_marketing_data.ao_webpages"
[0m16:23:23.340513 [debug] [Thread-5 (]: Began compiling node model.acton_marketing_data.ao_webpages
[0m16:23:23.341531 [debug] [Thread-5 (]: Compiling model.acton_marketing_data.ao_webpages
[0m16:23:23.344502 [debug] [Thread-5 (]: Writing injected SQL for node "model.acton_marketing_data.ao_webpages"
[0m16:23:23.344502 [debug] [Thread-5 (]: finished collecting timing info
[0m16:23:23.345500 [debug] [Thread-5 (]: Began executing node model.acton_marketing_data.ao_webpages
[0m16:23:23.352480 [debug] [Thread-5 (]: Writing runtime sql for node "model.acton_marketing_data.ao_webpages"
[0m16:23:23.353478 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_webpages"
[0m16:23:23.353478 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webpages: BEGIN
[0m16:23:23.354476 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:23:23.369586 [debug] [Thread-2 (]: SQL status: SELECT 103222 in 0.39 seconds
[0m16:23:23.373573 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_forms"
[0m16:23:23.373573 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_forms"} */
alter table "acton"."Postgres"."ao_forms" rename to "ao_forms__dbt_backup"
[0m16:23:23.416106 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:23:23.419098 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_forms"
[0m16:23:23.419098 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_forms"} */
alter table "acton"."Postgres"."ao_forms__dbt_tmp" rename to "ao_forms"
[0m16:23:23.461655 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:23:23.462692 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms: COMMIT
[0m16:23:23.462692 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_forms"
[0m16:23:23.463700 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms: COMMIT
[0m16:23:23.506265 [debug] [Thread-2 (]: SQL status: COMMIT in 0.04 seconds
[0m16:23:23.508300 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_forms"
[0m16:23:23.508300 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_forms"} */
drop table if exists "acton"."Postgres"."ao_forms__dbt_backup" cascade
[0m16:23:23.564246 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.06 seconds
[0m16:23:23.564246 [debug] [Thread-2 (]: finished collecting timing info
[0m16:23:23.565245 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms: Close
[0m16:23:23.565245 [info ] [Thread-2 (]: 2 of 31 OK created sql table model Postgres.ao_forms ........................... [[32mSELECT 103222[0m in 1.08s]
[0m16:23:23.567241 [debug] [Thread-2 (]: Finished running node model.acton_marketing_data.ao_forms
[0m16:23:23.567241 [debug] [Thread-2 (]: Began running node model.acton_marketing_data.contract_source_xf
[0m16:23:23.567241 [info ] [Thread-2 (]: 7 of 31 START sql table model Postgres.contract_source_xf ...................... [RUN]
[0m16:23:23.568237 [debug] [Thread-2 (]: Acquiring new postgres connection "model.acton_marketing_data.contract_source_xf"
[0m16:23:23.568237 [debug] [Thread-2 (]: Began compiling node model.acton_marketing_data.contract_source_xf
[0m16:23:23.569235 [debug] [Thread-2 (]: Compiling model.acton_marketing_data.contract_source_xf
[0m16:23:23.572227 [debug] [Thread-2 (]: Writing injected SQL for node "model.acton_marketing_data.contract_source_xf"
[0m16:23:23.573224 [debug] [Thread-2 (]: finished collecting timing info
[0m16:23:23.573224 [debug] [Thread-2 (]: Began executing node model.acton_marketing_data.contract_source_xf
[0m16:23:23.581203 [debug] [Thread-2 (]: Writing runtime sql for node "model.acton_marketing_data.contract_source_xf"
[0m16:23:23.582200 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.contract_source_xf"
[0m16:23:23.582200 [debug] [Thread-2 (]: On model.acton_marketing_data.contract_source_xf: BEGIN
[0m16:23:23.582200 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:23:23.721860 [debug] [Thread-5 (]: SQL status: BEGIN in 0.37 seconds
[0m16:23:23.721860 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_webpages"
[0m16:23:23.722858 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webpages: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_webpages"} */

  
    

  create  table "acton"."Postgres"."ao_webpages__dbt_tmp"
  as (
    

WITH base AS (

    SELECT *
    FROM "acton"."data_studio_s3"."data_studio_webpages"

)

SELECT *
FROM base
  );
  
[0m16:23:23.946753 [debug] [Thread-2 (]: SQL status: BEGIN in 0.36 seconds
[0m16:23:23.947764 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.contract_source_xf"
[0m16:23:23.947764 [debug] [Thread-2 (]: On model.acton_marketing_data.contract_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.contract_source_xf"} */

  
    

  create  table "acton"."Postgres"."contract_source_xf__dbt_tmp"
  as (
    

WITH base AS (
SELECT *
FROM "acton"."salesforce"."contract"

), final AS (
SELECT
id AS contract_id,
account_id,
owner_id,
status,
is_deleted,
DATE_TRUNC('day',created_date)::Date AS created_date,
DATE_TRUNC('day',created_date)::Date AS end_date,
created_by_id,
DATE_TRUNC('day',last_modified_date)::Date AS last_modified_date,
system_modstamp AS systemmodstamp,
contract_status_c AS contract_status,
related_opportunity_c AS contract_opportunity_id,
DATE_TRUNC('day',churn_date_c)::Date AS churn_date,
cs_churn_c AS cs_churn,
arr_c AS arr,
contract_acv_c AS contract_acv,
subscription_term_c AS subscription_term,
cs_churn_recognized_mrr_c AS cs_churn_recognized_mrr,
sales_churn_c AS sales_churn,
current_quarter_debook_value_c AS current_quarter_debook_value,
CASE
    WHEN contract_status_c = 'Cancelled' AND cs_churn_c != false THEN cs_churn_recognized_mrr_c*-12
    WHEN contract_status_c = 'Cancelled' AND sales_churn_c != false THEN current_quarter_debook_value_c
    ELSE 0
END AS arr_loss_amount
FROM base

)

SELECT
*
FROM final
  );
  
[0m16:23:24.409647 [debug] [Thread-4 (]: SQL status: SELECT 502882 in 1.43 seconds
[0m16:23:24.413636 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_media"
[0m16:23:24.413636 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_media"} */
alter table "acton"."Postgres"."ao_media" rename to "ao_media__dbt_backup"
[0m16:23:24.456522 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:23:24.459514 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_media"
[0m16:23:24.459514 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_media"} */
alter table "acton"."Postgres"."ao_media__dbt_tmp" rename to "ao_media"
[0m16:23:24.505795 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.05 seconds
[0m16:23:24.507790 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media: COMMIT
[0m16:23:24.507790 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_media"
[0m16:23:24.507790 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media: COMMIT
[0m16:23:24.551244 [debug] [Thread-4 (]: SQL status: COMMIT in 0.04 seconds
[0m16:23:24.553239 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_media"
[0m16:23:24.553239 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_media"} */
drop table if exists "acton"."Postgres"."ao_media__dbt_backup" cascade
[0m16:23:24.662132 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.11 seconds
[0m16:23:24.663007 [debug] [Thread-4 (]: finished collecting timing info
[0m16:23:24.663007 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media: Close
[0m16:23:24.663978 [info ] [Thread-4 (]: 4 of 31 OK created sql table model Postgres.ao_media ........................... [[32mSELECT 502882[0m in 2.18s]
[0m16:23:24.664975 [debug] [Thread-4 (]: Finished running node model.acton_marketing_data.ao_media
[0m16:23:24.664975 [debug] [Thread-4 (]: Began running node model.acton_marketing_data.opportunity_line_item_xf
[0m16:23:24.664975 [info ] [Thread-4 (]: 8 of 31 START sql table model Postgres.opportunity_line_item_xf ................ [RUN]
[0m16:23:24.665975 [debug] [Thread-4 (]: Acquiring new postgres connection "model.acton_marketing_data.opportunity_line_item_xf"
[0m16:23:24.665975 [debug] [Thread-4 (]: Began compiling node model.acton_marketing_data.opportunity_line_item_xf
[0m16:23:24.666969 [debug] [Thread-4 (]: Compiling model.acton_marketing_data.opportunity_line_item_xf
[0m16:23:24.669960 [debug] [Thread-4 (]: Writing injected SQL for node "model.acton_marketing_data.opportunity_line_item_xf"
[0m16:23:24.669960 [debug] [Thread-4 (]: finished collecting timing info
[0m16:23:24.670958 [debug] [Thread-4 (]: Began executing node model.acton_marketing_data.opportunity_line_item_xf
[0m16:23:24.678936 [debug] [Thread-4 (]: Writing runtime sql for node "model.acton_marketing_data.opportunity_line_item_xf"
[0m16:23:24.679934 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.opportunity_line_item_xf"
[0m16:23:24.679934 [debug] [Thread-4 (]: On model.acton_marketing_data.opportunity_line_item_xf: BEGIN
[0m16:23:24.680932 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:23:24.762271 [debug] [Thread-2 (]: SQL status: SELECT 29587 in 0.81 seconds
[0m16:23:24.765301 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.contract_source_xf"
[0m16:23:24.765301 [debug] [Thread-2 (]: On model.acton_marketing_data.contract_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.contract_source_xf"} */
alter table "acton"."Postgres"."contract_source_xf" rename to "contract_source_xf__dbt_backup"
[0m16:23:24.809284 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:23:24.811317 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.contract_source_xf"
[0m16:23:24.811317 [debug] [Thread-2 (]: On model.acton_marketing_data.contract_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.contract_source_xf"} */
alter table "acton"."Postgres"."contract_source_xf__dbt_tmp" rename to "contract_source_xf"
[0m16:23:24.856167 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:23:24.857195 [debug] [Thread-2 (]: On model.acton_marketing_data.contract_source_xf: COMMIT
[0m16:23:24.857195 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.contract_source_xf"
[0m16:23:24.858163 [debug] [Thread-2 (]: On model.acton_marketing_data.contract_source_xf: COMMIT
[0m16:23:24.901125 [debug] [Thread-2 (]: SQL status: COMMIT in 0.04 seconds
[0m16:23:24.903140 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.contract_source_xf"
[0m16:23:24.903140 [debug] [Thread-2 (]: On model.acton_marketing_data.contract_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.contract_source_xf"} */
drop table if exists "acton"."Postgres"."contract_source_xf__dbt_backup" cascade
[0m16:23:24.956498 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:23:24.957499 [debug] [Thread-2 (]: finished collecting timing info
[0m16:23:24.957499 [debug] [Thread-2 (]: On model.acton_marketing_data.contract_source_xf: Close
[0m16:23:24.958496 [info ] [Thread-2 (]: 7 of 31 OK created sql table model Postgres.contract_source_xf ................. [[32mSELECT 29587[0m in 1.39s]
[0m16:23:24.959494 [debug] [Thread-2 (]: Finished running node model.acton_marketing_data.contract_source_xf
[0m16:23:24.959494 [debug] [Thread-2 (]: Began running node model.acton_marketing_data.product_xf
[0m16:23:24.959494 [info ] [Thread-2 (]: 9 of 31 START sql table model Postgres.product_xf .............................. [RUN]
[0m16:23:24.960491 [debug] [Thread-2 (]: Acquiring new postgres connection "model.acton_marketing_data.product_xf"
[0m16:23:24.961489 [debug] [Thread-2 (]: Began compiling node model.acton_marketing_data.product_xf
[0m16:23:24.961489 [debug] [Thread-2 (]: Compiling model.acton_marketing_data.product_xf
[0m16:23:24.964480 [debug] [Thread-2 (]: Writing injected SQL for node "model.acton_marketing_data.product_xf"
[0m16:23:24.965476 [debug] [Thread-2 (]: finished collecting timing info
[0m16:23:24.965476 [debug] [Thread-2 (]: Began executing node model.acton_marketing_data.product_xf
[0m16:23:24.974453 [debug] [Thread-2 (]: Writing runtime sql for node "model.acton_marketing_data.product_xf"
[0m16:23:24.975452 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.product_xf"
[0m16:23:24.975452 [debug] [Thread-2 (]: On model.acton_marketing_data.product_xf: BEGIN
[0m16:23:24.975452 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:23:25.071748 [debug] [Thread-4 (]: SQL status: BEGIN in 0.39 seconds
[0m16:23:25.072752 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.opportunity_line_item_xf"
[0m16:23:25.072752 [debug] [Thread-4 (]: On model.acton_marketing_data.opportunity_line_item_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.opportunity_line_item_xf"} */

  
    

  create  table "acton"."Postgres"."opportunity_line_item_xf__dbt_tmp"
  as (
    

WITH base AS (
SELECT *
FROM "acton"."salesforce"."opportunity_line_item"

), final AS (
    SELECT 
        id AS line_item_id,
        opportunity_id,
        product_2_id AS product_id,
        name AS line_item_name,
        currency_iso_code,
        discount,
        total_price,
        list_price,
        DATE_TRUNC('day',created_date)::Date AS line_item_created_date,
        DATE_TRUNC('day',last_modified_date)::Date AS last_modified_date,
        system_modstamp AS systemmodstamp,
        is_deleted,
        sbqq_subscription_type_c AS sbqq_subscription_type,
        line_item_mrr_c AS line_item_mrr,
        product_code_c AS product_code,
        annual_price_c AS annual_price,
        discounted_annual_price_c AS discounted_annual_price,
        monthly_gross_c AS monthly_gross,
        monthly_net_c AS monthly_net,
        subscription_type_c AS subscription_type,
        total_discount_c AS total_discount,
        prorate_multiplier_mirror_c AS prorate_multiplier_mirror,
        sbqq_parent_id_c AS sbqq_parent_id,
        opp_product_family_text_c AS product_family
    FROM base

)

SELECT *
FROM final
  );
  
[0m16:23:25.386127 [debug] [Thread-2 (]: SQL status: BEGIN in 0.41 seconds
[0m16:23:25.386127 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.product_xf"
[0m16:23:25.386127 [debug] [Thread-2 (]: On model.acton_marketing_data.product_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.product_xf"} */

  
    

  create  table "acton"."Postgres"."product_xf__dbt_tmp"
  as (
    

WITH base AS (

    SELECT *
    FROM "acton"."salesforce"."product_2"

), final AS (

    SELECT 
        id AS product_id,
        product_code,
        DATE_TRUNC('day',created_date)::Date AS product_created_date,
        DATE_TRUNC('day',last_modified_date)::Date AS product_last_modified_date,
        system_modstamp AS systemmodstamp,
        is_deleted,
        rev_rec_c AS rev_rec,
        multiplier_override_c AS multiplier_override,
        sbqq_subscription_type_c AS sbqq_subscription_type,
        product_category_c AS product_category
    FROM base

)

SELECT *
FROM final
  );
  
[0m16:23:25.766685 [debug] [Thread-2 (]: SQL status: SELECT 247 in 0.38 seconds
[0m16:23:25.769305 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.product_xf"
[0m16:23:25.769305 [debug] [Thread-2 (]: On model.acton_marketing_data.product_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.product_xf"} */
alter table "acton"."Postgres"."product_xf" rename to "product_xf__dbt_backup"
[0m16:23:25.813243 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:23:25.816245 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.product_xf"
[0m16:23:25.816245 [debug] [Thread-2 (]: On model.acton_marketing_data.product_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.product_xf"} */
alter table "acton"."Postgres"."product_xf__dbt_tmp" rename to "product_xf"
[0m16:23:25.865901 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.05 seconds
[0m16:23:25.867937 [debug] [Thread-2 (]: On model.acton_marketing_data.product_xf: COMMIT
[0m16:23:25.867937 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.product_xf"
[0m16:23:25.867937 [debug] [Thread-2 (]: On model.acton_marketing_data.product_xf: COMMIT
[0m16:23:25.917691 [debug] [Thread-2 (]: SQL status: COMMIT in 0.05 seconds
[0m16:23:25.919716 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.product_xf"
[0m16:23:25.919716 [debug] [Thread-2 (]: On model.acton_marketing_data.product_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.product_xf"} */
drop table if exists "acton"."Postgres"."product_xf__dbt_backup" cascade
[0m16:23:25.972775 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.05 seconds
[0m16:23:25.973811 [debug] [Thread-2 (]: finished collecting timing info
[0m16:23:25.973811 [debug] [Thread-2 (]: On model.acton_marketing_data.product_xf: Close
[0m16:23:25.974780 [info ] [Thread-2 (]: 9 of 31 OK created sql table model Postgres.product_xf ......................... [[32mSELECT 247[0m in 1.01s]
[0m16:23:25.975776 [debug] [Thread-2 (]: Finished running node model.acton_marketing_data.product_xf
[0m16:23:25.975776 [debug] [Thread-2 (]: Began running node model.acton_marketing_data.user_source_xf
[0m16:23:25.976775 [info ] [Thread-2 (]: 10 of 31 START sql table model Postgres.user_source_xf ......................... [RUN]
[0m16:23:25.976775 [debug] [Thread-2 (]: Acquiring new postgres connection "model.acton_marketing_data.user_source_xf"
[0m16:23:25.977774 [debug] [Thread-2 (]: Began compiling node model.acton_marketing_data.user_source_xf
[0m16:23:25.977774 [debug] [Thread-2 (]: Compiling model.acton_marketing_data.user_source_xf
[0m16:23:25.980764 [debug] [Thread-2 (]: Writing injected SQL for node "model.acton_marketing_data.user_source_xf"
[0m16:23:25.981761 [debug] [Thread-2 (]: finished collecting timing info
[0m16:23:25.981761 [debug] [Thread-2 (]: Began executing node model.acton_marketing_data.user_source_xf
[0m16:23:25.990738 [debug] [Thread-2 (]: Writing runtime sql for node "model.acton_marketing_data.user_source_xf"
[0m16:23:25.991735 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.user_source_xf"
[0m16:23:25.991735 [debug] [Thread-2 (]: On model.acton_marketing_data.user_source_xf: BEGIN
[0m16:23:25.992733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:23:26.453745 [debug] [Thread-2 (]: SQL status: BEGIN in 0.46 seconds
[0m16:23:26.453745 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.user_source_xf"
[0m16:23:26.453745 [debug] [Thread-2 (]: On model.acton_marketing_data.user_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.user_source_xf"} */

  
    

  create  table "acton"."Postgres"."user_source_xf__dbt_tmp"
  as (
    

WITH base AS (

SELECT *
FROM "acton"."salesforce"."user"

)

    SELECT
        id AS user_id,
        username AS user_name,
        last_name AS user_last_name,
        first_name AS user_first_name,
        name AS user_full_name,
        department AS user_department,
        title AS user_title,
        email AS user_email,
        phone AS user_phone,
        is_active AS is_active_user,
        manager_id,
        created_date AS user_created_date,
        last_modified_date AS user_last_modified_date,
        system_modstamp AS systemmodstamp,
        contact_id AS user_contact_id,
        account_id AS user_account_id,
        full_photo_url AS user_photo_url,
        sales_loft_calendar_link_c AS sales_loft_calendar_link,
        calendly_link_c AS calendly_link,
        headshot_url_c AS user_headshot_url,
        office_location_c AS user_office_location,
        sales_home_office_c AS user_sales_home_office,
        csm_type_c AS csm_type,
        my_territory_c AS user_territory,
        photo_c AS user_photo
FROM base
  );
  
[0m16:23:26.734136 [debug] [Thread-4 (]: SQL status: SELECT 283917 in 1.66 seconds
[0m16:23:26.736164 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.opportunity_line_item_xf"
[0m16:23:26.736164 [debug] [Thread-4 (]: On model.acton_marketing_data.opportunity_line_item_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.opportunity_line_item_xf"} */
alter table "acton"."Postgres"."opportunity_line_item_xf" rename to "opportunity_line_item_xf__dbt_backup"
[0m16:23:26.782529 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.05 seconds
[0m16:23:26.785519 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.opportunity_line_item_xf"
[0m16:23:26.785519 [debug] [Thread-4 (]: On model.acton_marketing_data.opportunity_line_item_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.opportunity_line_item_xf"} */
alter table "acton"."Postgres"."opportunity_line_item_xf__dbt_tmp" rename to "opportunity_line_item_xf"
[0m16:23:26.831483 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:23:26.832483 [debug] [Thread-4 (]: On model.acton_marketing_data.opportunity_line_item_xf: COMMIT
[0m16:23:26.832483 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.opportunity_line_item_xf"
[0m16:23:26.832483 [debug] [Thread-4 (]: On model.acton_marketing_data.opportunity_line_item_xf: COMMIT
[0m16:23:26.873973 [debug] [Thread-2 (]: SQL status: SELECT 1252 in 0.42 seconds
[0m16:23:26.876004 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.user_source_xf"
[0m16:23:26.876004 [debug] [Thread-2 (]: On model.acton_marketing_data.user_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.user_source_xf"} */
alter table "acton"."Postgres"."user_source_xf" rename to "user_source_xf__dbt_backup"
[0m16:23:26.879983 [debug] [Thread-4 (]: SQL status: COMMIT in 0.05 seconds
[0m16:23:26.881961 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.opportunity_line_item_xf"
[0m16:23:26.881961 [debug] [Thread-4 (]: On model.acton_marketing_data.opportunity_line_item_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.opportunity_line_item_xf"} */
drop table if exists "acton"."Postgres"."opportunity_line_item_xf__dbt_backup" cascade
[0m16:23:26.918484 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:23:26.920511 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.user_source_xf"
[0m16:23:26.921507 [debug] [Thread-2 (]: On model.acton_marketing_data.user_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.user_source_xf"} */
alter table "acton"."Postgres"."user_source_xf__dbt_tmp" rename to "user_source_xf"
[0m16:23:26.939626 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.06 seconds
[0m16:23:26.941618 [debug] [Thread-4 (]: finished collecting timing info
[0m16:23:26.941618 [debug] [Thread-4 (]: On model.acton_marketing_data.opportunity_line_item_xf: Close
[0m16:23:26.942616 [info ] [Thread-4 (]: 8 of 31 OK created sql table model Postgres.opportunity_line_item_xf ........... [[32mSELECT 283917[0m in 2.28s]
[0m16:23:26.943613 [debug] [Thread-4 (]: Finished running node model.acton_marketing_data.opportunity_line_item_xf
[0m16:23:26.943613 [debug] [Thread-4 (]: Began running node model.acton_marketing_data.ao_webinars_xf
[0m16:23:26.943613 [info ] [Thread-4 (]: 11 of 31 START sql table model Postgres.ao_webinars_xf ......................... [RUN]
[0m16:23:26.944610 [debug] [Thread-4 (]: Acquiring new postgres connection "model.acton_marketing_data.ao_webinars_xf"
[0m16:23:26.944610 [debug] [Thread-4 (]: Began compiling node model.acton_marketing_data.ao_webinars_xf
[0m16:23:26.945608 [debug] [Thread-4 (]: Compiling model.acton_marketing_data.ao_webinars_xf
[0m16:23:26.948600 [debug] [Thread-4 (]: Writing injected SQL for node "model.acton_marketing_data.ao_webinars_xf"
[0m16:23:26.948600 [debug] [Thread-4 (]: finished collecting timing info
[0m16:23:26.949597 [debug] [Thread-4 (]: Began executing node model.acton_marketing_data.ao_webinars_xf
[0m16:23:26.957577 [debug] [Thread-4 (]: Writing runtime sql for node "model.acton_marketing_data.ao_webinars_xf"
[0m16:23:26.958602 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_webinars_xf"
[0m16:23:26.959570 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_webinars_xf: BEGIN
[0m16:23:26.959570 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:23:26.969543 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.05 seconds
[0m16:23:26.971577 [debug] [Thread-2 (]: On model.acton_marketing_data.user_source_xf: COMMIT
[0m16:23:26.971577 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.user_source_xf"
[0m16:23:26.972536 [debug] [Thread-2 (]: On model.acton_marketing_data.user_source_xf: COMMIT
[0m16:23:27.019955 [debug] [Thread-2 (]: SQL status: COMMIT in 0.05 seconds
[0m16:23:27.021949 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.user_source_xf"
[0m16:23:27.021949 [debug] [Thread-2 (]: On model.acton_marketing_data.user_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.user_source_xf"} */
drop table if exists "acton"."Postgres"."user_source_xf__dbt_backup" cascade
[0m16:23:27.167132 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.15 seconds
[0m16:23:27.167579 [debug] [Thread-2 (]: finished collecting timing info
[0m16:23:27.168581 [debug] [Thread-2 (]: On model.acton_marketing_data.user_source_xf: Close
[0m16:23:27.169578 [info ] [Thread-2 (]: 10 of 31 OK created sql table model Postgres.user_source_xf .................... [[32mSELECT 1252[0m in 1.19s]
[0m16:23:27.170576 [debug] [Thread-2 (]: Finished running node model.acton_marketing_data.user_source_xf
[0m16:23:27.170576 [debug] [Thread-2 (]: Began running node model.acton_marketing_data.ao_forms_xf
[0m16:23:27.170576 [info ] [Thread-2 (]: 12 of 31 START sql table model Postgres.ao_forms_xf ............................ [RUN]
[0m16:23:27.171574 [debug] [Thread-2 (]: Acquiring new postgres connection "model.acton_marketing_data.ao_forms_xf"
[0m16:23:27.172571 [debug] [Thread-2 (]: Began compiling node model.acton_marketing_data.ao_forms_xf
[0m16:23:27.172571 [debug] [Thread-2 (]: Compiling model.acton_marketing_data.ao_forms_xf
[0m16:23:27.175562 [debug] [Thread-2 (]: Writing injected SQL for node "model.acton_marketing_data.ao_forms_xf"
[0m16:23:27.176560 [debug] [Thread-2 (]: finished collecting timing info
[0m16:23:27.176560 [debug] [Thread-2 (]: Began executing node model.acton_marketing_data.ao_forms_xf
[0m16:23:27.184538 [debug] [Thread-2 (]: Writing runtime sql for node "model.acton_marketing_data.ao_forms_xf"
[0m16:23:27.185536 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_forms_xf"
[0m16:23:27.185536 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms_xf: BEGIN
[0m16:23:27.185536 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:23:27.413237 [debug] [Thread-4 (]: SQL status: BEGIN in 0.45 seconds
[0m16:23:27.413237 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_webinars_xf"
[0m16:23:27.413237 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_webinars_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_webinars_xf"} */

  
    

  create  table "acton"."Postgres"."ao_webinars_xf__dbt_tmp"
  as (
    

SELECT 
-- IDs
    webinar_id,
    contact_e_mail AS email,
    record_id,
    unique_visitor_id,

-- Webinar Attributes
    webinar_title,
    event_program_id AS event_id,

-- Action Data
    action,
    action_time,
    action_day,

-- Other Data
    e_mail_domain AS email_domain
FROM "acton"."Postgres"."ao_webinars"
WHERE contact_e_mail IS NOT null
AND contact_e_mail NOT LIKE 'unknown%'
  );
  
[0m16:23:27.568365 [debug] [Thread-2 (]: SQL status: BEGIN in 0.38 seconds
[0m16:23:27.568365 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_forms_xf"
[0m16:23:27.568365 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_forms_xf"} */

  
    

  create  table "acton"."Postgres"."ao_forms_xf__dbt_tmp"
  as (
    

SELECT
-- IDs
    form_id,
    email,
    unique_visitor_id,
    record_id,

--Form Attributes
    form_title,

--Action Attributes
    CASE
        WHEN action IN ('INSERT','UPDATE') THEN 'SUBMIT'
    END AS action,
    action_time,
    action_day,
    referral_url,

--Other Data
    ip_address,
    cookie_id
FROM "acton"."Postgres"."ao_forms"
WHERE email IS NOT null
AND email NOT LIKE 'unknown%'
  );
  
[0m16:23:28.076402 [debug] [Thread-4 (]: SQL status: SELECT 18487 in 0.66 seconds
[0m16:23:28.078397 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_webinars_xf"
[0m16:23:28.078397 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_webinars_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_webinars_xf"} */
alter table "acton"."Postgres"."ao_webinars_xf__dbt_tmp" rename to "ao_webinars_xf"
[0m16:23:28.121672 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:23:28.122668 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_webinars_xf: COMMIT
[0m16:23:28.122668 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_webinars_xf"
[0m16:23:28.122668 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_webinars_xf: COMMIT
[0m16:23:28.334664 [debug] [Thread-4 (]: SQL status: COMMIT in 0.21 seconds
[0m16:23:28.337694 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_webinars_xf"
[0m16:23:28.337694 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_webinars_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_webinars_xf"} */
drop table if exists "acton"."Postgres"."ao_webinars_xf__dbt_backup" cascade
[0m16:23:28.379634 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:23:28.380670 [debug] [Thread-4 (]: finished collecting timing info
[0m16:23:28.380670 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_webinars_xf: Close
[0m16:23:28.381638 [info ] [Thread-4 (]: 11 of 31 OK created sql table model Postgres.ao_webinars_xf .................... [[32mSELECT 18487[0m in 1.44s]
[0m16:23:28.382635 [debug] [Thread-4 (]: Finished running node model.acton_marketing_data.ao_webinars_xf
[0m16:23:28.382635 [debug] [Thread-4 (]: Began running node model.acton_marketing_data.ao_media_xf
[0m16:23:28.383662 [info ] [Thread-4 (]: 13 of 31 START sql table model Postgres.ao_media_xf ............................ [RUN]
[0m16:23:28.383662 [debug] [Thread-4 (]: Acquiring new postgres connection "model.acton_marketing_data.ao_media_xf"
[0m16:23:28.384630 [debug] [Thread-4 (]: Began compiling node model.acton_marketing_data.ao_media_xf
[0m16:23:28.384630 [debug] [Thread-4 (]: Compiling model.acton_marketing_data.ao_media_xf
[0m16:23:28.387655 [debug] [Thread-4 (]: Writing injected SQL for node "model.acton_marketing_data.ao_media_xf"
[0m16:23:28.388647 [debug] [Thread-4 (]: finished collecting timing info
[0m16:23:28.388647 [debug] [Thread-4 (]: Began executing node model.acton_marketing_data.ao_media_xf
[0m16:23:28.396627 [debug] [Thread-4 (]: Writing runtime sql for node "model.acton_marketing_data.ao_media_xf"
[0m16:23:28.397623 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_media_xf"
[0m16:23:28.397623 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media_xf: BEGIN
[0m16:23:28.398592 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:23:28.533608 [debug] [Thread-2 (]: SQL status: SELECT 79754 in 0.96 seconds
[0m16:23:28.535605 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_forms_xf"
[0m16:23:28.535605 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_forms_xf"} */
alter table "acton"."Postgres"."ao_forms_xf__dbt_tmp" rename to "ao_forms_xf"
[0m16:23:28.580467 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:23:28.581462 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms_xf: COMMIT
[0m16:23:28.581462 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_forms_xf"
[0m16:23:28.582432 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms_xf: COMMIT
[0m16:23:28.625205 [debug] [Thread-2 (]: SQL status: COMMIT in 0.04 seconds
[0m16:23:28.627235 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_forms_xf"
[0m16:23:28.627235 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_forms_xf"} */
drop table if exists "acton"."Postgres"."ao_forms_xf__dbt_backup" cascade
[0m16:23:28.670250 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:23:28.670870 [debug] [Thread-2 (]: finished collecting timing info
[0m16:23:28.670870 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_forms_xf: Close
[0m16:23:28.671870 [info ] [Thread-2 (]: 12 of 31 OK created sql table model Postgres.ao_forms_xf ....................... [[32mSELECT 79754[0m in 1.50s]
[0m16:23:28.672872 [debug] [Thread-2 (]: Finished running node model.acton_marketing_data.ao_forms_xf
[0m16:23:28.672872 [debug] [Thread-2 (]: Began running node model.acton_marketing_data.quote_line
[0m16:23:28.673865 [info ] [Thread-2 (]: 14 of 31 START sql table model Postgres.quote_line ............................. [RUN]
[0m16:23:28.673865 [debug] [Thread-2 (]: Acquiring new postgres connection "model.acton_marketing_data.quote_line"
[0m16:23:28.674863 [debug] [Thread-2 (]: Began compiling node model.acton_marketing_data.quote_line
[0m16:23:28.674863 [debug] [Thread-2 (]: Compiling model.acton_marketing_data.quote_line
[0m16:23:28.677884 [debug] [Thread-2 (]: Writing injected SQL for node "model.acton_marketing_data.quote_line"
[0m16:23:28.678852 [debug] [Thread-2 (]: finished collecting timing info
[0m16:23:28.678852 [debug] [Thread-2 (]: Began executing node model.acton_marketing_data.quote_line
[0m16:23:28.687827 [debug] [Thread-2 (]: Writing runtime sql for node "model.acton_marketing_data.quote_line"
[0m16:23:28.688825 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.quote_line"
[0m16:23:28.688825 [debug] [Thread-2 (]: On model.acton_marketing_data.quote_line: BEGIN
[0m16:23:28.688825 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:23:28.782902 [debug] [Thread-4 (]: SQL status: BEGIN in 0.38 seconds
[0m16:23:28.782902 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_media_xf"
[0m16:23:28.783903 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_media_xf"} */

  
    

  create  table "acton"."Postgres"."ao_media_xf__dbt_tmp"
  as (
    

SELECT 
-- IDs
    document_id AS media_id,
    e_mail_address AS email,
    record_id,
    unique_visitor_id,

-- Media Attributes
    document_name AS media_name,
    
-- Action Data
    action,
    action_time,
    action_day,

-- Other Data
    cookie_id,
    ip_address,
    e_mail_domain AS email_domain
FROM "acton"."Postgres"."ao_media"
WHERE e_mail_address IS NOT null
AND e_mail_address NOT LIKE 'unknown%'
  );
  
[0m16:23:29.068113 [debug] [Thread-2 (]: SQL status: BEGIN in 0.38 seconds
[0m16:23:29.068113 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.quote_line"
[0m16:23:29.068907 [debug] [Thread-2 (]: On model.acton_marketing_data.quote_line: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.quote_line"} */

  
    

  create  table "acton"."Postgres"."quote_line__dbt_tmp"
  as (
    

WITH base AS (

    SELECT *
    FROM "acton".salesforce."sbqq_quote_line_c"

), final AS (

    SELECT
        base.id AS quote_id,
        base.is_deleted,
        base.name AS quote_name,
        base.currency_iso_code,
        DATE_TRUNC('day',base.created_date)::Date AS quote_created_date,
        DATE_TRUNC('day',base.last_modified_date)::Date AS quote_last_modified_date,
        base.system_modstamp AS systemmodstamp,
        base.sbqq_quote_c AS sbqq_quote,
        base.sbqq_product_option_c AS sbqq_product_option,
        base.sbqq_product_c AS sbqq_product,
        base.sbqq_prorate_multiplier_c AS sbqq_prorate_multiplier,
        base.sbqq_prorated_list_price_c AS sbqq_prorated_list_price,
        base.sbqq_prorated_price_c AS sbqq_prorated_price,
        base.customer_discount_c AS customer_discount,
        base.sbqq_product_subscription_type_c AS sbqq_product_subscription_type,
        base.sbqq_subscription_term_c AS sbqq_product_subscription_term,
        sbqq_quote_c.sbqq_opportunity_2_c AS opportunity_id,
        product_xf.sbqq_subscription_type,
        product_xf.product_code,
        sbqq_quote_c.sbqq_primary_c AS sbqq_primary_quote
    FROM base
    LEFT JOIN "acton".salesforce."sbqq_quote_c" ON
    base.id=sbqq_quote_c.id
    LEFT JOIN "acton"."Postgres"."product_xf" ON
    base.sbqq_product_c=product_xf.product_id

)   

SELECT *
FROM final
  );
  
[0m16:23:29.996544 [debug] [Thread-4 (]: SQL status: SELECT 67144 in 1.21 seconds
[0m16:23:29.998541 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_media_xf"
[0m16:23:29.998541 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_media_xf"} */
alter table "acton"."Postgres"."ao_media_xf__dbt_tmp" rename to "ao_media_xf"
[0m16:23:30.040585 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:23:30.042579 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media_xf: COMMIT
[0m16:23:30.042579 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_media_xf"
[0m16:23:30.042579 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media_xf: COMMIT
[0m16:23:30.055546 [debug] [Thread-2 (]: SQL status: SELECT 211972 in 0.99 seconds
[0m16:23:30.058536 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.quote_line"
[0m16:23:30.058536 [debug] [Thread-2 (]: On model.acton_marketing_data.quote_line: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.quote_line"} */
alter table "acton"."Postgres"."quote_line" rename to "quote_line__dbt_backup"
[0m16:23:30.105412 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.05 seconds
[0m16:23:30.109400 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.quote_line"
[0m16:23:30.109400 [debug] [Thread-2 (]: On model.acton_marketing_data.quote_line: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.quote_line"} */
alter table "acton"."Postgres"."quote_line__dbt_tmp" rename to "quote_line"
[0m16:23:30.157274 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.05 seconds
[0m16:23:30.159268 [debug] [Thread-2 (]: On model.acton_marketing_data.quote_line: COMMIT
[0m16:23:30.159268 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.quote_line"
[0m16:23:30.159268 [debug] [Thread-2 (]: On model.acton_marketing_data.quote_line: COMMIT
[0m16:23:30.207140 [debug] [Thread-2 (]: SQL status: COMMIT in 0.05 seconds
[0m16:23:30.210135 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.quote_line"
[0m16:23:30.210135 [debug] [Thread-4 (]: SQL status: COMMIT in 0.17 seconds
[0m16:23:30.210135 [debug] [Thread-2 (]: On model.acton_marketing_data.quote_line: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.quote_line"} */
drop table if exists "acton"."Postgres"."quote_line__dbt_backup" cascade
[0m16:23:30.214122 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.ao_media_xf"
[0m16:23:30.214122 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_media_xf"} */
drop table if exists "acton"."Postgres"."ao_media_xf__dbt_backup" cascade
[0m16:23:30.259004 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:23:30.259998 [debug] [Thread-4 (]: finished collecting timing info
[0m16:23:30.259998 [debug] [Thread-4 (]: On model.acton_marketing_data.ao_media_xf: Close
[0m16:23:30.260996 [info ] [Thread-4 (]: 13 of 31 OK created sql table model Postgres.ao_media_xf ....................... [[32mSELECT 67144[0m in 1.88s]
[0m16:23:30.260996 [debug] [Thread-4 (]: Finished running node model.acton_marketing_data.ao_media_xf
[0m16:23:30.261993 [debug] [Thread-4 (]: Began running node model.acton_marketing_data.lead_source_xf
[0m16:23:30.261993 [info ] [Thread-4 (]: 15 of 31 START sql table model Postgres.lead_source_xf ......................... [RUN]
[0m16:23:30.262991 [debug] [Thread-4 (]: Acquiring new postgres connection "model.acton_marketing_data.lead_source_xf"
[0m16:23:30.262991 [debug] [Thread-4 (]: Began compiling node model.acton_marketing_data.lead_source_xf
[0m16:23:30.262991 [debug] [Thread-4 (]: Compiling model.acton_marketing_data.lead_source_xf
[0m16:23:30.266980 [debug] [Thread-4 (]: Writing injected SQL for node "model.acton_marketing_data.lead_source_xf"
[0m16:23:30.267978 [debug] [Thread-4 (]: finished collecting timing info
[0m16:23:30.267978 [debug] [Thread-4 (]: Began executing node model.acton_marketing_data.lead_source_xf
[0m16:23:30.275955 [debug] [Thread-4 (]: Writing runtime sql for node "model.acton_marketing_data.lead_source_xf"
[0m16:23:30.276953 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.lead_source_xf"
[0m16:23:30.276953 [debug] [Thread-4 (]: On model.acton_marketing_data.lead_source_xf: BEGIN
[0m16:23:30.276953 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:23:30.283934 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.07 seconds
[0m16:23:30.284931 [debug] [Thread-2 (]: finished collecting timing info
[0m16:23:30.284931 [debug] [Thread-2 (]: On model.acton_marketing_data.quote_line: Close
[0m16:23:30.285928 [info ] [Thread-2 (]: 14 of 31 OK created sql table model Postgres.quote_line ........................ [[32mSELECT 211972[0m in 1.61s]
[0m16:23:30.286926 [debug] [Thread-2 (]: Finished running node model.acton_marketing_data.quote_line
[0m16:23:30.286926 [debug] [Thread-2 (]: Began running node model.acton_marketing_data.opp_source_xf
[0m16:23:30.287923 [info ] [Thread-2 (]: 16 of 31 START sql table model Postgres.opp_source_xf .......................... [RUN]
[0m16:23:30.287923 [debug] [Thread-2 (]: Acquiring new postgres connection "model.acton_marketing_data.opp_source_xf"
[0m16:23:30.287923 [debug] [Thread-2 (]: Began compiling node model.acton_marketing_data.opp_source_xf
[0m16:23:30.288920 [debug] [Thread-2 (]: Compiling model.acton_marketing_data.opp_source_xf
[0m16:23:30.299891 [warn ] [Thread-2 (]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.opp_source_xf model triggered this warning.
[0m16:23:30.306873 [warn ] [Thread-2 (]: Warning: the `datediff` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `datediff` (no prefix) instead. The acton_marketing_data.opp_source_xf model triggered this warning.
[0m16:23:30.312856 [debug] [Thread-2 (]: Writing injected SQL for node "model.acton_marketing_data.opp_source_xf"
[0m16:23:30.313854 [debug] [Thread-2 (]: finished collecting timing info
[0m16:23:30.314851 [debug] [Thread-2 (]: Began executing node model.acton_marketing_data.opp_source_xf
[0m16:23:30.323827 [debug] [Thread-2 (]: Writing runtime sql for node "model.acton_marketing_data.opp_source_xf"
[0m16:23:30.324825 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.opp_source_xf"
[0m16:23:30.325822 [debug] [Thread-2 (]: On model.acton_marketing_data.opp_source_xf: BEGIN
[0m16:23:30.325822 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:23:30.686676 [debug] [Thread-4 (]: SQL status: BEGIN in 0.41 seconds
[0m16:23:30.686676 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.lead_source_xf"
[0m16:23:30.686676 [debug] [Thread-4 (]: On model.acton_marketing_data.lead_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.lead_source_xf"} */

  
    

  create  table "acton"."Postgres"."lead_source_xf__dbt_tmp"
  as (
    

WITH base AS (

SELECT *
FROM "acton"."salesforce"."lead"

), final AS (

    SELECT
        id AS lead_id,
        is_deleted,
        base.created_by_id,
        creator.user_name AS created_by_name,
        first_name,
        last_name, 
        title,
        company,
        state,
        country,
        email,
        lead_source,
        status AS lead_status,
        de_industry_c AS industry,
        CASE
            WHEN de_industry_c IN ('Business Services') THEN 'Business Services'
            WHEN de_industry_c IN ('Finance','Insurance') THEN 'Finance'
            WHEN de_industry_c IN ('Manufacturing') THEN 'Manufacturing'
            WHEN de_industry_c IN ('Software','Telecommunications') THEN 'SoftCom'
            ELSE 'Other'
        END AS industry_bucket,
        annual_revenue,
        number_of_employees,
        owner_id AS lead_owner_id,
        is_converted,
        DATE_TRUNC('day',converted_date)::Date AS converted_date,
        converted_account_id,
        converted_contact_id,
        converted_opportunity_id,
        last_modified_date,
        DATE_TRUNC('day',created_date)::Date AS created_date,
        system_modstamp AS systemmodstamp,
        DATE_TRUNC('day',mql_created_date_c)::Date AS mql_created_date,
        DATE_TRUNC('day',mql_most_recent_date_c)::Date AS mql_most_recent_date,
        DATE_TRUNC('day',date_time_to_working_c)::Date AS working_date,
        account_c AS account_id,
        no_longer_with_company_c AS no_longer_with_company,
        ft_utm_channel_c AS channel_first_touch,
        lt_utm_channel_c AS channel_last_touch,
        lt_utm_medium_c AS medium_last_touch,
        lt_utm_content_c AS content_last_touch,
        lt_utm_source_c AS source_last_touch,
        lt_utm_campaign_c AS campaign_last_touch,
        channel_lead_creation_c AS channel_lead_creation,
        medium_lead_creation_c AS medium_lead_creation,
        hand_raiser_c AS is_hand_raiser,
        ft_subchannel_c AS subchannel_first_touch,
        lt_subchannel_c AS subchannel_last_touch,
        lc_subchannel_c AS subchannel_lead_creation,
        ft_offer_asset_type_c AS offer_asset_type_first_touch,
        ft_offer_asset_subtype_c AS offer_asset_subtype_first_touch,
        ft_offer_asset_topic_c AS offer_asset_topic_first_touch,
        ft_offer_asset_name_c AS offer_asset_name_first_touch,
        lc_offer_asset_type_c AS offer_asset_type_lead_creation,
        lc_offer_asset_subtype_c AS offer_asset_subtype_lead_creation,
        lc_offer_asset_topic_c AS offer_asset_topic_lead_creation,
        lc_offer_asset_name_c AS offer_asset_name_lead_creation,
        lt_offer_asset_type_c AS offer_asset_type_last_touch,
        lt_offer_asset_subtype_c AS offer_asset_subtype_last_touch,
        lt_offer_asset_topic_c AS offer_asset_topic_last_touch,
        lt_offer_asset_name_c AS offer_asset_name_last_touch,
        lean_data_a_2_b_account_c AS lean_data_account_id,
        de_current_marketing_automation_c AS current_ma,
        de_current_crm_c AS current_crm,
        DATE_TRUNC('day',marketing_lead_creation_date_c)::Date AS marketing_created_date,
        mql_created_time_c AS mql_created_datetime,
        mql_most_recent_time_c AS mql_most_recent_datetime,
        article_14_notice_date_c AS article_14_notice_date,
        x_9883_lead_score_c AS lead_score,
        ft_utm_medium_c AS medium_first_touch,
        ft_utm_source_c AS source_first_touch,
        ft_utm_campaign_c AS campaign_first_touch,
        channel_lead_creation_c AS lead_channel_forecast,
        email_bounced_reason,
        legitimate_basis_c AS legitimate_basis,
        email_bounced_date,
        source_lead_creation_c AS source_lead_creation,
        campaign_lead_creation_c AS campaign_lead_creation,
        firmographic_demographic_lead_score_c AS firmographic_demographic_lead_score,
        do_not_contact_c AS do_not_contact,
        form_consent_opt_in_c AS form_consent_opt_in,
        CASE 
            WHEN annual_revenue <= 49999999 THEN 'SMB'
            WHEN annual_revenue > 49999999 AND annual_revenue <= 499999999 THEN 'Mid-Market'
            WHEN annual_revenue > 499999999 THEN 'Enterprise'
        END AS company_size_rev,
        CASE 
            WHEN LOWER(channel_lead_creation_c) = 'organic' THEN 'Organic'
            WHEN LOWER(channel_lead_creation_c) IS null THEN 'Unknown'
            WHEN LOWER(channel_lead_creation_c) = 'social' AND LOWER(medium_lead_creation_c) = 'social-organic' THEN 'Social - Organic'
            WHEN LOWER(channel_lead_creation_c) = 'social' AND LOWER(medium_lead_creation_c) = 'social-paid' THEN 'Paid Social'
            WHEN LOWER(channel_lead_creation_c) = 'ppc' THEN 'PPC/Paid Search'
            WHEN LOWER(channel_lead_creation_c) = 'email' AND LOWER(source_lead_creation_c) like '%act-on%' THEN 'Paid Email' 
            WHEN LOWER(channel_lead_creation_c) = 'ppl' AND LOWER(medium_lead_creation_c) = 'syndication partner' THEN 'PPL'
            WHEN LOWER(channel_lead_creation_c) IN ('prospecting','ppl') AND LOWER(medium_lead_creation_c) = 'intent partner' THEN 'Intent Partners'
            WHEN LOWER(channel_lead_creation_c) = 'event' THEN 'Events and Trade Shows'
            WHEN LOWER(channel_lead_creation_c) = 'partner' THEN 'Partners'
            ELSE 'Other'
        END AS channel_bucket,
        CASE
            WHEN country IS NOT null AND country IN ('GB','UK','IE','DE','DK','FI','IS','NO','SE','FR','AL','AD','AM','AT','BY','BE','BA','BG','HR','CS','CY','CZ','EE','FX','GE','GR','HU','IT','LV','LI','LT','LU','MK','MT','MD','MC','ME','NL','PL','PT','RO','SM','RS','SJ','SK','SI','ES','CH','UA','VA','FO','GI','GG','IM','JE','XK','RU','United Kingdom','England') THEN 'EUROPE'
            WHEN country IS NOT null AND country IN ('JP','KR','CN','MN','TW','VN','HK','LA','TH','KH','PH','MY','SG','ID','LK','IN','NP','BT','MM','PK','AF','KG','UZ','TM','KZ') THEN 'APJ'
            WHEN country IS NOT null AND country IN ('AU','CX','NZ','NF','Australia','New Zealand') THEN 'AUNZ'
            WHEN country IS NOT null AND country IN ('AR','BO','BR','BZ','CL','CO','CU','CR','DO','EC','FK','GF','GS','GY','GT','HN','MX','NI','PA','PE','PR','PY','SR','SV','UY','VE')THEN 'LATAM'
            WHEN state IS NOT null AND state IN ('CA','NV','UT','AK','MO','CO','HI','OK','IL','AR','NE','MI','KS','OR','WA','ID','WI','MN','ND','SD','MT','WY','IA','NB','ON','PE','QC','AB','BC','MB','SK','NL','NS','YT','NU','NT') THEN 'NA-WEST'
            WHEN state IS NOT null AND state IN ('NY','CT','MA','VT','NH','ME','NJ','RI','TX','AZ','NM','MS','LA','AL','TN','KY','OH','IN','GA','FL','NC','SC','PA','DC','DE','MD','VA','WV') THEN 'NA-EAST'
            WHEN country IS NOT null AND country IN ('AG','AI','AN','AW','BB','BM','BS','DM','GD','GP','HT','JM','KN','LC','MQ','MS','TC','TT','VC','VG','VI') THEN 'NA-EAST'
            WHEN country IS NOT null AND country IN ('US','CA') AND state IS null  THEN 'NA-NO-STATEPROV'
            WHEN country IS NOT null AND state IS NOT null THEN 'ROW'
            ELSE 'Unknown'
        END AS global_region,
        COALESCE(account_c,lean_data_a_2_b_account_c) AS person_account_id
    FROM base
    LEFT JOIN "acton"."Postgres"."user_source_xf" creator ON
    base.created_by_id=creator.user_id
    WHERE base.owner_id != '00Ga0000003Nugr' -- AO-Fake Leads

)

SELECT 
final.*,
CASE
    WHEN global_region IN ('EUROPE','ROW','AUNZ') THEN 'EMEA'
    WHEN company_size_rev IN ('SMB') OR company_size_rev IS null THEN 'Velocity'
    WHEN company_size_rev IN ('Mid-Market','Enterprise') THEN 'Upmarket'
    ELSE null
END AS segment
FROM final
  );
  
[0m16:23:30.717052 [debug] [Thread-2 (]: SQL status: BEGIN in 0.39 seconds
[0m16:23:30.717052 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.opp_source_xf"
[0m16:23:30.717052 [debug] [Thread-2 (]: On model.acton_marketing_data.opp_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.opp_source_xf"} */

  
    

  create  table "acton"."Postgres"."opp_source_xf__dbt_tmp"
  as (
    

WITH base AS (
SELECT *
FROM "acton"."salesforce"."opportunity"

), intermediate AS (

    SELECT DISTINCT
        base.id AS opportunity_id,
        base.is_deleted,
        base.account_id,
        account.name AS account_name,
        --account.account_csm_name,
        --account.account_owner_name,
        account.current_customer_c AS is_current_customer,
        account.sdr_c AS sdr_id,
        sdr.user_name AS sdr_name,
        CASE
            WHEN account.billing_country IS NOT null AND account.billing_country IN ('GB','UK','IE','DE','DK','FI','IS','NO','SE','FR','AL','AD','AM','AT','BY','BE','BA','BG','HR','CS','CY','CZ','EE','FX','GE','GR','HU','IT','LV','LI','LT','LU','MK','MT','MD','MC','ME','NL','PL','PT','RO','SM','RS','SJ','SK','SI','ES','CH','UA','VA','FO','GI','GG','IM','JE','XK','RU') THEN 'EUROPE'
            WHEN account.billing_country IS NOT null AND account.billing_country IN ('JP','KR','CN','MN','TW','VN','HK','LA','TH','KH','PH','MY','SG','ID','LK','IN','NP','BT','MM','PK','AF','KG','UZ','TM','KZ') THEN 'APJ'
            WHEN account.billing_country IS NOT null AND account.billing_country IN ('AU','CX','NZ','NF','Australia','New Zealand') THEN 'AUNZ'
            WHEN account.billing_country IS NOT null AND account.billing_country IN ('AR','BO','BR','BZ','CL','CO','CU','CR','DO','EC','FK','GF','GS','GY','GT','HN','MX','NI','PA','PE','PR','PY','SR','SV','UY','VE')THEN 'LATAM'
            WHEN account.billing_state IS NOT null AND account.billing_state IN ('CA','NV','UT','AK','MO','CO','HI','OK','IL','AR','NE','MI','KS','OR','WA','ID','WI','MN','ND','SD','MT','WY','IA','NB','ON','PE','QC','AB','BC','MB','SK','NL','NS','YT','NU','NT') THEN 'NA-WEST'
            WHEN account.billing_state IS NOT null AND account.billing_state IN ('NY','CT','MA','VT','NH','ME','NJ','RI','TX','AZ','NM','MS','LA','AL','TN','KY','OH','IN','GA','FL','NC','SC','PA','DC','DE','MD','VA','WV') THEN 'NA-EAST'
            WHEN account.billing_country IS NOT null AND account.billing_country IN ('AG','AI','AN','AW','BB','BM','BS','DM','GD','GP','HT','JM','KN','LC','MQ','MS','TC','TT','VC','VG','VI') THEN 'NA-EAST'
            WHEN account.billing_country IS NOT null AND account.billing_country IN ('US','CA') AND account.billing_state IS null  THEN 'NA-NO-STATEPROV'
            WHEN account.billing_country IS NOT null AND account.billing_state IS NOT null THEN 'ROW'
            ELSE 'Unknown'
        END AS account_global_region,
        CASE 
            WHEN account.annual_revenue <= 49999999 THEN 'SMB'
            WHEN account.annual_revenue > 49999999 AND account.annual_revenue <= 499999999 THEN 'Mid-Market'
            WHEN account.annual_revenue > 499999999 THEN 'Enterprise'
        END AS company_size_rev,
        base.name AS opportunity_name,
        stage_name,
        amount,
        base.type,
        lead_source AS opp_lead_source,
        is_closed,
        is_won,
        base.owner_id,
        owner.user_name AS owner_name, 
        base.created_date AS created_day,
        DATE_TRUNC('day',base.created_date)::Date AS created_date,
        DATE_TRUNC('day',base.last_modified_date)::Date AS last_modified_date,
        base.system_modstamp AS systemmodstamp,
        contact_id,
        base.contract_id,
        crm_c AS opp_crm,
        renewal_type_c AS renewal_type,
        renewal_acv_value_c AS renewal_acv,
        channel_lead_creation_c AS opp_channel_lead_creation,
        medium_lead_creation_c AS opp_medium_lead_creation,
        DATE_TRUNC('day',discovery_date_c)::Date AS discovery_date,
        DATE_TRUNC('day',date_reached_confirmed_value_c)::Date AS confirmed_value_date,
        DATE_TRUNC('day',date_reached_contract_c)::Date AS negotiation_date,
        DATE_TRUNC('day',date_reached_demo_c)::Date AS demo_date,
        DATE_TRUNC('day',date_reached_solution_c)::Date AS solution_date,
        DATE_TRUNC('day',date_reached_closing_c)::Date AS closing_date,
        DATE_TRUNC('day',date_time_reached_implement_c)::Date AS implement_date,
        DATE_TRUNC('day',sql_date_c)::Date AS sql_date,
        DATE_TRUNC('day',date_time_reached_voc_negotiate_c)::Date AS voc_date,
        DATE_TRUNC('day',date_time_reached_discovery_c)::Date AS discovery_day_time,
        DATE_TRUNC('day',date_time_reached_demo_c)::Date AS demo_day_time,
        DATE_TRUNC('day',date_time_reached_implement_c)::Date AS implement_day_time,
        DATE_TRUNC('day',date_time_reached_sql_c)::Date AS sql_day_time,
        DATE_TRUNC('day',date_time_reached_voc_negotiate_c)::Date AS voc_day_time,
        oc_utm_channel_c AS opp_channel_opportunity_creation,
        oc_utm_medium_c AS opp_medium_opportunity_creation,
        oc_utm_content_c AS opp_content_opportunity_creation, 
        oc_utm_source_c AS opp_source_opportunity_creation, 
        base.csm_c AS csm,
        base.marketing_channel_c AS marketing_channel,
        base.ft_utm_channel_c AS opp_channel_first_touch,
        base.ft_utm_content_c AS opp_content_first_touch,
        base.ft_utm_medium_c AS opp_medium_first_touch,
        base.ft_utm_source_c AS opp_source_first_touch,
        base.oc_offer_asset_type_c AS opp_offer_asset_type_opportunity_creation,
        base.oc_offer_asset_subtype_c AS opp_offer_asset_subtype_opportunity_creation,
        base.oc_offer_asset_topic_c AS opp_offer_asset_topic_opportunity_creation,
        base.oc_offer_asset_name_c AS opp_offer_asset_name_opportunity_creation,
        base.ft_offer_asset_name_c AS opp_offer_asset_name_first_touch,
        base.lc_offer_asset_name_c  AS opp_offer_asset_name_lead_creation, 
        base.ft_offer_asset_subtype_c AS opp_offer_asset_subtype_first_touch, 
        base.lc_offer_asset_subtype_c AS opp_offer_asset_subtype_lead_creation,
        base.ft_offer_asset_topic_c AS opp_offer_asset_topic_first_touch, 
        base.lc_offer_asset_topic_c AS opp_offer_asset_topic_lead_creation,
        base.ft_offer_asset_type_c AS opp_offer_asset_type_first_touch, 
        base.lc_offer_asset_type_c AS opp_offer_asset_type_lead_creation,
        base.ft_subchannel_c AS opp_subchannel_first_touch,
        base.lc_subchannel_c AS opp_subchannel_lead_creation, 
        base.oc_subchannel_c AS opp_subchannel_opportunity_creation,
        DATE_TRUNC('day',base.discovery_call_scheduled_date_c)::Date AS discovery_call_date,
        base.opportunity_status_c AS opportunity_status,
        base.sql_status_reason_c AS sql_status_reason,
        DATE_TRUNC('day',base.sql_date_c)::Date AS sql_day,
        DATE_TRUNC('day',base.discovery_call_scheduled_date_time_c)::Date AS discovery_call_scheduled_datetime,
        DATE_TRUNC('day',base.discovery_call_completed_date_time_c)::Date AS discovery_call_completed_datetime,
        base.ao_account_id_c AS ao_account_id,
        base.lead_id_converted_from_c AS lead_id_converted_from,
        base.close_date,
        base.opportunity_type_detail_c AS opp_type_details,
        DATE_TRUNC('day',base.close_date)::Date AS close_day,
        base.source_lead_creation_c AS opp_source_lead_creation,
        base.oc_utm_campaign_c AS opp_campaign_opportunity_creation,
        base.forecast_category,
        base.ft_utm_campaign_c AS opp_campaign_first_touch,  
        base.acv_deal_size_override_c AS acv_deal_size_override,
        base.lead_grade_at_conversion_c AS lead_grade_at_conversion,
        base.renewal_stage_c AS renewal_stage,
        base.created_by_id,
        quota_credit_renewal_c AS quota_credit_renewal,
        base.sbqq_renewed_contract_c AS renewed_contract_id,
        quota_credit_c AS quota_credit,
        sbqq_primary_quote_c AS primary_quote_id,
        quota_credit_new_business_c AS quota_credit_new_business,
        quota_credit_one_time_c AS quota_credit_one_time,
        submitted_for_approval_c AS submitted_for_approval,
        acv_add_back_c AS acv_add_back,
        trigger_renewal_value_c AS trigger_renewal_value,
        opportunity_line_item_xf.sbqq_subscription_type,
        quote_line.sbqq_product_subscription_term,
        opportunity_line_item_xf.product_code,
        opportunity_line_item_xf.product_family,
        opportunity_line_item_xf.total_price,
        opportunity_line_item_xf.annual_price,
        quote_line.sbqq_primary_quote,
        contract_source_xf.contract_acv,
        account.industry,
        CASE
            WHEN account.industry IN ('Business Services') THEN 'Business Services'
            WHEN account.industry IN ('Finance','Insurance') THEN 'Finance'
            WHEN account.industry IN ('Manufacturing') THEN 'Manufacturing'
            WHEN account.industry IN ('Software','Telecommunications') THEN 'SoftCom'
            ELSE 'Other'
        END AS industry_bucket,
        --account.segment,
        CASE
            WHEN base.type IN ('New Business','Upsell','Trigger Renewal','Trigger Up','Non-Monetary Mod','Admin Opp','Partner New','Partner UpSell','Admin Conversion') THEN true
            ELSE false
        END AS include_in_acv_deal_size,
        CASE
            WHEN is_closed = true THEN 
        ((base.close_date)::date - (base.created_date)::date)
    
            ELSE 
        ((CURRENT_DATE)::date - (base.created_date)::date)
    
        END AS age,
        CASE
            WHEN opportunity_line_item_xf.sbqq_subscription_type = 'Renewable' AND opportunity_line_item_xf.product_code != 'SOW-MNTH-CUST' THEN SUM(total_price)
            ELSE 0
        END AS tcv,
        CASE 
            WHEN opportunity_line_item_xf.sbqq_subscription_type = 'Renewable' AND opportunity_line_item_xf.product_family != 'Bundle' AND opportunity_line_item_xf.product_code NOT IN ('SOW-MNTH-CUST','MAAS-FND-TRAIN','MAAS-FND-FAST','MAAS-ACC-DELIV','MAAS-ACC-STRAT')
                THEN SUM(annual_price)
            ELSE 0
        END AS acv,
        CASE 
            WHEN opportunity_line_item_xf.sbqq_subscription_type = 'One-time' AND opportunity_line_item_xf.product_code NOT IN ('STD-CPCTY-ONE','SOW-MKTR-DMD','SOW-MNTH-CUST','MAAS-FND-TRAIN','MAAS-FND-FASTTRK','MAAS-ACC-IMPL','MAAS-ACC-DELIV','MAAS-ACC-STRAT','AO-CPM-OVER')
                THEN SUM(total_price)
            ELSE 0
        END AS one_time_ps_value,
        CASE 
            WHEN opportunity_line_item_xf.sbqq_subscription_type = 'One-time' AND opportunity_line_item_xf.product_code IN ('STD-CPCTY-ONE','AO-CPM-OVER') THEN SUM(total_price)
            ELSE 0
        END AS one_time_license_value,
        CASE 
            WHEN opportunity_line_item_xf.product_code IN ('SOW-MKTR-DMD','SOW-MNTH-CUST','MAAS-FND-TRAIN','MAAS-FND-FASTTRK','MAAS-ACC-IMPL','MAAS-ACC-DELIV','MAAS-ACC-STRAT') THEN SUM(total_price)
            ELSE 0
        END AS pso_recurring_fees
    FROM base
    LEFT JOIN "acton"."Postgres"."contract_source_xf" ON
    base.id=contract_source_xf.contract_opportunity_id
    LEFT JOIN "acton"."Postgres"."opportunity_line_item_xf" ON
    base.id=opportunity_line_item_xf.opportunity_id
    LEFT JOIN "acton"."Postgres"."quote_line" ON
    base.id=quote_line.opportunity_id
    LEFT JOIN "acton".salesforce."account" account ON
    base.account_id=account.id
    LEFT JOIN "acton"."Postgres"."user_source_xf" owner ON
    base.owner_id=owner.user_id
    LEFT JOIN "acton"."Postgres"."user_source_xf" sdr ON
    account.sdr_c=sdr.user_id
    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108

), intermediate_acv_formula AS (

    SELECT 
      intermediate.opportunity_id,
      intermediate.is_deleted,
      intermediate.account_id,
      intermediate.account_name,
      intermediate.is_current_customer,
      intermediate.sdr_id,
      intermediate.sdr_name,
      intermediate.company_size_rev,
      intermediate.account_global_region,
      intermediate.opportunity_name,
      intermediate.stage_name,
      intermediate.amount,
      intermediate.type,
      intermediate.opp_lead_source,
      intermediate.is_closed,
      intermediate.is_won,
      intermediate.owner_id,
      intermediate.owner_name,
      intermediate.created_day,
      intermediate.created_date,
      intermediate.last_modified_date,
      intermediate.systemmodstamp,
      intermediate.contact_id,
      intermediate.contract_id,
      intermediate.opp_crm,
      intermediate.renewal_type,
      intermediate.renewal_acv,
      intermediate.opp_channel_lead_creation,
      intermediate.opp_medium_lead_creation,
      intermediate.discovery_date,
      intermediate.demo_date,
      intermediate.solution_date,
      intermediate.negotiation_date,
      intermediate.confirmed_value_date,
      intermediate.closing_date,
      intermediate.implement_date,
      intermediate.sql_date,
      intermediate.voc_date,
      intermediate.discovery_day_time,
      intermediate.demo_day_time,
      intermediate.implement_day_time,
      intermediate.sql_day_time,
      intermediate.voc_day_time,
      intermediate.opp_channel_opportunity_creation,
      intermediate.opp_medium_opportunity_creation,
      intermediate.opp_content_opportunity_creation,
      intermediate.opp_source_opportunity_creation,
      intermediate.csm,
      intermediate.marketing_channel,
      intermediate.opp_channel_first_touch,
      intermediate.opp_content_first_touch,
      intermediate.opp_medium_first_touch,
      intermediate.opp_source_first_touch,
      intermediate.opp_offer_asset_type_opportunity_creation,
      intermediate.opp_offer_asset_subtype_opportunity_creation,
      intermediate.opp_offer_asset_topic_opportunity_creation,
      intermediate.opp_offer_asset_name_opportunity_creation,
      intermediate.opp_offer_asset_name_first_touch,
      intermediate.opp_offer_asset_name_lead_creation,
      intermediate.opp_offer_asset_subtype_first_touch,
      intermediate.opp_offer_asset_subtype_lead_creation,
      intermediate.opp_offer_asset_topic_first_touch,
      intermediate.opp_offer_asset_topic_lead_creation,
      intermediate.opp_offer_asset_type_first_touch,
      intermediate.opp_offer_asset_type_lead_creation,
      intermediate.opp_subchannel_first_touch,
      intermediate.opp_subchannel_lead_creation,
      intermediate.opp_subchannel_opportunity_creation,
      intermediate.discovery_call_date,
      intermediate.opportunity_status,
      intermediate.sql_status_reason,
      intermediate.sql_day,
      intermediate.discovery_call_scheduled_datetime,
      intermediate.discovery_call_completed_datetime,
      intermediate.ao_account_id,
      intermediate.lead_id_converted_from,
      intermediate.close_date,
      intermediate.opp_type_details,
      intermediate.close_day,
      intermediate.opp_source_lead_creation,
      intermediate.opp_campaign_opportunity_creation,
      intermediate.forecast_category,
      intermediate.opp_campaign_first_touch,
      intermediate.acv_deal_size_override,
      intermediate.lead_grade_at_conversion,
      intermediate.renewal_stage,
      intermediate.created_by_id,
      intermediate.quota_credit_renewal,
      intermediate.renewed_contract_id,
      intermediate.quota_credit,
      intermediate.primary_quote_id,
      intermediate.quota_credit_new_business,
      intermediate.quota_credit_one_time,
      intermediate.submitted_for_approval,
      intermediate.acv_add_back,
      intermediate.trigger_renewal_value,
      intermediate.sbqq_primary_quote,
      intermediate.sbqq_product_subscription_term,
      intermediate.contract_acv,
      intermediate.industry,
      intermediate.industry_bucket,
      --intermediate.segment,
      intermediate.include_in_acv_deal_size,
      intermediate.age,
      intermediate.tcv,
      intermediate.acv,
      intermediate.one_time_ps_value,
      intermediate.one_time_license_value,
      intermediate.pso_recurring_fees,
      intermediate.total_price,
      intermediate.annual_price,
      CASE
        WHEN sbqq_product_subscription_term = 0 AND sbqq_primary_quote IS null THEN SUM(contract_acv)
        WHEN sbqq_product_subscription_term > 0 AND sbqq_product_subscription_term < 12 THEN SUM(tcv) 
        ELSE SUM(acv)
      END AS acv_formula
      --intermediate.sbqq_subscription_type,
      --intermediate.product_code,
      --intermediate.product_family,
    FROM intermediate
    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110

), intermediate_acv_sum AS (
    
    SELECT
      intermediate_acv_formula.opportunity_id,
      intermediate_acv_formula.is_deleted,
      intermediate_acv_formula.account_id,
      intermediate_acv_formula.account_name,
      intermediate_acv_formula.is_current_customer,
      intermediate_acv_formula.sdr_id,
      intermediate_acv_formula.sdr_name,
      intermediate_acv_formula.account_global_region,
      intermediate_acv_formula.company_size_rev,
      intermediate_acv_formula.opportunity_name,
      intermediate_acv_formula.stage_name,
      intermediate_acv_formula.amount,
      intermediate_acv_formula.type,
      intermediate_acv_formula.opp_lead_source,
      intermediate_acv_formula.is_closed,
      intermediate_acv_formula.is_won,
      intermediate_acv_formula.owner_id,
      intermediate_acv_formula.owner_name,
      intermediate_acv_formula.created_day,
      intermediate_acv_formula.created_date,
      intermediate_acv_formula.last_modified_date,
      intermediate_acv_formula.systemmodstamp,
      intermediate_acv_formula.contact_id,
      intermediate_acv_formula.contract_id,
      intermediate_acv_formula.opp_crm,
      intermediate_acv_formula.renewal_type,
      intermediate_acv_formula.renewal_acv,
      intermediate_acv_formula.opp_channel_lead_creation,
      intermediate_acv_formula.opp_medium_lead_creation,
      intermediate_acv_formula.discovery_date,
      intermediate_acv_formula.negotiation_date,
      intermediate_acv_formula.demo_date,
      intermediate_acv_formula.solution_date,
      intermediate_acv_formula.confirmed_value_date,
      intermediate_acv_formula.closing_date,
      intermediate_acv_formula.implement_date,
      intermediate_acv_formula.discovery_day_time,
      intermediate_acv_formula.demo_day_time,
      intermediate_acv_formula.implement_day_time,
      intermediate_acv_formula.sql_day_time,
      intermediate_acv_formula.voc_day_time,
      intermediate_acv_formula.sql_date,
      intermediate_acv_formula.voc_date,
      intermediate_acv_formula.opp_channel_opportunity_creation,
      intermediate_acv_formula.opp_medium_opportunity_creation,
      intermediate_acv_formula.opp_content_opportunity_creation,
      intermediate_acv_formula.opp_source_opportunity_creation,
      intermediate_acv_formula.csm,
      intermediate_acv_formula.marketing_channel,
      intermediate_acv_formula.opp_channel_first_touch,
      intermediate_acv_formula.opp_content_first_touch,
      intermediate_acv_formula.opp_medium_first_touch,
      intermediate_acv_formula.opp_source_first_touch,
      intermediate_acv_formula.opp_offer_asset_type_opportunity_creation,
      intermediate_acv_formula.opp_offer_asset_subtype_opportunity_creation,
      intermediate_acv_formula.opp_offer_asset_topic_opportunity_creation,
      intermediate_acv_formula.opp_offer_asset_name_opportunity_creation,
      intermediate_acv_formula.opp_offer_asset_name_first_touch,
      intermediate_acv_formula.opp_offer_asset_name_lead_creation,
      intermediate_acv_formula.opp_offer_asset_subtype_first_touch,
      intermediate_acv_formula.opp_offer_asset_subtype_lead_creation,
      intermediate_acv_formula.opp_offer_asset_topic_first_touch,
      intermediate_acv_formula.opp_offer_asset_topic_lead_creation,
      intermediate_acv_formula.opp_offer_asset_type_first_touch,
      intermediate_acv_formula.opp_offer_asset_type_lead_creation,
      intermediate_acv_formula.opp_subchannel_first_touch,
      intermediate_acv_formula.opp_subchannel_lead_creation,
      intermediate_acv_formula.opp_subchannel_opportunity_creation,
      intermediate_acv_formula.discovery_call_date,
      intermediate_acv_formula.opportunity_status,
      intermediate_acv_formula.sql_status_reason,
      intermediate_acv_formula.sql_day,
      intermediate_acv_formula.discovery_call_scheduled_datetime,
      intermediate_acv_formula.discovery_call_completed_datetime,
      intermediate_acv_formula.ao_account_id,
      intermediate_acv_formula.lead_id_converted_from,
      intermediate_acv_formula.close_date,
      intermediate_acv_formula.opp_type_details,
      intermediate_acv_formula.close_day,
      intermediate_acv_formula.opp_source_lead_creation,
      intermediate_acv_formula.opp_campaign_opportunity_creation,
      intermediate_acv_formula.forecast_category,
      intermediate_acv_formula.opp_campaign_first_touch,
      intermediate_acv_formula.acv_deal_size_override,
      intermediate_acv_formula.lead_grade_at_conversion,
      intermediate_acv_formula.renewal_stage,
      intermediate_acv_formula.created_by_id,
      intermediate_acv_formula.quota_credit_renewal,
      intermediate_acv_formula.renewed_contract_id,
      intermediate_acv_formula.quota_credit,
      intermediate_acv_formula.primary_quote_id,
      intermediate_acv_formula.quota_credit_new_business,
      intermediate_acv_formula.quota_credit_one_time,
      intermediate_acv_formula.submitted_for_approval,
      intermediate_acv_formula.acv_add_back,
      intermediate_acv_formula.trigger_renewal_value,
      intermediate_acv_formula.sbqq_primary_quote,
      intermediate_acv_formula.sbqq_product_subscription_term,
      intermediate_acv_formula.contract_acv,
      intermediate_acv_formula.industry,
      intermediate_acv_formula.industry_bucket,
     -- intermediate_acv_formula.segment,
      intermediate_acv_formula.include_in_acv_deal_size,
      intermediate_acv_formula.age,
      SUM(intermediate_acv_formula.one_time_ps_value) AS one_time_ps_value,
      SUM(intermediate_acv_formula.one_time_license_value) AS one_time_license_value,
      SUM(intermediate_acv_formula.pso_recurring_fees) AS pso_recurring_fees,
      SUM(intermediate_acv_formula.tcv) AS tcv,
      SUM(intermediate_acv_formula.acv) AS acv,
      SUM(intermediate_acv_formula.total_price) AS total_price,
      SUM(intermediate_acv_formula.annual_price) AS annual_price,
      SUM(intermediate_acv_formula.acv_formula) AS acv_formula
    FROM intermediate_acv_formula
    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103

), intermediate_acv_deal_size AS (
    
    SELECT
      intermediate_acv_sum.*,
      CASE
        WHEN account_global_region IN ('EUROPE','ROW','AUNZ') THEN 'EMEA'
        WHEN company_size_rev IN ('SMB') OR company_size_rev IS null THEN 'Velocity'
        WHEN company_size_rev IN ('Mid-Market','Enterprise') THEN 'Upmarket'
        ELSE null
      END AS segment, 
      CASE
        WHEN acv_deal_size_override > 0 AND is_closed = false AND submitted_for_approval = false THEN acv_deal_size_override
        WHEN type = 'Renewal' THEN SUM(acv_add_back + trigger_renewal_value)
        WHEN include_in_acv_deal_size=false THEN 0
        WHEN include_in_acv_deal_size=true AND acv_formula=0 AND one_time_ps_value=0 AND one_time_license_value=0 AND pso_recurring_fees=0 THEN amount
        ELSE acv_formula
      END AS acv_deal_size_usd
    FROM intermediate_acv_sum
    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111

), final AS (

    SELECT
        intermediate_acv_deal_size.*,
        CASE 
            WHEN acv_deal_size_usd <= '9999' THEN '< 10K'
            WHEN acv_deal_size_usd > '9999' AND acv_deal_size_usd <= '14999' THEN '10-15K'
            WHEN acv_deal_size_usd > '14999' AND acv_deal_size_usd <= '19999' THEN '15-20K'
            WHEN acv_deal_size_usd > '19999' AND acv_deal_size_usd <= '24999' THEN '20-25K'
            WHEN acv_deal_size_usd > '24999' AND acv_deal_size_usd <= '29999' THEN '25-30K'
            ELSE '30K+'
        END AS deal_size_range,
        CASE 
            WHEN LOWER(opp_channel_lead_creation) = 'organic' THEN 'Organic'
            WHEN LOWER(opp_channel_lead_creation) IS null THEN 'Unknown'
            WHEN LOWER(opp_channel_lead_creation) = 'social' AND LOWER(opp_medium_lead_creation) = 'social-organic' THEN 'Social - Organic'
            WHEN LOWER(opp_channel_lead_creation) = 'social' AND LOWER(opp_medium_lead_creation) = 'social-paid' THEN 'Paid Social'
            WHEN LOWER(opp_channel_lead_creation) = 'ppc' THEN 'PPC/Paid Search'
            WHEN LOWER(opp_channel_lead_creation) = 'email' AND LOWER(opp_source_lead_creation) like '%act-on%' THEN 'Paid Email' 
            WHEN LOWER(opp_channel_lead_creation) = 'ppl' AND LOWER(opp_medium_lead_creation) = 'syndication partner' THEN 'PPL'
            WHEN LOWER(opp_channel_lead_creation) IN ('prospecting','ppl') AND LOWER(opp_medium_lead_creation) = 'intent partner' THEN 'Intent Partners'
            WHEN LOWER(opp_channel_lead_creation) = 'event' THEN 'Events and Trade Shows'
            WHEN LOWER(opp_channel_lead_creation) = 'partner' THEN 'Partners'
            ELSE 'Other'
        END AS channel_bucket
    FROM intermediate_acv_deal_size
)

SELECT DISTINCT
*
FROM final
  );
  
[0m16:23:38.745648 [debug] [Thread-4 (]: SQL status: SELECT 359010 in 8.06 seconds
[0m16:23:38.775024 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.lead_source_xf"
[0m16:23:38.775024 [debug] [Thread-4 (]: On model.acton_marketing_data.lead_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.lead_source_xf"} */
alter table "acton"."Postgres"."lead_source_xf" rename to "lead_source_xf__dbt_backup"
[0m16:23:38.820243 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.05 seconds
[0m16:23:38.821901 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.lead_source_xf"
[0m16:23:38.821901 [debug] [Thread-4 (]: On model.acton_marketing_data.lead_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.lead_source_xf"} */
alter table "acton"."Postgres"."lead_source_xf__dbt_tmp" rename to "lead_source_xf"
[0m16:23:39.144595 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.32 seconds
[0m16:23:39.146563 [debug] [Thread-4 (]: On model.acton_marketing_data.lead_source_xf: COMMIT
[0m16:23:39.146563 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.lead_source_xf"
[0m16:23:39.146563 [debug] [Thread-4 (]: On model.acton_marketing_data.lead_source_xf: COMMIT
[0m16:23:39.777386 [debug] [Thread-4 (]: SQL status: COMMIT in 0.63 seconds
[0m16:23:39.779383 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.lead_source_xf"
[0m16:23:39.779383 [debug] [Thread-4 (]: On model.acton_marketing_data.lead_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.lead_source_xf"} */
drop table if exists "acton"."Postgres"."lead_source_xf__dbt_backup" cascade
[0m16:23:39.856230 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.08 seconds
[0m16:23:39.857230 [debug] [Thread-4 (]: finished collecting timing info
[0m16:23:39.857230 [debug] [Thread-4 (]: On model.acton_marketing_data.lead_source_xf: Close
[0m16:23:39.858227 [info ] [Thread-4 (]: 15 of 31 OK created sql table model Postgres.lead_source_xf .................... [[32mSELECT 359010[0m in 9.60s]
[0m16:23:39.859225 [debug] [Thread-4 (]: Finished running node model.acton_marketing_data.lead_source_xf
[0m16:24:01.148676 [debug] [Thread-2 (]: SQL status: SELECT 117466 in 30.43 seconds
[0m16:24:01.151281 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.opp_source_xf"
[0m16:24:01.151281 [debug] [Thread-2 (]: On model.acton_marketing_data.opp_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.opp_source_xf"} */
alter table "acton"."Postgres"."opp_source_xf" rename to "opp_source_xf__dbt_backup"
[0m16:24:01.196596 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.05 seconds
[0m16:24:01.199587 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.opp_source_xf"
[0m16:24:01.199587 [debug] [Thread-2 (]: On model.acton_marketing_data.opp_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.opp_source_xf"} */
alter table "acton"."Postgres"."opp_source_xf__dbt_tmp" rename to "opp_source_xf"
[0m16:24:01.242416 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:24:01.243376 [debug] [Thread-2 (]: On model.acton_marketing_data.opp_source_xf: COMMIT
[0m16:24:01.244373 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.opp_source_xf"
[0m16:24:01.244373 [debug] [Thread-2 (]: On model.acton_marketing_data.opp_source_xf: COMMIT
[0m16:24:01.293510 [debug] [Thread-2 (]: SQL status: COMMIT in 0.05 seconds
[0m16:24:01.296502 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.opp_source_xf"
[0m16:24:01.296502 [debug] [Thread-2 (]: On model.acton_marketing_data.opp_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.opp_source_xf"} */
drop table if exists "acton"."Postgres"."opp_source_xf__dbt_backup" cascade
[0m16:24:01.364510 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.07 seconds
[0m16:24:01.365805 [debug] [Thread-2 (]: finished collecting timing info
[0m16:24:01.365805 [debug] [Thread-2 (]: On model.acton_marketing_data.opp_source_xf: Close
[0m16:24:01.366775 [info ] [Thread-2 (]: 16 of 31 OK created sql table model Postgres.opp_source_xf ..................... [[32mSELECT 117466[0m in 31.08s]
[0m16:24:01.367814 [debug] [Thread-2 (]: Finished running node model.acton_marketing_data.opp_source_xf
[0m16:24:01.368770 [debug] [Thread-4 (]: Began running node model.acton_marketing_data.account_source_xf
[0m16:24:01.368770 [info ] [Thread-4 (]: 17 of 31 START sql table model Postgres.account_source_xf ...................... [RUN]
[0m16:24:01.369766 [debug] [Thread-4 (]: Acquiring new postgres connection "model.acton_marketing_data.account_source_xf"
[0m16:24:01.369766 [debug] [Thread-4 (]: Began compiling node model.acton_marketing_data.account_source_xf
[0m16:24:01.369766 [debug] [Thread-4 (]: Compiling model.acton_marketing_data.account_source_xf
[0m16:24:01.374840 [debug] [Thread-4 (]: Writing injected SQL for node "model.acton_marketing_data.account_source_xf"
[0m16:24:01.375837 [debug] [Thread-4 (]: finished collecting timing info
[0m16:24:01.375837 [debug] [Thread-4 (]: Began executing node model.acton_marketing_data.account_source_xf
[0m16:24:01.383891 [debug] [Thread-4 (]: Writing runtime sql for node "model.acton_marketing_data.account_source_xf"
[0m16:24:01.384889 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.account_source_xf"
[0m16:24:01.384889 [debug] [Thread-4 (]: On model.acton_marketing_data.account_source_xf: BEGIN
[0m16:24:01.384889 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:24:01.832105 [debug] [Thread-4 (]: SQL status: BEGIN in 0.45 seconds
[0m16:24:01.832105 [debug] [Thread-4 (]: Using postgres connection "model.acton_marketing_data.account_source_xf"
[0m16:24:01.832105 [debug] [Thread-4 (]: On model.acton_marketing_data.account_source_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.account_source_xf"} */

  
    

  create  table "acton"."Postgres"."account_source_xf__dbt_tmp"
  as (
    
WITH base AS (

SELECT *
FROM "acton"."salesforce"."account"

), final AS (

    SELECT
        base.id AS account_id,
        base.is_deleted,
        base.name AS account_name,
        base.type AS account_type,
        base.parent_id AS account_parent_id,
        base.billing_state,
        base.billing_postal_code,
        base.billing_country,
        base.industry,
        CASE
            WHEN base.industry IN ('Business Services') THEN 'Business Services'
            WHEN base.industry IN ('Finance','Insurance') THEN 'Finance'
            WHEN base.industry IN ('Manufacturing') THEN 'Manufacturing'
            WHEN base.industry IN ('Software','Telecommunications') THEN 'SoftCom'
            ELSE 'Other'
        END AS default_industry_bucket,
        base.annual_revenue,
        base.number_of_employees,
        base.owner_id AS account_owner_id,
        base.created_date AS account_created_date,
        base.last_modified_date,
        base.system_modstamp AS systemmodstamp,
        base.is_partner,
        base.current_customer_c AS is_current_customer,
        base.csm_c AS account_csm_c,
        base.current_crm_c AS current_crm,
        base.current_marketing_automation_c AS current_ma,
        base.de_country_c AS de_country,
        base.de_current_crm_c AS de_current_crm,
        base.de_current_marketing_automation_c AS de_current_ma,
        base.de_industry_c AS de_industry,
        CASE
            WHEN base.de_industry_c IN ('Business Services') THEN 'Business Services'
            WHEN base.de_industry_c IN ('Finance','Insurance') THEN 'Finance'
            WHEN base.de_industry_c IN ('Manufacturing') THEN 'Manufacturing'
            WHEN base.de_industry_c IN ('Software','Telecommunications') THEN 'SoftCom'
            ELSE 'Other'
        END AS industry_bucket,
        base.de_parent_company_c AS de_account_parent_name,
        base.de_ultimate_parent_company_c AS de_ultimate_parent_account_name,
        base.ao_instance_number_c AS ao_instance_number,
        base.do_not_market_c AS do_not_market,
        base.target_account_c AS target_account,
        base.market_segment_static_c AS market_segment_static,
        base.sdr_c AS sdr,
        base.current_contract_c AS current_contract,
        base.onboarding_completion_date_c AS onboarding_completion_date,
        base.customer_since_c AS customer_since,
        base.onboarding_specialist_c AS onboarding_specialist,
        base.executive_sponsor_c AS executive_sponsor,
        base.assigned_account_tier_c AS assigned_account_tier,
        base.business_model_c AS business_model,
        base.contract_type_c AS contract_type,
        base.delivered_support_tier_c AS delivered_support_tier,
        parent.name AS account_parent_name,
        base.deliverability_consultant_c AS deliverability_consultant_id,
        sdr.user_email AS sdr_email,
        sdr.user_first_name AS sdr_first_name,
        sdr.user_full_name AS sdr_full_name,
        sdr.user_photo AS sdr_photo,
        sdr.calendly_link AS sdr_calendly,
        sdr.user_title AS sdr_title,
        sdr.user_phone AS sdr_phone,
        csm.user_email AS account_csm_email,
        csm.user_photo AS account_csm_photo,
        csm.user_id AS csm_id,
        csm.user_full_name AS account_csm_name,
        account_owner.user_full_name AS account_owner_name,
        account_owner.user_email AS account_owner_email,
        account_owner.calendly_link AS account_owner_calendly,
        account_owner.user_photo AS account_owner_photo,
        onboarding.user_photo AS onboarding_specialist_photo,
        onboarding.user_email AS onboarding_specialist_email,
        onboarding.user_full_name AS onboarding_specialist_name,
        deliverability.user_email AS account_deliverability_consultant_email,
        deliverability.user_full_name AS account_deliverability_consultant,
        opp_source_xf.is_closed,
        contract_source_xf.end_date,
        CASE 
            WHEN base.annual_revenue <= 49999999 THEN 'SMB'
            WHEN base.annual_revenue > 49999999 AND base.annual_revenue <= 499999999 THEN 'Mid-Market'
            WHEN base.annual_revenue > 499999999 THEN 'Enterprise'
        END AS company_size_rev,
        COUNT(DISTINCT opp_source_xf.opportunity_id) AS number_of_open_opportunities,
        CASE 
            WHEN opp_source_xf.is_closed = false THEN COUNT(DISTINCT opp_source_xf.opportunity_id)
            ELSE 0
        END AS number_of_open_opps,
        CASE
            WHEN base.billing_country IS NOT null AND base.billing_country IN ('GB','UK','IE','DE','DK','FI','IS','NO','SE','FR','AL','AD','AM','AT','BY','BE','BA','BG','HR','CS','CY','CZ','EE','FX','GE','GR','HU','IT','LV','LI','LT','LU','MK','MT','MD','MC','ME','NL','PL','PT','RO','SM','RS','SJ','SK','SI','ES','CH','UA','VA','FO','GI','GG','IM','JE','XK','RU') THEN 'EUROPE'
            WHEN base.billing_country IS NOT null AND base.billing_country IN ('JP','KR','CN','MN','TW','VN','HK','LA','TH','KH','PH','MY','SG','ID','LK','IN','NP','BT','MM','PK','AF','KG','UZ','TM','KZ') THEN 'APJ'
            WHEN base.billing_country IS NOT null AND base.billing_country IN ('AU','CX','NZ','NF','Australia','New Zealand') THEN 'AUNZ'
            WHEN base.billing_country IS NOT null AND base.billing_country IN ('AR','BO','BR','BZ','CL','CO','CU','CR','DO','EC','FK','GF','GS','GY','GT','HN','MX','NI','PA','PE','PR','PY','SR','SV','UY','VE')THEN 'LATAM'
            WHEN base.billing_state IS NOT null AND base.billing_state IN ('CA','NV','UT','AK','MO','CO','HI','OK','IL','AR','NE','MI','KS','OR','WA','ID','WI','MN','ND','SD','MT','WY','IA','NB','ON','PE','QC','AB','BC','MB','SK','NL','NS','YT','NU','NT') THEN 'NA-WEST'
            WHEN base.billing_state IS NOT null AND base.billing_state IN ('NY','CT','MA','VT','NH','ME','NJ','RI','TX','AZ','NM','MS','LA','AL','TN','KY','OH','IN','GA','FL','NC','SC','PA','DC','DE','MD','VA','WV') THEN 'NA-EAST'
            WHEN base.billing_country IS NOT null AND base.billing_country IN ('AG','AI','AN','AW','BB','BM','BS','DM','GD','GP','HT','JM','KN','LC','MQ','MS','TC','TT','VC','VG','VI') THEN 'NA-EAST'
            WHEN base.billing_country IS NOT null AND base.billing_country IN ('US','CA') AND base.billing_state IS null  THEN 'NA-NO-STATEPROV'
            WHEN base.billing_country IS NOT null AND base.billing_state IS NOT null THEN 'ROW'
            ELSE 'Unknown'
        END AS global_region,
        contract_source_xf.end_date+1 AS renewal_date
        -- "Renewal_Notice_Date__c" AS renewal_notice_date,
    FROM base
    LEFT JOIN "acton".salesforce."account" AS parent ON
    base.id=parent.parent_id
    LEFT JOIN "acton"."Postgres"."user_source_xf" AS sdr ON
    base.sdr_c=sdr.user_id
    LEFT JOIN "acton"."Postgres"."user_source_xf" AS csm ON
    base.csm_c=csm.user_id
    LEFT JOIN "acton"."Postgres"."user_source_xf" AS account_owner ON
    base.owner_id=account_owner.user_id
    LEFT JOIN "acton"."Postgres"."user_source_xf" AS onboarding ON
    base.onboarding_specialist_c=onboarding.user_id
    LEFT JOIN "acton"."Postgres"."user_source_xf" AS deliverability ON
    base.deliverability_consultant_c=deliverability.user_id
    LEFT JOIN "acton"."Postgres"."opp_source_xf" ON
    base.id=opp_source_xf.account_id
    LEFT JOIN "acton"."Postgres"."contract_source_xf" ON
    base.current_contract_c=contract_source_xf.contract_id
    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66

)

SELECT 
final.*,
CASE
    WHEN global_region IN ('EUROPE','ROW','AUNZ') THEN 'EMEA'
    WHEN company_size_rev IN ('SMB') OR company_size_rev IS null THEN 'Velocity'
    WHEN company_size_rev IN ('Mid-Market','Enterprise') THEN 'Upmarket'
    ELSE null
END AS segment 
FROM final
  );
  
[0m16:24:05.538709 [debug] [Thread-5 (]: SQL status: SELECT 5868221 in 41.82 seconds
[0m16:24:05.541702 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_webpages"
[0m16:24:05.542698 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webpages: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_webpages"} */
alter table "acton"."Postgres"."ao_webpages" rename to "ao_webpages__dbt_backup"
[0m16:24:05.588575 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.05 seconds
[0m16:24:05.590571 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_webpages"
[0m16:24:05.591569 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webpages: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_webpages"} */
alter table "acton"."Postgres"."ao_webpages__dbt_tmp" rename to "ao_webpages"
[0m16:24:05.633457 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:24:05.634453 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webpages: COMMIT
[0m16:24:05.635451 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_webpages"
[0m16:24:05.635451 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webpages: COMMIT
[0m16:24:05.679333 [debug] [Thread-5 (]: SQL status: COMMIT in 0.04 seconds
[0m16:24:05.682325 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_webpages"
[0m16:24:05.682325 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webpages: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_webpages"} */
drop table if exists "acton"."Postgres"."ao_webpages__dbt_backup" cascade
[0m16:24:05.753993 [debug] [Thread-5 (]: SQL status: DROP TABLE in 0.07 seconds
[0m16:24:05.754991 [debug] [Thread-5 (]: finished collecting timing info
[0m16:24:05.755988 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_webpages: Close
[0m16:24:05.756986 [info ] [Thread-5 (]: 6 of 31 OK created sql table model Postgres.ao_webpages ........................ [[32mSELECT 5868221[0m in 42.42s]
[0m16:24:05.756986 [debug] [Thread-5 (]: Finished running node model.acton_marketing_data.ao_webpages
[0m16:24:05.757982 [debug] [Thread-2 (]: Began running node model.acton_marketing_data.ao_webpages_xf
[0m16:24:05.757982 [info ] [Thread-2 (]: 18 of 31 START sql table model Postgres.ao_webpages_xf ......................... [RUN]
[0m16:24:05.758980 [debug] [Thread-2 (]: Acquiring new postgres connection "model.acton_marketing_data.ao_webpages_xf"
[0m16:24:05.758980 [debug] [Thread-2 (]: Began compiling node model.acton_marketing_data.ao_webpages_xf
[0m16:24:05.758980 [debug] [Thread-2 (]: Compiling model.acton_marketing_data.ao_webpages_xf
[0m16:24:05.762970 [debug] [Thread-2 (]: Writing injected SQL for node "model.acton_marketing_data.ao_webpages_xf"
[0m16:24:05.763967 [debug] [Thread-2 (]: finished collecting timing info
[0m16:24:05.763967 [debug] [Thread-2 (]: Began executing node model.acton_marketing_data.ao_webpages_xf
[0m16:24:05.772943 [debug] [Thread-2 (]: Writing runtime sql for node "model.acton_marketing_data.ao_webpages_xf"
[0m16:24:05.772943 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_webpages_xf"
[0m16:24:05.773941 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_webpages_xf: BEGIN
[0m16:24:05.773941 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:24:06.180012 [debug] [Thread-2 (]: SQL status: BEGIN in 0.41 seconds
[0m16:24:06.180396 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_webpages_xf"
[0m16:24:06.180396 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_webpages_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_webpages_xf"} */

  
    

  create  table "acton"."Postgres"."ao_webpages_xf__dbt_tmp"
  as (
    

SELECT 
-- IDs
    contact_e_mail AS email,
    unique_visitor_id,

-- Webpage Attributes
    page_url,
    referral_url,
    visitor_type,
    url_path_info AS url_path,
    SPLIT_PART(SPLIT_PART(page_url,'utm_campaign=',2),'&',1) AS campaign,
    SPLIT_PART(SPLIT_PART(page_url,'utm_channel=',2),'&',1) AS channel,
    SPLIT_PART(SPLIT_PART(page_url,'utm_source=',2),'&',1) AS source,
    SPLIT_PART(SPLIT_PART(page_url,'utm_medium=',2),'&',1) AS medium,
    SPLIT_PART(SPLIT_PART(page_url,'utm_content=',2),'&',1) AS content,
    
-- Action Data
    action,
    action_time,
    action_day,

-- Other Data
    attribution_id,
    cookie_id,
    ip_address,
    e_mail_domain AS email_domain
FROM "acton"."Postgres"."ao_webpages"
WHERE contact_e_mail IS NOT null
  );
  
[0m16:24:41.323600 [debug] [Thread-2 (]: SQL status: SELECT 1516237 in 35.14 seconds
[0m16:24:41.325597 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_webpages_xf"
[0m16:24:41.325597 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_webpages_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_webpages_xf"} */
alter table "acton"."Postgres"."ao_webpages_xf__dbt_tmp" rename to "ao_webpages_xf"
[0m16:24:41.374428 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.05 seconds
[0m16:24:41.375435 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_webpages_xf: COMMIT
[0m16:24:41.375435 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_webpages_xf"
[0m16:24:41.376437 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_webpages_xf: COMMIT
[0m16:24:41.422221 [debug] [Thread-2 (]: SQL status: COMMIT in 0.05 seconds
[0m16:24:41.424244 [debug] [Thread-2 (]: Using postgres connection "model.acton_marketing_data.ao_webpages_xf"
[0m16:24:41.424244 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_webpages_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_webpages_xf"} */
drop table if exists "acton"."Postgres"."ao_webpages_xf__dbt_backup" cascade
[0m16:24:41.468724 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:24:41.469727 [debug] [Thread-2 (]: finished collecting timing info
[0m16:24:41.469727 [debug] [Thread-2 (]: On model.acton_marketing_data.ao_webpages_xf: Close
[0m16:24:41.470724 [info ] [Thread-2 (]: 18 of 31 OK created sql table model Postgres.ao_webpages_xf .................... [[32mSELECT 1516237[0m in 35.71s]
[0m16:24:41.471922 [debug] [Thread-2 (]: Finished running node model.acton_marketing_data.ao_webpages_xf
[0m16:25:00.709736 [debug] [Thread-1 (]: SQL status: SELECT 14787925 in 97.71 seconds
[0m16:25:00.711908 [debug] [Thread-1 (]: Using postgres connection "model.acton_marketing_data.ao_emails"
[0m16:25:00.711908 [debug] [Thread-1 (]: On model.acton_marketing_data.ao_emails: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_emails"} */
alter table "acton"."Postgres"."ao_emails" rename to "ao_emails__dbt_backup"
[0m16:25:00.762723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.05 seconds
[0m16:25:00.765717 [debug] [Thread-1 (]: Using postgres connection "model.acton_marketing_data.ao_emails"
[0m16:25:00.765717 [debug] [Thread-1 (]: On model.acton_marketing_data.ao_emails: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_emails"} */
alter table "acton"."Postgres"."ao_emails__dbt_tmp" rename to "ao_emails"
[0m16:25:00.808855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:25:00.810850 [debug] [Thread-1 (]: On model.acton_marketing_data.ao_emails: COMMIT
[0m16:25:00.810850 [debug] [Thread-1 (]: Using postgres connection "model.acton_marketing_data.ao_emails"
[0m16:25:00.810850 [debug] [Thread-1 (]: On model.acton_marketing_data.ao_emails: COMMIT
[0m16:25:00.859901 [debug] [Thread-1 (]: SQL status: COMMIT in 0.05 seconds
[0m16:25:00.862066 [debug] [Thread-1 (]: Using postgres connection "model.acton_marketing_data.ao_emails"
[0m16:25:00.862066 [debug] [Thread-1 (]: On model.acton_marketing_data.ao_emails: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_emails"} */
drop table if exists "acton"."Postgres"."ao_emails__dbt_backup" cascade
[0m16:25:00.944396 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.08 seconds
[0m16:25:00.945396 [debug] [Thread-1 (]: finished collecting timing info
[0m16:25:00.945396 [debug] [Thread-1 (]: On model.acton_marketing_data.ao_emails: Close
[0m16:25:00.946393 [info ] [Thread-1 (]: 1 of 31 OK created sql table model Postgres.ao_emails .......................... [[32mSELECT 14787925[0m in 98.46s]
[0m16:25:00.947390 [debug] [Thread-1 (]: Finished running node model.acton_marketing_data.ao_emails
[0m16:25:00.947390 [debug] [Thread-5 (]: Began running node model.acton_marketing_data.ao_emails_xf
[0m16:25:00.948416 [info ] [Thread-5 (]: 19 of 31 START sql table model Postgres.ao_emails_xf ........................... [RUN]
[0m16:25:00.948416 [debug] [Thread-5 (]: Acquiring new postgres connection "model.acton_marketing_data.ao_emails_xf"
[0m16:25:00.949386 [debug] [Thread-5 (]: Began compiling node model.acton_marketing_data.ao_emails_xf
[0m16:25:00.949386 [debug] [Thread-5 (]: Compiling model.acton_marketing_data.ao_emails_xf
[0m16:25:00.951503 [debug] [Thread-5 (]: Writing injected SQL for node "model.acton_marketing_data.ao_emails_xf"
[0m16:25:00.952543 [debug] [Thread-5 (]: finished collecting timing info
[0m16:25:00.953513 [debug] [Thread-5 (]: Began executing node model.acton_marketing_data.ao_emails_xf
[0m16:25:00.960521 [debug] [Thread-5 (]: Writing runtime sql for node "model.acton_marketing_data.ao_emails_xf"
[0m16:25:00.961678 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_emails_xf"
[0m16:25:00.961678 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_emails_xf: BEGIN
[0m16:25:00.961678 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:25:01.415574 [debug] [Thread-5 (]: SQL status: BEGIN in 0.45 seconds
[0m16:25:01.415574 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_emails_xf"
[0m16:25:01.416623 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_emails_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_emails_xf"} */

  
    

  create  table "acton"."Postgres"."ao_emails_xf__dbt_tmp"
  as (
    

SELECT
-- IDs
    message_id,
    recipient_e_mail AS email,
    record_id,
    unique_visitor_id,

--Message Attributes
    message_title,
    subject AS subject_line,
    "from" AS from_address,

--Action Attributes
    action,
    action_time,
    action_day,
    SPLIT_PART(SPLIT_PART(clicked_url,'utm_campaign=',2),'&',1) AS campaign,
    SPLIT_PART(SPLIT_PART(clicked_url,'utm_channel=',2),'&',1) AS channel,
    SPLIT_PART(SPLIT_PART(clicked_url,'utm_source=',2),'&',1) AS source,
    SPLIT_PART(SPLIT_PART(clicked_url,'utm_medium=',2),'&',1) AS medium,
    SPLIT_PART(SPLIT_PART(clicked_url,'utm_content=',2),'&',1) AS content,
    clicked_url,
    clickthrough_link_name
FROM "acton"."Postgres"."ao_emails"
WHERE action = 'CLICKED'
AND recipient_e_mail IS NOT null
AND recipient_e_mail NOT LIKE 'unknown%'
  );
  
[0m16:25:38.926061 [debug] [Thread-5 (]: SQL status: SELECT 631932 in 37.51 seconds
[0m16:25:38.928058 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_emails_xf"
[0m16:25:38.928058 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_emails_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_emails_xf"} */
alter table "acton"."Postgres"."ao_emails_xf__dbt_tmp" rename to "ao_emails_xf"
[0m16:25:38.974808 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.05 seconds
[0m16:25:38.975342 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_emails_xf: COMMIT
[0m16:25:38.976372 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_emails_xf"
[0m16:25:38.976372 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_emails_xf: COMMIT
[0m16:25:39.021579 [debug] [Thread-5 (]: SQL status: COMMIT in 0.05 seconds
[0m16:25:39.024602 [debug] [Thread-5 (]: Using postgres connection "model.acton_marketing_data.ao_emails_xf"
[0m16:25:39.024602 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_emails_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_emails_xf"} */
drop table if exists "acton"."Postgres"."ao_emails_xf__dbt_backup" cascade
[0m16:25:39.068819 [debug] [Thread-5 (]: SQL status: DROP TABLE in 0.04 seconds
[0m16:25:39.069819 [debug] [Thread-5 (]: finished collecting timing info
[0m16:25:39.069819 [debug] [Thread-5 (]: On model.acton_marketing_data.ao_emails_xf: Close
[0m16:25:39.070817 [info ] [Thread-5 (]: 19 of 31 OK created sql table model Postgres.ao_emails_xf ...................... [[32mSELECT 631932[0m in 38.12s]
[0m16:25:39.071813 [debug] [Thread-5 (]: Finished running node model.acton_marketing_data.ao_emails_xf
[0m16:25:50.316525 [debug] [Thread-3 (]: SQL status: SELECT 48039074 in 147.32 seconds
[0m16:25:50.318521 [debug] [Thread-3 (]: Using postgres connection "model.acton_marketing_data.ao_landingpages"
[0m16:25:50.319519 [debug] [Thread-3 (]: On model.acton_marketing_data.ao_landingpages: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_landingpages"} */
alter table "acton"."Postgres"."ao_landingpages" rename to "ao_landingpages__dbt_backup"
[0m16:25:50.370306 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.05 seconds
[0m16:25:50.372162 [debug] [Thread-3 (]: Using postgres connection "model.acton_marketing_data.ao_landingpages"
[0m16:25:50.372162 [debug] [Thread-3 (]: On model.acton_marketing_data.ao_landingpages: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_landingpages"} */
alter table "acton"."Postgres"."ao_landingpages__dbt_tmp" rename to "ao_landingpages"
[0m16:25:50.415975 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.04 seconds
[0m16:25:50.417939 [debug] [Thread-3 (]: On model.acton_marketing_data.ao_landingpages: COMMIT
[0m16:25:50.417939 [debug] [Thread-3 (]: Using postgres connection "model.acton_marketing_data.ao_landingpages"
[0m16:25:50.417939 [debug] [Thread-3 (]: On model.acton_marketing_data.ao_landingpages: COMMIT
[0m16:25:50.468562 [debug] [Thread-3 (]: SQL status: COMMIT in 0.05 seconds
[0m16:25:50.470415 [debug] [Thread-3 (]: Using postgres connection "model.acton_marketing_data.ao_landingpages"
[0m16:25:50.470415 [debug] [Thread-3 (]: On model.acton_marketing_data.ao_landingpages: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_landingpages"} */
drop table if exists "acton"."Postgres"."ao_landingpages__dbt_backup" cascade
[0m16:25:50.566143 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.1 seconds
[0m16:25:50.567178 [debug] [Thread-3 (]: finished collecting timing info
[0m16:25:50.567178 [debug] [Thread-3 (]: On model.acton_marketing_data.ao_landingpages: Close
[0m16:25:50.568147 [info ] [Thread-3 (]: 3 of 31 OK created sql table model Postgres.ao_landingpages .................... [[32mSELECT 48039074[0m in 148.08s]
[0m16:25:50.569145 [debug] [Thread-3 (]: Finished running node model.acton_marketing_data.ao_landingpages
[0m16:25:50.569145 [debug] [Thread-1 (]: Began running node model.acton_marketing_data.ao_landingpages_xf
[0m16:25:50.569145 [info ] [Thread-1 (]: 20 of 31 START sql table model Postgres.ao_landingpages_xf ..................... [RUN]
[0m16:25:50.570170 [debug] [Thread-1 (]: Acquiring new postgres connection "model.acton_marketing_data.ao_landingpages_xf"
[0m16:25:50.571139 [debug] [Thread-1 (]: Began compiling node model.acton_marketing_data.ao_landingpages_xf
[0m16:25:50.571139 [debug] [Thread-1 (]: Compiling model.acton_marketing_data.ao_landingpages_xf
[0m16:25:50.574159 [debug] [Thread-1 (]: Writing injected SQL for node "model.acton_marketing_data.ao_landingpages_xf"
[0m16:25:50.575129 [debug] [Thread-1 (]: finished collecting timing info
[0m16:25:50.575129 [debug] [Thread-1 (]: Began executing node model.acton_marketing_data.ao_landingpages_xf
[0m16:25:50.583269 [debug] [Thread-1 (]: Writing runtime sql for node "model.acton_marketing_data.ao_landingpages_xf"
[0m16:25:50.584237 [debug] [Thread-1 (]: Using postgres connection "model.acton_marketing_data.ao_landingpages_xf"
[0m16:25:50.584237 [debug] [Thread-1 (]: On model.acton_marketing_data.ao_landingpages_xf: BEGIN
[0m16:25:50.584237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:51.019250 [debug] [Thread-1 (]: SQL status: BEGIN in 0.44 seconds
[0m16:25:51.019250 [debug] [Thread-1 (]: Using postgres connection "model.acton_marketing_data.ao_landingpages_xf"
[0m16:25:51.019250 [debug] [Thread-1 (]: On model.acton_marketing_data.ao_landingpages_xf: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "deployment", "target_name": "postgres", "node_id": "model.acton_marketing_data.ao_landingpages_xf"} */

  
    

  create  table "acton"."Postgres"."ao_landingpages_xf__dbt_tmp"
  as (
    

SELECT 
-- IDs
    landing_page_id,
    e_mail_address AS email,
    record_id,
    unique_visitor_id,

-- LP Attributes
    landing_page_title,
    SPLIT_PART(SPLIT_PART(clicked_url,'utm_campaign=',2),'&',1) AS campaign,
    SPLIT_PART(SPLIT_PART(clicked_url,'utm_channel=',2),'&',1) AS channel,
    SPLIT_PART(SPLIT_PART(clicked_url,'utm_source=',2),'&',1) AS source,
    SPLIT_PART(SPLIT_PART(clicked_url,'utm_medium=',2),'&',1) AS medium,
    SPLIT_PART(SPLIT_PART(clicked_url,'utm_content=',2),'&',1) AS content,
    clicked_url,
    clickthrough_link_name,
    referral_url,

-- Action Data
    action,
    action_time,
    action_day,

-- Other Data
    cookie_id,
    ip_address,
    e_mail_domain AS email_domain
FROM "acton"."Postgres"."ao_landingpages"
WHERE e_mail_address IS NOT null
AND e_mail_address NOT LIKE 'unknown%'
  );
  
